<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Machine Learning on Quantopian part 1: Basics
</title>
<meta content='This is the first part of our series on Machine Learning on Quantopian. See  Part 2  to see how to run this NB in a walk-forward manner and  Part 3  for a fully functional ML algorithm. Recently, Quantopian’s Chief Investment Officer, Jonathan Larkin, shared an industry insider’s overview of the  professional quant equity workflow . This workflow is comprised of distinct stages including: (1) Universe Definition, (2) Alpha Discovery, (3) Alpha Combination, (4) Portfolio Construction and (5)...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="3JHACjFVOFzKLax8gwpGZ0KIXU2QkUPCk6Ddhuoiz52g97ZHk6Pqv3Mw9U3M5e4TegZ+JOpdVtkRrwbsQGetJg==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=true;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/machine-learning-on-quantopian-part-1-basics' property='og:url'>
<meta content='Machine Learning on Quantopian part 1: Basics' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/machine-learning-on-quantopian-part-1-basics' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Machine Learning on Quantopian part 1: Basics' property='og:title'>
<meta content='This is the first part of our series on Machine Learning on Quantopian. See  Part 2  to see how to run this NB in a walk-forward manner and  Part 3  for a fully functional ML algorithm. Recently, Quantopian’s Chief Investment Officer, Jonathan Larkin, shared an industry insider’s overview of the  professional quant equity workflow . This workflow is comprised of distinct stages including: (1) Universe Definition, (2) Alpha Discovery, (3) Alpha Combination, (4) Portfolio Construction and (5)...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/machine-learning-on-quantopian-part-1-basics">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='57e1164ad73bba1af50001f9'>
<div class='post-container' data-post-id='57e1164ad73bba1af50001f9' id='57e1164ad73bba1af50001f9'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Machine Learning on Quantopian part 1: Basics</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<span class='posted-at'>edited </span>
<span UTCms='1558692788000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Machine Learning on Quantopian part 1: Basics&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fmachine-learning-on-quantopian-part-1-basics%3Futm_source%3Dwebsite_share%26utm_campaign%3Dmachine-learning-on-quantopian%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fmachine-learning-on-quantopian-part-1-basics%3Futm_source%3Dwebsite_share%26utm_campaign%3Dmachine-learning-on-quantopian%26utm_medium%3Dlinkedin&amp;title=Machine+Learning+on+Quantopian+part+1%3A+Basics+%28Thomas+Wiecki%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Machine Learning' data-tag-id='55c50e7d8d4710ec6e00000b' href='/posts/tag/Machine-Learning/newest'>Machine Learning</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Research' data-tag-id='55c50e7d8d4710ec6e000018' href='/posts/tag/Research/newest'>Research</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-1-basics?utm_source=website_share&amp;utm_campaign=machine-learning-on-quantopian&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Thomas Wiecki" />
<div class='body-text'>
<div class='body-text-container post-body'><p>This is the first part of our series on Machine Learning on Quantopian. See <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-2-ml-as-a-factor">Part 2</a> to see how to run this NB in a walk-forward manner and <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm">Part 3</a> for a fully functional ML algorithm.</p>

<p>Recently, Quantopian’s Chief Investment Officer, Jonathan Larkin, shared an industry insider’s overview of the <a href="http://blog.quantopian.com/a-professional-quant-equity-workflow/">professional quant equity workflow</a>. This workflow is comprised of distinct stages including: (1) Universe Definition, (2) Alpha Discovery, (3) Alpha Combination, (4) Portfolio Construction and (5) Trading.</p>

<p>This Notebook focuses on stage 3: Alpha Combination. At this stage, Machine Learning is an intuitive choice as we have abstracted the problem to such a degree that it is now a classic classification (or regression) problem which ML is very good at solving and coming up with an alpha combination that is predictive.</p>

<p>In this notebook we will show how to:</p>

<ul>
<li>construct alphas in pipeline,<br></li>
<li>preprocess alphas so that they can be fed into scikit-learn classifiers,<br></li>
<li>train a ML classifier on these alphas with good performance on hold-out data,<br></li>
<li>analyze which alphas were most predictive.</li>
</ul>

<p>In addition, this notebook discusses:</p>

<ul>
<li>Pointers on how to improve the accuracy.<br></li>
<li>A small Machine Learning competition.<br></li>
<li>Resources to further your understanding of Machine Learning.</li>
</ul>

<p>Note, however, that this workflow is still a bit rough around the edges. We are working on improving it and adding better educational materials. This serves as a sneak-peek for the curious and adventurous.</p>
</div>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>160 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='57e121e5ed23aa5b61000321' id='57e121e5ed23aa5b61000321'>
<a href='#57e121e5ed23aa5b61000321'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474372075000' class='quanto-date posted-at response-posted-at' href='#57e121e5ed23aa5b61000321'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>And here is a library of commonly used alpha factors. You can copy&amp;paste some (or all?) of these into the above notebook to see if you can improve the accuracy of the classification. Ultimately, we will include these in a library you can just import.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e13e41c063a92d7e000160' id='57e13e41c063a92d7e000160'>
<a href='#57e13e41c063a92d7e000160'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1474379336000' class='quanto-date posted-at response-posted-at' href='#57e13e41c063a92d7e000160'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Stunning, no other word for it.<br>
It will take me a while to absorb it all since I am still currently working through various books. However, your work will make this entire area vastly easier for me to comprehend and put into practice.</p>

<p>One initial question:</p>

<blockquote>
<p>Exercise: It is also common to run cross-validation on the training data and tweak the parameters based on that score, testing should only be done rarely.</p>
</blockquote>

<p>I am aware of having made serious errors in this respect in the past. I still can&#39;t quite think my way through this properly. I understand the whole concept of cross validation on training data and so forth but wonder whether you could expand your thoughts a little on when to actually resort to the test data? </p>

<p>We will be coming up with countless different models using a combination of the factors. I&#39;m just not quite clear on when to use any of those models on the test data.</p>

<blockquote>
<p>Accuracy on test set = 67.26%</p>
</blockquote>

<p>As you are well aware, predictions on price alone rarely exceed much above the 50% random level. This therefore seems more than a &quot; small edge in the market (or at least the test set)! &quot;</p>

<p>It will be interesting to see as we implement models going forward whether this sort of accuracy can be maintained on fresh data. But it certainly looks promising, even if it has not yet been put into an actual system for back testing.</p>

<p>Interesting to see the low ranking of momentum.</p>

<p>Anyway, thanks to the whole team for this.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e1424cbb67fc6087000078' id='57e1424cbb67fc6087000078'>
<a href='#57e1424cbb67fc6087000078'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474380373000' class='quanto-date posted-at response-posted-at' href='#57e1424cbb67fc6087000078'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks, Anthony.</p>

<p>Cross-validation: A common method is to do model development and comparison without ever touching the hold-out set. Once you have something you think works really well you put it to the final test to see how much you fooled yourself. A good mind-set is that you lose something every time you test on your hold-out set.</p>

<p>Accuracy: I&#39;m a bit suspicious of that myself. Initially I got more like 53% which seems much more reasonable. I think this is due to having overlapping time-periods. The factors themselves are computed over overlapping windows and so are the returns to be predicted. Thus, probably just by forward-projecting you get pretty good predictability. Then again, the classifier does not have access to any forward returns so can&#39;t just forward-fill (except the first 4 days). I can post another version where I subsample the data to only train and predict once every week to avoid the overlap. This brings accuracy down significantly (i.e. to 53%). The ultimate test, as always, will be how well this predicts on future data (i.e. testing the classifier in a month from now).  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e144b4bb67fc608700008c' id='57e144b4bb67fc608700008c'>
<a href='#57e144b4bb67fc608700008c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474380988000' class='quanto-date posted-at response-posted-at' href='#57e144b4bb67fc608700008c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Anthony: The high accuracy was indeed driven by the overlap from the training day returns into the testing day returns. I updated the NB now to leave a 4-day delay between train and test (as we have 5-day returns) and the accuracy is down to a more reasonable 53.3%.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e14c82cd655901ed000153' id='57e14c82cd655901ed000153'>
<a href='#57e14c82cd655901ed000153'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1474382986000' class='quanto-date posted-at response-posted-at' href='#57e14c82cd655901ed000153'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>and the accuracy is down to a more reasonable 53.3%.</p>
</blockquote>

<p>Got it, thanks Thomas. As you know a typical unadorned trend following system as practiced by the old style CTAs rarely has &quot;accuracy&quot; of more than 40%. I E the win loss ratio is around 40/60. </p>

<p>Given that, an accuracy of 53.3% ought to be quite high enough to profit handsomely when combined with the usual TF type rules of letting profits run and cutting winners. </p>

<p>But more of that anon when I have a clearer view of ML and the whole process.</p>

<p>This all seems a huge step forward.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e15e4dc4e345e02500022f' id='57e15e4dc4e345e02500022f'>
<a href='#57e15e4dc4e345e02500022f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/576591f557c9cda4520005fc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d5eb91b2c6bc98ecbd25c910b1ba0c00?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/576591f557c9cda4520005fc'>James Hutchison</a>
</div>
<a UTCms='1474387544000' class='quanto-date posted-at response-posted-at' href='#57e15e4dc4e345e02500022f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>it seems like we need a way to save a trained ANN.  just like people, the intelligence of each network can vary based on the initial weights and the training set it was given.</p>

<p>also, input data needs to be randomized to avoid over learning a common segment. not sure if that is done automatically using the tools given  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e240a61deda18691000a16' id='57e240a61deda18691000a16'>
<a href='#57e240a61deda18691000a16'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56990262be2416509000011c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0cccbbae7e2a982659980bd3c4d0a6eb?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56990262be2416509000011c'>Richard Jamieson</a>
</div>
<a UTCms='1474445489000' class='quanto-date posted-at response-posted-at' href='#57e240a61deda18691000a16'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Anthony &amp; others who may be interested - check out udacity&#39;s free course &#39;Intro to Machine Learning&#39; - it&#39;s specifically focused on python, and the sklearn module, and I&#39;ve found it an excellent course.</p>

<p>@ Thomas thanks for the notebook, looks really cool, gonna get stuck in as soon as I have some time  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e2468e8fe17039a3000a51' id='57e2468e8fe17039a3000a51'>
<a href='#57e2468e8fe17039a3000a51'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1474446999000' class='quanto-date posted-at response-posted-at' href='#57e2468e8fe17039a3000a51'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>it seems like we need a way to save a trained ANN</p>
</blockquote>

<p>Example is AdaBoost, not neural network. I&#39;m not sure why this selection as there are superior alternatives - boosting classifiers are known to overfit easily especally with noisy datasets and financial data clearly is noisy. For example Random forest or extremely randomized forest ie. extratrees are known not to overfit easily.</p>

<p>I didn&#39;t go through the example but if the data is not normalized and the data used has upwards trend (as has been in past years) the training data should be normalized if trend continues or the classifier might just fit the trend - This is even more important when using classifiers like adaboost which are known to overfit easily and especially with unbalanced datasets.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e250bc51d47afda6000a5c' id='57e250bc51d47afda6000a5c'>
<a href='#57e250bc51d47afda6000a5c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474449605000' class='quanto-date posted-at response-posted-at' href='#57e250bc51d47afda6000a5c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas,</p>

<p>You Q folks are doing great work, I&#39;m sure, but for me, it&#39;s a bit like trying to eat a nice steak in one bite (and perhaps trying to take in a whole potato, as well).</p>

<p>My understanding is that you are interested in &quot;coming up with an alpha combination that is predictive&quot; (in &#39;combination&#39; you presumably include interactions, up to some effective polynomial order?).  Presumably, you are trying to predict forward daily returns, based on daily prices (open or close...take your pick).  There is a vector of Y&#39;s, which consists of the daily returns of N stocks (not per unit wall clock time, since early closes/weekends/holidays are ignored).  So, the name of the game is to find the set of M X&#39;s that, in combination, best predict Y&#39;s (on any timescale...I just need predictability to trade).  The X&#39;s consist of a set of &quot;commonly used factors&quot; (fundamentals, technical indicator, and their combinations, etc....whatever one dreams up).</p>

<p>So, if I follow, there are returns for N stocks (Y), and the supposition is that M factors (X) can be used to predict those returns.  So, in effect, are you creating N independent models?  Are you finding Yn = fn(Xn), where n corresponds to the nth stock?</p>

<p>Or is it that you are building a model that best predicts the overall return (R) and the model consists of the M factors and the weightings of N stocks in the portfolio?  Something like R = f(X,W), where R is the scalar overall return of my optimized portfolio, X is a vector of M factors, and W is a vector of N stock weights?</p>

<p>Or maybe you are doing something else altogether?</p>

<p>On a separate note, I can&#39;t tell from your notebook if you are computing the feature importance for a single period, or these features would be considered persistent over a long time span (e.g. back to 2002 or whatever)?  It would seem the question to answer would be, are there any factors that are consistently predictive over many market cycles (even if their relative importance varies with time).  In other words, which factors are total junk and which ones are the gems.  Should I include the age/gender/nationality/favorite food of the CEO?  Or do these factors never have any predictive power whatsoever, and just over-complicate the model, and impute a risk of over-fitting?</p>

<p>What is the chart of &quot;Feature importances&quot; telling us?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e265bc57e9c90312000b56' id='57e265bc57e9c90312000b56'>
<a href='#57e265bc57e9c90312000b56'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474454982000' class='quanto-date posted-at response-posted-at' href='#57e265bc57e9c90312000b56'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another question is, it seems that your workflow of screening individual factors using alphalens, followed by combination (using ML), would assume that you don&#39;t have terms like y = c*x1*x2 (where c is a constant)?  If the response, y, is a function of the product of the factors x1 &amp; x2 only, then they won&#39;t survive to the combination step; they would be ruled out using alphalens (since it only looks at individual factors, right?).  Is this a correct understanding?  Or would alphalens include a model up to, say y = a*(b + x1)*(c + x2), which includes the cross-term?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e2664057e9c947ce000bed' id='57e2664057e9c947ce000bed'>
<a href='#57e2664057e9c947ce000bed'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1474455118000' class='quanto-date posted-at response-posted-at' href='#57e2664057e9c947ce000bed'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>What is the chart of &quot;Feature importances&quot; telling us? </p>
</blockquote>

<p>In ensembles of trees &quot;Feature importance&quot; basically tells how many times given input is used in tree ensemble.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e316b851d47a4fe400037c' id='57e316b851d47a4fe400037c'>
<a href='#57e316b851d47a4fe400037c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474500290000' class='quanto-date posted-at response-posted-at' href='#57e316b851d47a4fe400037c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Mikko -</p>

<blockquote>
<p>how many times given input is used in tree ensemble</p>
</blockquote>

<p>Is it a good thing for a factor to be used many times in a tree ensemble?  Or bad?  Presumably good.</p>

<p>Also, what is meant by &quot;a non-linear combination of features&quot; as used in the notebook?  Is this in the sense of the quadratic and cubic models described on <a href="http://www.itl.nist.gov/div898/handbook/pri/section3/pri336.htm">http://www.itl.nist.gov/div898/handbook/pri/section3/pri336.htm</a> ?</p>

<p>Uggh...lots to learn here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e391a1ab3ccd91be000371' id='57e391a1ab3ccd91be000371'>
<a href='#57e391a1ab3ccd91be000371'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1474531752000' class='quanto-date posted-at response-posted-at' href='#57e391a1ab3ccd91be000371'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Mikko M<br>
Exactly what type of normalisation are you suggesting and at what stage? Is each and every factor to be scaled between 0 and 1 at the very beginning ? Or standardised? Or what?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e395890cb622f6c30003eb' id='57e395890cb622f6c30003eb'>
<a href='#57e395890cb622f6c30003eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474532754000' class='quanto-date posted-at response-posted-at' href='#57e395890cb622f6c30003eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Every factor is first ranked and then scaled to be between 0 and 1. Scaling matters for some classifiers but not tree-based ones as used here. Returns are converted to -1 and 1 by median-splitting.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e3971a0cb622f6c30003f8' id='57e3971a0cb622f6c30003f8'>
<a href='#57e3971a0cb622f6c30003f8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1474533156000' class='quanto-date posted-at response-posted-at' href='#57e3971a0cb622f6c30003f8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>Scaling matters for some classifiers</p>
</blockquote>

<p>Yes, so I understand. Does this scaling you have put into place here suffice for all classifiers? Or would some prefer other methods? And de-trending (as Mikko M seems to be suggesting)? Or does this amount to the same thing in the way you have done it?</p>

<p>In any event, the framework is there and I guess people can experiment in any way they want. Which has to be a good thing. Its a great framework and given the fundamental data from Morningstar its all there, wide open for experimentation.<br>
A  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e3a77bab3ccd70030000c3' id='57e3a77bab3ccd70030000c3'>
<a href='#57e3a77bab3ccd70030000c3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474537347000' class='quanto-date posted-at response-posted-at' href='#57e3a77bab3ccd70030000c3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas,</p>

<p>If it is not obvious from my comments here and elsewhere, I&#39;m interested in the overall workflow you folks are putting together, but I&#39;m finding it challenging to get the bigger picture.  Your efforts seem to be based on an established intellectual edifice that is foreign to me.  Jonathan Larkin provides a decent 30,000 foot view on <a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">https://blog.quantopian.com/a-professional-quant-equity-workflow/</a>.  We have the 
<code>Q500US</code> &amp; <code>Q1500US</code> (along with the more general <code>make_us_equity_universe</code>), and then alphalens, which is a manual tool for analyzing individual factors.  Followed by your work above, to combine the factors.  Etc.</p>

<p>At a level lower than 30,000 feet, but above the ground level of individual lines of code (let&#39;s say 10,000 feet), there is a kind of overall point-in-time optimization problem that is being solved, which includes the universe selection, and the factors and their interactions.  There&#39;s also the issue of how the universe selection interacts with the factors, which I don&#39;t think is addressed in the workflow (at least not as a factor to be automatically optimized).  In the end, it would seem that as an output of the factor combination step, I should have a model of how to forecast returns for every stock independently, no?  Is that where we are headed?  Then the portfolio construction step would be to sort out how to apply those forecasts and construct portfolio weights (i.e. how much of my portfolio should be in XYZ at any given point in time)?</p>

<p>Perhaps you could provide a sense for the overall optimization problem that is being solved (across the entire workflow) and how your factor combination step fits in?  Presumably, your &quot;library of commonly used alpha factors&quot; was run through alphalens and somehow vetted?  Each one was shown to have some predictive power individually, and now you are combining them in a fashion that accounts for interactions (&quot;a non-linear combination of features&quot;).  Sorry, as I said, I&#39;m missing the 10,000 foot view.  What are you doing?</p>

<p>To provide some background, I am familiar with the so-called &quot;response surface methodology&quot; used in design and process engineering.  My fuzzy picture is that you are building a multi-dimensional response surface that can be used for optimization, subject to constraints?  If so, what order of model are you constructing (first-order, second-order)?  Is the ML model effectively the response surface?  Or has it already done the optimization?  Again, I&#39;m obviously confused...</p>

<p>Best regards,</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e40850e73a964db50002f0' id='57e40850e73a964db50002f0'>
<a href='#57e40850e73a964db50002f0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474562134000' class='quanto-date posted-at response-posted-at' href='#57e40850e73a964db50002f0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Anthony: Yes, this normalization works for all classifiers.</p>

<p>Grant:  </p>

<blockquote>
<p>I should have a model of how to forecast returns for every stock independently, no?</p>
</blockquote>

<p>With independently, do you refer to the fact that we are ranking the stocks here and that rank depends on the other stocks in the univ?</p>

<p>The idea is: we have factors, we combine them in such a way to be predictive of future <em>relative</em> returns. When we can predict that, we just need to long stocks that the model predicts to go up, and short the ones that go down. The other stuff is just icing and there are many ways to skin the cat.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e446bb07f55bcc3f00016d' id='57e446bb07f55bcc3f00016d'>
<a href='#57e446bb07f55bcc3f00016d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1474578114000' class='quanto-date posted-at response-posted-at' href='#57e446bb07f55bcc3f00016d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Regarding normalization, as I said before I didn&#39;t go through the code and now after explanation by Thomas it sounds like normalization is done &quot;properly&quot; for long-short purposes.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e450db9b35ba313c0001a5' id='57e450db9b35ba313c0001a5'>
<a href='#57e450db9b35ba313c0001a5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474580709000' class='quanto-date posted-at response-posted-at' href='#57e450db9b35ba313c0001a5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas,</p>

<p>Not sure that makes things any clearer, but I&#39;ll take what I can get.  I&#39;ll have to take another pass through your workbook, to see if I can understand it.  All of this ranking talk, I don&#39;t understand.  For example, if I assign a value of 1-10 to foods that I like, 10 being the highest, then by default, I can rank them.  It is the value assignment that would seem to matter.</p>

<p>I guess you are saying that the underlying assumption is that there is a monotonic relationship between the values and their utility for trading.  So, if I rank them, I can pick the top/bottom 10% or whatever.  Still, it is not the ranking, but the assignment of values in such a way that the monotonicity holds, right?  The ranking is just turning the crank, so to speak.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e4ecd643fb92abb90007b0' id='57e4ecd643fb92abb90007b0'>
<a href='#57e4ecd643fb92abb90007b0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474620639000' class='quanto-date posted-at response-posted-at' href='#57e4ecd643fb92abb90007b0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>Under your section &quot;Run the pipeline&quot; you end up with a table of numbers, resulting from 
<code>results.head()</code>.  How did you derive the table?  I see factors as column labels (except for &quot;Returns&quot;?), and then for each day, there is a list of securities (presumably every security in the universe).  And integers within the table (except for the &quot;Returns&quot; column).  How are you determining the integers?  How are the returns calculated?  Are the returns used to determine the integers?  The integers are ranks, but is the ranking by security (row-wise), but not normalized?  Or by factor (column-wise)?  Or something else?  Are you ranking the relative predictive power of each factor, relative to other factors, by security?  For a single security, I read across, and for a single factor, I read down?</p>

<p>Also, I don&#39;t understand if a factor doesn&#39;t directly predict the 5-day return, then how are you applying it?  For example, <code>Working_Capital_To_Assets</code> doesn&#39;t tell me if I have a stock price for XYZ, what the price will be 5 days later?  Wouldn&#39;t all of my factors need to be formulated to actually forecast prices?</p>

<p>If you could fill in some missing pieces on how you are doing the forecasting and relative ranking, it might help (me at least).  What is the recipe (in words, mostly, since I don&#39;t have the patience to unravel Python/Q API code...which I can do later, once I understand the big picture)?</p>

<p>Thanks,</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e5113d7bc29f9d880002cd' id='57e5113d7bc29f9d880002cd'>
<a href='#57e5113d7bc29f9d880002cd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474629957000' class='quanto-date posted-at response-posted-at' href='#57e5113d7bc29f9d880002cd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The integers are the rank of that factor of that security on that day relative to the rest of the universe. Returns are calculated over a 5-day window. The computation of returns are not influenced by the factor rank or vice-versa. </p>

<p>For example: on day 1 we have four stocks in our universe.<br>
1. On that day <code>Working_Capital_To_Assets</code> values of all stocks are <code>[0.2, 0.3, 0.1, 0.5]</code>.<br>
2. We rank them which will become <code>[1, 2, 0, 3]</code>.<br>
3. We then normalize so that it becomes <code>[0.25, 0.75, 0., 1.]</code>.<br>
4. Assume 5-day-returns from day 2 to day 6 of each stock of <code>[.01, 0.05, -.01, 0.02]</code>.<br>
5. We then binarize the returns by a median-split which gives <code>[-1, 1, -1, 1]</code>.<br>
6. We then feed this into a classifier which will try to find a way to predict the labels from the input. In this case, we could use the decision rule: <code>if normalized_ranked_factor_of_stock_i &gt; 0.5 predict 1, else predict -1</code>. In this case, it would get 100% of the training data correct. </p>

<p>Intuitively, stocks which have a high rank in <code>Working_Capital_To_Assets</code> are predictive of a stock going up more than the other stocks in its universe. </p>

<p>If we were to act on our prediction on day 2, we would long stock 2 and 4 and short stock 1 and 3 and exit the positions on day 6. This would be a profitable trade.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e531a27bc29f9d8800045b' id='57e531a27bc29f9d8800045b'>
<a href='#57e531a27bc29f9d8800045b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1474638248000' class='quanto-date posted-at response-posted-at' href='#57e531a27bc29f9d8800045b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>We then binarize the returns by a median-split which gives [-1, 1, -1, 1].<br>
 if normalized_ranked_factor_of_stock_i &gt; 0.5 predict 1, else predict -1.</p>
</blockquote>

<p>I am going to try a probability based approach rather than stepwise binary.</p>

<blockquote>
<p>Find the top and bottom 30 percentile stocks by their returns. Essentially, we only care about relative movement of stocks. If we later short stocks that go down and long stocks going up relative to each other, it doesn&#39;t matter if e.g. all stocks are going down in absolute terms. Moverover, we are ignoring stocks that did not move that much (i.e. 30th to 70th percentile) to only train the classifier on those that provided strong signal.</p>
</blockquote>

<p>Nice idea but I suspect it may perhaps introduce an element of bias. I would prefer to rank later based on the probability of the 1/-1 forecast and not load the dice by momentum at this stage. </p>

<p>My initial gut feel is that selecting / filtering  at this stage based on just momentum is tainting the procedure. Patterns affected by the other Factors we are calculating may have an independence from Momentum. At least I am hoping so.</p>

<p>Sorry if my thoughts are not very well expressed. I will of course be coming back in Notebook form once I am further forward in my thinking.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e5320043fb923da100060c' id='57e5320043fb923da100060c'>
<a href='#57e5320043fb923da100060c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474638343000' class='quanto-date posted-at response-posted-at' href='#57e5320043fb923da100060c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Anthony: Cool! Most classifiers in <code>sklearn</code> support <code>.predict_proba()</code> as well.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e58a095b38e3770700002e' id='57e58a095b38e3770700002e'>
<a href='#57e58a095b38e3770700002e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474660881000' class='quanto-date posted-at response-posted-at' href='#57e58a095b38e3770700002e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas,</p>

<p>Makes more sense now.  I&#39;m still kinda fuzzy on the ranking step 2, since it seems you could just skip it, and normalize.</p>

<p>By the way, your binarize reminded me of this:</p>

<p><a href="http://www.cs.ucr.edu/%7Eeamonn/SAX.pdf">http://www.cs.ucr.edu/~eamonn/SAX.pdf</a></p>

<p>You are basically reducing the dimensionality in a similar fashion, except just chopping the returns in half, +1 or -1, instead of multiple levels.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e653e60c4975c808000698' id='57e653e60c4975c808000698'>
<a href='#57e653e60c4975c808000698'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474712560000' class='quanto-date posted-at response-posted-at' href='#57e653e60c4975c808000698'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I am very much in favor of the structured workflow y&#39;all are pulling together.  I&#39;ve seen Jonathan Larkin referenced several times (by you above, and on other posts).  He is blogging on the topic (<a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">https://blog.quantopian.com/a-professional-quant-equity-workflow/</a> ) at a high level, but I&#39;m guessing he&#39;s more of an internal stakeholder, than a nitty-gritty, detail-oriented system engineer/architect.  Is there anyone in this role on your end who could speak to how the whole thing might go together, kinda at the 10,000 foot level and below?  I think it&#39;d be really productive to have an open discussion, back-and-forth with users on the topic, with someone on your end who has the vision for the end &quot;product&quot; and knows the deep-dive details of your platform (and where it might go in the future).  But is at a high enough level in the organization that they can just decide what can be discussed and what shouldn&#39;t, on a public form.  Does such a person exist?  Would this approach be beneficial?</p>

<p>As you might recollect, back in the day, folks like Fawce, Dan D., others would field questions and interact with users on the forum, and I think the openness/transparency was better.  Maybe it is just a natural evolution, from start-up to actual business.  Something has been lost, unfortunately.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e6673a5b38e385560003eb' id='57e6673a5b38e385560003eb'>
<a href='#57e6673a5b38e385560003eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474717504000' class='quanto-date posted-at response-posted-at' href='#57e6673a5b38e385560003eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The ranking serves a purpose. If I change the example to have <code>Working_Capital_To_Assets</code> values of all stocks to be <code>[0.2, 0.3, 0.1, 100.]</code>(perhaps due to a data error or just an outlier) the normalization would squash the first three values.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e683565b38e377070009a0' id='57e683565b38e377070009a0'>
<a href='#57e683565b38e377070009a0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474724701000' class='quanto-date posted-at response-posted-at' href='#57e683565b38e377070009a0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas W. -</p>

<p>I&#39;ll have to noodle on this ranking business more.  It is not obvious why it is necessary, what problem it solves, and what might be the alternatives.  Normally, when dealing with extreme values, one might work in logarithms, or some such thing.  It seems that the ranking is a form of summary statistic that is then used for your horizontal axis of factors, which drive the responses (e.g. the returns in this case, but there could be multiple responses).  There is some information that is lost, I think, but perhaps you need put all factors on the same scale, effectively, to be able to manage the analysis in a simple fashion, hence the ranking (although there must be other approaches, right?).  For uniform sampling of the factor, ranking is trivial, right?  If my factor values are 
<code>A = [0.1, 0.2, 0.3, 0.4]</code>, and I rank, then I just get <code>A_ranked = [0, 1, 2, 3]</code>, which is the same as subtracting the minimum, and then dividing by the maximum (offset the axis, and then normalize) and then scaling by the total number of elements minus one (re-normalizing).  I can use <code>A</code> or <code>A_ranked</code>, but they are equivalent, I think.  But if you don&#39;t sample factors uniformly, then you are doing something different, as you suggest.  You are pulling in outliers, making it seem as if you used uniform sampling, when actually you didn&#39;t.  So, something is lost.  There is a big leap in the analysis, I think.</p>

<p>In my most recent post above, am I correct about Jonathan L.&#39;s role?  Or is he fielding user comments/questions/feedback?  If not, who?  Or maybe you don&#39;t want to approach it in this fashion?  Worker bees will be assigned pieces of the puzzle, and interact selectively with users, keeping the meat of the development process internal?</p>

<p>Your contest idea sounds interesting, but would it just be for bragging rights?  A &quot;prize&quot; of some sort?  Could you formulate it like Numerai, so that users would have the option of running offline, or using the Q platform?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e68751f4706ed6b80009eb' id='57e68751f4706ed6b80009eb'>
<a href='#57e68751f4706ed6b80009eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474725725000' class='quanto-date posted-at response-posted-at' href='#57e68751f4706ed6b80009eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Definitely information is lost. You don&#39;t have to rank your stocks in this way. These aren&#39;t strict rules to be followed but rather some initial default settings. If it doesn&#39;t make sense to you, the best thing is to try what accuracy you get without the rank, maybe it works even better.</p>

<p>The mini-contest I mention is just for fun and learning right now. We might turn this into a real thing later.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e68b380c497508a70004da' id='57e68b380c497508a70004da'>
<a href='#57e68b380c497508a70004da'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474726719000' class='quanto-date posted-at response-posted-at' href='#57e68b380c497508a70004da'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas -</p>

<p>That&#39;s what I thought, regarding losing information.  I&#39;ll have to think about it a bit more.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e6d706f4706ed6b8000d6c' id='57e6d706f4706ed6b8000d6c'>
<a href='#57e6d706f4706ed6b8000d6c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57e6cfa534908ab10f000d68'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b9e488f3b7d6eda3d8e18f0a579d08ae?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57e6cfa534908ab10f000d68'>Madhur Bhargava</a>
</div>
<a UTCms='1474746125000' class='quanto-date posted-at response-posted-at' href='#57e6d706f4706ed6b8000d6c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><a href="http://www.cs.ucr.edu/%7Eeamonn/SAX.pdf">www.cs.ucr.edu/~eamonn/SAX.pdf</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e7adf5bbbef2d05700017f' id='57e7adf5bbbef2d05700017f'>
<a href='#57e7adf5bbbef2d05700017f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474801149000' class='quanto-date posted-at response-posted-at' href='#57e7adf5bbbef2d05700017f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I feel compelled to understand the ranking of factors better (versus using factors directly, which in my experience, is the typical thing to do, e.g. in science/engineering).  I found this:</p>

<p><a href="http://www.cs.cmu.edu/%7Eggordon/rank.pdf">http://www.cs.cmu.edu/~ggordon/rank.pdf</a></p>

<p>On page 16 (slide 15), it says:</p>

<blockquote>
<p>Rank vector R = ((1), (2),...(N)) is <em>maximal invariant statistic</em> under monotone transforms<br>
That is any statistic unaffected by monotone transforms is a function of rank vector</p>
</blockquote>

<p>I&#39;m not sure what all this means yet, but it is not clear that any information is lost, under certain assumptions (e.g. as I discuss above, ranking is equivalent to an axis offset and normalization/scaling, for equi-spaced (uniformly sampled) factor values).  Maybe if one assumes a monotonic relationship between the raw factors (
<code>X</code>) and the responses (<code>Y</code>), then no information is lost in converting to ranks of the factors (<code>X_rank</code>)?  But it reduces the dimensionality, since I can now work with discrete integer values (levels) instead of continuous float values (or I don&#39;t need to interpolate the missing data)?  But the risk is that if the monotonic relationship does not hold, then I&#39;ve thrown a monkey wrench into the whole thing (e.g. if my response <code>Y</code> peaks at extreme values of <code>X</code> and then rolls off)?</p>

<p>Maybe one has to show that the monotonic relationship actually holds, prior to ranking?  Just guessing...</p>

<p>Anybody understand the ranking?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e7e1851b95b3d187000362' id='57e7e1851b95b3d187000362'>
<a href='#57e7e1851b95b3d187000362'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56ad36b98db5338d3d0002b4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c7fc7105c5cc29e9d7af85f34dde8fa8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56ad36b98db5338d3d0002b4'>Laszlo A.</a>
</div>
<a UTCms='1474814348000' class='quanto-date posted-at response-posted-at' href='#57e7e1851b95b3d187000362'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>why notebook is not working at train-test split?</p>

<p>/usr/local/lib/python2.7/dist-packages/IPython/kernel/__main__.py:5: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future</p>

<p>print X_train_shift.shape, X_test_shift.shape<br>
(0, 18) (0, 18)</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e8f693e95e37d7fa0001c3' id='57e8f693e95e37d7fa0001c3'>
<a href='#57e8f693e95e37d7fa0001c3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56990262be2416509000011c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0cccbbae7e2a982659980bd3c4d0a6eb?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56990262be2416509000011c'>Richard Jamieson</a>
</div>
<a UTCms='1474885276000' class='quanto-date posted-at response-posted-at' href='#57e8f693e95e37d7fa0001c3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;m having the same problem as Laszlo - initially the notebook was working fine, but now it seems to be breaking down at the point he mentions...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57e8f6ee61d547db960001b5' id='57e8f6ee61d547db960001b5'>
<a href='#57e8f6ee61d547db960001b5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474885366000' class='quanto-date posted-at response-posted-at' href='#57e8f6ee61d547db960001b5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;ll investigate, thanks for reporting.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57e95240a4460ccacc0000a5' id='57e95240a4460ccacc0000a5'>
<a href='#57e95240a4460ccacc0000a5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474908746000' class='quanto-date posted-at response-posted-at' href='#57e95240a4460ccacc0000a5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Small update: I fixed the breaking change by replacing <code>np.percentile()</code> with <code>np.nanpercentile()</code>. This is due to updated <code>numpy</code> (<a href="https://www.quantopian.com/posts/soon-upgrade-to-pandas-0-dot-18">https://www.quantopian.com/posts/soon-upgrade-to-pandas-0-dot-18</a>). Unfortunately, the shape of the resulting data also changed which I&#39;m not sure why that is the case. It also negatively affected the OOS performance of the classifier, as you can see. I will try to get to the bottom of why the two would be different but others are free to explore too and see if they can get a better score.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57ea1b050de7f589930004ec' id='57ea1b050de7f589930004ec'>
<a href='#57ea1b050de7f589930004ec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56ad36b98db5338d3d0002b4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c7fc7105c5cc29e9d7af85f34dde8fa8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56ad36b98db5338d3d0002b4'>Laszlo A.</a>
</div>
<a UTCms='1474960148000' class='quanto-date posted-at response-posted-at' href='#57ea1b050de7f589930004ec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ea34c00de7f54f9c00003f' id='57ea34c00de7f54f9c00003f'>
<a href='#57ea34c00de7f54f9c00003f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57b66bb53553a6947d000188'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/44e3b16636de26114666ad2e297c1dea?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57b66bb53553a6947d000188'>Alpha Seeker</a>
</div>
<a UTCms='1474966729000' class='quanto-date posted-at response-posted-at' href='#57ea34c00de7f54f9c00003f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant Kiehne </p>

<p>Hi Grant,</p>

<p>I am new to Quantopian and spotted that you have been using machine learning for trading strategies.</p>

<p>I am not yet familiar with the environment of Quantopian and would like to see if you could help giving some insight using ML on the development environment of Quantopian.</p>

<p>I myself have more than 30 years’ experience in proprietary trading (discretionary approach, not systematic one) while my partner is more into quantitative approach. We look to collaborate with someone with more AI expertise and experience of algo development (someone like you we believe). We hope our domain knowledge in proprietary trading could also be good for your personal use.</p>

<p>Just drop us a message. We look forward to communicating with you further.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ea3abf7b82e31eee00002b' id='57ea3abf7b82e31eee00002b'>
<a href='#57ea3abf7b82e31eee00002b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474968263000' class='quanto-date posted-at response-posted-at' href='#57ea3abf7b82e31eee00002b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas,</p>

<p>I&#39;m still working my way through your notebook above.  In your 
<code>results.head()</code> what is the <em>Returns</em> column?  Is it the trailing returns?  Is that why you then have to &quot;Shift factor ranks to align with future returns n_fwd_days days in the future&quot;?  I suggest simply doing the alignment within pipeline, so that one can directly read across the rows, as factor-response data.  Is this possible?</p>

<p>You say:</p>

<blockquote>
<p>Find the top and bottom 30 percentile stocks by their returns.</p>
</blockquote>

<p>Are you setting up for the ML to predict which stocks fall into the two buckets, the top 30 percentile, and the bottom 30 percentile?  For example, if you code +1 for the top bucket, and -1 for the bottom bucket (and 0 for not in a bucket), then a given stock XYZ could take on values (-1,0,+1)?  In other words, if my ML ends up predicting a +1 for XYZ, then I&#39;d expect its return in 5 days to be positive, and better than the mass of stocks falling between the 30 to 70 percentiles?</p>

<p>Another question is presumably this is all aimed toward writing a glorious, scalable long-short algos for your Point72 buddies.  What if all the stocks go up and I have nothing to short?  Is there an implicit assumption here that I&#39;ll end up with a basket of stocks to long, and a basket to short?  I don&#39;t see anything in the analyses that would imply a market neutrality constraint.  Or is it in there, somehow?</p>

<p>And how would one handle categorical factors (e.g. color of CEO&#39;s sports car, exchange on which stock is listed, etc.)?</p>

<p>Can this be extended to handle multiple responses (Y&#39;s)?  You only do returns, but wouldn&#39;t one want a model for other stuff, too?  The Quantopian contest and pyfolio are concerned with lots of responses, which all have some importance, right?  It seems that in the end, to do constrained optimization, you need more than one response (e.g. maximize overall return under the constraint that SR &gt; 1.0, for which you&#39;d need to predict the return and its variance).</p>

<p>Thanks,</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ea3b5928a96c8d600003d4' id='57ea3b5928a96c8d600003d4'>
<a href='#57ea3b5928a96c8d600003d4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474968415000' class='quanto-date posted-at response-posted-at' href='#57ea3b5928a96c8d600003d4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Alpha Seeker - I&#39;m definitely not your guy for ML, but there should be some whiz kids here on Quantopian who can guide you (including Thomas W. &amp; Co.).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ea3e142a0d8d627a000047' id='57ea3e142a0d8d627a000047'>
<a href='#57ea3e142a0d8d627a000047'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474969115000' class='quanto-date posted-at response-posted-at' href='#57ea3e142a0d8d627a000047'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, those are great questions.</p>

<blockquote>
<p>In your results.head() what is the Returns column? Is it the trailing returns? </p>
</blockquote>

<p>Yes, trailing 5-day returns.</p>

<blockquote>
<p>Is that why you then have to &quot;Shift factor ranks to align with future returns n_fwd_days days in the future&quot;? I suggest simply doing the alignment within pipeline, so that one can directly read across the rows, as factor-response data. Is this possible?</p>
</blockquote>

<p>Yes, that would be ideal, but not possible currently. What we need would be a <code>.shift()</code> pipeline operator. It&#39;s on the feature wish list.</p>

<blockquote>
<p>Are you setting up for the ML to predict which stocks fall into the two buckets, the top 30 percentile, and the bottom 30 percentile? For example, if you code +1 for the top bucket, and -1 for the bottom bucket (and 0 for not in a bucket), then a given stock XYZ could take on values (-1,0,+1)? In other words, if my ML ends up predicting a +1 for XYZ, then I&#39;d expect its return in 5 days to be positive, and better than the mass of stocks falling between the 30 to 70 percentiles?</p>
</blockquote>

<p>Yes, that&#39;s exactly the right understanding. But note that there could be a case where you correctly predict +1 but the 5-day forward return is not positive in absolute terms. E.g. it could be that market is tanking and <em>all</em> stocks are negative, just this one less than others (i.e. it&#39;s still in the top 30th percentile).</p>

<blockquote>
<p>Another question is presumably this is all aimed toward writing a glorious, scalable long-short algos for your Point72 buddies. What if all the stocks go up and I have nothing to short? Is there an implicit assumption here that I&#39;ll end up with a basket of stocks to long, and a basket to short? I don&#39;t see anything in the analyses that would imply a market neutrality constraint. Or is it in there, somehow?</p>
</blockquote>

<p>As we train the model to predict <em>relative</em> stock movements it&#39;s very unlikely to not have shortable stocks. As I said above, they can still go up for this to be profitable, just less than the others. So a very simple next step would be to just short the N stocks the classifier is most certain are -1&#39;s and long the N stocks the classifier is certain are +1&#39;s. That way I&#39;m always market neutral.</p>

<blockquote>
<p>And how would one handle categorical factors (e.g. color of CEO&#39;s sports car, exchange on which stock is listed, etc.)?</p>
</blockquote>

<p>That&#39;s a great question and not one where there is a single obvious answer to. One idea with e.g. sectors would be to train a single classifier for each sector independently. But there are also other methods to include categorical data in machine learning. This is really where someone can add value by being creative.</p>

<blockquote>
<p>Can this be extended to handle multiple responses (Y&#39;s)? You only do returns, but wouldn&#39;t one want a model for other stuff, too? The Quantopian contest and pyfolio are concerned with lots of responses, which all have some importance, right? It seems that in the end, to do constrained optimization, you need more than one response (e.g. maximize overall return under the constraint that SR &gt; 1.0, for which you&#39;d need to predict the return and its variance).</p>
</blockquote>

<p>Technically, those ML algorithms exist but I don&#39;t think they would be useful here. That&#39;s not to say that those other things you mention are not important, but there are other ways to include them. The ML prediction part is just one piece of the trading algorithm. The prediction just gives me a long and a short book. Do I just equal weight each stock in each book? Probably not, so that&#39;s where a risk model would come in handy. For example I could do inverse-vol weighting, but then you also want to reduce exposure to certain risk factors etc. Or also &quot;maximize overall return under the constraint that SR &gt; 1.0&quot; could be included at this level as well. You could also train a separate classifier to predict vol and feed that into the portfolio optimization, but my hunch is that historical vol will be good enough in that case.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57ea451b1bac060a440000e6' id='57ea451b1bac060a440000e6'>
<a href='#57ea451b1bac060a440000e6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57b66bb53553a6947d000188'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/44e3b16636de26114666ad2e297c1dea?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57b66bb53553a6947d000188'>Alpha Seeker</a>
</div>
<a UTCms='1474970919000' class='quanto-date posted-at response-posted-at' href='#57ea451b1bac060a440000e6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant Kiehne</p>

<p>Thanks Grant for the introduction. Let us keep in touch.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ea45510de7f54f9c0000db' id='57ea45510de7f54f9c0000db'>
<a href='#57ea45510de7f54f9c0000db'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1474970970000' class='quanto-date posted-at response-posted-at' href='#57ea45510de7f54f9c0000db'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas.  More questions to follow, as I continue my effort to understand what you are doing. </p>

<blockquote>
<p>As we train the model to predict relative stock movements it&#39;s very unlikely to not have shortable stocks.</p>
</blockquote>

<p>Not so clear on this one.  To go long-short, one needs absolute returns to be forecast as positive-negative, respectively, right?  Or are you assuming some additional market neutralization machinery at a later step, should one end up with only shorts (the statistics don&#39;t support long positions with any confidence)?  For example, when the whole market was crashing in 1929 or 2008-09 (or other such &quot;corrections&quot;), maybe going long can&#39;t be justified, based on the data?  Then what?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ea49e228a96c23f5000025' id='57ea49e228a96c23f5000025'>
<a href='#57ea49e228a96c23f5000025'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474972139000' class='quanto-date posted-at response-posted-at' href='#57ea49e228a96c23f5000025'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It&#39;s important to realize that we do not attempt to predict market movements here and are not interested in them. A market-neutral strategy tries to make money on relative price movements. A couple of examples with simplified math:<br>
1) long book returns: 5%, short-book returns: -5% -> profit: 5% + (-1)*-5% = 10%<br>
2) long book returns: 15%, short-book returns: 5% -> profit: 15% + (-1)*5% = 10% (bull market)<br>
3) long book returns: -5%, short-book returns -15% -> profit: -5% + (-1)*-15% = 10% (bear market)</p>

<p>As you can see, we&#39;re making profit on the spread between the long and short book. We don&#39;t actually care about the total movement, only about the difference between them. The classifier is trained in that manner too, it only tries to predict returns relative to others, not absolute. As such, the classifier should never predict all stocks go down <em>relative to each other</em>, as that&#39;s impossible, even in 2008.</p>

<p>In each of these examples, the classifier could have correctly predicted +1s for the long book and -1s for the short books as the ones in the long book are relatively better.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57ea89e26b01184a210000ab' id='57ea89e26b01184a210000ab'>
<a href='#57ea89e26b01184a210000ab'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1474988522000' class='quanto-date posted-at response-posted-at' href='#57ea89e26b01184a210000ab'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Why is Merton&#39;s Distance to Default commented you in the 2nd notebooks? Also why some of the defined factors are not added to all_factors?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57eab35e378c5f8c2f00030e' id='57eab35e378c5f8c2f00030e'>
<a href='#57eab35e378c5f8c2f00030e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1474999141000' class='quanto-date posted-at response-posted-at' href='#57eab35e378c5f8c2f00030e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Suminda: I got an error with Merton, maybe it cleared up. The missing factors are an oversight, want to add them?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57eab50f6b011807cd0001f8' id='57eab50f6b011807cd0001f8'>
<a href='#57eab50f6b011807cd0001f8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1474999579000' class='quanto-date posted-at response-posted-at' href='#57eab50f6b011807cd0001f8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>It also negatively affected the OOS performance of the classifier, as you can see. I will try to get to the bottom of why the two would be different but others are free to explore too and see if they can get a better score. </p>
</blockquote>

<p>I would guess that the first results were mostly due to &quot;good&quot; (even though incorrect) values for the test set and by changing the values to represent data differently you just got different result.</p>

<p>I also note that you raised the number of stubs from 60 to 150. This might have a big difference. I would also think if you ran the same example (with different seed) n times you would get different results but then you could calculate mean and variance and understand what kind of results you are really getting.. Adaboost is randomized not &quot;static&quot; classifier ie the results vary especially with larger datasets.</p>

<p>Just for fun, here is Naive bayes. It gets a slightly better results. NaiveBayes is usually a good baseline.</p>

<p>edit: I accidentally posted a training set prediction, test set prediction was<br>
Accuracy on test set = 50.49%<br>
Log-loss = 0.70200</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57eab78b378c5f8c2f00036e' id='57eab78b378c5f8c2f00036e'>
<a href='#57eab78b378c5f8c2f00036e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1475000208000' class='quanto-date posted-at response-posted-at' href='#57eab78b378c5f8c2f00036e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is another variation (Naive bayes again) where we only pick top 10 and bottom 10% for training set. The idea behind this is that by picking just the best/worst performers we might better find an anomaly that has to do with extreme returns/losses. It seems that this is helping.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57eaefcf4410dfdf87000222' id='57eaefcf4410dfdf87000222'>
<a href='#57eaefcf4410dfdf87000222'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475014613000' class='quanto-date posted-at response-posted-at' href='#57eaefcf4410dfdf87000222'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>Sorry, I must be missing something.  Say I decide to do one of these long-short thingys with only two stocks, ABC &amp; XYZ.  So, no matter what, I&#39;ll go long ABC &amp; short XYZ (or vice versa).  What if ABC &amp; XYZ are highly correlated?  If my model says that both will go down, shouldn&#39;t I short both, and then go long an ETF, as an overall market hedge?</p>

<p>I guess I don&#39;t get the concept of going long-short if my model predicts everything (or almost everything) will go in a certain direction.  Does it all work out somehow in the limit of a relatively large number of volatile stocks, over many market cycles?  The whole scheme you guys are cooking up would seem to require certain assumptions about how the market works, no?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57eb2eb402e751a86700002d' id='57eb2eb402e751a86700002d'>
<a href='#57eb2eb402e751a86700002d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4fe8beb792a029000200000d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fe3ffe502559d05f16eb9fe41ab7e9a1?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4fe8beb792a029000200000d'>Dan Dunn</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475030720000' class='quanto-date posted-at response-posted-at' href='#57eb2eb402e751a86700002d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, in your case of ABC and XYZ, think about it as a pair trade. Correlation is a fine thing, so long as a) they aren&#39;t 1.0 perfectly correlated and b) you know which one to long and which one to short.</p>

<p>It&#39;s OK if your long-short model predicts everything to move in the same <strong><em>direction</em></strong>.  The important part is that your model have to has to have different predictions for each stock (or at least predictions for a top book and bottom book).  Look again at Thomas&#39;s examples:</p>

<blockquote>
<p>1) long book returns: 5%, short-book returns: -5% -> profit: 5% + (-1)*-5% = 10%<br>
2) long book returns: 15%, short-book returns: 5% -> profit: 15% + (-1)*5% = 10% (bull market)<br>
3) long book returns: -5%, short-book returns -15% -> profit: -5% + (-1)*-15% = 10% (bear market)</p>
</blockquote>

<p>Summarizing: If your model predicts every equity to behave exactly the same, it&#39;s useless. If your model accurately predicts differentiation between equities, then it has alpha.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57eb324c6b01184a21000a6d' id='57eb324c6b01184a21000a6d'>
<a href='#57eb324c6b01184a21000a6d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/557bd955ed001022f30003e8'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/13ab569823126bf80ea032e4332e73e4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/557bd955ed001022f30003e8'>James Christopher</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475031635000' class='quanto-date posted-at response-posted-at' href='#57eb324c6b01184a21000a6d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant,</p>

<p>The great thing about maintaining these long and short baskets is that irrespective of the market you can make money. As Thomas illustrated above, it is all about the spread. Though I understand what you are saying, in that if you know things are going down or going up why not just do one leg with a hedging instrument? The answer to that is by long and shorting based on our predictive scheme we are completely isolating the performance of the algorithm to just our ability to predict. As long as we are confident in our model (in this case our ML classifier) then we don&#39;t care what the market is doing. We don&#39;t want to bet on the market - we want to bet on our model.</p>

<p>As far as correlation goes, let&#39;s take those two stocks and extrapolate it too 200 stocks, now we have two baskets (long and short) each with a beta of approximately 1.0 (assuming here that on average 100 stocks would have a beta about equal to the market). Now by putting equal amounts of the portfolio value in each leg we get 1.0 + (-1) * (1.0) = 0, for a low beta algorithm. It is this property that is so great because it removes the need for a hedging instrument entirely.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57eb8821c6dcd450a6000243' id='57eb8821c6dcd450a6000243'>
<a href='#57eb8821c6dcd450a6000243'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475053608000' class='quanto-date posted-at response-posted-at' href='#57eb8821c6dcd450a6000243'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think Grant&#39;s question is more concerned with the corner case of the classifier predicting -1 for everything. That&#39;s valid, but in reality, we are not using the binary label but rather have the classifier predict probabilities of the stock going up or down (in the notebook is <code>.predict_proba() for that</code>). In that case you get a continuous measure which you can rank and short the bottom and long the top, even if the probabilities for all stocks is &lt; 50%.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57eb890d02e7512fb2000d29' id='57eb890d02e7512fb2000d29'>
<a href='#57eb890d02e7512fb2000d29'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475053843000' class='quanto-date posted-at response-posted-at' href='#57eb890d02e7512fb2000d29'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Mikko: Thanks, I completely agree. After all, this is still a toy example and finding a significant edge with well-known factors and a simple classifier in the current market regime is probably a lot to ask. Your NB is very interesting, especially only using top and bottom 10% movers. I wonder if a more sophisticated classifier does better with these inputs.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57eb90d6c6dcd450a600027b' id='57eb90d6c6dcd450a600027b'>
<a href='#57eb90d6c6dcd450a600027b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475055836000' class='quanto-date posted-at response-posted-at' href='#57eb90d6c6dcd450a600027b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Dan, James -</p>

<p>Just trying to understand the assumptions here, how the thing actually works (and why it might not work under certain conditions).  Taking Thomas&#39; example again, assume that my forecasting is 100% accurate.  Then I could do:</p>

<blockquote>
<p>1) long book returns: 5%, short-book returns: -5% -> profit: 5% + (-1)*-5% = 10%<br>
2) long book returns: 15%, short-book returns: 5% -> profit: 15% + (-1)*5% = 10% (bull market), or 20% if all long<br>
3) long book returns: -5%, short-book returns -15% -> profit: -5% + (-1)*-15% = 10% (bear market), or 20% if all short</p>
</blockquote>

<p>Why wouldn&#39;t I do this?  Instead of a blended profit of 10%, I end up with 17% (assuming scenarios 1, 2, &amp; 3 are equally probable).  Is the implicit assumption here that I can forecast individual stocks but not the entire market (which would be nice, since then I could write a much simpler algo that would just go either long or short in SPY)?  I&#39;ll never get the additional 7%?  There&#39;s too much risk in going all long or all short, since my ability to forecast the market stinks?  I&#39;d agree with Dan&#39;s statement &quot;If your model predicts every equity to behave exactly the same, it&#39;s useless&quot; except that if my model is actually predictive, then I&#39;d just chuck the market neutrality constraint, and go either long or short, but not both equal weight.</p>

<p>Perhaps the confusion lies in the fact that you have an implicit market neutrality constraint that, as James points out, one hopes can be met if enough stocks of the right flavor are included in the long-short portfolio.  The ranking and then going long-short (top-bottom percentiles) equal-weight will satisfy this constraint under certain assumptions.  So, if I play my cards right, I&#39;ll break even, worst-case (on average, I&#39;ll make no profit), although I have to make enough to recover my Vegas flight and hotel.  On top of that, there is some magical uncorrelated profit (the so-called &quot;alpha&quot;).  By the way, since &quot;beta&quot; is so undesirable, if Q makes any money this way, I&#39;d be glad to take it off your hands.</p>

<p>Jonathan L. suggests that there may be a deeper understanding:</p>

<blockquote>
<p>Today I’ll add substance to that philosophy by giving you a detailed tour of the investment process for a popular and deep area of the quantitative investment world: cross-sectional equity investing, also known as equity statistical arbitrage or equity market neutral investing. This approach to equity investing involves holding hundreds of stocks long and short in a tightly risk-controlled portfolio with the goal of capturing transient market anomalies while exhibiting little to no correlation to market direction or other major risk factors.</p>
</blockquote>

<p>Perhaps there is a really good (not highly mathematical/theoretical), short tutorial out there that fills in the gaps (and shows that it actually can work)?  Sounds wonderful, but it is hard to picture, particularly in a statistical sense.  Why is it called &quot;equity statistical arbitrage&quot;?  How would I know that I&#39;m doing &quot;arbitrage&quot; i.e. printing money, and not something else?  If beta is zero, then is it automatically &quot;arbitrage&quot; by definition?  Or do I have to show some form of point-in-time cointegration for the long-short baskets, point-in-time?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57eb949ec6dcd450a60002a0' id='57eb949ec6dcd450a60002a0'>
<a href='#57eb949ec6dcd450a60002a0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475056805000' class='quanto-date posted-at response-posted-at' href='#57eb949ec6dcd450a60002a0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>Is the implicit assumption here that I can forecast individual stocks but not the entire market (which would be nice, since then I could write a much simpler algo that would just go either long or short in SPY)? I&#39;ll never get the additional 7%? There&#39;s too much risk in going all long or all short, since my ability to forecast the market stinks?</p>
</blockquote>

<p>Yes, that&#39;s exactly right (no snarkyness intended).  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57eb9a0fc6dcd4c86f000130' id='57eb9a0fc6dcd4c86f000130'>
<a href='#57eb9a0fc6dcd4c86f000130'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475058198000' class='quanto-date posted-at response-posted-at' href='#57eb9a0fc6dcd4c86f000130'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well, is this assumption justified?  What if I&#39;m able to forecast the overall market, even a little bit?  Wouldn&#39;t your workflow and alpha combination step be leaving money on the table?  Or does it allow for a point-in-time market &quot;tilt&quot; to the portfolio (i.e. beta not exactly zero)?  Does it allow for beta to be between -0.3 and +0.3, for example, as the contest allows?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57eb9b4d02e75169f60000ae' id='57eb9b4d02e75169f60000ae'>
<a href='#57eb9b4d02e75169f60000ae'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475058514000' class='quanto-date posted-at response-posted-at' href='#57eb9b4d02e75169f60000ae'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It&#39;s just the assumption of the workflow outlined here. If you can forecast the overall market you should absolutely do so. Perhaps there&#39;s a way to combine the two (long/short and market-forecast) by having a separate macro-market model that introduces said tilt.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57ebafbf02e751f4e200013a' id='57ebafbf02e751f4e200013a'>
<a href='#57ebafbf02e751f4e200013a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1475063748000' class='quanto-date posted-at response-posted-at' href='#57ebafbf02e751f4e200013a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas I actually also tried random forests, extremely randomized forests and gradient boosting but they all got worse accuracy than naive bayes. It&#39;s also worth noting that log loss went up with naive bayes so it&#39;s not clear if it&#39;s &quot;better&quot;. This should be tried in trading environment to make sure which one finds better trades, I would assume that if we will use predict_proba and use probabilities then the random forest would do better (but I would also guess that neither would be profitable).</p>

<p>By the way sklearn has this thing called classification report which might be better than the simple accuracy score.<br>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html#sklearn.metrics.classification_report">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html#sklearn.metrics.classification_report</a></p>

<p>I also like cohens kappa a lot (classification report does not include it neither does any older sklearn version)<br>
<a href="https://en.wikipedia.org/wiki/Cohen&#x27;s_kappa">https://en.wikipedia.org/wiki/Cohen&#39;s_kappa</a></p>

<p>Sklearn also has its own pipeline that can be used to get rid of all that transformation stuff (see attached notebook that uses the same transformations and Random Forest for classification)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ebb2814410dfdf87000a53' id='57ebb2814410dfdf87000a53'>
<a href='#57ebb2814410dfdf87000a53'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1475064456000' class='quanto-date posted-at response-posted-at' href='#57ebb2814410dfdf87000a53'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>And here is confusion matrix for the same prediction.<br>
<a href="https://en.wikipedia.org/wiki/Confusion_matrix">https://en.wikipedia.org/wiki/Confusion_matrix</a></p>

<p>This usually tells important information especially when working with unbalanced datasets (not the case here) or more than 2 classes.</p>

<p>By the way it&#39;s worth studying which method does get you better results in trading, predicting relative movement or predicting probability of going up/down and going long/short percentile of those predictions.. Because of volatility clustering usual machine learning statistics usually don&#39;t tell you the whole truth about classifier robustness in real trading environment..  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ebb6ef378c5f47530006bb' id='57ebb6ef378c5f47530006bb'>
<a href='#57ebb6ef378c5f47530006bb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57098964269e5c568a0006a2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/359adb3730b5bc74e40922342110a57b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57098964269e5c568a0006a2'>Evil Speculator</a>
</div>
<a UTCms='1475065589000' class='quanto-date posted-at response-posted-at' href='#57ebb6ef378c5f47530006bb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey Mikko - I&#39;m lurking in this thread as I&#39;m new to Quantopian. But I saw you mention Random Forests and was curious if you happen to have an example of that you&#39;d be willing to share. I&#39;m trying to find a decent example of running a list of vectors through a simple RF with Quantopian. Thus far I have only worked with ANNs and SVMs (outside of Quantopian) and I&#39;m not sure what the appropriate dot file format is, appropriate first settings, etc. </p>

<p>Maybe you (or someone else) can help out? Any pointers would be welcome. Thanks in advance! :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ebe20c06a724a9be000080' id='57ebe20c06a724a9be000080'>
<a href='#57ebe20c06a724a9be000080'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475076625000' class='quanto-date posted-at response-posted-at' href='#57ebe20c06a724a9be000080'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Evil @Mikko</p>

<p>Just in case you guys look to take a RF model to the IDE, I want to remind you that random number generation is not currently supported in live trading (per the <a href="https://www.quantopian.com/help#overview-livetrading">live trading guidelines</a>).</p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57ebe4dd4ff6333f780000cd' id='57ebe4dd4ff6333f780000cd'>
<a href='#57ebe4dd4ff6333f780000cd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57098964269e5c568a0006a2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/359adb3730b5bc74e40922342110a57b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57098964269e5c568a0006a2'>Evil Speculator</a>
</div>
<a UTCms='1475077350000' class='quanto-date posted-at response-posted-at' href='#57ebe4dd4ff6333f780000cd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie: My current approach with SVMs (outside of Quantopian) is to produce the model externally and then use it to parse during live trading, which does not use much processing at all. I would draw the same separation if ended up using Quantopian for SVMs, ANNs, or RF models. Thanks for the pointer.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ebe574d98031f73500014e' id='57ebe574d98031f73500014e'>
<a href='#57ebe574d98031f73500014e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1475077500000' class='quanto-date posted-at response-posted-at' href='#57ebe574d98031f73500014e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie</p>

<p>Now I&#39;m a bit confused, almost every more advanced ML method uses randomity as part of training including adaboost used in this example and neural networks, random forests (and almost every other recent method). </p>

<p>If there is no way to load classifiers trained elsewhere to live environment and there is no way to train a classifier/regressor in live trading environment then why are we even talking about machine learning?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ebfbe64ff633f2ca0000af' id='57ebfbe64ff633f2ca0000af'>
<a href='#57ebfbe64ff633f2ca0000af'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475083251000' class='quanto-date posted-at response-posted-at' href='#57ebfbe64ff633f2ca0000af'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Mikko,</p>

<p>Sorry, you&#39;re right, I wasn&#39;t clear at all. Currently, live trading only supports deterministic algorithms. As a result, if you want to live trade with an algorithm that depends on random number generation, you have to specify a seed. For example, with the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">RandomForestClassifer</a> in sklearn, there&#39;s a <code>random_state</code> parameter that you can use to specify the seed. This will make the algo deterministic. This is only necessary in live trading.</p>

<p>Let me know if this helps.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57ec00a14753a38ce1000231' id='57ec00a14753a38ce1000231'>
<a href='#57ec00a14753a38ce1000231'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1475084456000' class='quanto-date posted-at response-posted-at' href='#57ec00a14753a38ce1000231'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Okay this is good to hear. I was afraid that it&#39;s not possible to use random at all. Having to specify the seed sounds very reasonable.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ec176510d7a08d3a0003ff' id='57ec176510d7a08d3a0003ff'>
<a href='#57ec176510d7a08d3a0003ff'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57098964269e5c568a0006a2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/359adb3730b5bc74e40922342110a57b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57098964269e5c568a0006a2'>Evil Speculator</a>
</div>
<a UTCms='1475090284000' class='quanto-date posted-at response-posted-at' href='#57ec176510d7a08d3a0003ff'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;m still hoping for a pointer regarding the RI classifier. So <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">sklearn</a> is it then?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ec1a41d980310cdc0003c9' id='57ec1a41d980310cdc0003c9'>
<a href='#57ec1a41d980310cdc0003c9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1475091017000' class='quanto-date posted-at response-posted-at' href='#57ec1a41d980310cdc0003c9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>See the notebook I attached to the post, it uses random forest (from scikit-learn ie sklearn which is quite widely used library).</p>

<p>Here is the ensemble page with some other alternatives too and from there you can find the link to Random Forest api as well.<br>
<a href="http://scikit-learn.org/stable/modules/ensemble.html">http://scikit-learn.org/stable/modules/ensemble.html</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ec243a7ddfd6d49b00001c' id='57ec243a7ddfd6d49b00001c'>
<a href='#57ec243a7ddfd6d49b00001c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57098964269e5c568a0006a2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/359adb3730b5bc74e40922342110a57b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57098964269e5c568a0006a2'>Evil Speculator</a>
</div>
<a UTCms='1475093570000' class='quanto-date posted-at response-posted-at' href='#57ec243a7ddfd6d49b00001c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Mikko - outstanding, much obliged! :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ec40e8f6937e2653000015' id='57ec40e8f6937e2653000015'>
<a href='#57ec40e8f6937e2653000015'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475100911000' class='quanto-date posted-at response-posted-at' href='#57ec40e8f6937e2653000015'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<blockquote>
<p>That&#39;s valid, but in reality, we are not using the binary label but rather have the classifier predict probabilities of the stock going up or down (in the notebook is .predict_proba() for that). In that case you get a continuous measure which you can rank and short the bottom and long the top, even if the probabilities for all stocks is &lt; 50%. </p>
</blockquote>

<p>So presumably this would allow one to go more long than short (or vice versa) and then neutralize the beta with SPY.  This is what I do in an algo I&#39;m working on.  My general advice is that the workflow should support both the long-short equity only style, and one that accommodates one or more hedging instruments (e.g. ETFs).  Or is there a compelling reason to be in all equities?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ece233cef6be731600009d' id='57ece233cef6be731600009d'>
<a href='#57ece233cef6be731600009d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1475142203000' class='quanto-date posted-at response-posted-at' href='#57ece233cef6be731600009d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas since you cannot directly use something done in research directly as an algorithms if you were to port this to to the algo pipeline side who would the code look like?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ecf1be7aa461bdca0000bf' id='57ecf1be7aa461bdca0000bf'>
<a href='#57ecf1be7aa461bdca0000bf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475146182000' class='quanto-date posted-at response-posted-at' href='#57ecf1be7aa461bdca0000bf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I don&#39;t quite understand the desired output of this alpha combination step.  In my mind, the most general approach would be to input a universe of 500 (or 1500) stocks, point-in-time, and then output a corresponding vector of 500 weights, normalized as a portfolio weight vector (e.g. ready for 
<code>order_target_percent</code>).  Or does this happen at the next step of portfolio construction?  And if so, how do the two fit together?  I&#39;m confused, since you seem to be setting some of the weights to zero (by only working on the extreme percentiles).  Shouldn&#39;t every stock get some weight, and then the portfolio construction step would optimize subject to constraints, taking risk and other factors into account?  Or is it more like the alpha combination step passes synthetic securities to the portfolio construction step?  You&#39;ve clumped them together; they are no long individual instruments?  You end up with a minimum of two clumps, the longs and the shorts?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ed25f7cc9177d3530003f0' id='57ed25f7cc9177d3530003f0'>
<a href='#57ed25f7cc9177d3530003f0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5103fb5f05e76f5d3a000114'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/26758cf12bcb1e1c124dfd950eaaac96?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5103fb5f05e76f5d3a000114'>Ricardo Hanesy</a>
</div>
<a UTCms='1475159555000' class='quanto-date posted-at response-posted-at' href='#57ed25f7cc9177d3530003f0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Why is working capital to assets a most predictive feature? This does not make any sense. But I see a more basic issue with this ML approach. </p>

<p>ML works best when features are spatial, not temporal, as in character and picture recognition. If you have a picture with the features changing in time ML would produce random results. </p>

<p>As someone mentioned, long/short makes no sense and IMO &quot;market neutral&quot; is a misnomer. Funds during 2008 crash learned that the hard way. When everything goes down your spatial ML classifier will fail to predict it. Random profits from several years will vanish in thin air in less than a month. </p>

<p>Numerai is already doing this and results are not good based on payout for best predictions. </p>

<p>Not even mentioned data snooping. </p>

<p>I would like to see a good explanation as to why ML works with time series and time-based features. Until then I will trade SPY long and I am doing 12% this year with simple strategy and limited risk.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ed3697f6937ed2cd00004a' id='57ed3697f6937ed2cd00004a'>
<a href='#57ed3697f6937ed2cd00004a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/524c8e5e1b170472e000009e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ca099e1b5658826bcf478acad7ecce81?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/524c8e5e1b170472e000009e'>Brom Rector</a>
</div>
<a UTCms='1475163805000' class='quanto-date posted-at response-posted-at' href='#57ed3697f6937ed2cd00004a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>First off, this is a great intro.  But I have two comments/questions:</p>

<p>1:  It can be argued that access to tools like sklearn  has only been widespread for a few years (sklearn didn&#39;t even have it&#39;s initial git commit until 2011).  If we see alpha from using ML techniques on backtests, couldn&#39;t it be argued that the alpha only exists because most market participants didn&#39;t have access to ML at that time, and that in the current era when anyone with a laptop can do this analysis, we can expect it to rapidly decay?</p>

<p>2:  The post mentions briefly using cross validation, and then links to the SKLearn cross validation tools, but I would like to point out that those tools are unusable for time series.  The SKLearn cross validation suite just picks random samples for training and random for testing, but it should be obvious that that introduces look ahead bias.  </p>

<p>Thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ed4b7bf6937ed2cd0001fe' id='57ed4b7bf6937ed2cd0001fe'>
<a href='#57ed4b7bf6937ed2cd0001fe'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57098964269e5c568a0006a2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/359adb3730b5bc74e40922342110a57b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57098964269e5c568a0006a2'>Evil Speculator</a>
</div>
<a UTCms='1475169153000' class='quanto-date posted-at response-posted-at' href='#57ed4b7bf6937ed2cd0001fe'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Brom - my 2 cents:</p>

<p>1) I have been developing trading strategies for the better part of the past decade. And let me assure you that having access to ML tools/libs doesn&#39;t mean they&#39;re able to produce and then maintain an edge. Besides running simulations in mathematica or now Quantopian/Quantconnect is one thing - integrating various ML techniques into a viable trading strategy is quite another. The devil lurks in the details...</p>

<p>2) How is randomized testing associated with look ahead bias? Please explain how this is obvious. IMO randomization reduces form fitting and especially market cycle dependencies.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ed57becc9177d353000707' id='57ed57becc9177d353000707'>
<a href='#57ed57becc9177d353000707'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/524c8e5e1b170472e000009e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ca099e1b5658826bcf478acad7ecce81?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/524c8e5e1b170472e000009e'>Brom Rector</a>
</div>
<a UTCms='1475172295000' class='quanto-date posted-at response-posted-at' href='#57ed57becc9177d353000707'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Evil Speculator</p>

<p>I think we agree on point 1:</p>

<p>On point two.  if you train your ML model on data from 2016, then test it on data from 2015 and get a high accuracy score, it seems like you shouldnt really trust it since you wouldn&#39;t have had data from 2016 if you were trading in 2015.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ed7a1148f895f0060000ad' id='57ed7a1148f895f0060000ad'>
<a href='#57ed7a1148f895f0060000ad'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1475181082000' class='quanto-date posted-at response-posted-at' href='#57ed7a1148f895f0060000ad'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Cross validation / look ahead bias. I&#39;m not sure it really matters as long as at the point of running the training you are using data which would have been available at the end of the training period.  Unless of course you then integrate trained weights into a back test for the training period. You should / could use the trained weights thus obtained but only for the validation and test set. And going forward the same thing applies. That is my tentative reading at this stage anyway.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57edb130cb4cf6fe0f00018e' id='57edb130cb4cf6fe0f00018e'>
<a href='#57edb130cb4cf6fe0f00018e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475195189000' class='quanto-date posted-at response-posted-at' href='#57edb130cb4cf6fe0f00018e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Interesting point regarding spatial versus temporal.  I gather than Thomas may be doing something analogous to determining a 2D response surface by sampling the X&#39;s over many periods.  For example, say I have factors X1 &amp; X2.  To sample X1 &amp; X2 and determine a response surface, I have to let X1 &amp; X2 vary over time.  However, if I then ignore the fact that the X&#39;s were spread out in time, there&#39;s potentially something wrong with the analysis, unless every week is like every other.  Does stationarity have to be assumed for this to work?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee10cacb4cf6fe0f0007b8' id='57ee10cacb4cf6fe0f0007b8'>
<a href='#57ee10cacb4cf6fe0f0007b8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1475219671000' class='quanto-date posted-at response-posted-at' href='#57ee10cacb4cf6fe0f0007b8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Nice work here on ML but I have also doubts about the effectiveness of the method.  As someone mentioned already ML does a good job when features are in  space domain. In time domain ML does not appear to do a good job. In fact, ML was popular in the 1980s but traders abandoned it as soon as they understood the problems, for much simpler algos. </p>

<p>As far as cross validation: There is an issue because it assumes i.i.d.  But the most important issue with ML is that each time you update your data the classifier must run again and that means data-snooping is inevitable due to reuse of old data. </p>

<p>Unless you are going to use ML only once for a single prediction, something that is not practical of course but this is what is done with text and face recognition, then each time it runs with updated data the probability of a Type I error is higher. This must be understood and ML immediately disqualifies unless there is a sound method for determining significance of results and can compensate for the bias.</p>

<p><a href="http://www.priceactionlab.com/Blog/2016/09/data-science/">I have written a post about Numerai.</a> It is interesting to see how more than half of the predictions are worse than random.</p>

<p>It is also important to realize that better ML metrics (logloss, accuracy, etc.) do not necessarily mean better predictions. Most top performers in terms of logloss in Numerai have probably achieved that via &quot;boosting&quot; based on knowledge of public leaderboard. On the other hand, good predictions can be generated from random participants. Due to that Numerai takes many predictions into account (controlling capital) in an attempt to average out noise. This is smart but at the same time risky as the probability of ruin is not zero and at some point will occur, we just do not know when, hopefully in a long time and after Elon Musk has already colonized Mars.:)</p>

<p>Conclusion: ML for markets can be an exercise in futility. I have spent many many  hours testing different ML algos:</p>

<p>Logistic regression (with and without L1, L2 and k-fold validation)<br>
Random forests (with and without k-fold validation)<br>
Gradient Boosted Trees (with and without k-fold validation)<br>
Decision trees (with and without k-fold validation)<br>
SVM with RBF and sigmoid kernel<br>
Stochastic gradient descent</p>

<p>None of the above worked for me unless I already knew which feature will work. But if I know that, ML is not really required. I can use a simple scan. I do not discount the possibility that it can work well for someone else and I was not doing it right. But that was my experience. </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee171e2ecde4f344000095' id='57ee171e2ecde4f344000095'>
<a href='#57ee171e2ecde4f344000095'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1475221289000' class='quanto-date posted-at response-posted-at' href='#57ee171e2ecde4f344000095'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>ML is good at telling you what IS. I suspect no method, including ML is very good at predicting what will be.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee1cf2cb4cf6fe0f000851' id='57ee1cf2cb4cf6fe0f000851'>
<a href='#57ee1cf2cb4cf6fe0f000851'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1475222779000' class='quanto-date posted-at response-posted-at' href='#57ee1cf2cb4cf6fe0f000851'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>People can&#39;t have it both ways. If the markets have no memory and autocorrelation does not exist then cross validation on time series is perfectly valid. Provided it is based on data available at the time of testing with no look see as to tomorrow.</p>

<p>The exercise would nonetheless be futile by definition.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee265e144f88ad2f000cac' id='57ee265e144f88ad2f000cac'>
<a href='#57ee265e144f88ad2f000cac'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1475225190000' class='quanto-date posted-at response-posted-at' href='#57ee265e144f88ad2f000cac'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>This must be understood and ML immediately disqualifies unless there is a sound method for determining significance of results and can compensate for the bias.</p>
</blockquote>

<p>I absolutely agree with the above. Fitness method is absolutely the most important aspect when working with machine learning.</p>

<p>I also am not sure that using notebooks to find results in general way without time series analysis is a good idea at all. Accuracy of the classifier might tell you that everything is better than great but the actual trading results can be catastrophic due to volatility clustering that this kind of analysis does not take into account. </p>

<p>I have done a lot of work with genetic algos in the past (some discussion at this old thread <a href="http://www.forexfactory.com/showthread.php?t=167720">http://www.forexfactory.com/showthread.php?t=167720</a> - please note that this was before the current ML/deep learning hype) and my observation based on lots of studies in actual trading results is that the best results out sample (it&#39;s very easy to get good in sample results) come from very simple fitness method: normalized_returns/maximum_dd (and you might want to include some correlation analysis if you are trading multiple methods). But you always want to get the fitness score from  real market data  so volatility clustering is take into account.</p>

<p>Does ML work? This is like asking if it is possible to find trading methods at all. IMHO computer can find methods as well as human can but you better be sure that you know what your requirements are as the computer will find you the methods you have asked, not the ones that you want.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee32ca4ea9b0975c0009c9' id='57ee32ca4ea9b0975c0009c9'>
<a href='#57ee32ca4ea9b0975c0009c9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475228369000' class='quanto-date posted-at response-posted-at' href='#57ee32ca4ea9b0975c0009c9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>One way to think about this is to suppose that everything is static, going back to the Stone Age (like physics).  Then, I can assume a model Y = <em>f</em>(X1,X2), and the problem becomes finding the unknown function <em>f</em>.  Say I&#39;d like to know how long it takes to bring a water/ice mix to boil on my stove top, with a constraint on the total mass of water in the pot.  So, X1 could be the mass ratio of water-to-ice, and X2 could be the setting on my burner, 1-10.  And Y would be the time it takes for the water to come to a boil (I could get fancy and use a thermometer, or just look for bubbles).  I could control the experiment by stirring the pot in a certain way, etc.  I would then hire a graduate student, or more likely, an unpaid middle-schooler to conduct N measurements to find the relationship, <em>f</em>.  If I know what I&#39;m doing, I&#39;ll find <em>f</em> and I&#39;ll be able to predict Y, the time to boiling, just fine (most likely, with some finagling, I can get a model in the form of a multivariate polynomial in X1 &amp; X2, over some range of X1 &amp; X2).</p>

<p>For the stock market, one would hope to apply the same approach, but of course controlled measurements are not possible (and would probably be illegal if they were), unless X1 &amp; X2 naturally vary in time over the parameter space of interest (which of course they do).  Then, I could say &#39;Aha!&#39;  I&#39;ll just let the market do the work for me, and once I have a sufficiently large data set of (X1,X2,Y), I&#39;ll figure out Y = <em>f</em>(X1,X2).  If changes are slow, I can simply update Y = <em>f</em>(X1,X2) as new data become available, making incremental adjustments.  The adjustments don&#39;t really play into my short-term forecasts; they just keep the model in line with reality over the long term.  This is not unlike the water/ice boiling model construction, where I might have some long-term aging effect (e.g. gradual deterioration of my heating element) that I can compensate for by repeating the measurements on an appropriate time scale.</p>

<p>One problem, it would seem, is that I&#39;d like to trade at least weekly, if not more frequently, but there are only 252 trading days in a year.  And I only have one noisy data point per day (if I&#39;m following, the proposed workflow is based on pipeline and daily OHLCV bars).  But then I&#39;d like a model that is Y = <em>f</em>(X1,X2,...XN), where N is a large number and I&#39;d like to include non-linearity and interactions up to some order.  My intuition is that unless the signal-to-noise is really good and the market mechanisms are stable over many years, I won&#39;t have enough data to trade frequently (which I&#39;d like to do on an effectively continuous basis, to have tight control over the portfolio return, to increase the Sharpe ratio).</p>

<p>My intuition is that basing the workflow on daily OHLCV bars doesn&#39;t make fundamental sense, when a historical database of minute OHLCV bars is available.  It doesn&#39;t mean that the input data would be greater in dimension (i.e. one could still use 252 data points per year), but they could be significantly better quality in terms of signal-to-noise (e.g. one could compute daily factor values using minute OHLCV bars or summary statistics derived from minute OHLCV bars).  For some reason, this basic point has not gotten traction.  I&#39;m befuddled.  Am I wrong in my intuition?  Whether I use ML or not, I&#39;ll be much better off with the greatly improved signal-to-noise.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee38491c021cf155000001' id='57ee38491c021cf155000001'>
<a href='#57ee38491c021cf155000001'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530dc58192f94a48e80002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6a81c3996de61b5880d979f288a9a743?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530dc58192f94a48e80002b6'>Mikko M</a>
</div>
<a UTCms='1475229779000' class='quanto-date posted-at response-posted-at' href='#57ee38491c021cf155000001'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, if you look at the code at the notebook you&#39;ll notice that the factors used for prediction are quite long term ones derived from both fundamental and price data. In these kind of factors I don&#39;t think there is much sense to use minutely data to aggregate these kind of factors but I might be wrong.</p>

<p>If we would be regressing price data then the question would be if data aggregated from 1 min bars (or even lower tf!) would give us better results than using daily data. I don&#39;t think we can answer this question without actually implementing both methods and checking the results.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee3f914ea9b0a7ee00008e' id='57ee3f914ea9b0a7ee00008e'>
<a href='#57ee3f914ea9b0a7ee00008e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475231640000' class='quanto-date posted-at response-posted-at' href='#57ee3f914ea9b0a7ee00008e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>We aren&#39;t actually using daily data, unless the signal-to-noise of a single trade in a given day is the same as that of the mean price for the day, for example.  The mean must be a lot less noisy, since it would be the average of 390 individual trades; the noise will be knocked down by a factor of 1/sqrt(390).  And the mean would be a better representation of the price for the day; a single trade of unknown volume could be pretty whacky.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee45401c021c3bac000019' id='57ee45401c021c3bac000019'>
<a href='#57ee45401c021c3bac000019'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475233096000' class='quanto-date posted-at response-posted-at' href='#57ee45401c021c3bac000019'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Re stationarity: That&#39;s certainly the assumption in the window of the training data. But if you don&#39;t assume some form of stationarity over a limited time-period, how would you want to do predictions of any nature in the first place? What the classifier is trying to learn is that if a stock has this pattern of factors (lower vol, higher earnings quality, etc) it will do better than then others in its universe. </p>

<p>I would not expect these patterns to hold indefinitely. One way to get around that is to retrain the classifier e.g. every week.</p>

<p>@Brom: Cross-validation is a way to see how robust your classifier is and allows you to tweak hyper-parameters. It also gives you some guidance of what to expect for the hold-out. It&#39;s true that we mix future and past data there but that&#39;s why there is the hold-out set with only future data. That is the only number we should really care about, as I write in the NB. Cross-validation is just a tool to get more out of our training data.</p>

<p>@Suminda: I have a notebook almost ready to go that shows this</p>

<p>@Michael Harris: I do know of systems not unlike the one I present here (albeit more complex) that have shown very competitive performance over long periods of time. I do agree that it&#39;s all about the factors (garbage in garbage out) and any system that does not allow you to innovate at that level will be limiting. The ML or factor aggregation step however can turn many weak signals into a stronger one, especially if they are uncorrelated. But it can not create signal where there is none. I don&#39;t think that the well-known factors I used here would be expected to carry much alpha. That&#39;s where the <a href="https://www.quantopian.com/data">Quantopian data sets</a> get interesting.</p>

<p>@Grant  </p>

<blockquote>
<p>In my mind, the most general approach would be to input a universe of 500 (or 1500) stocks, point-in-time, and then output a corresponding vector of 500 weights, normalized as a portfolio weight vector (e.g. ready for order_target_percent). Or does this happen at the next step of portfolio construction? And if so, how do the two fit together?</p>
</blockquote>

<p>That&#39;s exactly right. Transform the long and short baskets to portfolio weights is part of the portfolio construction step. Given the baskets (just binary long/short signals or probabilities) it would run portfolio optimization to e.g. (i) minimize volatility, (ii) minimize exposure to certain risk factors, (iii) take the previous portfolio into account to reduce turn-over, (iv) take transaction and borrow costs into account etc to determine the weight vector for <code>order_target_percent()</code>. We haven&#39;t discussed this step at all yet but it is in the works.</p>

<p>@Mikko: Thanks, love your contributions. I didn&#39;t know about the classification report which looks very useful. I do like the sklearn pipeline approach, it makes the fitting and prediction steps much more concise. I also agree that a classifier should be evaluated in a broader context and over longer periods of time. My next NB will show how to do that.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57ee50ea144f88ad2f000e73' id='57ee50ea144f88ad2f000e73'>
<a href='#57ee50ea144f88ad2f000e73'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1475236080000' class='quanto-date posted-at response-posted-at' href='#57ee50ea144f88ad2f000e73'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Anthony,</p>

<p>&quot;ML is good at telling you what IS&quot;</p>

<p>This is interesting. The problem is that &quot;What IS&quot; is always relative to some metric.  In some domains (example relativity physics) the metric is constant for a wide range of parameters (in case of relativity physics  it is the timespace metric, which breaks down only at the quantum level) In the market , the metric changes all the time depending on conditions. &quot;What IS&quot; changes constantly and this is done naturally due to liquidity constraints among other things. </p>

<p>@Mikko,</p>

<p>&quot;...before the current ML/deep learning hype...&quot;</p>

<p>The hype is there because the industry must morph to maintain its profitability. There is always a new promise. In the 1990s the industry offered chart patterns and simple indicators. Most traders  were ruined. Now the industry offers GP, machine learning and promises of &quot;deep learning.&quot;  Many more  will get ruined. Then the industry will morph to something different. I expect home HFT to be available soon for a few dollars a month. </p>

<p>There are good applications for ML and deep learning in other domains where features are well-defined and there is no risk of ruin. I remember someone telling a story in a forum that their ML identified a pattern in stolen credit cards: the thief goes to buy gas immediately after stealing the card with high probability. You can then inform the gas stations to be careful in accepting credit cards. Here  the application limits losses. Face recognition and aversion of a crime may limit losses of human lives. But when asking ML to generate pure alpha in the markets, this is too much. Maybe best use is for risk management, not for alpha.</p>

<p>@Thomas,</p>

<p>AMZN with P/E of about 205 (TTM) (reminiscent of dot com bubble BTW)  is moving the tech market. The classifier could easily get fooled that gains in some stocks are due to some factors when in fact they are due to index correlation. I do not now how to solve this problem (de-correlate data) and I am even not willing to do it when a simple mean reversion algo that I use based on a simple formula out of a college text in probability theory is <a href="http://www.priceactionlab.com/Blog/2016/09/mean-reversion-performance/">performing quite well</a> YTD when ML algos are struggling to stay in the black. </p>

<p>Please do not take me wrong, I find high value in Quantopian and I actually use it now for backtest sanity check. I think this platform is quite valuable for traders and everyone should use it and contribute. I have doubts about ML and long/short systems with the designation &quot;market neutral.&quot; There is no such thing and if there is it is only temporary and risks are much larger than those of directional algos.  Then, one should be skeptical why some people are in favor of these market neutral strategies. Note that this market is notorious for squeezing out shorts and has done it repeatedly in the last 7 years. Why would anyone want to go short individual stocks when risk is so high? I could think of some reasons but this is not the place to discuss them. </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee702648f89581f00000ec' id='57ee702648f89581f00000ec'>
<a href='#57ee702648f89581f00000ec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1475244079000' class='quanto-date posted-at response-posted-at' href='#57ee702648f89581f00000ec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Michael</p>

<blockquote>
<p>&quot;ML is good at telling you what IS&quot;</p>
</blockquote>

<p>What I meant (but did not specify) is that ML is great for such things as text or image processing.  But probably less great at predicting the future state of a chaotic system.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee71dfcb4cf617080000a6' id='57ee71dfcb4cf617080000a6'>
<a href='#57ee71dfcb4cf617080000a6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1475244519000' class='quanto-date posted-at response-posted-at' href='#57ee71dfcb4cf617080000a6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Michael</p>

<p>As usual I find myself hard pushed to disagree with much of what you say. The only slight difference is that if that is what managers like numerai want and are willing to pay for it....well, am I going to complain.</p>

<p>Although even then I still find myself in a slight moral quandry.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee79f71c021c62f4000020' id='57ee79f71c021c62f4000020'>
<a href='#57ee79f71c021c62f4000020'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57098964269e5c568a0006a2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/359adb3730b5bc74e40922342110a57b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57098964269e5c568a0006a2'>Evil Speculator</a>
</div>
<a UTCms='1475246590000' class='quanto-date posted-at response-posted-at' href='#57ee79f71c021c62f4000020'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Disclaimer - I run a trading blog and have had the dubious pleasure of seeing several thousand people come and quickly go (i.e. wipe out) over the past eight years plus. And quite frankly the shake out rate is equally high among regular traders and highly intelligent ones with programming or even quant/math backgrounds. Intelligence and system complexity are not guarantors of success! Otherwise we&#39;d see a lot less white papers on trading algos and more yachts parked over here in the Mediterranean ;-)</p>

<p>Machine <em>Learning</em> is just that. The wiki describes it as &#39;a subfield of computer science that evolved from the study of pattern recognition and computational learning theory in artificial intelligence.&#39; Says nothing in there about predicting future market activity. Which, just like the future, you CANNOT. The best you can do is to look for discrepancies, to parse for subtle repetitive patterns, develop a small edge based on market inefficiencies. You work with the factors and markets you KNOW and NOT with the ones YOU THINK YOU KNOW or THINK/WISH WILL HAPPEN.</p>

<p>Most of you guys probably have forgotten more about mathematics and machine learning than I will ever manage to grasp in my life. I&#39;m literally standing on the shoulders of giants here and I&#39;m more an ML groupie than a quant. But over the past years I nevertheless have managed to hold my own and even help many others develop and maintain a profitable edge. And for the sole reason that I DO NOT EVER ATTEMPT TO PREDICT THE FUTURE. Having spent the better part of the last decade developing trading systems (for myself and clients) I assure you that anything that may appear to be predictable will quickly cease to be. I cannot tell you how many systems I have seen thrive for a few weeks or even months and then nosedive into oblivion. It&#39;s probably the one reliable pattern I am confident about when it comes to trading systems.</p>

<p>Part of the problem is that markets are cyclical and that the nature of those cycles are not easily determined. The best indicator is your P&amp;L curve and one of the most promising techniques for improving my systems has been to know when to turn them off and then on again. There are many very profitable systems out there - you just need to figure out when they work and when they don&#39;t. That is where I believe the rubber meets the road.</p>

<p>Now machine learning is extremely fascinating to me but it in my mind it is also a double edged sword. I do not believe that complexity equals success - quite to the contrary actually. Give me a simple system with simple (human) observable rules any day instead of having to run three parsers and decision trees in order to produce an entry or exit. The ML systems <em>I am</em> interested in building are simple by design but its patterns require ML techniques to be unveiled. I would not feel comfortable to trade via a black box that spits out rules I cannot understand.</p>

<p>FWIW this is one of the better discussions I have seen on this topic and it reflects the high caliber of the people who participate here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee7bf72ecde403c800005a' id='57ee7bf72ecde403c800005a'>
<a href='#57ee7bf72ecde403c800005a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1475247104000' class='quanto-date posted-at response-posted-at' href='#57ee7bf72ecde403c800005a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Anthony,</p>

<p>One cannot know the true intentions of a manager like Numerai. The concept is smart and the manager appears also very smart. But I have no idea of what he is doing in background. Numerous tests I have done on training and tournament data show that they are i.i.d. despite claims to the opposite and that the highest possible accuracy without any clever boosting is in the order of 3% and logloss is higher than 0.6900. Of course some participants can lower logloss via boosting and get a top placement but that does not increase prediction accuracy. </p>

<p>Now it is possible to profit with a 3% edge if there is a decent payoff ratio and a large number of low cost transactions or a high payoff ratio with a lower number of transactions at moderate cost. The problem with this ensemble approach (expectation) is possibility of ruin in the time domain. It is gambling in essence. He may have found a way to minimize risk of ruin but it is still there, it is finite and as a result, ruin will occur at some point (in this sense, ruin even takes place when a cumulative stop-loss is reached after which trading stops.) </p>

<p>However, these problems are not particular to ML but present in all trading methods. ML has additional issues with high data-snooping, selection bias and overfitting. Note that all these are in play when one uses ML. In essence then, probability of success is very low.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ee8182cb4cf62ce7000223' id='57ee8182cb4cf62ce7000223'>
<a href='#57ee8182cb4cf62ce7000223'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57098964269e5c568a0006a2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/359adb3730b5bc74e40922342110a57b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57098964269e5c568a0006a2'>Evil Speculator</a>
</div>
<a UTCms='1475248522000' class='quanto-date posted-at response-posted-at' href='#57ee8182cb4cf62ce7000223'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Brom &quot;On point two. if you train your ML model on data from 2016, then test it on data from 2015 and get a high accuracy score, it seems like you shouldnt really trust it since you wouldn&#39;t have had data from 2016 if you were trading in 2015.&quot;</p>

<p>Obviously not. The better approach would be to train your model on data from 2008, 2010, 2114, etc. and then test it on 2016. Most likely this will break your model (completely different market cycles) and so your real task begins. Which is to figure out the conditions under which your model functions within your defined parametes. As a sidenote and I concede that this may sound horribly unscientific to an audience of quants: The root of all evil in system development may be in attempting to produce systems that work continuously. There may be some exception to this rule, e.g. time insensitive systems discussed further above, but I suspect that many models fail because they are based on the assumptions that market patterns/fractals/cycles are continuous. I think our time may be much better spent in modeling what sometimes works well as opposed to what always works.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ef887ab00116dc4c0007ad' id='57ef887ab00116dc4c0007ad'>
<a href='#57ef887ab00116dc4c0007ad'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475315842000' class='quanto-date posted-at response-posted-at' href='#57ef887ab00116dc4c0007ad'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<blockquote>
<p>Transform the long and short baskets to portfolio weights is part of the portfolio construction step. Given the baskets (just binary long/short signals or probabilities) it would run portfolio optimization</p>
</blockquote>

<p>My point is that the workflow that is being discussed and engineered is a kind of system with interfaces.  There is a step-by-step flow of inputs and outputs (for a high-level sketch, see <a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">https://blog.quantopian.com/a-professional-quant-equity-workflow/</a> ).  As a side note, I would encourage the whole financial industry to stop using the term &quot;alpha&quot; and use &quot;factor&quot; instead, in this context.  For one thing, it pre-supposes that after the universe definition step, you&#39;ve magically found factors that have been expunged of any overall market influences, and can print money in an uncorrelated fashion.  Can &quot;alpha&quot; as it is conventionally defined, even be calculated accurately until the backtest step anyway?  Save the buzz-words for the marketing guys.</p>

<p>Back to my point...as I understand, you are working to put together a factor combination step using ML that will be general, and applicable to the vast majority of users.  You want a kind of module (like the Q500US &amp; Q1500US universes) that is broad brush and configurable, and that will provide the most general set of outputs to the next step in the workflow, which as you describe, is another optimization.  So, my sense is that if your factor combination step takes in N securities, it ought to spit out N securities, as a normalized portfolio weight vector (e.g. a series of calls to 
<code>order_target_percent(stock,weight[stock])</code> would update my portfolio).  There would be no baskets of long-short; the output of the factor combination step could be all long or all short, for example.</p>

<p>The next step in the workflow, portfolio construction, would operate on the portfolio weight vector, as you say:</p>

<blockquote>
<p>run portfolio optimization to e.g. (i) minimize volatility, (ii) minimize exposure to certain risk factors, (iii) take the previous portfolio into account to reduce turn-over, (iv) take transaction and borrow costs into account etc </p>
</blockquote>

<p>At this step, for example, you would apply the market neutral constraint, which is a risk factor to be managed.  If you impose the market neutral constraint by design earlier in the workflow, then one can&#39;t apply it in the portfolio construction step, where it would seem to reside.  Your factor combination step, I think, should be an unconstrained maximization of the overall portfolio return, point-in-time (which may be a problem, since there is no constraint on the new portfolio vector bearing any resemblance to the old one...this is handled in the OLMAR algo by minimizing the square of the Euclidean distance between the old and new portfolio vectors, subject to an overall forecasted return inequality constraint).  In the factor combination step, are you effectively finding the point-in-time overall return response surface and then finding the peak, with no constraints in the optimization (under a stationarity assumption, I gather)?  Is the idea that you can sorta patch things up in the next step of portfolio construction, by re-normalizing the portfolio vector output from the factor combination step?</p>

<p>I&#39;m wondering if you can actually approach things as you are.  Your combination and optimization steps may be better thought of as one step.  You are wanting to solve a constrained global optimization problem, I think, to control the overall portfolio return versus time.  Shouldn&#39;t you be combining the factors to maximize the forecast return for the next portfolio update, subject to a set of equality and inequality constraints?  I don&#39;t understand how you can break things up, and still get the right answer.</p>

<p>Grant</p>

<p>EDIT: Maybe what you should be passing to the portfolio optimization step is effectively a point-in-time response surface model for the overall return (the &quot;mega-alpha&quot;)?  Is that what you are doing?  Then you can use the model in the constrained portfolio optimization problem?  This would seem to make sense.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ef8e322ddd8c92ba00074a' id='57ef8e322ddd8c92ba00074a'>
<a href='#57ef8e322ddd8c92ba00074a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475317310000' class='quanto-date posted-at response-posted-at' href='#57ef8e322ddd8c92ba00074a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>As a baseline, to see if this fancy ML jazz is buying you anything, you might try the old-school response surface methodology, which amounts to a multivariate polynomial fit to predict the response.  If you have stationarity and your factors vary enough, you&#39;ll be able to establish the point-in-time response surface of the forecast return  and find the maximum.  Computationally, it should be easier.  If you get the same (or a better) answer than ML, then chuck the ML (or find a ML approach that is superior to the multivariate polynomial fit).</p>

<p>A problem, I think, is that at each point-in-time, your multivariable polynomial model will change.  Not all terms will be statistically significant at all times.  So, you&#39;d need some way to evaluate which terms to keep at any given time.  Manually, this is done by assuming a higher order model and then reviewing which terms should be dropped based on their fit statistics.  Then a re-fit is done, with a simpler model, to avoid over-fitting.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57efa998d5dff46b16000b3d' id='57efa998d5dff46b16000b3d'>
<a href='#57efa998d5dff46b16000b3d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475324318000' class='quanto-date posted-at response-posted-at' href='#57efa998d5dff46b16000b3d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<blockquote>
<p>Re stationarity: That&#39;s certainly the assumption in the window of the training data. But if you don&#39;t assume some form of stationarity over a limited time-period, how would you want to do predictions of any nature in the first place?</p>
</blockquote>

<p>So aren&#39;t you then obligated to test for stationarity in some fashion?  Or would this have been done in picking the factors in the first place (with alphalens)?  But then, what if the factors go in and out of stationarity?</p>

<p>Sorry, I still continue to be confused how all of this fits together...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f0f4d16be3bb05d9000e98' id='57f0f4d16be3bb05d9000e98'>
<a href='#57f0f4d16be3bb05d9000e98'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475409110000' class='quanto-date posted-at response-posted-at' href='#57f0f4d16be3bb05d9000e98'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>Another thought is, shouldn&#39;t you include SPY in your analyses, as a proxy for the entire market?  You would run as many factors against it as you can (should be able to augment the Morningstar data with aggregate numbers for SPY, right?).  Maybe some factors run against certain stocks are simply yielding the same results as SPY, and they could be rejected?  For stock ABC, if I compute factor_ABC and it is indistinguishable from factor_SPY, then I should reject the use of the factor on ABC, since I&#39;m not interested in the market.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f2715ef2000485b3000062' id='57f2715ef2000485b3000062'>
<a href='#57f2715ef2000485b3000062'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a5e05aaf3a4c589d0009ab'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7bdda3882c7b4b607ca34ae9a4029810?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a5e05aaf3a4c589d0009ab'>Peter Harrington</a>
</div>
<a UTCms='1475506541000' class='quanto-date posted-at response-posted-at' href='#57f2715ef2000485b3000062'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Mikko M, I&#39;d be interested in hearing more about Cohen&#39;s Kappa.  </p>

<p>The Wikipedia page suggests that <a href="https://en.wikipedia.org/wiki/Youden%27s_J_statistic">Youden&#39;s J statistic</a> is better for supervised learning.  Did you use either of these?  I&#39;d be interested in seeing how the Adaboost and NB implementations compared with these stats instead of just using accuracy.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f2f2126a58b7fb80000452' id='57f2f2126a58b7fb80000452'>
<a href='#57f2f2126a58b7fb80000452'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475539482000' class='quanto-date posted-at response-posted-at' href='#57f2f2126a58b7fb80000452'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>Having thought about this a bit, for the next step in your workflow, portfolio optimization, it seems like you&#39;ll want a model for the returns.  For example, up to quadratic order, you&#39;d need this:</p>

<p>Y = β0+β1X1+β2X2+β3X3+β12X1X2+β13X1X3+β23X2X3+β11X1^2+β22X2^2+β33X3^2</p>

<p>where Y is the forecast return and X1, X2, &amp; X3 are 3 factors.  For each security, you would have such an equation.</p>

<p>Is this effectively what you are doing with the ML?  Combining factors in a nonlinear fashion?  Why chose ML over a polynomial fit?  Is it expected to do a better job?</p>

<p>And would you also need to forecast the volatility in returns?  If so, shouldn&#39;t that be included in the modelling?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f394f6d8d35064ad00060b' id='57f394f6d8d35064ad00060b'>
<a href='#57f394f6d8d35064ad00060b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1475581182000' class='quanto-date posted-at response-posted-at' href='#57f394f6d8d35064ad00060b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant,</p>

<p>In trading we are looking for a model with categorical dependent variable: {Buy, Sell} or {1,0}</p>

<p>i.e., we want to know when to buy and when to sell/short</p>

<p>Although linear regression could model this problem by looking at feature changes and using dummy variables to represent categories, a more efficient way is machine learning classification where we try to find a model using the features that predicts the categorical depended variable with high enough accuracy. Essentially, this model provides the buy and sell/short signals when new data are available. These signals are necessary in practice. </p>

<p>I hope this makes sense.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f39751d8d3505c1200021a' id='57f39751d8d3505c1200021a'>
<a href='#57f39751d8d3505c1200021a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57ea3ff07b82e31eee000056'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0d4911fbffe710264e58b4ea910617f8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57ea3ff07b82e31eee000056'>angel lily</a>
</div>
<a UTCms='1475581782000' class='quanto-date posted-at response-posted-at' href='#57f39751d8d3505c1200021a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>At a level lower than 30,000 feet, but above the ground level of individual lines of code (let&#39;s say 10,000 feet), there is a kind of overall point-in-time optimization problem that is being solved, which includes the universe selection, and the  factors and their interactions. There&#39;s also the issue of how the universe selection interacts with the factors, which I don&#39;t think is addressed <a href="http://prodissertation.co.uk">Dissertation Help</a> in the workflow (at least not as a factor to be automatically optimized). In the end, it would seem that as an output of the factor combination step, I should have a model of how to forecast returns for every stock independently, no? Is that where we are headed? Then the portfolio construction step would be to sort out how to apply those forecasts and construct portfolio weights (i.e. how much of my portfolio should be in XYZ at any given point in time)?</p>

<p>Perhaps you could provide a sense for the overall optimization problem that is being solved (across the entire workflow) and how your factor combination step fits in? Presumably, your &quot;library of commonly used alpha factors&quot; was run through alphalens and somehow vetted? Each one was shown to have some predictive power individually, and now you are combining them in a fashion that accounts for interactions (&quot;a non-linear combination of features&quot;). Sorry, as I said, I&#39;m missing the 10,000 foot view. What are you doing?</p>

<p>To provide some background, I am familiar with the so-called &quot;response surface methodology&quot; used in design and process engineering. My fuzzy picture is that you are building a multi-dimensional response surface that can be used for optimization, subject to constraints? If so, what order of model are you constructing (first-order, second-order)? Is the ML model effectively the response surface? Or has it already done the optimization? Again, I&#39;m obviously confused...</p>

<p>Best regards<br>
angellily</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f3b46fe26f3d131c00099f' id='57f3b46fe26f3d131c00099f'>
<a href='#57f3b46fe26f3d131c00099f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a5e05aaf3a4c589d0009ab'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7bdda3882c7b4b607ca34ae9a4029810?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a5e05aaf3a4c589d0009ab'>Peter Harrington</a>
</div>
<a UTCms='1475589241000' class='quanto-date posted-at response-posted-at' href='#57f3b46fe26f3d131c00099f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is a version with cross validation implemented.  Note with cross validation your training error is very close to your test error, so you can tune your classifier and your final results will be similar to your training results.  On the RandomForests classifier there was almost 99% training accuracy but the test accuracy was much closer to 50%.  Now with cross validation.  the RandomForests training error is more realistic.  </p>

<p>Additionally I have implemented another performance metric: <a href="https://en.wikipedia.org/wiki/Youden%27s_J_statistic">Youden&#39;s J-stat</a>, which ranges from -1 to 1.  A J-stat of 0 says your classifier is useless.  I ran it for Adaboost, NB, and RandomForests giving: -0.04, -0.06, -0.03.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f3c3696a58b74af9000332' id='57f3c3696a58b74af9000332'>
<a href='#57f3c3696a58b74af9000332'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a5e05aaf3a4c589d0009ab'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7bdda3882c7b4b607ca34ae9a4029810?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a5e05aaf3a4c589d0009ab'>Peter Harrington</a>
</div>
<a UTCms='1475593076000' class='quanto-date posted-at response-posted-at' href='#57f3c3696a58b74af9000332'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I noticed that there were 20 factors defined but only 18 were being used, upon further inspection I noticed that two were defined twice, so all 18 were being used.  The definitions were the same so the duplication didn&#39;t change the results, attached is a version with the duplicates removed.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f430a58d5598e3bb0002d8' id='57f430a58d5598e3bb0002d8'>
<a href='#57f430a58d5598e3bb0002d8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475621037000' class='quanto-date posted-at response-posted-at' href='#57f430a58d5598e3bb0002d8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Michael Harris -</p>

<p>In general, for the portfolio optimization step, I think one wants, at a minimum, the projected absolute return of each stock in the universe, using multiple factors combined to make the forecast.  It also seems like it would be handy to have a measure of the expected variance in the forecast return.  Additionally, projected stock-to-stock pairwise returns correlations might be useful.  In the end, it is something like minimizing the rotation angle of the portfolio vector in its N-dimensional space (since there are N stocks in the universe), subject to a minimum Sharpe ratio constraint (e.g. SR ~ 1.0), and a constraint that the beta of the portfolio be within a range about zero (or not, if one wants a strong beta tilt or long-only or short-only).</p>

<p>If the output of the alpha combination step is just baskets of long and short stocks, with no other information, it seems like the optimization step won&#39;t be performed optimally.</p>

<p>But admittedly, I&#39;m still trying to get my head around this whole thing...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f43a2b8e0bad63f4000356' id='57f43a2b8e0bad63f4000356'>
<a href='#57f43a2b8e0bad63f4000356'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1475623474000' class='quanto-date posted-at response-posted-at' href='#57f43a2b8e0bad63f4000356'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just a simple question. </p>

<p>How long does it take to run the last pipeline? </p>

<p>I think it would be nice if authors of cloneable notebooks give an estimate on how many hours will be spent running a pipeline and waiting for a response.</p>

<p>Some kind of progress indicator might be fine too.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f4c7838d559864e800016b' id='57f4c7838d559864e800016b'>
<a href='#57f4c7838d559864e800016b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475659662000' class='quanto-date posted-at response-posted-at' href='#57f4c7838d559864e800016b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter: Thanks, those are great contributions. I updated the original NB with your fixes to the Factor library. It&#39;s also validating to see that the cross-validation gives similar (poor) results than the hold-out, suggesting it does not overfit. </p>

<p>I think the next steps would be to use less common factors to try and improve accuracy.</p>

<p>@Guy: I updated the original NB with a timer for running the pipeline, it took around 3 minutes.</p>

<p>@Grant: You can certainly experiment with different classifiers, like a polynomial model. In general, these give poor out-of-sample performance due to overfitting. Beta-to-SPY is a great factor to include as well. Your comments in general are valid ways to experiment with the workflow. You shouldn&#39;t understand this as &quot;the one and only way to do algorithmic trading on Q&quot;, but rather, &quot;here is a starting point that might be a useful template to extend from&quot;.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57f4ccc07ec267c0000002e3' id='57f4ccc07ec267c0000002e3'>
<a href='#57f4ccc07ec267c0000002e3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475661002000' class='quanto-date posted-at response-posted-at' href='#57f4ccc07ec267c0000002e3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>We just published part 2 of this workflow which retrains the model periodically: <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-2-ml-as-a-factor">https://www.quantopian.com/posts/machine-learning-on-quantopian-part-2-ml-as-a-factor</a>  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57f4d5b08d5598b08d00006d' id='57f4d5b08d5598b08d00006d'>
<a href='#57f4d5b08d5598b08d00006d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1475663288000' class='quanto-date posted-at response-posted-at' href='#57f4d5b08d5598b08d00006d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas,</p>

<p>You might have missed that but @Grant talked about regression (similar to a Probit model maybe)  and portfolio optimization, not classification.  </p>

<p>You said that &quot;In general, these give poor out-of-sample performance due to overfitting.&quot; and I agree. But this also holds for machine learning classification. </p>

<p>It is not entirely clear how classification is better than either simple regression or probit regression for large long/short portfolios in the absence of a study. At the end of the day, classification is also an optimization method. </p>

<p>I would start by comparing the results of machine leaning to a simple cross sectional momentum model, i.e., buy the strong performers and short the week performers. If excess alpha is not significant,  then this may be an overkill but nevertheless a good analytical exercise. </p>

<p>Data-snooping is hard to overcome and it is a serious issue in machine learning. As the number of factors and securities increase, it becomes difficult to assess the significance of the results due to the multiple comparisons problem.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f4d5c78e0bad1bc80001b5' id='57f4d5c78e0bad1bc80001b5'>
<a href='#57f4d5c78e0bad1bc80001b5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475663313000' class='quanto-date posted-at response-posted-at' href='#57f4d5c78e0bad1bc80001b5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas -</p>

<blockquote>
<p>You can certainly experiment with different classifiers, like a polynomial model. In general, these give poor out-of-sample performance due to overfitting.</p>
</blockquote>

<p>I think over-fitting can be avoided by excluding terms not supported by the fit statistics.  As I recall, one ends up with p-values for each polynomial term.  One accepts/rejects terms based on their p-values.  For example, if I have only two points (factor-response pairs) and I try to fit a quadratic to them, the quadratic terms should be flagged as over-fit; I can only fit a straight line (or a constant?).  Given that one could manage the over-fitting problem, is there a reason this approach would still be a bad idea, over ML or something else?</p>

<p>The stationarity issue would seem to be the sticky one.  If all of my factor-response data represent one unchanging, underlying market going back 20 years, then I have a shot at sorting things out.  I gather, though, that we are perhaps dealing with transient stationarity.  Is this correct?  Don&#39;t I also need to know which factors are valid, point-in-time?  Perhaps this was the point by others above, that a static ML model (or any static model, for that matter) might not work.  I need to know the validity of each factor as a function of time?  Normally, one would want to know if a given factor-response is &quot;in control&quot; over the look-back period, prior to attempting a model.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f4f9197ec26797f5000257' id='57f4f9197ec26797f5000257'>
<a href='#57f4f9197ec26797f5000257'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a5e05aaf3a4c589d0009ab'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7bdda3882c7b4b607ca34ae9a4029810?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a5e05aaf3a4c589d0009ab'>Peter Harrington</a>
</div>
<a UTCms='1475672352000' class='quanto-date posted-at response-posted-at' href='#57f4f9197ec26797f5000257'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is a version of the notebook that uses sector codes.  The sector codes are then binarized so that they can be used in an algorithm that cannot handle categorical data, SVM for example.  There was no improvement in the training performance, so I didn&#39;t implement the categories in the test.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f5009a382464e1260000b7' id='57f5009a382464e1260000b7'>
<a href='#57f5009a382464e1260000b7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1475674276000' class='quanto-date posted-at response-posted-at' href='#57f5009a382464e1260000b7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Gentleman<br>
The efficacy or otherwise of ML can only be tested by applying the predictions to past data and looking at the profitability of the system. Note my extreme scepticism of back testing after many years experience, however it is all we have. The predictive capability of back testing as to the future profitability of a given system is.......probably rather feeble.</p>

<p>As we all know however, given a 50/50 win loss ration it is quite possible to make substantial profit from long term trend following. CTAs usually make do with 40/60 against.</p>

<p>Trend following is not want Q wants to do. Fair enough. But the rest of us may have interest in this long standing apparent anomaly.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f51864d1ee0f684e000494' id='57f51864d1ee0f684e000494'>
<a href='#57f51864d1ee0f684e000494'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475680362000' class='quanto-date posted-at response-posted-at' href='#57f51864d1ee0f684e000494'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter: Interesting! Seems to be doing a little bit better (but probably not significant). Personally, I&#39;d be interested to see how it does on the hold-out. Sectors are intuitively an important thing to consider. An alternative approach would be to train a classifier for each sector.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57f556ceefaae8c3e500005b' id='57f556ceefaae8c3e500005b'>
<a href='#57f556ceefaae8c3e500005b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a5e05aaf3a4c589d0009ab'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7bdda3882c7b4b607ca34ae9a4029810?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a5e05aaf3a4c589d0009ab'>Peter Harrington</a>
</div>
<a UTCms='1475696341000' class='quanto-date posted-at response-posted-at' href='#57f556ceefaae8c3e500005b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I cleaned up the code so it works on both training and testing.  Using sectors in this manner did not improve the performance of the classifier.  I am going to try new factors, perhaps with better factors the sector data could be used to improve performance.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f55e8da8adc967d80000d4' id='57f55e8da8adc967d80000d4'>
<a href='#57f55e8da8adc967d80000d4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1475698325000' class='quanto-date posted-at response-posted-at' href='#57f55e8da8adc967d80000d4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter </p>

<p>But this repeated testing increases data-mining bias considerably. At some point the model will validate on hold-out but could be a random result. A method to quantify significance due to multiple testing is also required apart from hold out performance.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f6082ddbf17e92e10000b2' id='57f6082ddbf17e92e10000b2'>
<a href='#57f6082ddbf17e92e10000b2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1475741750000' class='quanto-date posted-at response-posted-at' href='#57f6082ddbf17e92e10000b2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I wonder whether it is better to start from fundamental analysis rather than end with it. </p>

<p>Testing each all every factor is to begin with fundamental analysis and to let ML decide which of those factors has predictive ability. Michael Harris and others have pointed out the dangers of over optimisation and repeatedly testing new ML versions over the same data.   This is the paradox of back testing; ultimately it is useless.</p>

<p>The determinants of price in the LONG term must surely be obvious: economic growth at the macro level and earnings growth at the individual corporate level. Coupled with a strong balance sheet.</p>

<p>In the long term these factors will win out and these companies will enter into and remain in the relevant big cap stock indices until their success falters and they begin the inevitable decline which is the fate of all things.</p>

<p>Anything else is mere noise. So perhaps ML ought to be secondary to one&#39;s judgement of what makes markets tick.</p>

<p>Unfortunately of course this is hardly a sexy approach for a hedge fund.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f6142140967f4988000137' id='57f6142140967f4988000137'>
<a href='#57f6142140967f4988000137'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475744808000' class='quanto-date posted-at response-posted-at' href='#57f6142140967f4988000137'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Michael: Certainly that&#39;s true, although we have quite a bit of hold-out data here which dampens the severity. The other benefit is that everyday we accumulate new hold-out data. Like with algorithms, the proof is in paper-trading.</p>

<p>@Anthony: I definitely think intuition and statistics should complement each other. For example, a quality earnings factor has some intuitive appeal, so I include it in the model. Then when training the classifier, I find an inverted-U shape relationship to how it relates to returns. That could lead to the insight that obviously bad earnings are bad, but perhaps overly positive reports are suspicious too and might try to mask a more fundamental problem. You seem to have gained a lot of intuition in markets over the years which is highly valuable so I encourage you to compile this knowledge into factors which more ML / Data Sciency people can play around with and try to optimally employ and combine.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57f618fadbf17e2f01000178' id='57f618fadbf17e2f01000178'>
<a href='#57f618fadbf17e2f01000178'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475746048000' class='quanto-date posted-at response-posted-at' href='#57f618fadbf17e2f01000178'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Michael Harris -</p>

<blockquote>
<p>You might have missed that but @Grant talked about regression (similar to a Probit model maybe) and portfolio optimization, not classification.</p>

<p>You said that &quot;In general, these give poor out-of-sample performance due to overfitting.&quot; and I agree. But this also holds for machine learning classification.</p>

<p>It is not entirely clear how classification is better than either simple regression or probit regression for large long/short portfolios in the absence of a study. At the end of the day, classification is also an optimization method.</p>
</blockquote>

<p>My intuition is that if the conditions are right for ML to work, then multivariate polynomial regression for forecasting returns will also work, if applied correctly.  If the underlying system is stable in time, all of my factor-response pairs are stationary, and all is copasetic, then I should be able to find an empirically-derived multi-factor response surface.  There are areas of science and engineering where this works just fine; even if I don&#39;t have a scientific model (e.g. from Maxwell&#39;s equations in E&amp;M), with the right experimental data sets, I can build a perfectly valid, predictive multi-factor empirical model.  By analogy, in finance, if the underlying system is stable, then it should be predictable, given the right data sets.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f61b84b475b1f3870001a5' id='57f61b84b475b1f3870001a5'>
<a href='#57f61b84b475b1f3870001a5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1475746703000' class='quanto-date posted-at response-posted-at' href='#57f61b84b475b1f3870001a5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Anthony,</p>

<p>Nice summary.  It should be used as a guide for any future work. </p>

<p>The clash is between unique hypotheses versus hypotheses suggested by the data. I still do not understand whether the objective is asset allocation or short-term anomaly arbitrage. Using fundamental factors for the latter makes no sense. </p>

<p>Can anyone clarify the above? For example, the probability of AMZN selected as a longer-term holding based on fundamental factors is quite low. </p>

<p>On the other hand, as you said:</p>

<p>&quot;Unfortunately of course this is hardly a sexy approach for a hedge fund.&quot;</p>

<p>except in the case that they will act as your sell side to test market strength with a small investments while leveraging the faded trade with a bigger investment. </p>

<p>@Thomas</p>

<p>&quot;we have quite a bit of hold-out data here which dampens the severity.&quot;</p>

<p>This is true, i.e., a large hold-out increases power of the test and minimizes Type I error. However, what is important is the actual sample of predictions and not the hold-out length. If that is a sufficient sample then there is a chance. But a large hold-out limits the exposure of ML to a variety of market conditions. In my book I recommend doing away with hold-out and use two distinct universes, one for learning and the other for testing, both spanning same timeframes. The test universe should be chosen in advance and never changed to minimize data-snooping. This certainly decreases p-hacking probability but never to zero. There is always possibility of a random fit. </p>

<p>What are the objectives of Point72 in terms of trading timeframes? intraday, short-term, medium-term of longer-term? That can make a huge difference in the approach. </p>

<p>Best.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f62068dbf17e2f010001d1' id='57f62068dbf17e2f010001d1'>
<a href='#57f62068dbf17e2f010001d1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475747950000' class='quanto-date posted-at response-posted-at' href='#57f62068dbf17e2f010001d1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>As I&#39;ve mentioned above, my sense is that the timeframe is largely driven by the exclusive use of daily OHLCV bars in conjunction with pipeline.  The game plan, as I see it, is to see how far that will take us, without additional development and operational costs.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f642c0dbf17e92e1000333' id='57f642c0dbf17e92e1000333'>
<a href='#57f642c0dbf17e92e1000333'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1475756743000' class='quanto-date posted-at response-posted-at' href='#57f642c0dbf17e92e1000333'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Michael: What I never understood about the two-universe hold-out method is how correlations do not invalidate it. If correlations are high and we are in a bear-market, the classifier will easily predict all stocks to go down and get a high score on the other 50%. It is also much more complex to find an equal split across industries etc. It also just seems more detached from what we&#39;re actually trying to measure (performance going forward, rather than performance if we knew half of the universe&#39;s returns).  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57f65414dbf17e2f01000442' id='57f65414dbf17e2f01000442'>
<a href='#57f65414dbf17e2f01000442'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1475761179000' class='quanto-date posted-at response-posted-at' href='#57f65414dbf17e2f01000442'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas: All valid points.  There is a trade-off between determining the integrity of the ML process and reducing universe size with the two universe hold-out method.</p>

<p>The problem is - and  as far as I know it is a misunderstood issue - that validation on a hold-out is not enough to determine the integrity of the ML process due to multiple comparisons. For example, for simple strategies with one ETF I develop with my ML program I use validation on a anti-correlated security. The result is used to determine whether the predictions made by ML are not suggested by the data but from more fundamental factors. </p>

<p>With the two universe hold-out method the power of test increases significantly and this is what can help in minimizing Type I error. Your point about correlation is valid and this is why the two universes should have sufficient history and include a wide variety of market conditions. I agree there are issues and your points are valid but in my opinion the single hold-out method is doomed in the first place unless you  intend to run the ML algo only a few times and not make many changes to features, etc.  motivated by knowledge of performance in hold-out, which is data-snooping. </p>

<p>Actually, as I have written in one of my articles, analyzing the integrity of the ML process is the true edge, not the predictions.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f6555240967f4988000455' id='57f6555240967f4988000455'>
<a href='#57f6555240967f4988000455'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1475761501000' class='quanto-date posted-at response-posted-at' href='#57f6555240967f4988000455'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I agree with Anthony&#39;s point of view. Fundamental data on a day to day basis has very little predictive powers. And as expressed by Grant, a multivariate polynomial regression is the same thing as using multiple factors.</p>

<p>All real life trading decisions have to be taken at the right edge of a chart. </p>

<p>You can&#39;t decide backwards. Looking at past data can only be useful to validate a concept, to show that indeed using such and such trading methods would have produced something over a particular data set over a particular period in time. </p>

<p>The main idea has always been to extend to the future what has been found to work in the past. However, if I manipulate the data in the past just to show good results (over optimize), I should not expect the market to comply with my “better” trading methodology going forward.</p>

<p>That is the problem, at the right edge of a chart, the future remains this stochastic sea of stock variances generating this buzzing cloud of price variations where a quasi random walk infrastructure might prevail. And it might be quite independent of its past.</p>

<p>Maybe what best describes what I am saying is the following chart:</p>

<p><a href="http://alphapowertrading.com/images/divers/SDE_long_term.png">http://alphapowertrading.com/images/divers/SDE_long_term.png</a></p>

<p>In the beginning, fundamental data is a lesser part of price variations while over the long term, it is what will have dominated the scene. Without some positive fundamental data to support a stock over the interval, a stock might not even survive to appreciate the notion of long term.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f76ab5634a51cb33000077' id='57f76ab5634a51cb33000077'>
<a href='#57f76ab5634a51cb33000077'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475832510000' class='quanto-date posted-at response-posted-at' href='#57f76ab5634a51cb33000077'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>One problem I see here is that you are trying to show that everything works on real data from the get-go.  Your methodology would benefit from synthesizing stock data with known characteristics.  Then, you can see if the known inputs generate the expected output.  Then, you can take the next step, and say &quot;If the real-world input data have characteristics similar to my synthesized data, then my tool will work&quot; and proceed to try real data.</p>

<p>As Michael Harris touches on above, you first need to prove &quot;the integrity of the ML process&quot; and then give it a go on real-world data.  For example, if you were developing a ML system to recognize faces, you might use some 3D rendering software to synthesize a set of faces for training, and then see if you could extract known features, before moving on to applying your ML system on actual faces.</p>

<p>Is this kinda thing done in the quant world?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f7a15eb7ed9f0c7a0002b7' id='57f7a15eb7ed9f0c7a0002b7'>
<a href='#57f7a15eb7ed9f0c7a0002b7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/553a99b1c16c1ab564000419'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f9dfceac3cbc0bef3151a67e839a2e03?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/553a99b1c16c1ab564000419'>Sangria Ostrich</a>
</div>
<a UTCms='1475846502000' class='quanto-date posted-at response-posted-at' href='#57f7a15eb7ed9f0c7a0002b7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Grant - </p>

<p>Here&#39;s an example of someone doing something kind of similar to what you&#39;re describing in terms of using synthetic data series:<br>
<a href="http://jonathankinlay.com/2014/06/developing-trading-strategies-with-genetic-programming/">http://jonathankinlay.com/2014/06/developing-trading-strategies-with-genetic-programming/</a> </p>

<p>Specifically the paragraphs that read: </p>

<blockquote>
<p>One of the challenges I devised was to create data sets in which real<br>
and synthetic stock series were mixed together and given to the system<br>
evaluate. To the human eye (or analyst’s spreadsheet), the synthetic<br>
series were indistinguishable from the real thing. But, in fact, I had<br>
“planted” some patterns within the processes of the synthetic stocks<br>
that made them perform differently from their real-life counterparts.<br>
Some of the patterns I created were quite simple, such as introducing<br>
a drift component. But other patterns were more nuanced, for example,<br>
using a fractal Brownian motion generator to induce long memory in the<br>
stock volatility process.  </p>

<p>It was when I saw the system detect and exploit the patterns buried<br>
deep within the synthetic series to create sensible, profitable<br>
strategies that I began to pay attention. A short time thereafter<br>
Haftan and I joined forces to create what became the Proteom Fund.</p>
</blockquote>

<p>It should be noted that in this case he deliberately throws in patterns that are <em>different</em> from the patterns in the actual stock data, rather than making them as similar as possible. Figured you still might be interested though.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f7b3ad55d41a8d470000bd' id='57f7b3ad55d41a8d470000bd'>
<a href='#57f7b3ad55d41a8d470000bd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57f7a6ec5d86b6d09e0002fd'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bbc1027ac8225d3170525ee4018fff37?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57f7a6ec5d86b6d09e0002fd'>David Powers</a>
</div>
<a UTCms='1475851188000' class='quanto-date posted-at response-posted-at' href='#57f7b3ad55d41a8d470000bd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Graham,</p>

<p>So author of the article sees his system fitting to random drift and fractal Brownian motion and he thinks he&#39;s got something.  There is no proof from his results that the system did not fit but instead identified some genuine patterns. Double blind out-of-sample does not solve this problem at all. He was probably fooled by noise and genetic programming. </p>

<p>Whatever happened to the Proteom fund? Website is not operational: <a href="http://www.proteomcapital.com">www.proteomcapital.com</a></p>

<p>It would be nice to see the performance for a reality check. Maybe they made it big, maybe not.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f7b8f30b740f6b8f00003a' id='57f7b8f30b740f6b8f00003a'>
<a href='#57f7b8f30b740f6b8f00003a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/553a99b1c16c1ab564000419'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f9dfceac3cbc0bef3151a67e839a2e03?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/553a99b1c16c1ab564000419'>Sangria Ostrich</a>
</div>
<a UTCms='1475852539000' class='quanto-date posted-at response-posted-at' href='#57f7b8f30b740f6b8f00003a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ David - </p>

<p>I just shared that as an example somewhat along the same lines of what Grant was describing in terms of using synthetic data. I can&#39;t speak to the effectiveness of the author&#39;s use of the synthetic data. The topic is far beyond my capabilities so I can&#39;t comment personally. However, I&#39;ve read some of his research via his blog for a while - <a href="http://www.jonathankinlay.com">http://www.jonathankinlay.com</a> - and he seems to know his way around a trading model, so I tend to take notice whenever he writes about something. Obviously, as you pointed out one can never know without access to his historical returns, which I also don&#39;t have. I recommend you read some more of his writings to decide for yourself. </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f7c0d5885106b2c40000c2' id='57f7c0d5885106b2c40000c2'>
<a href='#57f7c0d5885106b2c40000c2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57f7a6ec5d86b6d09e0002fd'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bbc1027ac8225d3170525ee4018fff37?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57f7a6ec5d86b6d09e0002fd'>David Powers</a>
</div>
<a UTCms='1475854557000' class='quanto-date posted-at response-posted-at' href='#57f7c0d5885106b2c40000c2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Graham,</p>

<p>The high Sharpe ratios in excess of 5 indicate high probability of over-fitting to noise. The inclusion of a drift component in synthetic data is possibly responsible for that. And thanks but no - I will not be spending any time in a blog like that. The author gives the answer about the quality of his work himself: &quot;Even so, given the enormous number of models evaluated, there remains a significant risk of over-fitting.&quot; </p>

<p>Note that the approach followed in that article is quite different from the sound ML approach of Quantopian with models based on classifiers of economically sound factors. It is hard to incorporate these factors in synthetic data and for this reason the data are useless for the purpose of this modeling approach here. </p>

<p>I disagree with some posters who have questioned the integrity of the ML process followed by Quantopian. This is a valid process based on classifying features that have economic value. Synthetic data and two universe hold-out are not required. All that is needed is forward testing of about three months and then go live if it works.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57f7d7b28c042804d80000f7' id='57f7d7b28c042804d80000f7'>
<a href='#57f7d7b28c042804d80000f7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1475860407000' class='quanto-date posted-at response-posted-at' href='#57f7d7b28c042804d80000f7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>All that is needed is forward testing of about three months and then go live if it works. </p>
</blockquote>

<p>For weekly trading, that&#39;s only ~ 12 trades (sets of orders).  Doesn&#39;t seem like enough data.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57ff973b7f099fdd6a000658' id='57ff973b7f099fdd6a000658'>
<a href='#57ff973b7f099fdd6a000658'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1476368197000' class='quanto-date posted-at response-posted-at' href='#57ff973b7f099fdd6a000658'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant: 12 * n_stocks, and it&#39;s not reasonable to assume n_stocks &gt; 200, so at least 2400 data points which is not nothing.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5800093702729409e7000220' id='5800093702729409e7000220'>
<a href='#5800093702729409e7000220'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1476397373000' class='quanto-date posted-at response-posted-at' href='#5800093702729409e7000220'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>I was thinking in terms of the number of times the portfolio is rejiggered.  There will be a return for each rejiggering (week-to-week).  I end up with a timeline of 12 rejiggers, which in my mind is still in the realm of small-number statistics.  I guess it all depends on how quiet the backtest data are.  If I end up with (1+r)^2 returns, and the trend continues, then o.k.  But in all likelihood, the backtest will have zig-zags over any 12 week period.  So, it&#39;ll be hard to say if the overall trend is continuing, or if the dreaded over-fitting may be at play.</p>

<p>I don&#39;t see how the number of stocks matters, but then all of this is still sinking in.  Unless you are thinking that lots of stocks will smooth out returns, making it easier to detect a change in slope, at the transition from in-sample to out-of-sample?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='580366af46abdfaf6a0004fa' id='580366af46abdfaf6a0004fa'>
<a href='#580366af46abdfaf6a0004fa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/573a484fca30e0fe8c000007'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/53d91c835d819983b5b379ff7ed385f8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/573a484fca30e0fe8c000007'>Jonny Langefeld</a>
</div>
<a UTCms='1476617909000' class='quanto-date posted-at response-posted-at' href='#580366af46abdfaf6a0004fa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you Thomas for this awesome piece of work! This notebook and also the one where you put <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-2-ml-as-a-factor">all into one factor</a> are a great way to easily apply all machine learning ideas on Quantopian.</p>

<p>I thought this approach should be close to the partner data set <a href="https://www.quantopian.com/data/logitbot/precog_top_100">PreCog Top 100 Securities</a>, so I just took your notebook and included this one as an additional factor. It didn&#39;t change the result at all (still a little under 50%). In the predictor importance it was only in the middle field (see <em>predicted_five_day_log_retrun</em>).</p>

<p>Do you think this data set is worth its $100?</p>

<p>I also did the <a href="https://www.quantopian.com/posts/alphalens-a-new-tool-for-analyzing-alpha-factors#58036214b4c82e3db80006d1">alphalens analysis</a> on it.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='580686d093c1cf2741000070' id='580686d093c1cf2741000070'>
<a href='#580686d093c1cf2741000070'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5669e14376242e50ed00028e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cd0d17865613681b37aacd67a5066a60?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5669e14376242e50ed00028e'>Photi</a>
</div>
<a UTCms='1476822744000' class='quanto-date posted-at response-posted-at' href='#580686d093c1cf2741000070'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>For weekly trading, that&#39;s only ~ 12 trades (sets of orders). Doesn&#39;t seem like enough data.</p>
</blockquote>

<h2></h2>

<blockquote>
<p>12 * n_stocks, and it&#39;s not reasonable to assume n_stocks &gt; 200, so at least 2400 data points which is not nothing.</p>
</blockquote>

<p>@Grant @Thomas</p>

<p>The larger the amount of data points &amp; trading days the more  confident you can obviously be.<br>
But i would add another point here which i don&#39;t think has been mentioned. If after 3 months of Live trading your backtest closely tracks your real account activity, then you can be fairly confident that you are on the right track. If you made a bunch of money in those 3 months but your backtest doesn&#39;t track well your live activity, you need to rethink what it is you are doing.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='581575db5734a5e6b1000465' id='581575db5734a5e6b1000465'>
<a href='#581575db5734a5e6b1000465'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/580b5cdba3ae936c9100009e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bec781f94652ac70fdd50cc2e6fb2079?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/580b5cdba3ae936c9100009e'>Chuhan Wang</a>
</div>
<a UTCms='1477801441000' class='quanto-date posted-at response-posted-at' href='#581575db5734a5e6b1000465'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas<br>
Thank you Thomas. Compared with adaboost , what do you think of  hidden markov model,  support vector machine  with the  fundamental data ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='581f123b348d9abc4d000633' id='581f123b348d9abc4d000633'>
<a href='#581f123b348d9abc4d000633'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/575bf1f79553c1b89e000683'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a45c812344bf2989eff0bc6c7d627fb6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/575bf1f79553c1b89e000683'>Leigh Hopcroft</a>
</div>
<a UTCms='1478431302000' class='quanto-date posted-at response-posted-at' href='#581f123b348d9abc4d000633'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Any ideas why I keep getting import errors for sklearn modules?</p>

<p>&quot;InputRejected:
Importing SelectFromModel from sklearn.feature_selection raised an ImportError. Did you mean to import SelectFdr from sklearn.feature_selection? Last warning! One more import error and your account will be suspended for security reasons until a human can talk to you. &quot;</p>

<p>I&#39;ve also had problems with the below:</p>

<p>sklearn.model_selection.KFold<br>
sklearn.model_selection.GroupFold<br>
sklearn.model_selection.StratfiedKFold  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='582afa700d2fcd0016000e51' id='582afa700d2fcd0016000e51'>
<a href='#582afa700d2fcd0016000e51'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1479211639000' class='quanto-date posted-at response-posted-at' href='#582afa700d2fcd0016000e51'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Leigh: It seems we haven&#39;t whitelisted the new namespace. In the meantime you can still get them via:<br>
<code>from sklearn.cross_validation import StratifiedKFold</code></p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='583ba801cf734f001200036c' id='583ba801cf734f001200036c'>
<a href='#583ba801cf734f001200036c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55a833fd3b6b49c9e1000101'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9c809e6f98687dbaff7a18bb1d5755e4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55a833fd3b6b49c9e1000101'>Boris Lau</a>
</div>
<a UTCms='1480304652000' class='quanto-date posted-at response-posted-at' href='#583ba801cf734f001200036c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas - Running into the same issue with <code>sklearn.model_selection</code> (trying to use <code>sklearn.model_selection.GridSearchCV</code> ) - would there be an ETA for whitelisting the namespace?</p>

<p>(For now, using <code>sklearn.grid_search.GridSearchCV</code> which is going to be deprecated)</p>

<p>Many thanks!<br>
boris  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='583bb601cf734f00150003f5' id='583bb601cf734f00150003f5'>
<a href='#583bb601cf734f00150003f5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1480308231000' class='quanto-date posted-at response-posted-at' href='#583bb601cf734f00150003f5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It will definitely be fixed when we upgrade sklearn next so not to worry about the deprecation warning.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='584b064df143fb49c60000ca' id='584b064df143fb49c60000ca'>
<a href='#584b064df143fb49c60000ca'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481311834000' class='quanto-date posted-at response-posted-at' href='#584b064df143fb49c60000ca'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Check out Part 3 of how to turn this workflow into an actual strategy: <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm">https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm</a>  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='58dbc7e650b13d40be2f0665' id='58dbc7e650b13d40be2f0665'>
<a href='#58dbc7e650b13d40be2f0665'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58b31f3fe70bbf000af10187'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8cf7e6add155b5b4a9ab522f4e3bc002?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58b31f3fe70bbf000af10187'>Raid Ateir</a>
</div>
<a UTCms='1490798566000' class='quanto-date posted-at response-posted-at' href='#58dbc7e650b13d40be2f0665'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Dear Thomas, </p>

<p>Yesterday Jonathan Larkin was giving a talk to Imperial students at Stevens Institute of Technology. I am one of the students from the group. Thomas presented an &quot;L1&quot; risk layer, which we would like to implement in our algorithms. It would be great, if you could direct us to the relevant topic or piece of code.</p>

<p>Kind Regards,</p>

<p>Raid  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59947b96ff20c821d6e3bb16' id='59947b96ff20c821d6e3bb16'>
<a href='#59947b96ff20c821d6e3bb16'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1502903190000' class='quanto-date posted-at response-posted-at' href='#59947b96ff20c821d6e3bb16'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In trying to understand this notebook a bit better, as well as wrap my head around the implications of rank vs not ranked factors, I found that I&#39;m able to remove the <code>.rank(mask=universe)</code> from the notebook research environment, however when I tried to do this within an Algorithm it resulted in an error: <code>NonWindowSafeInput: Can&#39;t compute windowed expression</code></p>

<p>I suspect this is caused by the ML factor calling f() on the previously declared factors, however I&#39;m still getting my feet wet with understanding how they play together.  I understand why it&#39;s important for the Algo to be &quot;window_safe&quot; however I&#39;m not sure how to go about insuring that each of the factors declared within <code>make_factors</code> actually is window_safe.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59949d23307686000da3654d' id='59949d23307686000da3654d'>
<a href='#59949d23307686000da3654d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1502911779000' class='quanto-date posted-at response-posted-at' href='#59949d23307686000da3654d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>You&#39;re right, that&#39;s a nice side-effect of ranking that I hadn&#39;t thought about before. The problem can be seen as follows: if one of our factors is just the price of the asset and there is a split, the price would halve inside of your window causing the classifier to be confused. I&#39;m not quite sure what one would have to do to ensure everything is window-safe otherwise. Maybe Scotty can advise on which operations make an input window-safe.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5994be19cf5cde000d4b8141' id='5994be19cf5cde000d4b8141'>
<a href='#5994be19cf5cde000d4b8141'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1502920217000' class='quanto-date posted-at response-posted-at' href='#5994be19cf5cde000d4b8141'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>But doesn&#39;t the function need to run before it can compute the rank in the first place?  If that&#39;s the case it seems like we should be able to get the pre-ranked values out.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59951263b6822a00104f710d' id='59951263b6822a00104f710d'>
<a href='#59951263b6822a00104f710d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1502941795000' class='quanto-date posted-at response-posted-at' href='#59951263b6822a00104f710d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It looks like a workaround might be to feed <code>.top()</code> with full list of stocks.  For example if you&#39;re using <code>Q500US</code> then something like this avoids the error, however I don&#39;t know yet it if also adjusts for splits.  </p>

<pre><code>    # Instantiate factors using top() to avoid NonWindowSafeInput Error  
    for name, f in factors.iteritems():  
        #factors_pipe[name] = f().rank(mask=universe)  
        factors_pipe[name] = f().top(500,mask=universe)  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59954eefd8c103000d928d10' id='59954eefd8c103000d928d10'>
<a href='#59954eefd8c103000d928d10'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1502957295000' class='quanto-date posted-at response-posted-at' href='#59954eefd8c103000d928d10'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Pumplerod</p>

<p>If you really know what you are doing  you can remove the window_safe exception like this:</p>

<pre><code>    for name, f in factors.iteritems():  
        factor = f(mask=mask)  
        factor.window_safe = True # some factors don&#39;t have window_safe=True even if they should  
        factors_pipe[name] =factor  
        [...]  
</code></pre>

<p>Please understand well the implication of removing the NonWindowSafeInput exception or you might encounter some trouble in the future.</p>

<p>By the way, you know that you can use the zscore function instead of rank?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59955feb0d533f000d62871e' id='59955feb0d533f000d62871e'>
<a href='#59955feb0d533f000d62871e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1502961643000' class='quanto-date posted-at response-posted-at' href='#59955feb0d533f000d62871e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>By the way here is what <a href="https://www.quantopian.com/posts/new-pipeline-features-slicing-and-correlation-slash-regression-methods">David Michalowicz said</a> about using factors as input of other factor:</p>

<p>&quot;[...] is now allowed for a selected few factors deemed safe for use as inputs. This includes <strong>Returns</strong> and any <strong>factors created from rank or zscore</strong>. The main reason that these factors can be used as inputs is that they are comparable across splits. Returns, rank and zscore produce normalized values, meaning that they can be meaningfully compared in any context.&quot;</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59956456b6822a00104f771a' id='59956456b6822a00104f771a'>
<a href='#59956456b6822a00104f771a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1502962774000' class='quanto-date posted-at response-posted-at' href='#59956456b6822a00104f771a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>That&#39;s great, thanks for digging that up. z-scoring should be done in any case so if it also solves the window_safe issue that&#39;s the preferred way if you don&#39;t want to rank, Pumplerod. Please report back if that improved the prediction.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='599785c751d96c000d2b282e' id='599785c751d96c000d2b282e'>
<a href='#599785c751d96c000d2b282e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57fe58ed6a6efd5dab00012a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6bb52c4a8fa592657649d767861c1c1f?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57fe58ed6a6efd5dab00012a'>Vladislav Svyazhin</a>
</div>
<a UTCms='1503102407000' class='quanto-date posted-at response-posted-at' href='#599785c751d96c000d2b282e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi to all.  I am writing the dissertation with idea that feature extraction (PCA) can improve metrics of classification.<br>
I change the following<br>
1. add Momentum as a factor<br>
2. add many returns as a factors<br>
3. divide period to chunk to run pipeline for longer period<br>
4. use zscore not rank<br>
5.  use random forest not adaboost<br>
6.  using different number of pca and see results<br>
7.  try to work with pca number 5 for different sectors</p>

<p>What I have now that it look like that different result we have for different sectors. And I think it is the main idea!<br>
One needs to create machine learning algorithm for each sector or even for each company.<br>
Possible the different results happen because of some bias.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59afbc1f4b8458001005dbc5' id='59afbc1f4b8458001005dbc5'>
<a href='#59afbc1f4b8458001005dbc5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1504689183000' class='quanto-date posted-at response-posted-at' href='#59afbc1f4b8458001005dbc5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladislav: This is a very comprehensive study and your findings on sector-differences are highly intriguing. Thanks for sharing this!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59b02f5be75ce62c24501f00' id='59b02f5be75ce62c24501f00'>
<a href='#59b02f5be75ce62c24501f00'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54290b4cf783d96eaa0002fd'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/54fa4343064b4a4e6fbb8868709e6c8d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54290b4cf783d96eaa0002fd'>Batbold Sanghi</a>
</div>
<a UTCms='1504718683000' class='quanto-date posted-at response-posted-at' href='#59b02f5be75ce62c24501f00'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I am new to Quantopian. Can I use keras with Tensorflow backend  and sklearn on quantopian ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59b02fa9a566ce47eb481ec5' id='59b02fa9a566ce47eb481ec5'>
<a href='#59b02fa9a566ce47eb481ec5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54290b4cf783d96eaa0002fd'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/54fa4343064b4a4e6fbb8868709e6c8d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54290b4cf783d96eaa0002fd'>Batbold Sanghi</a>
</div>
<a UTCms='1504718761000' class='quanto-date posted-at response-posted-at' href='#59b02fa9a566ce47eb481ec5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>does quantopian allow users to install packages or load their own packages ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a469d63c3d9fa62c2305202' id='5a469d63c3d9fa62c2305202'>
<a href='#5a469d63c3d9fa62c2305202'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e3b3bee4f6f7f6c70000e3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/17e8ead3cc488b55278a7864897a0e22?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e3b3bee4f6f7f6c70000e3'>qi chen</a>
</div>
<a UTCms='1514577251000' class='quanto-date posted-at response-posted-at' href='#5a469d63c3d9fa62c2305202'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas,</p>

<p>Thanks for the nice post. I see Sheng Wang&#39;s name in the notebook and I roughly get where you got your original 30-40-30 split for 1/-1 label from:-) I have also read his original reports and I have also tried to duplicate his results w/o that kind of success using my local data. </p>

<p>I do have some general questions especially about the data part.<br>
1. In your notebook you got QS1500 stocks and calculate the returns for the past 5 days and shift the returns to make it aligned as future returns. This step could introduce some bias. Basically, when you are constructing the Xs and Ys at time t you are using stocks guaranteed to have a close price at time t+5 and being in QS1500 at time t+5. This seemingly small look-ahead bias might bring huge performance difference when I was testing Sheng&#39;s original monthly schemes.<br>
2. Don&#39;t you think a window length of 1 year is too small? At least we should include some minor pullback (10%) of the SPY to make the ML able to learn about the relative performance of stocks around the turning point so the underlying model may not be totally dominated by momentum type of behavior for instance.</p>

<p>Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a4cc335a3ad2b47428431fa' id='5a4cc335a3ad2b47428431fa'>
<a href='#5a4cc335a3ad2b47428431fa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1514980149000' class='quanto-date posted-at response-posted-at' href='#5a4cc335a3ad2b47428431fa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@qi chen: Yes, we&#39;ve been greatly inspired by the Sheng Wang paper. Good catch :)</p>

<ol>
<li>Good point. We should probably add those back in that didn&#39;t have prices at t+5.<br></li>
<li>Potentially. It&#39;s been difficult to make it scale but now it seems like the platform is fast enough. The current bottleneck is the actual training of the classifier, but with a linear SGD we could probably run longer windows. How do you mean &quot;include some minor pullback of the SPY&quot;?<br></li>
</ol>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a5388fd9b454d0012deabf5' id='5a5388fd9b454d0012deabf5'>
<a href='#5a5388fd9b454d0012deabf5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e3b3bee4f6f7f6c70000e3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/17e8ead3cc488b55278a7864897a0e22?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e3b3bee4f6f7f6c70000e3'>qi chen</a>
</div>
<a UTCms='1515423997000' class='quanto-date posted-at response-posted-at' href='#5a5388fd9b454d0012deabf5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas Wiecki</p>

<p>I meant instead of using a 1-2 year window which may not see any SPY corrections we should use a longer window (~5 year) to include the market correction to make sure the training sample has experienced both cycles. Otherwise if the ML algo is smart enough using only the past year data it may just give you a buy the dip model.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a53aaf64760681043d2ccd8' id='5a53aaf64760681043d2ccd8'>
<a href='#5a53aaf64760681043d2ccd8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1515432694000' class='quanto-date posted-at response-posted-at' href='#5a53aaf64760681043d2ccd8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Qi, </p>

<p>I agree with you, most ML algos use long training periods to capture price dynamics meaningfully, unfortunately under Q framework, they have a time limitation on computational resources ( I think it is 5 minutes if I&#39;m not mistaken).  So any attempt in ML within this given time limitation is in my opinion, an exercise in futility.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a53ae750efb867064e9a4d1' id='5a53ae750efb867064e9a4d1'>
<a href='#5a53ae750efb867064e9a4d1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1515433589000' class='quanto-date posted-at response-posted-at' href='#5a53ae750efb867064e9a4d1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@qi chen, @James Villa</p>

<p>I believe that the training period length is related to how far in the future the ML is predicting the assets performance. If you are using ML to predict tomorrow prices you won&#39;t probably need 5 years of data, but if you like to predict next month price it is likely you need a long training period. We face a trade-off with ML:  on one side we want a long training period to avoid overfitting, but at the same time we want a short training period so that ML can predict the price for the current market regime. As we keep updating the ML model in a rolling basis we can take advantage of that and focus on transient market features that would be not recognized using a long training period.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a53b6c22ad3730018bfd328' id='5a53b6c22ad3730018bfd328'>
<a href='#5a53b6c22ad3730018bfd328'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1515435714000' class='quanto-date posted-at response-posted-at' href='#5a53b6c22ad3730018bfd328'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Luca,</p>

<blockquote>
<p>As we keep updating the ML model in a rolling basis we can take advantage of that and focus on transient market features that would be not recognized using a long training period.</p>
</blockquote>

<p>Sorry to disagree with your above statement . On the contrary, these transient market features specially black swan events like the 2008 mortgage crisis and subsequent recession, will be recognized  and possibly give you ample warning, if 2008 data was included in training and ML model trained well. Under your scenario, say, you just trained the ML algo during the last two years which is an upward bullish market, if a sudden black swan event occurred, your algo will not be able to react because it has not seen or trained for such an event, you will be wiped out!  How can your model give you meaningful prediction on data or event it has never seen before, makes sense?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a53b8f92ad373001bbfd2a1' id='5a53b8f92ad373001bbfd2a1'>
<a href='#5a53b8f92ad373001bbfd2a1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1515436281000' class='quanto-date posted-at response-posted-at' href='#5a53b8f92ad373001bbfd2a1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James Villa</p>

<p>I understand you point and it might be correct but it depends on what you are trying to predict,  how far in the future and what features you are using. As I said earlier we have a trade-off here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5afd3954c5d2fe00438ec67d' id='5afd3954c5d2fe00438ec67d'>
<a href='#5afd3954c5d2fe00438ec67d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a985c0f6459381ff1d93374'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/515707e6390c0b71718208578eddd9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a985c0f6459381ff1d93374'>ASHISH SHARMA</a>
</div>
<a UTCms='1526544724000' class='quanto-date posted-at response-posted-at' href='#5afd3954c5d2fe00438ec67d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Sorry for ask you people stupid question, but I was wondering.whether any one of you wizard has tried it in real markets and gained something ?  I ask this from retail solo investor/trader point of view.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5bd99473716514003bc55357' id='5bd99473716514003bc55357'>
<a href='#5bd99473716514003bc55357'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58880efc8409b5000a2ceb74'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12ba22a00be0c4a1e197d0120358dd61?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58880efc8409b5000a2ceb74'>Zak Raicik</a>
</div>
<a UTCms='1540985971000' class='quanto-date posted-at response-posted-at' href='#5bd99473716514003bc55357'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Is predicting 5 day returns appropriate here? Fundamental data is updated very infrequently, so should we be testing it&#39;s ability to predict longer term returns?</p>

<p>Also- can someone provide the link to the Sheng Wang paper?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5bd999bc70a7ff003b4a7fcc' id='5bd999bc70a7ff003b4a7fcc'>
<a href='#5bd999bc70a7ff003b4a7fcc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1540987324000' class='quanto-date posted-at response-posted-at' href='#5bd999bc70a7ff003b4a7fcc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Zak: A valid point, it would treat the algo more as a template so definitely experiment around with longer time-horizons.</p>

<p>Unfortunately the Sheng Wang paper is not public.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5c7fe513d1c0cf70d33995b1' id='5c7fe513d1c0cf70d33995b1'>
<a href='#5c7fe513d1c0cf70d33995b1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5c7fe1e3d1c0cf1b7339932a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b8c674dbdcf34680b718484e40c8e5ca?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5c7fe1e3d1c0cf1b7339932a'>antony evmorfopoulos</a>
</div>
<a UTCms='1551885587000' class='quanto-date posted-at response-posted-at' href='#5c7fe513d1c0cf70d33995b1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Very useful guide on getting started making your own projects and strategies.Helped a lot on clarifying some stuff using this library  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ec273cf563b6e003d9cf055' id='5ec273cf563b6e003d9cf055'>
<a href='#5ec273cf563b6e003d9cf055'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5ec2732ef880bf003f5aac8e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/55d0e09780d46ad9effd638544e7e45a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5ec2732ef880bf003f5aac8e'>sanjay baghela</a>
</div>
<a UTCms='1589801935000' class='quanto-date posted-at response-posted-at' href='#5ec273cf563b6e003d9cf055'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I believe that the training period length is related to how far in the future the ML is predicting the assets performance. If you are using ML to predict tomorrow prices you won&#39;t probably need 5 years of data, but if you like to predict next month price it is likely you need a long training period. We face a trade-off with ML: on one side we want a long training period to avoid overfitting, but at the same time we want a short training period so that ML can predict the price for the current market regime.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f192c3bfd7ebf001049e325' id='5f192c3bfd7ebf001049e325'>
<a href='#5f192c3bfd7ebf001049e325'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5e54e3000bc58600491f6b55'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/650288982a65f50c5e0f094017569f52?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5e54e3000bc58600491f6b55'>CF Chan</a>
</div>
<a UTCms='1595485243000' class='quanto-date posted-at response-posted-at' href='#5f192c3bfd7ebf001049e325'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi, I was studying the codes:</p>

<pre><code># Massage data to be in the form expected by shift_mask_data()  
results_wo_returns = results.copy()  
returns = results_wo_returns.pop(&#39;Returns&#39;)  
Y = returns.unstack().values  
X = results_wo_returns.to_panel()  
X = X.swapaxes(2, 0).swapaxes(0, 1).values # (factors, time, stocks) -&gt; (time, stocks, factors)  
</code></pre>

<p>and  then</p>

<pre><code>X_train_shift, Y_train_shift = shift_mask_data(X_train, Y_train, n_fwd_days=n_fwd_days)  
X_test_shift, Y_test_shift = shift_mask_data(X_test, Y_test, n_fwd_days=n_fwd_days,  
                                             lower_percentile=50,  
                                             upper_percentile=50)  
</code></pre>

<p>When I check the <strong>shape</strong> of <strong>X_train_shift</strong> and <strong>Y_train_shift</strong> before passing into <strong>shift_mask_data</strong>, I notice differences in the second axis which I think is the number of stocks.  (time, stock, factor) is expected for X_train_shift and (time, stock) for Y_train_shift.  Will this cause masking issues in the function <strong>shift_mask_data</strong> and hence not labelling the Y_train_shift to X_train_shift properly?  </p>

<p>Am I missing something here?  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/machine-learning-on-quantopian-part-1-basics'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/machine-learning-on-quantopian-part-1-basics'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#9afcfffffef8fbf9f1daebeffbf4eef5eaf3fbf4b4f9f5f7">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
