<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Machine Learning on Quantopian Part 3: Building an Algorithm
</title>
<meta content='This is the third part of our series on Machine Learning on Quantopian. Most of the code is borrowed from  Part 1 , which showed how to train a model on static data, and  Part 2 , which showed how to train a model in an online fashion. Both of these were in research so they weren&#39;t functional algorithms. I highly recommend reading those before as it will make the code here much clearer. It was pleasantly easy to copy over the code from research to make a functional algorithm. The new ...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="NcaCiF0GAPbsT6YAf9xNgM5oLXb7i48ox3EueGYqHMtJoPTF//DSFVVS/zEwM+X09uYOH4FHmjNFfvUSzG9+cA==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=true;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm' property='og:url'>
<meta content='Machine Learning on Quantopian Part 3: Building an Algorithm' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Machine Learning on Quantopian Part 3: Building an Algorithm' property='og:title'>
<meta content='This is the third part of our series on Machine Learning on Quantopian. Most of the code is borrowed from  Part 1 , which showed how to train a model on static data, and  Part 2 , which showed how to train a model in an online fashion. Both of these were in research so they weren&#39;t functional algorithms. I highly recommend reading those before as it will make the code here much clearer. It was pleasantly easy to copy over the code from research to make a functional algorithm. The new ...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/machine-learning-on-quantopian-part-3-building-an-algorithm">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='584b04061bf08800120004c9'>
<div class='post-container' data-post-id='584b04061bf08800120004c9' id='584b04061bf08800120004c9'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Machine Learning on Quantopian Part 3: Building an Algorithm</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<span class='posted-at'>edited </span>
<span UTCms='1536926041000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Machine Learning on Quantopian Part 3: Building an Algorithm&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fmachine-learning-on-quantopian-part-3-building-an-algorithm%3Futm_source%3Dwebsite_share%26utm_campaign%3Dmachine-learning-on-quantopian-part-3-backtesting%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fmachine-learning-on-quantopian-part-3-building-an-algorithm%3Futm_source%3Dwebsite_share%26utm_campaign%3Dmachine-learning-on-quantopian-part-3-backtesting%26utm_medium%3Dlinkedin&amp;title=Machine+Learning+on+Quantopian+Part+3%3A+Building+an+Algorithm+%28Thomas+Wiecki%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Machine Learning' data-tag-id='55c50e7d8d4710ec6e00000b' href='/posts/tag/Machine-Learning/newest'>Machine Learning</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Market Neutral' data-tag-id='55d33f6e3f6ba10061000002' href='/posts/tag/Market-Neutral/newest'>Market Neutral</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Pipeline' data-tag-id='561525bcf252a59171000001' href='/posts/tag/Pipeline/newest'>Pipeline</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm?utm_source=website_share&amp;utm_campaign=machine-learning-on-quantopian-part-3-backtesting&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Thomas Wiecki" />
<div class='body-text'>
<div class='body-text-container post-body'><p>This is the third part of our series on Machine Learning on Quantopian. Most of the code is borrowed from <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian">Part 1</a>, which showed how to train a model on static data, and <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-2-ml-as-a-factor">Part 2</a>, which showed how to train a model in an online fashion. Both of these were in research so they weren&#39;t functional algorithms. I highly recommend reading those before as it will make the code here much clearer.</p>

<p>It was pleasantly easy to copy over the code from research to make a functional algorithm. The new <a href="https://www.quantopian.com/posts/optimize-api-now-available-in-algorithms">Optimization API</a> made the portfolio construction and trade execution part very simple. Thus, with a few lines of code we have an algorithm with the following desirable properties:</p>

<ul>
<li>Uses Machine Learning on a Factor-based workflow.<br></li>
<li>Retrains the model periodically.<br></li>
<li>Trades a large universe of stocks, using the <a href="https://www.quantopian.com/posts/the-q500us-and-q1500us">Q1500US universe</a> (chose a subset of 1000 stocks here).<br></li>
<li>Beta-neutral by going long-short.<br></li>
<li>Sector-neutral due to new optimization API.<br></li>
<li>Sets strict limits on maximum weight of any individual stock.</li>
</ul>

<p>I also tried to make this algorithm to be template-like. If you clone it, you should be able to very easily put in your own alpha factors and they will be automatically picked up and incorporated. You can also configure this algorithm with a few prominent high-level settings:</p>

<pre><code>N_STOCKS_TO_TRADE = 1000 # Will be split 50% long and 50% short  
ML_TRAINING_WINDOW = 250 # Number of days to train the classifier on, easy to run out of memory here  
PRED_N_FWD_DAYS = 1 # train on returns over N days into the future  
TRADE_FREQ = date_rules.week_start() # How often to trade, for daily, set to date_rules.every_day()  
</code></pre>

<p>However, this is definitely not the be-all-end-all algorithm. There are still many missing pieces and some rough edges:</p>

<ul>
<li>Ideally, we could train on a longer window, like 6 months. But it&#39;s very easy to run out-of-memory here. We are acutely aware of this problem and are working hard to resolve it. Until then, we have to make due with being limited in this regard.<br></li>
<li>As you can see, performance is not great. I actually think this is quite honest. The alpha factors I included are all widely known and can probably not be expected to carry a significant amount of alpha. No ML fanciness will convert a non-predictable signal into a predictable one. I also noticed that it is very hard to get good performance out of this. That, however, is a good thing in my perspective. It means that because we are making so many bets, it is very difficult to overfit this strategy by making a few lucrative bets that pay off big-time but can&#39;t be expected to re-occur out-of-sample.<br></li>
<li>I deactivated all trading costs to focus on the pure performance. Obviously this would need to be taken into account to create a viable strategy.</li>
</ul>

<p>As I said, there is still some work required and we will keep pushing the boundaries. Until then, please check this out, improve it, and poke holes in it.  </p>
</div>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>212 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='584b0572310ac10012000472' id='584b0572310ac10012000472'>
<a href='#584b0572310ac10012000472'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481311612000' class='quanto-date posted-at response-posted-at' href='#584b0572310ac10012000472'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is the tear-sheet.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='584b8d216417d40015000235' id='584b8d216417d40015000235'>
<a href='#584b8d216417d40015000235'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/545efaf518a7c68d75006f6e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/40f6d1feb3dff9adb73b245c46e0ba04?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/545efaf518a7c68d75006f6e'>Rudiger Lippert</a>
</div>
<a UTCms='1481346346000' class='quanto-date posted-at response-posted-at' href='#584b8d216417d40015000235'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is great news! I&#39;m excited to take a look at your code and give it a try.</p>

<p>Bummer about the memory restrictions though. That&#39;s a very limited amount of training data and I&#39;m skeptical that we will be able to train a good model with so little data.</p>

<p>Out of curiosity, what were the changes you required of the infrastructure code for algorithms in order to be able to finally publish this?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584bddd79d0ca100120001cc' id='584bddd79d0ca100120001cc'>
<a href='#584bddd79d0ca100120001cc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481367009000' class='quanto-date posted-at response-posted-at' href='#584bddd79d0ca100120001cc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Rudiger: Yes, reducing memory constraints is definitely a top concern for us right now. There&#39;s also lots of optimizations we can do for fundamentals.</p>

<p>Scott Sanderson  ultimately unlocked the workflow in its current form. Mainly there were some pipeline improvements. I&#39;ll let him chime in but I think the main one was that pipeline was caching data of all pipline nodes, even those that were no longer needed: <a href="https://github.com/quantopian/zipline/pull/1484">https://github.com/quantopian/zipline/pull/1484</a>  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='584bfbc8b9e3594a2d000256' id='584bfbc8b9e3594a2d000256'>
<a href='#584bfbc8b9e3594a2d000256'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1481374669000' class='quanto-date posted-at response-posted-at' href='#584bfbc8b9e3594a2d000256'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas -</p>

<p>You describe the 
<code>predictions</code> as &quot;probabilities ranging from 0 to 1.&quot;  Is that before or after you perform this operation:</p>

<pre><code>predictions -= 0.5  
</code></pre>

<p>Presumably, you are shifting the mean to be centered around 0, so that <code>predictions</code> ranges from -0.5 to 0.5 as an input to <code>objective = opt.MaximizeAlpha(predictions)</code> (which requires a signed input, even though it has a <code>market_neutral</code> constraint)?</p>

<p>Are the <code>predictions</code> the relative forecast returns, by stock in the universe?  The stock with the highest prediction value is the surest bet for a long allocation, and the stock with the lowest prediction value is the surest bet for a short allocation?</p>

<p>You are generating the alpha factors and apply the ML (alpha combination) using <code>Q1500US()</code>, which, as I understand, has sector diversification (see the help page, &quot;...choosing no more than 30% of the assets from any single market sector&quot;).  But then, within the optimizer, a constraint is applied:</p>

<pre><code>sector_neutral = opt.NetPartitionExposure.with_equal_bounds(  
            labels=context.risk_factors.Sector.dropna(),  
            min=-0.0001,  
            max=0.0001,  
    )  
</code></pre>

<p>I&#39;m wondering if this is the right way to approach things?  Wouldn&#39;t you want to start with a sector-diverse universe and let things play out?  It seems like with the <code>sector_neutral</code> constraint, you are a priori taking it as beneficial to have sector neutrality over a potentially higher SR without the constraint.  I guess the idea is that you can reduce &quot;sector risk&quot; but it seems like you&#39;ll end up undoing any advantageous sector tilt that might result from the prior steps.  Or maybe in the world of long-short investing, it is well-established that sector tilt should be avoided?</p>

<p>As a structural consideration, I&#39;d look at moving the optimization step into <code>before_trading_start</code>.  All of your alpha factors are based on trailing daily bars, so intraday, you are only using the current portfolio state information in the optimizer.  I guess the idea is that you&#39;ll do a better job of optimizing if the portfolio state is fresh (overnight gaps/drift could be significant).  Or maybe run the alpha combination step intraday on daily bars plus the current minutely bars (or a daily VWAP up to the current minutely time)?  Given the time scale of the algo, it might be just as well and tidier to do everything in <code>before_trading_start</code> and then before the market opens, hand off the new portfolio weights to the O/EMS system that you are presumably developing.  It just seems kinda muddled structurally to run the alpha combination before the market open on trailing daily bars, and then to do the optimization intraday.  Also, how are your approaching combining individual algos into the fund?  I&#39;d think each one would be a kind of alpha factor, right?  So if you&#39;ll be combining them on a daily basis, you&#39;ll need all of them to report in before the market opens, right?  You have <code>schedule_function(my_rebalance, TRADE_FREQ, time_rules.market_open(minutes=10))</code>, but there is nothing to prevent users from fiddling with the execution time, and then you&#39;ll have all of the algos spitting out portfolio updates willy-nilly which would not seem to be the best scenario for combining the algos and your O/EMS system.</p>

<p>As a side note, you posted an example algo that requires a paid subscription to a data set over the period of the backtest (see <a href="https://www.quantopian.com/data/zacks/earnings_surprises">https://www.quantopian.com/data/zacks/earnings_surprises</a> ).  It mucks up the paradigm of anyone being able to clone your algo, fiddle with it, and then posting a 1:1 comparison.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584c009013c64c176400059e' id='584c009013c64c176400059e'>
<a href='#584c009013c64c176400059e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481375897000' class='quanto-date posted-at response-posted-at' href='#584c009013c64c176400059e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Grant,</p>

<blockquote>
<p>Presumably, you are shifting the mean to be centered around 0, so that predictions ranges from -0.5 to 0.5 as an input to objective = opt.MaximizeAlpha(predictions) (which requires a signed input, even though it has a market_neutral constraint)?</p>
</blockquote>

<p>Exactly. Probabilities of &lt; 0.5 indicate the stock dropping and will be converted to a short-signal after subtracting 0.5.</p>

<p>Re Sectors: Yes, this is the same logic as being market-neutral. The optimization will long/short equally within each sector to achieve sector-neutrality. The logic is the same, we do not try to predict market or sector movements here, so it&#39;s a good idea to remove that source of risk. If you had a model that accurately predicted how sectors move you might of course want to introduce some sector-tilt.</p>

<p>Re moving portfolio construction into <code>before_trading_start</code>: Not a bad idea, we could definitely do that. Although not sure there would be a lot of upside, the function right now does portfolio construction and execution simultaneously which is convenient. But yeah, as we make portfolio construction more complex that could make sense.</p>

<p>Extracting alpha factors is still ongoing research. Having the portfolio construction happen in <code>before_trading_start</code> might help with that. But one could also imagine us wanting to do our construction based on pure alphas in that approach.</p>

<p>Re earnings surprises: Thanks for alerting me to that, I wasn&#39;t aware. I&#39;ll update the algo to comment it out.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='584c0845b9e3590015000649' id='584c0845b9e3590015000649'>
<a href='#584c0845b9e3590015000649'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1481377871000' class='quanto-date posted-at response-posted-at' href='#584c0845b9e3590015000649'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas -</p>

<p>Personally, my biggest gap is with respect to the basics of ML.  If there is a concise primer on the exact flavor you are using, it would be helpful (without having to read Python code line-by-line, which in the end is good, but doesn&#39;t give the big picture).  Maybe I can get an article onto my Kindle and eventually educate myself on your modern computational voodoo.</p>

<p>By the way, as I mentioned to Scot, it&#39;d be nice to run the optimizer on an expanding trailing window, and then combine the results, for smoothing.  I think this would amount to running the alpha combination step N times per day, storing the predictions, running the optimizer on each prediction, and then combining the results in some fashion (e.g. a weighted average, weighted by expected return).  Effectively, I think this means in 
<code>before_trading_start</code>, you&#39;d have to be able to call the &quot;alpha combiner&quot; with a parameter specifying the trailing window size.  Is this feasible?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584d457ef170800012000127' id='584d457ef170800012000127'>
<a href='#584d457ef170800012000127'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1481459078000' class='quanto-date posted-at response-posted-at' href='#584d457ef170800012000127'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Your comment makes intuitive sense:</p>

<blockquote>
<p>As you can see, performance is not great. I actually think this is quite honest. The alpha factors I included are all widely known and can probably not be expected to carry a significant amount of alpha. No ML fanciness will convert a non-predictable signal into a predictable one. I also noticed that it is very hard to get good performance out of this. That, however, is a good thing in my perspective. It means that because we are making so many bets, it is very difficult to overfit this strategy by making a few lucrative bets that pay off big-time but can&#39;t be expected to re-occur out-of-sample.</p>
</blockquote>

<p>The issue I see is that with the set of factors and real-world data you used above, you can kinda debug the prototype tool, answering questions like:</p>

<ul>
<li>How many factors can it handle?<br></li>
<li>Will it produce sensible, stable results, or go wildly off the rails?<br></li>
<li>Can a useful template be provided to the end-user, with a set of known real-world factors?</li>
</ul>

<p>The problem, though, is that I think it is gonna be hard to tell if the tool is working properly, since there is a convolution of the noisy, uncertain inputs, and the unproven tool.  You are basically saying &quot;garbage in, garbage out&quot; is to be expected.  But the tool may be contributing to the &quot;garbage out&quot; and it seems like it&#39;ll be hard to sort its contribution, if any, to the &quot;garbage out.&quot;</p>

<p>Say I wanted to show that my new, fancy method for fitting a straight line works.  I guess I&#39;d synthesize a data set with known characteristics (e.g. y = mx + b, with noise), and then apply my new-fangled algorithm to it.  Could something analogous be done here?  It would be nice to see that if a high SR output is expected (e.g. (1+r)^n type returns), one actually gets it.</p>

<blockquote>
<p>Extracting alpha factors is still ongoing research. Having the portfolio construction happen in before_trading_start might help with that. But one could also imagine us wanting to do our construction based on pure alphas in that approach.</p>
</blockquote>

<p>Well, it seems like a no-brainer.  I think the idea is for users to research and develop long-short alpha factors, and implement them in pipeline, using daily bars.  My sense is that most of the value-add will be at this step (although presently, the only way to get paid for the effort is to write a full-up algo).  Y&#39;all could grab the alpha factors from each user, and take it from there, doing a global combination and optimization (on a high-performance computing platform, so you don&#39;t have to fuss with memory limitations, etc.).  Of course, the over-arching question is, with this sort of a relatively long timescale system and equities, what sort of SR is achievable?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584e67f9ed92bf0016000f78' id='584e67f9ed92bf0016000f78'>
<a href='#584e67f9ed92bf0016000f78'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/580d82d24e82e056aa00026c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/54ea9828452c6f4ae1187ecc8e6a1889?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/580d82d24e82e056aa00026c'>Lex</a>
</div>
<a UTCms='1481533448000' class='quanto-date posted-at response-posted-at' href='#584e67f9ed92bf0016000f78'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for this incredible work Thomas ! I have eagerly begun playing around with it.</p>

<p>Do you know if its possible to plot the weights assigned to each factor during each period as the algo runs?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584e6c89f17080598b0001bc' id='584e6c89f17080598b0001bc'>
<a href='#584e6c89f17080598b0001bc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481534612000' class='quanto-date posted-at response-posted-at' href='#584e6c89f17080598b0001bc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant: Good point regarding garbage in garbage out. Ideally we&#39;d have some simulated data to demonstrate it works. I think this should be pretty straight-forward to do in research.</p>

<p>Lex: Yes, the commented out line 286 (<code>log.debug(self.clf.feature_importances_)</code>) prints it out, albeit without the name of the factors associated to the importance. Perhaps you can store them in a global var, combine them with the factor-names and then plot them. That would be a great contribution.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='584e8376a487e10017000876' id='584e8376a487e10017000876'>
<a href='#584e8376a487e10017000876'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1481540482000' class='quanto-date posted-at response-posted-at' href='#584e8376a487e10017000876'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Aside from synthetic data &amp; factors that would be expected to yield consistent, high SR, you&#39;d also want to feed it noise to show that it doesn&#39;t extract a spurious signal from the noise (i.e. &quot;make a silk purse out of a sow&#39;s ear,&quot; or &quot;overfit&quot; per the standard lingo).</p>

<p>One point of confusion here is with respect to <a href="https://www.quantopian.com/posts/the-101-alphas-project">The 101 Alphas Project</a> which seems to suggest that if approached correctly, lots of sketchy, mini-alpha factors can be combined into a mega-alpha that will be viable.  Is there any overlap between what you&#39;ve done, and what is claimed in the <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2701346">paper</a> (that many &quot;faint and ephemeral&quot; alphas can be combined advantageously)?  Maybe with the right set of 101 alphas, your algo would be a winner?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584e844485d8bf0012000062' id='584e844485d8bf0012000062'>
<a href='#584e844485d8bf0012000062'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481540687000' class='quanto-date posted-at response-posted-at' href='#584e844485d8bf0012000062'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, the 101 Alphas Project would be a fantastic place to start for adding new alphas. This post is really about Alpha Combination, not Alpha Discovery.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='584e8ff2d7c15d0012000147' id='584e8ff2d7c15d0012000147'>
<a href='#584e8ff2d7c15d0012000147'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1481543674000' class='quanto-date posted-at response-posted-at' href='#584e8ff2d7c15d0012000147'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Lex -</p>

<p>Regarding &quot;Do you know if its possible to plot the weights assigned to each factor during each period as the algo runs?&quot; you can only plot 5 variables.  However, a tedious hack would be to run the backtest N times, recording a different set of variables each time.  Within the research platform, the recorded variables are accessible.  For example, try (with your own 
<code>backtest_id</code>):</p>

<pre><code>bt = get_backtest(&#39;584bf25a0ca16a64879c92f1&#39;)  
dir(bt)  
print bt.bt.recorded_vars  
</code></pre>

<p>Once you get all of the factor weights versus time into the research platform, you could then plot them together.</p>

<p>One tweak to the Quantopian backtester would be to allow recording of a larger number of variables, but perhaps still only allow plotting 5 per backtest.  Then, in one backtest, all variables of interest could be loaded into the backtester in one shot.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584e95f6a487e10012000965' id='584e95f6a487e10012000965'>
<a href='#584e95f6a487e10012000965'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/580d82d24e82e056aa00026c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/54ea9828452c6f4ae1187ecc8e6a1889?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/580d82d24e82e056aa00026c'>Lex</a>
</div>
<a UTCms='1481545224000' class='quanto-date posted-at response-posted-at' href='#584e95f6a487e10012000965'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I cant help but feel somethings not quite right here. I ran a single factor (fcfy) with only 2 constraints (market neutral &amp; gross leverage), set it to monthly rebalancing &amp; 20-period prediction &amp; 20 percentile ranges. I was expecting to get rather similar results as my monthly long/short factor rebalancing model for the same factor but it is rather very different. If the leverage still hovers around 0. Why would the results deviate so much if it is only being passed one factor?</p>

<p>Also without significantly removing constraints do I find it difficult to  achieve non-flat line results. Am I missing something here?</p>

<pre><code>N_STOCKS_TO_TRADE = 200 # Will be split 50% long and 50% short  
ML_TRAINING_WINDOW = 60 # Number of days to train the classifier on, easy to run out of memory here  
PRED_N_FWD_DAYS = 20 # train on returns over N days into the future  
TRADE_FREQ = date_rules.month_start() # How often to trade, for daily, set to date_rules.every_day()  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584e97261fa10a0015000176' id='584e97261fa10a0015000176'>
<a href='#584e97261fa10a0015000176'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481545522000' class='quanto-date posted-at response-posted-at' href='#584e97261fa10a0015000176'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Lex, there&#39;s not a lot go on here. In general, the ML combines factors in non-linear way, so it could end up completely different from the weighting you do. Perhaps remove that part or replace it with something linear like <a href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html">LinearSVC</a>?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='584f01b7d7c15d38610000ca' id='584f01b7d7c15d38610000ca'>
<a href='#584f01b7d7c15d38610000ca'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56a8196e384d0519150000cf'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fc260316ff51383a8eb95a56353cf504?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56a8196e384d0519150000cf'>kamran sokhanvari</a>
</div>
<a UTCms='1481572803000' class='quanto-date posted-at response-posted-at' href='#584f01b7d7c15d38610000ca'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The memory limitation on the Q platform is quite serious when it comes to really delving into machine learning techniques. The size of a data cube with quite a few factors  one needs to extract generalizations and keep predication forward variance down does not fit into the current memory requirements. Additionally lack of being able to serialize variables and models using the pickle library makes offline training impossible too. </p>

<p>I hope the Q team can see that in order to support the ML field beyond conceptual token examples the platform needs to significantly  improve in functionality and performance  !  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='584fd819b3dc394a6d0000b7' id='584fd819b3dc394a6d0000b7'>
<a href='#584fd819b3dc394a6d0000b7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1481627684000' class='quanto-date posted-at response-posted-at' href='#584fd819b3dc394a6d0000b7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I&#39;m wondering how to handle &quot;magic numbers&quot; in factors, particularly with respect to time scales.  For example, say I defined a simple price mean reversion factor as:</p>

<pre><code>np.mean(prices[-n:,:],axis=0)/price[-1,:]  
</code></pre>

<p>At any point in time, there may be a sweet spot for <code>n</code> (and presumably, using alphalens, I could sort that out, and kinda ballpark an optimum).  However, I could also code a whole set of factors, each with a different trailing window length for the mean, and then let the ML combine them.  For example, I could write 8 separate factors, with:</p>

<pre><code>np.mean(prices[-3:,:],axis=0)/price[-1,:]

np.mean(prices[-4:,:],axis=0)/price[-1,:]

np.mean(prices[-5:,:],axis=0)/price[-1,:]

np.mean(prices[-6:,:],axis=0)/price[-1,:]

np.mean(prices[-7:,:],axis=0)/price[-1,:]

np.mean(prices[-8:,:],axis=0)/price[-1,:]

np.mean(prices[-9:,:],axis=0)/price[-1,:]

np.mean(prices[-10:,:],axis=0)/price[-1,:]  
</code></pre>

<p>This would seem to have the advantage that I&#39;ve eliminated (or at least smoothed) a magic number factor setting.  Also, perhaps the ML algorithm would then dynamically combine them versus time in an optimal way.  Or would it just create a mess?  If it would make sense, is there a more elegant way to code things, so that one does not have to write N identical factors, only differing by their settings (e.g. be able to call a single factor N times with different parameters)?</p>

<p>On a separate note, does pipeline support CVXPY?  Is it possible to write factors that include the application of CVXPY?</p>

<p>Regarding platform limitations, my two cents is that there is an odd unidirectional relationship between the research platform and the backtester.  It seems that they could be better integrated/unified, so that data could pass freely between them, and backtests could be called from the research platform.  It seems also that one should be able to output a set of data from the research platform, and it should be available to algos (both for backtesting and live trading).  Trying to do everything online in the algo is limiting, but I guess in the end, you need stand-alone contributions to the Q fund; you can&#39;t have &quot;managers&quot; fiddling with them offline.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585057e42c8f69001500083d' id='585057e42c8f69001500083d'>
<a href='#585057e42c8f69001500083d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1481660400000' class='quanto-date posted-at response-posted-at' href='#585057e42c8f69001500083d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas - Thanks for continuing the machine learning thread here with working code...that is really useful! What is on the horizon next for this thread?</p>

<p>@Kamran - yes..without something like a powerful compute/memory  nvidia-docker image or cluster to work with, you have no real way to compute massive regression-based  or deep machine learning algorithms.  Perhaps one could deploy already learned models with Q&#39;s infrastructure though?</p>

<p>Just finished reading a blog article that I found interesting:<br>
<a href="https://medium.com/@TalPerry/deep-learning-the-stock-market-df853d139e02">https://medium.com/@TalPerry/deep-learning-the-stock-market-df853d139e02</a></p>

<p>Besides the detail involving the different ways to learn sequential information (Recurrent Neural Network, LTSM, etc.), I found the overall targets the author delineates useful, so I quote from that section of the blog article by @TalPerry:</p>

<blockquote>
<p>In our case of predicting the market, we need to ask ourselves what exactly we want to market to predict? Some of the options that I thought about were:<br>
 1. Predict the next price for each of the 1000 stocks<br>
 2. Predict the value of some index (S&amp;P, VIX etc) in the next n minutes.<br>
 3. Predict which of the stocks will move up by more than x% in the next n minutes<br>
 4. (My personal favorite) Predict which stocks will go up/down by 2x% in the next n minutes while not going down/up by more than x% in that time.<br>
 5. (The one well follow for the remainder of this article). Predict when the VIX will go up/down by 2x% in the next n minutes while not going down/up by more than x% in that time.<br>
1 and 2 are regression problems, where we have to predict an actual number instead of the likelihood of a specific event (like the letter n appearing or the market going up). Those are fine but not what I want to do.<br>
3 and 4 are fairly similar, they both ask to predict an event (In technical jargona class label). An event could be the letter n appearing next or it could be Moved up 5% while not going down more than 3% in the last 10 minutes. The trade-off between 3 and 4 is that 3 is much more common and thus easier to learn about while 4 is more valuable as not only is it an indicator of profit but also has some constraint on risk.<br>
5 is the one well continue with for this article because its similar to 3 and 4 but has mechanics that are easier to follow. The VIX is sometimes called the Fear Index and it represents how volatile the stocks in the S&amp;P500 are. It is derived by observing the implied volatility for specific options on each of the stocks in the index.</p>
</blockquote>

<p>I like target number 4 also, yet wonder...<br>
What do others think of these targets ?<br>
alan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585176eb4a02df00150000ff' id='585176eb4a02df00150000ff'>
<a href='#585176eb4a02df00150000ff'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481733876000' class='quanto-date posted-at response-posted-at' href='#585176eb4a02df00150000ff'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Luca: Thanks so much -- those are two critical bugs. I&#39;ll update the original code too.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='585183ea8de3101bb40000b8' id='585183ea8de3101bb40000b8'>
<a href='#585183ea8de3101bb40000b8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/545efaf518a7c68d75006f6e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/40f6d1feb3dff9adb73b245c46e0ba04?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/545efaf518a7c68d75006f6e'>Rudiger Lippert</a>
</div>
<a UTCms='1481737202000' class='quanto-date posted-at response-posted-at' href='#585183ea8de3101bb40000b8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Not sure if you&#39;re doing this, because I haven&#39;t had time to look at your code carefully, but beware of lookahead bias. You should use a different timeperiod to run alphalens on your factors to the timeperiod where you test the efficacy of the &quot;simple&quot; model. By the same token, the ML model should be trained using data from the first timeperiod and tested using the second timeperiod.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585185f024834d1fac0000ce' id='585185f024834d1fac0000ce'>
<a href='#585185f024834d1fac0000ce'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1481737719000' class='quanto-date posted-at response-posted-at' href='#585185f024834d1fac0000ce'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Rudiger Lippert, thanks for your comment but that&#39;s not an issue. I applied the same approach Thomas used in his ML part 2.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5852c714224b205e3a0000e1' id='5852c714224b205e3a0000e1'>
<a href='#5852c714224b205e3a0000e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481819931000' class='quanto-date posted-at response-posted-at' href='#5852c714224b205e3a0000e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Luca: That&#39;s a very insightful analysis. It&#39;s clear that the ML does not come off very well here. Since the factors are already pretty good and linear, perhaps this isn&#39;t too surprising as the ML would just muddle with that. So two experiments would be to try a linear classifier and adding a nonsense-factor which hopefully the ML would identify and not listen to when making predictions. I have already tried experiment 1 by replacing the ML algo with logistic regression. However, it didn&#39;t do much to improve metrics like Annualized IR. As another suggestion, I would condense the outputs and only store metrics like spread, IC and IR. Then display a big comparison table at the end comparing all the individual experiments. The full tear-sheets are too difficult to compare directly.</p>

<p>I also took another stab at improving the code. Specifically, I&#39;m now tracking past predictions to evaluate the alpha model directly on held out data. Just looking at returns is too far detached from checking if the model actually works, as Luca and Grant highlighted. Thus, we can now track all kinds of metrics like accuracy, log-loss and spread. Surprisingly, these look pretty good on the held-out data (accuracy ~55%). This raises the question of why the algorithm isn&#39;t doing better than it is. Possibly because the spread is still pretty small, or because there are still bugs. In any case, I also simplified the portfolio allocation to try and get the trading of the algorithm closer to what is suggested by the alpha model.</p>

<p>Ultimately, we really need to develop tools and methods to evaluate each stage independently to track where things go wrong.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5852e166c3a9c7050f000087' id='5852e166c3a9c7050f000087'>
<a href='#5852e166c3a9c7050f000087'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/545efaf518a7c68d75006f6e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/40f6d1feb3dff9adb73b245c46e0ba04?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/545efaf518a7c68d75006f6e'>Rudiger Lippert</a>
</div>
<a UTCms='1481826673000' class='quanto-date posted-at response-posted-at' href='#5852e166c3a9c7050f000087'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;m not sure we&#39;re thinking about this problem correctly. It&#39;s not about whether &quot;ML&quot; works as means for alpha combination or not. Any technique that learns how to predict values from training data is technically ML, even if it is an extremely simple technique like linear regression.</p>

<p>I think it&#39;s more about the bias-variance tradeoff, which tells us that simpler models will do a better job at not fitting to random noise, but can be systematically biased if output function isn&#39;t itself simple (like trying to fit a polynomial with a line). The problem of fitting to noise is particularly exacerbated by having very little data. The more complex model (like Adaboost) tries to infer properties from limited examples and comes up with incorrect inferences (for example, if you never saw a dog and you were only given 5 pictures of dogs, where each of them contained a tree, you might infer that the tree is the dog. Only by adding many more examples, where trees aren&#39;t present, do you have a chance to learn a better rule for identifying a dog). I think the biggest problem with this new ML factor is that it&#39;s training on so little data. The model needs to see what happens when the market is in different conditions or it will assume that the last month is completely representative of how markets behave. Ernie Chan commented in one of his books that financial data is so noisy that even if you have a lot of data it makes sense to use very simple models or you&#39;re going to overfit. Steps like ranking features, ranking targets, changing the target into a classification problem, using a linear combination of ranks, are all steps to try to tame the noise beast.</p>

<p>I wrote a bit about these kinds of issues in my blog post for my former company, if you&#39;re interested: <a href="https://www.factual.com/blog/the-wisdom-of-crowds">https://www.factual.com/blog/the-wisdom-of-crowds</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5853aeab420fbe2341000197' id='5853aeab420fbe2341000197'>
<a href='#5853aeab420fbe2341000197'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481879220000' class='quanto-date posted-at response-posted-at' href='#5853aeab420fbe2341000197'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Rudiger: All great points. It&#39;s definitely worthwhile to start with linear classifiers and some robust factors. Note that we&#39;re already doing ranking features and changing the target into a classification problem. I think Luca&#39;s experiments actually are compatible with your thoughts. The simplest linear classifier is an equal-weighted one. If something that is learned is doing poorer, it means there&#39;s so much noise we can&#39;t even infer stable combinations.</p>

<p>Ideally I&#39;d like to test with &quot;fake&quot; factors that have great predictive power (like today&#39;s return, introducing look-ahead bias essentially). This would really show the benefit (can add non-linearities and noise on top), and be good for debugging and making sure everything works.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5853cca53657633966000094' id='5853cca53657633966000094'>
<a href='#5853cca53657633966000094'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1481886891000' class='quanto-date posted-at response-posted-at' href='#5853cca53657633966000094'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s Thomas&#39; recent revision (first post in thread, Backtest ID: 58517784ee8d8363d0d9790d), with:</p>

<pre><code>predictions -= 0.5 # predictions are probabilities ranging from 0 to 1  
predictions *= -1 # flip sign of predictions, to see if return improves  
</code></pre>

<p>Not sure what it tells us, but I recall that a SR of as low as 0.7 could qualify for the Q fund.  If it gets funded, I stake my claim to a share of the profits!</p>

<p>One interesting thing is that beta is on the high side.  Would there be a way to mix in a hedging instrument (SPY?) to knock it down?  I suspect that we may just be seeing the effect of a finite beta.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5853ce1784e0ff54de00008c' id='5853ce1784e0ff54de00008c'>
<a href='#5853ce1784e0ff54de00008c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1481887263000' class='quanto-date posted-at response-posted-at' href='#5853ce1784e0ff54de00008c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant: That&#39;s funny ;). For some reason the original algorithm has negative beta, not sure why yet. I suspect the returns here also due to the higher beta.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='58552096b880fd00150008f8' id='58552096b880fd00150008f8'>
<a href='#58552096b880fd00150008f8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1481973918000' class='quanto-date posted-at response-posted-at' href='#58552096b880fd00150008f8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas &amp; all,</p>

<p>Yesterday, I&#39;d posted some comments that were judged to be off the main topic here and deleted by a Quantopian moderator.  I moved them to:</p>

<p><a href="https://www.quantopian.com/posts/optimize-api-now-available-in-algorithms">https://www.quantopian.com/posts/optimize-api-now-available-in-algorithms</a><br>
<a href="https://www.quantopian.com/posts/side-comment-to-machine-learning-on-quantopian-part-3-building-an-algorithm">https://www.quantopian.com/posts/side-comment-to-machine-learning-on-quantopian-part-3-building-an-algorithm</a></p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5869c0d6f7d5f90012000526' id='5869c0d6f7d5f90012000526'>
<a href='#5869c0d6f7d5f90012000526'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55d1714517d6e5d12b000252'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/25058a7be55cf8d10ad03ba4b26dad0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55d1714517d6e5d12b000252'>Nicholas Butler</a>
</div>
<a UTCms='1483325667000' class='quanto-date posted-at response-posted-at' href='#5869c0d6f7d5f90012000526'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>A potential problem with this algorithm is the ML technique you are applying. AdaBoost is a meta-algorithm which requires a base learner as an argument (see the sklearn documentation on this). If you do not pass in a base learner it defaults to a decision stump, which may not be optimal (or even useful) for predicting returns.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='586a57fd01696066cd000142' id='586a57fd01696066cd000142'>
<a href='#586a57fd01696066cd000142'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/573af8c089bb64093f000893'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9bfa4d5fca3a14f516a215379b92bc55?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/573af8c089bb64093f000893'>Jun Chao Keung</a>
</div>
<a UTCms='1483364356000' class='quanto-date posted-at response-posted-at' href='#586a57fd01696066cd000142'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>how can we fix the memory problem please ? can we pay premium to expand our memory restriction ? or is it possible to train the learner offline ? whats the setup for parallel computing on this ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='586a60a23413d20012000cf8' id='586a60a23413d20012000cf8'>
<a href='#586a60a23413d20012000cf8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1483366568000' class='quanto-date posted-at response-posted-at' href='#586a60a23413d20012000cf8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Nicholas: Note that we&#39;re not predicting returns directly, but rather if returns go up or down (relative to the other in the universe). Certainly this is a choice but I think it&#39;s a good default to start with (although I now start with linear classifiers to remove complexity). Having said that, it&#39;s certainly something to experiment around with. What base learner do you think would be better suited?</p>

<p>@Jun: We hope to be able to just increase memory for everyone.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='587567147118eb54e4bfe276' id='587567147118eb54e4bfe276'>
<a href='#587567147118eb54e4bfe276'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/545efaf518a7c68d75006f6e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/40f6d1feb3dff9adb73b245c46e0ba04?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/545efaf518a7c68d75006f6e'>Rudiger Lippert</a>
</div>
<a UTCms='1484089108000' class='quanto-date posted-at response-posted-at' href='#587567147118eb54e4bfe276'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas,</p>

<p>I was thinking about how to make sure you account for 1)  securities that go broke and are removed from the entire stock universe and/or 2) securities that exit your particular screen. I&#39;m not 100% sure your shifting approach would account for them. I&#39;ve attached a Notebook with how I would approach getting accurate returns for a specific screen (Q1500US for my example).</p>

<p>Anyway, not sure it would be possible in the algorithm code but something to consider.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='587c30ff1cc2fd000aaa1c7a' id='587c30ff1cc2fd000aaa1c7a'>
<a href='#587c30ff1cc2fd000aaa1c7a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/528da7be3d75fbb0ca000043'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1022244d7c6d5f9e361a9e4b6c9c0d49?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/528da7be3d75fbb0ca000043'>David Quinn</a>
</div>
<a UTCms='1484534015000' class='quanto-date posted-at response-posted-at' href='#587c30ff1cc2fd000aaa1c7a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;ll get this posted in the next few days, work has been hectic -- I have been running an SVM on the S&amp;P 500 that is showing promise as well. I am thinking that an approach that equal weights holdings from SVM, NB and Ensemble might do well. Stay tight.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='587ce0e0914cef000d0d9148' id='587ce0e0914cef000d0d9148'>
<a href='#587ce0e0914cef000d0d9148'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55263f70660e382642000361'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b7386c2d21c82004675b4f92393c4eb5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55263f70660e382642000361'>Bharath Rao</a>
</div>
<a UTCms='1484579040000' class='quanto-date posted-at response-posted-at' href='#587ce0e0914cef000d0d9148'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>ML combines the factors in a non-linear way. Does that help get rid of the problem of correlated factors (used in linear regression based factor models) to some extent?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58809675eedd7a000a093e94' id='58809675eedd7a000a093e94'>
<a href='#58809675eedd7a000a093e94'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1484822133000' class='quanto-date posted-at response-posted-at' href='#58809675eedd7a000a093e94'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Luca: Great catch, did you debug the function in a NB?</p>

<p>Bharath: In the case of correlated features, Random Forests will pick one feature to make predictions and then give the other a very low weighting. This should be taken into account when looking at feature importances. See e.g. <a href="http://blog.datadive.net/selecting-good-features-part-iii-random-forests/">http://blog.datadive.net/selecting-good-features-part-iii-random-forests/</a>.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5880ae3a3858cd117c784154' id='5880ae3a3858cd117c784154'>
<a href='#5880ae3a3858cd117c784154'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1484828218000' class='quanto-date posted-at response-posted-at' href='#5880ae3a3858cd117c784154'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I still don&#39;t get any good results in the NB, even after this bug fix. Then I believe it was just luck that the backtest improved.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5880bfdf6218db064f2476c9' id='5880bfdf6218db064f2476c9'>
<a href='#5880bfdf6218db064f2476c9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55263f70660e382642000361'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b7386c2d21c82004675b4f92393c4eb5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55263f70660e382642000361'>Bharath Rao</a>
</div>
<a UTCms='1484832735000' class='quanto-date posted-at response-posted-at' href='#5880bfdf6218db064f2476c9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58af9c1b03c3d85c0b1eaf40' id='58af9c1b03c3d85c0b1eaf40'>
<a href='#58af9c1b03c3d85c0b1eaf40'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57adfff39c39de124a0003c4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/79ce2198c64d3fb629e456d791aedc8f?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57adfff39c39de124a0003c4'>Quoc Le</a>
</div>
<a UTCms='1487903771000' class='quanto-date posted-at response-posted-at' href='#58af9c1b03c3d85c0b1eaf40'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>We need Python pickle serialize/deserialize.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bad4acbef4b2000a56fa53' id='58bad4acbef4b2000a56fa53'>
<a href='#58bad4acbef4b2000a56fa53'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1488639148000' class='quanto-date posted-at response-posted-at' href='#58bad4acbef4b2000a56fa53'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas/Q team -</p>

<p>Above, it is stated regarding memory limitations &quot;We are acutely aware of this problem and are working hard to resolve it.&quot;</p>

<p>What is the status?  What approaches are being considered?  Timeline for implementation?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58baf37485e7906b92e688f0' id='58baf37485e7906b92e688f0'>
<a href='#58baf37485e7906b92e688f0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/584da0c18ab6f572050000c4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/48796fcbbbeb695ef822ea241b9c713c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/584da0c18ab6f572050000c4'>Andy Visser</a>
</div>
<a UTCms='1488647028000' class='quanto-date posted-at response-posted-at' href='#58baf37485e7906b92e688f0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;ve been playing with ML locally using zipline for some time now and I&#39;m not sure 6 months of Daily data is going to do much in the way of ML. I&#39;ve found considerably better results with 15-20k data points. This being said, we definitely need a way to take a model trained locally and then import it into quantopian. If this could be done on a daily basis (Train at home, upload, and have the Q script fetch it), the idea of using ML with Quantopian would make a lot more sense. Just my thoughts, maybe people have had better luck with smaller datasets?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bb2ad0a2394a000a344046' id='58bb2ad0a2394a000a344046'>
<a href='#58bb2ad0a2394a000a344046'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1488661200000' class='quanto-date posted-at response-posted-at' href='#58bb2ad0a2394a000a344046'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Visser  Agree with you on the model import importance for Q platform.  Might be hard for them to do for large user-base...don&#39;t know...<br>
We, also, haven&#39;t gotten good ML results with a small number of days over a small number of  factors...which actually feels right.<br>
It should take a large number of days over a large number of factors to eke out an alpha that is not easily detected by human inspection.</p>

<p>When you say &quot;15-20k data points&quot;, do you mean 1.5-2k time-points over 10 factors, or 15-20k time-points over one factor?<br>
Thanks!<br>
alan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bb2fbc493b30000d487665' id='58bb2fbc493b30000d487665'>
<a href='#58bb2fbc493b30000d487665'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58a11669207362000da345f7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e99bb18f7ce462e61906ff732d70c361?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58a11669207362000da345f7'>John Cook</a>
</div>
<a UTCms='1488662460000' class='quanto-date posted-at response-posted-at' href='#58bb2fbc493b30000d487665'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;ll second Andy&#39;s point - I know it&#39;s been asked for before. A method for taking a model trained locally and uploading it and using it with Quantopian data. The computation-heavy part of machine learning is the training of the model. If memory limitations are the problem, let us train the model outside the platform and import it in. </p>

<p>@Alan - the models I&#39;m playing with locally are trained using 750k lines across 25-30 factors, so between 18M and 22.5M data points, covering two years of data. More factors means more training data is needed to get a model that generalizes well, although I&#39;m probably using more than I need (I have another 500k lines or so I&#39;m using as a testing set). I agree that using a small number of factors over a short time is likely to yield poor results, or results that only apply to a specific situation. </p>

<p>Training those models can take hours (most take a few minutes though), but predictions are much quicker (usually seconds). Offloading the computation heavy part to a local machine and keeping the predictions, which are relatively easy, would be the least painful solution for everyone. </p>

<p>On the other hand, I&#39;m not a computer scientist, so I have no idea whats going on around the back end. :)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bb35a083547e4ff505db17' id='58bb35a083547e4ff505db17'>
<a href='#58bb35a083547e4ff505db17'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1488663968000' class='quanto-date posted-at response-posted-at' href='#58bb35a083547e4ff505db17'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think part of the problem may be how this would fit with the Q fund concept of being able to time-stamp algos once an initial backtest has been run, and then re-running the backtest in 6 months out-of-sample for evaluation.  Would the ML model be stale by then?  How often would uploads be required to keep it fresh?  And how would Q manage the uploads in evaluating the algos for the fund?   Q is all about the Q fund, so one has to consider everything in that context.</p>

<p>It seems like one solution might be to super-charge the research platform, and then work out the mechanics of launching an algo with the ability for the user to push data from the research platform to the algo (or perhaps call an automated script tied to the algo).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bb531983547e38b505d828' id='58bb531983547e38b505d828'>
<a href='#58bb531983547e38b505d828'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/584da0c18ab6f572050000c4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/48796fcbbbeb695ef822ea241b9c713c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/584da0c18ab6f572050000c4'>Andy Visser</a>
</div>
<a UTCms='1488671513000' class='quanto-date posted-at response-posted-at' href='#58bb531983547e38b505d828'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Alan 15-20k lines with 75 or so features each. Your idea of 750k to 1mil is probably where I should be though ;)</p>

<p><em>EDIT</em><br>
Sorry, I meant @John Cook  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bb5389a2394a000a34434d' id='58bb5389a2394a000a34434d'>
<a href='#58bb5389a2394a000a34434d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/584da0c18ab6f572050000c4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/48796fcbbbeb695ef822ea241b9c713c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/584da0c18ab6f572050000c4'>Andy Visser</a>
</div>
<a UTCms='1488671625000' class='quanto-date posted-at response-posted-at' href='#58bb5389a2394a000a34434d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, that&#39;s an idea. I&#39;d love to be able to do it all with Quantopian.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bccb1ee57c67000a3465c9' id='58bccb1ee57c67000a3465c9'>
<a href='#58bccb1ee57c67000a3465c9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1488767774000' class='quanto-date posted-at response-posted-at' href='#58bccb1ee57c67000a3465c9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@John - Thanks for the info...sounds great!<br>
Have you used multi-time-scale learning yet, with fusion...or is your time scale all in seconds ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c8e457eb10d21f8e694af7' id='58c8e457eb10d21f8e694af7'>
<a href='#58c8e457eb10d21f8e694af7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/527612eb2de84d52740000d5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/873c5860f8b916285b474f56cbd6f135?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/527612eb2de84d52740000d5'>Deleted User</a>
</div>
<a UTCms='1489560663000' class='quanto-date posted-at response-posted-at' href='#58c8e457eb10d21f8e694af7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi,</p>

<p>Rather than using ML to predict tomorrow&#39;s return, I want to predict today&#39;s return and see if prediction is greater than or less than actual return. Go long if prediction &gt; today&#39;s return and short if prediction &lt; today&#39;s return. Could someone help me do this if it is not too much to ask?</p>

<p>Best regards,<br>
Pravin  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c8efb493f5dd2d47b9be78' id='58c8efb493f5dd2d47b9be78'>
<a href='#58c8efb493f5dd2d47b9be78'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a9a4586b792a01d90001e4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c9e558372c8a4422060f277b3f73886?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a9a4586b792a01d90001e4'>arshpreet singh</a>
</div>
<a UTCms='1489563572000' class='quanto-date posted-at response-posted-at' href='#58c8efb493f5dd2d47b9be78'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Pravin Bezwada it seems easy. You need simple comparison function something like create an array of today&#39;s returns(Those you can just calculate by using %change function) and create an array of tomorrow&#39;s-perditions and shift by -1 so those will become today&#39;s returns. After that all you need to do is compare two arrays. :) On the other side you can do this operation using Pandas as well. Hope it will help.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c8f5ce626bf1000a97b6b5' id='58c8f5ce626bf1000a97b6b5'>
<a href='#58c8f5ce626bf1000a97b6b5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/527612eb2de84d52740000d5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/873c5860f8b916285b474f56cbd6f135?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/527612eb2de84d52740000d5'>Deleted User</a>
</div>
<a UTCms='1489565134000' class='quanto-date posted-at response-posted-at' href='#58c8f5ce626bf1000a97b6b5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Arshpreet Singh. That could work; although I wanted to regress today&#39;s factor on today&#39;s returns instead of yesterday&#39;s factors on today&#39;s returns.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c9069593f5dd2d47b9bfde' id='58c9069593f5dd2d47b9bfde'>
<a href='#58c9069593f5dd2d47b9bfde'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1489569429000' class='quanto-date posted-at response-posted-at' href='#58c9069593f5dd2d47b9bfde'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Pravin, there is this variable  </p>

<pre><code>PRED_N_FWD_DAYS = 1 # train on returns over N days into the future  
</code></pre>

<p>But keep in mind the following: pipeline is run every day after market close (precisely before market open of the next day, but still the data available to pipeline is the same) so after market close you can compute your latest factor values but, as the returns are calculated as % difference in <strong>open</strong> prices (because algorithm enters/exits positions at market open), pipeline will compute today returns (that is tomorrow open / today open) only tomorrow after market close. This is the reason why the algorithm discards today pipeline factor and uses yesterday pipeline factor with pipeline returns calculated today (today open / yesterday open), that actually means using ML on yesterday factor and yesterday actual returns. This is what you get with PRED_N_FWD_DAYS = 1.</p>

<p>This is also a bug, that I reported above, as the algorithm was intended to run ML on future returns, not current returns. That is, suppose you want to use 1 day future returns, the algorithm should use returns calculated today and factor values calculated 2 day ago (not yesterday).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c9076493f5dd491eb9c600' id='58c9076493f5dd491eb9c600'>
<a href='#58c9076493f5dd491eb9c600'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a9a4586b792a01d90001e4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c9e558372c8a4422060f277b3f73886?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a9a4586b792a01d90001e4'>arshpreet singh</a>
</div>
<a UTCms='1489569636000' class='quanto-date posted-at response-posted-at' href='#58c9076493f5dd491eb9c600'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Pravin Bezwada:  Yes that was random guess.  :)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c90a196ee814000a7263e7' id='58c90a196ee814000a7263e7'>
<a href='#58c90a196ee814000a7263e7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/527612eb2de84d52740000d5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/873c5860f8b916285b474f56cbd6f135?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/527612eb2de84d52740000d5'>Deleted User</a>
</div>
<a UTCms='1489570329000' class='quanto-date posted-at response-posted-at' href='#58c90a196ee814000a7263e7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Arshpreet. </p>

<p>@Luca, thanks for your valuable feedback. I now see how it works. Here is my attempt with ML. My take on this problem is that what happens tomorrow is anyone&#39;s guess. But you can always tell if today has been undervalued or overvalued. The attached algorithm has a few bugs and crashes but it is so far profitable with transaction costs and slippage. If someone could take a look and fix the bug, I can improve it further.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c91627eb10d239896945a5' id='58c91627eb10d239896945a5'>
<a href='#58c91627eb10d239896945a5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1489573415000' class='quanto-date posted-at response-posted-at' href='#58c91627eb10d239896945a5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas/Quantopian support -</p>

<p>What is the status of this effort, in terms of releasing an API?  Is that the goal?  Is it still a work-in-progress on your end?  Or is it complete, from your perspective?</p>

<p>The approach taken with the <a href="https://www.quantopian.com/posts/optimize-api-now-available-in-algorithms">optimization API</a> is nice, and presumably it will eventually be &quot;released&quot; and moved out of 
<code>quantopian.experimental</code> with the source code on github.  Is that the game plan here, too?  If so, what remains to be done?</p>

<p>Some issues I see:</p>

<ol>
<li>Memory constraints.<br></li>
<li>Testing of ML on known (synthesized) datasets (to confirm its functionality independent of noisy, real-world factors).<br></li>
<li>Encapsulation into an API with documentation and revision control on github.<br></li>
<li>Other?</li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c93787c4400220f60d1496' id='58c93787c4400220f60d1496'>
<a href='#58c93787c4400220f60d1496'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/527612eb2de84d52740000d5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/873c5860f8b916285b474f56cbd6f135?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/527612eb2de84d52740000d5'>Deleted User</a>
</div>
<a UTCms='1489581959000' class='quanto-date posted-at response-posted-at' href='#58c93787c4400220f60d1496'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>After further reviewing this algorithm, I realized that we club the factors and returns across all securities for the prediction. I want to run multiple predictions, one per security by regressing time series of factors per security against security returns. My problem is I don&#39;t know how to fetch a time series (say 60 days) of factor values per security. Sigh, pipeline is so hard.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c9393b4e930f000a7bb9eb' id='58c9393b4e930f000a7bb9eb'>
<a href='#58c9393b4e930f000a7bb9eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1489582395000' class='quanto-date posted-at response-posted-at' href='#58c9393b4e930f000a7bb9eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant: I see the same issues you do (especially memory). A lot of engineering work recently went into improving the infrastructure but hopefully we can work on removing these issues soon.</p>

<p>@Pravin: Correct. You don&#39;t need to change anything to pipeline, however, since it is already providing the ticker information. The classifier just ignores it. I recommend starting with the NB and static data: <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian">https://www.quantopian.com/posts/machine-learning-on-quantopian</a> as it&#39;s much easier to intuit about what needs to be done.</p>

<p>@Luca: That logic seems correct to me. Returns will be open of day T-2 to open of day T-1, so really returns of day T-2. I&#39;ll fix the code in the various posts.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='58c9946b626bf16a3497b68d' id='58c9946b626bf16a3497b68d'>
<a href='#58c9946b626bf16a3497b68d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/586b1cca8bef0c0015000613'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/11c615ca1ce468a950fdd551f1e87732?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/586b1cca8bef0c0015000613'>Sam Hughes</a>
</div>
<a UTCms='1489605739000' class='quanto-date posted-at response-posted-at' href='#58c9946b626bf16a3497b68d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas: I&#39;m glad to see this discussion is still active.</p>

<p>I have a question regarding the X values used as input for AdaBoostClassifier. When I was previously learning about AdaBoost, X would be the predicted results of the X classifiers and they&#39;d be the same possible values as Y, i.e., 1 or -1. So for example, if there were three classifiers, in the case of the first training data item, you may have [-1, 1, 1], with the expected Y as [1]. </p>

<p>In the case of your provided sample code, you&#39;re initially fitting the distributed ranking values (so they&#39;re between 0 and 1) as your X data. </p>

<p><strong>My Question:</strong> Is there a point in the AdaBoostClassifier in which these X input values get classified into a 1 or -1? If so, where is that happening? Is that the job of the DecisionTreeClassifier? </p>

<p>Btw, this site has opened my eyes to quantitative trading. I really appreciate the vast amount of material available here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58cad42e836b38000adfbe92' id='58cad42e836b38000adfbe92'>
<a href='#58cad42e836b38000adfbe92'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/586b1cca8bef0c0015000613'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/11c615ca1ce468a950fdd551f1e87732?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/586b1cca8bef0c0015000613'>Sam Hughes</a>
</div>
<a UTCms='1489687598000' class='quanto-date posted-at response-posted-at' href='#58cad42e836b38000adfbe92'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Actually, never mind, I see what&#39;s going on. By default AdaBoostClassifier is using DecisionTreeClassifier as the base estimator.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58cfaa0778f4cb000a8f3583' id='58cfaa0778f4cb000a8f3583'>
<a href='#58cfaa0778f4cb000a8f3583'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1490004487000' class='quanto-date posted-at response-posted-at' href='#58cfaa0778f4cb000a8f3583'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>I would add to the to-do list a re-consideration of your architecture that limits the ML to pipeline.  My view is that a general ML API should accept alpha factors from both pipeline, and from the minutely algo.  This doesn&#39;t mean that the ML would need to run during the trading day, but just that it would need to accept alpha factors derived from minute bars, for example.  As it stands, I don&#39;t think there is a way to do that now, since one can&#39;t feed data into pipeline.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58cfaf06c4df8a3e3b1ba9f5' id='58cfaf06c4df8a3e3b1ba9f5'>
<a href='#58cfaf06c4df8a3e3b1ba9f5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1490005766000' class='quanto-date posted-at response-posted-at' href='#58cfaf06c4df8a3e3b1ba9f5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant: The problem is still that pipeline only returns the most recent row, rather than the full history of factors required to train the classifier. I suppose we could somehow hack around that and store the history in a global variable and then train the classifier in before_trading_start(), or handle_data() if you want to collect minute data and feed that in as well.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='58cfdf1378f4cb68f68f2d43' id='58cfdf1378f4cb68f68f2d43'>
<a href='#58cfdf1378f4cb68f68f2d43'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/586b1cca8bef0c0015000613'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/11c615ca1ce468a950fdd551f1e87732?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/586b1cca8bef0c0015000613'>Sam Hughes</a>
</div>
<a UTCms='1490018067000' class='quanto-date posted-at response-posted-at' href='#58cfdf1378f4cb68f68f2d43'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Ok, I understand where I was going wrong earlier.. Being new to both quantitative trading and machine learning, maybe it&#39;s just me, but I&#39;ll state what I was mixing up in case anyone else ran into the same thing.</p>

<p>I was mixing up the Pipeline <em>factors</em> with the AdaBoost <em>classifiers</em>. That is, I was thinking that the factor functions were the classifiers that AdaBoost was expected to use and improve upon. From a naive perspective, the factor functions look similar to what I would define as &quot;weak learners.&quot; </p>

<p>But in reality, the weak learners (classifiers) are decision tree stump classifiers that are used by the AdaBoost classifier. The Pipeline factor ranks are the data fed to those weak learners (classifiers).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d053c6a4186c000af2ade6' id='58d053c6a4186c000af2ade6'>
<a href='#58d053c6a4186c000af2ade6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1490047942000' class='quanto-date posted-at response-posted-at' href='#58d053c6a4186c000af2ade6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas - If I understand correctly, within pipeline, we have access to the full history of factors to train the classifier, but one can&#39;t get pipeline to spit out trailing windows of factors.  But you think globals will work?  Maybe I&#39;ll try that at some point, just for yucks.  Is there a time frame for upgrading pipeline to output multiple rows?  Then you could elegantly park the ML outside pipeline to allow for combining pipeline and non-pipeline factors.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59313ecc3303a6000d24dac3' id='59313ecc3303a6000d24dac3'>
<a href='#59313ecc3303a6000d24dac3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1496399564000' class='quanto-date posted-at response-posted-at' href='#59313ecc3303a6000d24dac3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Good news! Since we <a href="https://www.quantopian.com/posts/double-the-memory-double-the-fun">doubled RAM</a> in research and the backtester we can finally start running the ML workflow with longer lookback windows. In this backtest I run with a half-year window, training weekly over a 4 year period.</p>

<p>As you can see, the algorithm still does not perform magically better and my hunch is that the factors themselves do not have enough alpha in them, so I think exploring other factors in this framework would be a good next step.</p>

<p>Also, the next bottleneck that popped up are timeouts in <code>before_trading_starts</code>. These happen if we use fundamentals (MorningStar) which unfortunately many factors rely on. I removed all of these from this backtest to make things work. There are plans to speed fundamentals up eleviating this problem. Until then, there are many things that can be done in this framework already, also using factors based on <a href="https://www.quantopian.com/data">other data sources</a>.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5931c898e59e9e000d468ba4' id='5931c898e59e9e000d468ba4'>
<a href='#5931c898e59e9e000d468ba4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5847522904d4c600150003f9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bf91c4231625f9896145a877ea25eab9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5847522904d4c600150003f9'>Sam Khorsand</a>
</div>
<a UTCms='1496434840000' class='quanto-date posted-at response-posted-at' href='#5931c898e59e9e000d468ba4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Sounds good thanks for the update!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59320d863ae66f5d9100617f' id='59320d863ae66f5d9100617f'>
<a href='#59320d863ae66f5d9100617f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/59166ec0a06a46001015b555'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/57857e55ddda2ac00736c02e664ffce8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/59166ec0a06a46001015b555'>Warren Menezes</a>
</div>
<a UTCms='1496452486000' class='quanto-date posted-at response-posted-at' href='#59320d863ae66f5d9100617f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Awesome!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='594a14dfb3973c4722bb3978' id='594a14dfb3973c4722bb3978'>
<a href='#594a14dfb3973c4722bb3978'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5794dffde0d8a39a6d000a98'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c828e5faa1058f6173a4ba98dc4bb36c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5794dffde0d8a39a6d000a98'>Mat</a>
</div>
<a UTCms='1498027231000' class='quanto-date posted-at response-posted-at' href='#594a14dfb3973c4722bb3978'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Can someone explain why results can change between two backtests with same algorithm and parameters. I am using  AdaBoostClassifier with default parameters and their is two possible results. Is this an effect of random state ? How I can avoid this effect ?<br>
Thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='594a8b7a9b45800010879c0c' id='594a8b7a9b45800010879c0c'>
<a href='#594a8b7a9b45800010879c0c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1498057594000' class='quanto-date posted-at response-posted-at' href='#594a8b7a9b45800010879c0c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Mat: I added a random seed now to the classifier instantiation. Can you see if the problem persists?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='594a9e359b4580000d879d46' id='594a9e359b4580000d879d46'>
<a href='#594a9e359b4580000d879d46'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5794dffde0d8a39a6d000a98'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c828e5faa1058f6173a4ba98dc4bb36c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5794dffde0d8a39a6d000a98'>Mat</a>
</div>
<a UTCms='1498062389000' class='quanto-date posted-at response-posted-at' href='#594a9e359b4580000d879d46'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas, even with random_state=1337 param set, there is still 2 results for my backtest with AdaBoostClassifier. I have no problem with GradientBoostingClassifier with default param but backtest result is less interesting  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='594b5a948c06c40010ddd71f' id='594b5a948c06c40010ddd71f'>
<a href='#594b5a948c06c40010ddd71f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1498110612000' class='quanto-date posted-at response-posted-at' href='#594b5a948c06c40010ddd71f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Mat: We haven an open issue about this, will try to fix it and post an update here.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='594b6949c01901000d18dab7' id='594b6949c01901000d18dab7'>
<a href='#594b6949c01901000d18dab7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5794dffde0d8a39a6d000a98'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c828e5faa1058f6173a4ba98dc4bb36c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5794dffde0d8a39a6d000a98'>Mat</a>
</div>
<a UTCms='1498114377000' class='quanto-date posted-at response-posted-at' href='#594b6949c01901000d18dab7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>You can check self.clf.score(X, Y) between to backtest run is not always the same. Maybe an effect of default AdaBoostClassifier param algorithm=SAMME.R. For weekly training does not seems to have any effect but on yearly training you can see a huge effect on backtest returns  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='594bff51b6556845e67a2bcc' id='594bff51b6556845e67a2bcc'>
<a href='#594bff51b6556845e67a2bcc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1498152785000' class='quanto-date posted-at response-posted-at' href='#594bff51b6556845e67a2bcc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Mat - Are you sure that the results of ensemble.AdaBoostClassifier should be fully  deterministic, even with random_state set ?<br>
                 I looked, yet couldn&#39;t resolve that question.<br>
                One could make a case for a slight bit of non-determinism based on the base-classifier being a two-leaf tree(e.g. one if-statement), and the choice flipping one way or the other for &quot;equal&quot; values...not sure about that argument though.</p>

<p>@Mat - From what I can tell googling, there was a problem with random_state in   late 2016, which was fixed in the sklearn 0.18 release.<br>
See: <a href="http://scikit-learn.org/stable/whats_new.html">http://scikit-learn.org/stable/whats_new.html</a></p>

<blockquote>
<p>Fix bug where ensemble.AdaBoostClassifier and<br>
ensemble.AdaBoostRegressor would perform poorly if the random_state<br>
was fixed (#7411). By Joel Nothman.  </p>

<p>Fix bug in ensembles with  </p>

<blockquote>
<p>randomization where the ensemble would not set random_state on base<br>
estimators in a pipeline or similar nesting. (#7411). Note, results<br>
for ensemble.BaggingClassifier ensemble.BaggingRegressor,<br>
ensemble.AdaBoostClassifier and ensemble.AdaBoostRegressor will now<br>
differ from previous versions. By Joel Nothman</p>
</blockquote>
</blockquote>

<p>@Thomas - Can&#39;t tell what version of sklearn is being used anymore, so don&#39;t know if the bug is fixed in the Quantopian ResearchPlatform,</p>

<pre><code>import sklearn  
print(&#39;The scikit-learn version is {}.&#39;.format(sklearn.__version__))

</code></pre>

<p>produces</p>

<blockquote>
<p>SecurityViolation: 0002 Security Violation(s): Accessing<br>
sklearn.<strong>version</strong> raised an AttributeError. No attributes with a<br>
similar name were found.</p>
</blockquote>

<p>alan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='594c25a0231b2a000d7b4464' id='594c25a0231b2a000d7b4464'>
<a href='#594c25a0231b2a000d7b4464'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1498162592000' class='quanto-date posted-at response-posted-at' href='#594c25a0231b2a000d7b4464'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@alan: we run 0.16.1 (quite old) so this definitely seems like it could be the cause, really need to upgrade. I think with the same seed it <em>should</em> behave reliably.</p>

<p>So it sounds like the bug is specific to AdaBoostClassifier, in which case we can instantly fix it by switching to e.g. RandomForestClassifier.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='594c26f5674222000d3a0edc' id='594c26f5674222000d3a0edc'>
<a href='#594c26f5674222000d3a0edc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/586b1cca8bef0c0015000613'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/11c615ca1ce468a950fdd551f1e87732?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/586b1cca8bef0c0015000613'>Sam Hughes</a>
</div>
<a UTCms='1498162933000' class='quanto-date posted-at response-posted-at' href='#594c26f5674222000d3a0edc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Mat - Based on my understanding, AdaBoostClassifier uses the DecisionTreeClassifier by default, which produces &quot;best&quot; splits (using gini computation). I believe that in some cases, there are several splits that result in the same gini score. It&#39;s possible that, in such a case, the DecisionTreeClassifier randomly picks which split to use. </p>

<p>I found this: <a href="https://github.com/scikit-learn/scikit-learn/issues/2386">https://github.com/scikit-learn/scikit-learn/issues/2386</a>, which seems to support the theory. </p>

<p>Sam  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='594c27ebe066eb00107b4bdf' id='594c27ebe066eb00107b4bdf'>
<a href='#594c27ebe066eb00107b4bdf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1498163179000' class='quanto-date posted-at response-posted-at' href='#594c27ebe066eb00107b4bdf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Sam: Even if it&#39;s random, it should be deterministic with a set seed.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='594cfe89d2aa2f000da32c49' id='594cfe89d2aa2f000da32c49'>
<a href='#594cfe89d2aa2f000da32c49'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5794dffde0d8a39a6d000a98'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c828e5faa1058f6173a4ba98dc4bb36c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5794dffde0d8a39a6d000a98'>Mat</a>
</div>
<a UTCms='1498218121000' class='quanto-date posted-at response-posted-at' href='#594cfe89d2aa2f000da32c49'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you all for your help, I switched to RandomForestClassifier(n_estimators=300, random_state=10) that is deterministic but very sensitive to training period.  With a 5 factors model I have to fit model only few month at beginning of each year to find some good results, maybe classifier find some factors relations that do no exist the rest of the year. Difficult to explain  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5957925d04eece000dbad724' id='5957925d04eece000dbad724'>
<a href='#5957925d04eece000dbad724'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/573af8c089bb64093f000893'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9bfa4d5fca3a14f516a215379b92bc55?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/573af8c089bb64093f000893'>Jun Chao Keung</a>
</div>
<a UTCms='1498911325000' class='quanto-date posted-at response-posted-at' href='#5957925d04eece000dbad724'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>understand that we &#39;re doing ranking on the features/alpha factors<br>
is it possible for us to deploy sector neutralization technique on the signal level ?<br>
==&gt;  focusing our algorithm on the relative factor score and stock performance within each sector</p>

<p>e.g the outperformers might have negative forward one- month returns as long as they outperform relative to their sectors</p>

<p>can you show me how to do the above pls ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='596e557686857e67287f5df3' id='596e557686857e67287f5df3'>
<a href='#596e557686857e67287f5df3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5441e3042c869f0bc00000e2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/07eec08109406c6cd989e75416ffbbb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5441e3042c869f0bc00000e2'>Jonathan Larkin</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1500403062000' class='quanto-date posted-at response-posted-at' href='#596e557686857e67287f5df3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I noticed today on LinkedIn a nice post by Harish Davarajin at DeepValue on this subject. He looks at the combination of 32 alphas from the <a href="https://www.quantopian.com/posts/the-101-alphas-project">101 Alphas publication</a> using various classifiers in <code>sklearn</code> (which are all available on Quantopian). He finds the best results with the SVM classifier (<code>sklearn.svm.SVC</code>) at default settings (e.g., radial bias kernel).</p>

<p>The post is <a href="https://www.linkedin.com/pulse/using-simple-machine-learning-approaches-combine-alphas-devarajan">here</a>.</p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='596ff2f4e62c230010c6642e' id='596ff2f4e62c230010c6642e'>
<a href='#596ff2f4e62c230010c6642e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58794da090925a000abd5ca3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/18f509f82da972d016ae90ca4489a17b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58794da090925a000abd5ca3'>jacob shrum</a>
</div>
<a UTCms='1500508916000' class='quanto-date posted-at response-posted-at' href='#596ff2f4e62c230010c6642e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I will be posting improvements shortly: </p>

<p>Thanks for the giggle: &quot;random_state=1337&quot;  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59720f14a58ff60d1b6c5721' id='59720f14a58ff60d1b6c5721'>
<a href='#59720f14a58ff60d1b6c5721'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1500647188000' class='quanto-date posted-at response-posted-at' href='#59720f14a58ff60d1b6c5721'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@jacob: Great, eager to see improvements to this workflow. Re random_state: ;)  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59734b58e30b81001018bd36' id='59734b58e30b81001018bd36'>
<a href='#59734b58e30b81001018bd36'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1500728152000' class='quanto-date posted-at response-posted-at' href='#59734b58e30b81001018bd36'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Jonathan/Thomas -</p>

<p>Regarding the <a href="https://www.linkedin.com/pulse/using-simple-machine-learning-approaches-combine-alphas-devarajan">post</a> by Harish Davarajin at DeepValue, is it something that could be done on Quantopian?  If so, is there an outline you could provide of how to approach it?</p>

<p>I&#39;ve taken an interest in learning some machine learning (perhaps as I age, I can augment my feeble mind with AI!), so perhaps this would be a good entry point.</p>

<p>Thanks,</p>

<p>Grant &quot;Off-White Seal&quot; Kiehne</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='597f6ef643cc8721a981a05d' id='597f6ef643cc8721a981a05d'>
<a href='#597f6ef643cc8721a981a05d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5707e024829bc5dae2000064'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ff7931ca8733a8571ecea76999905df7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5707e024829bc5dae2000064'>Georges Bilan</a>
</div>
<a UTCms='1501523702000' class='quanto-date posted-at response-posted-at' href='#597f6ef643cc8721a981a05d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Has anyone modified this framework to train on intraday (open to close) returns?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59808511cb2376000d21777d' id='59808511cb2376000d21777d'>
<a href='#59808511cb2376000d21777d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/590159d926a03f00107ee416'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c5e9fa96bbd2dc1e9a027cc2d277a0da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/590159d926a03f00107ee416'>Ian Worthington</a>
</div>
<a UTCms='1501594897000' class='quanto-date posted-at response-posted-at' href='#59808511cb2376000d21777d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@jacob shrum come on then :D  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59811ca841b3161539a70e7b' id='59811ca841b3161539a70e7b'>
<a href='#59811ca841b3161539a70e7b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/590159d926a03f00107ee416'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c5e9fa96bbd2dc1e9a027cc2d277a0da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/590159d926a03f00107ee416'>Ian Worthington</a>
</div>
<a UTCms='1501633704000' class='quanto-date posted-at response-posted-at' href='#59811ca841b3161539a70e7b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>If the entire market is in a bull, and all returns are positive for whatever universe we select, then will this algorithm still short  the worst performing?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5983e477ecce050010e23018' id='5983e477ecce050010e23018'>
<a href='#5983e477ecce050010e23018'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/592fdb6e5ca8457015aed6b7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ef3d7e5f6e34fd2df443d841bad2035c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/592fdb6e5ca8457015aed6b7'>Chidambaram Periakaruppan</a>
</div>
<a UTCms='1501815927000' class='quanto-date posted-at response-posted-at' href='#5983e477ecce050010e23018'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas when do you think you might have a fix for the Morningstar related timeouts?</p>

<p>From what I can see in backtesting, pipeline appears to batch multiple days of factor calculations and if the arbitrary batching breaches the before_trading_start timeout of 5 mins the whole thing fails. I wish there was a way for us to control how the batching gets done as even if we are sure that one day of factor calculations only takes say 100secs because of the arbitrary batching we seem to get seemingly random timeouts.</p>

<p>The example below resulted in a timout even though the before_trading pipeline itself ran in under 250 secs for a 6 day batch job.</p>

<p>2017-01-03 21:45 before_trading_start:1086 INFO started running pipeline on 2017-01-03 08:45:00-05:00<br>
2017-01-03 21:45 compute:482 INFO weekday 2017-01-03 00:00:00+00:00 1<br>
2017-01-03 21:45 compute:484 INFO 2017-01-03 00:00:00+00:00<br>
2017-01-03 21:45 compute:489 INFO Training took 1.717320 secs<br>
2017-01-03 21:45 compute:482 INFO weekday 2017-01-04 00:00:00+00:00 2<br>
2017-01-03 21:45 compute:484 INFO 2017-01-04 00:00:00+00:00<br>
2017-01-03 21:45 compute:489 INFO Training took 1.708877 secs<br>
2017-01-03 21:45 compute:482 INFO weekday 2017-01-05 00:00:00+00:00 3<br>
2017-01-03 21:45 compute:484 INFO 2017-01-05 00:00:00+00:00<br>
2017-01-03 21:45 compute:489 INFO Training took 1.675035 secs<br>
2017-01-03 21:45 compute:482 INFO weekday 2017-01-06 00:00:00+00:00 4<br>
2017-01-03 21:45 compute:484 INFO 2017-01-06 00:00:00+00:00<br>
2017-01-03 21:45 compute:489 INFO Training took 1.717600 secs<br>
2017-01-03 21:45 compute:482 INFO weekday 2017-01-09 00:00:00+00:00 0<br>
2017-01-03 21:45 compute:484 INFO 2017-01-09 00:00:00+00:00<br>
2017-01-03 21:45 compute:489 INFO Training took 1.901481 secs<br>
2017-01-03 21:45 compute:482 INFO weekday 2017-01-10 00:00:00+00:00 1<br>
2017-01-03 21:45 compute:484 INFO 2017-01-10 00:00:00+00:00<br>
2017-01-03 21:45 compute:489 INFO Training took 1.795630 secs<br>
2017-01-03 21:45 before_trading_start:1089 INFO Time to run pipeline 246.63 secs<br>
2017-01-03 21:45 before_trading_start:1124 DEBUG Number of secruities to be considered: 200<br>
2017-01-03 21:45 get_best_portfolio:1052 INFO one good optimization done<br>
2017-01-03 21:45 WARN sklearn/cross_validation.py:417: Warning: The least populated class in y has only 1 members, which is too few. The minimum number of labels for any class cannot be less than n_folds=3.<br>
2017-01-03 21:45 WARN sklearn/cross_validation.py:417: Warning: The least populated class in y has only 2 members, which is too few. The minimum number of labels for any class cannot be less than n_folds=3.<br>
2017-01-03 21:45 WARN Logging limit exceeded; some messages discarded<br>
2017-01-04 21:45 before_trading_start:1086 INFO started running pipeline on 2017-01-04 08:45:00-05:00<br>
2017-01-04 21:45 before_trading_start:1089 INFO Time to run pipeline 0.00 secs<br>
2017-01-04 21:45 before_trading_start:1124 DEBUG Number of secruities to be considered: 200<br>
2017-01-04 21:45 get_best_portfolio:1052 INFO one good optimization done<br>
2017-01-04 21:45 before_trading_start:1151 INFO Time to run optimizer 33.54 secs<br>
2017-01-04 21:45 before_trading_start:1156 INFO total weight: 1.0, total abs weight: 2.0, maxweight : 0.005, -0.005<br>
2017-01-05 21:45 before_trading_start:1086 INFO started running pipeline on 2017-01-05 08:45:00-05:00<br>
2017-01-05 21:45 before_trading_start:1089 INFO Time to run pipeline 0.00 secs<br>
2017-01-05 21:45 before_trading_start:1124 DEBUG Number of secruities to be considered: 200<br>
2017-01-05 21:45 get_best_portfolio:1052 INFO one good optimization done<br>
2017-01-05 21:45 before_trading_start:1151 INFO Time to run optimizer 30.15 secs<br>
2017-01-05 21:45 before_trading_start:1156 INFO total weight: 1.0, total abs weight: 2.0, maxweight : 0.005, -0.005<br>
2017-01-06 21:45 before_trading_start:1086 INFO started running pipeline on 2017-01-06 08:45:00-05:00<br>
2017-01-06 21:45 before_trading_start:1089 INFO Time to run pipeline 0.00 secs<br>
2017-01-06 21:45 before_trading_start:1124 DEBUG Number of secruities to be considered: 200<br>
2017-01-06 21:45 get_best_portfolio:1052 INFO one good optimization done<br>
2017-01-06 21:45 before_trading_start:1151 INFO Time to run optimizer 29.93 secs<br>
2017-01-06 21:45 before_trading_start:1156 INFO total weight: 1.0, total abs weight: 1.99999999999, maxweight : 0.005, -0.00499999999999<br>
2017-01-09 21:45 before_trading_start:1086 INFO started running pipeline on 2017-01-09 08:45:00-05:00<br>
2017-01-09 21:45 before_trading_start:1089 INFO Time to run pipeline 0.00 secs<br>
2017-01-09 21:45 before_trading_start:1124 DEBUG Number of secruities to be considered: 200<br>
2017-01-09 21:45 get_best_portfolio:1052 INFO one good optimization done<br>
2017-01-09 21:45 before_trading_start:1151 INFO Time to run optimizer 32.78 secs<br>
2017-01-09 21:45 before_trading_start:1156 INFO total weight: 1.0, total abs weight: 2.0, maxweight : 0.005, -0.005<br>
2017-01-10 21:45 before_trading_start:1086 INFO started running pipeline on 2017-01-10 08:45:00-05:00<br>
2017-01-10 21:45 before_trading_start:1089 INFO Time to run pipeline 0.00 secs<br>
2017-01-10 21:45 before_trading_start:1124 DEBUG Number of secruities to be considered: 200<br>
2017-01-10 21:45 get_best_portfolio:1052 INFO one good optimization done<br>
2017-01-10 21:45 before_trading_start:1151 INFO Time to run optimizer 30.61 secs<br>
2017-01-10 21:45 before_trading_start:1156 INFO total weight: 1.0, total abs weight: 1.99999999998, maxweight : 0.00499999999998, -0.00499999999997<br>
2017-01-11 21:45 before_trading_start:1086 INFO started running pipeline on 2017-01-11 08:45:00-05:00<br>
End of logs.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59949bd709380d298baac437' id='59949bd709380d298baac437'>
<a href='#59949bd709380d298baac437'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1502911447000' class='quanto-date posted-at response-posted-at' href='#59949bd709380d298baac437'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This has been a wonderful example to learn from Thomas, thank you.</p>

<p>Is there a way to make the factors from <code>make_factors()</code> &quot;window_safe&quot;?  I find that if I remove <code>.rank(mask=universe)</code> from when the functions are evaluated I get a <code>NonWindowSafeInput: Can&#39;t compute windowed expression</code> error.</p>

<pre><code>    # Rather than Instantiate ranked factors, just get the actual values  
    # This works in notebook research environment but fails in the algorithm arena  
    for name, f in factors.iteritems():  
        #factors_pipe[name] = f().rank(mask=universe)  
        factors_pipe[name] = f()  
</code></pre>

<p>Which, honestly, I&#39;m a bit confused by because I would think that before <code>.rank()</code> could run the main function would first have to be evaluated.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='599814bceabe6b000d4ef0a3' id='599814bceabe6b000d4ef0a3'>
<a href='#599814bceabe6b000d4ef0a3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1503139004000' class='quanto-date posted-at response-posted-at' href='#599814bceabe6b000d4ef0a3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I&#39;m following up on your comment above:</p>

<blockquote>
<p>@Grant: The problem is still that pipeline only returns the most recent row, rather than the full history of factors required to train the classifier. I suppose we could somehow hack around that and store the history in a global variable and then train the classifier in before_trading_start(), or handle_data() if you want to collect minute data and feed that in as well. </p>
</blockquote>

<p>Has there been any progress on upgrading Pipeline to return the full history of factors?  In terms of a more generic architecture, my thinking is that within 
<code>before_trading_start()</code> (where we have access to a 5-minute compute window...well sort of, since Pipeline chunking can consume a lot of it), one would run the ML code, combining both Pipeline-derived alphas and alphas computed using minute data.  Additionally, this would allow control over when the ML step is run (you are running it every day, correct?).  Unfortunately, it could be a bit of a kludge, since I&#39;m not sure <code>schedule_function()</code> is compatible with <code>before_trading_start()</code> so some sort of flag would be required.</p>

<p>Regarding the idea of using globals, I see them used pretty much willy nilly in examples from Quantopian, but I thought they were a bad practice in writing software.  Are they confined to the sand-boxed algo API, so it is copacetic?  Or is there a risk that globals of the same name are used elsewhere in your software, and there would be a conflict?</p>

<p>Overall, what is the Q priority on this ML stuff?  Is the code you published above running to your satisfaction?  What are the next steps?  Or is it on the back burner?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59981d5bdf0d900010cb07c4' id='59981d5bdf0d900010cb07c4'>
<a href='#59981d5bdf0d900010cb07c4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1503141211000' class='quanto-date posted-at response-posted-at' href='#59981d5bdf0d900010cb07c4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Pumpelrod: Instead of <code>.rank()</code>, use <code>.zscore()</code>.</p>

<p>@Grant: Good questions. I agree that having access to pipeline output elsewhere is likely to be the way to go. Training does not happen daily, however. There is actually meaningful progress to this workflow and I will post an update soon.</p>

<p>Global variables might not be an unreasonable stop-gap solution, even though it&#39;s not good practice. The algo is sand-boxed so there is no concern of overwriting some other variables.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59982f283fb13f709fa0fca4' id='59982f283fb13f709fa0fca4'>
<a href='#59982f283fb13f709fa0fca4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1503145768000' class='quanto-date posted-at response-posted-at' href='#59982f283fb13f709fa0fca4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I breezed through a learning/deep learning book recently:</p>

<p>Hands-On Machine Learning with Scikit-Learn and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems<br>
by Aurlien Gron</p>

<p>It does cover AdaBoost, but later on, in the Tensorflow section, it has a chapter on recurrent neural networks as being particularly well-suited for time series problems.  Presumably, RNN&#39;s are used in quantitative trading, but maybe that&#39;s beyond the scope here.</p>

<p>As I&#39;d pointed out earlier, I&#39;d recommend figuring out how to synthesize an input data set with a known output, to see if your ML code is actually working.  For example, you could make up a bunch of factors that, when combined simplistically (e.g. linear combination, equal weights), gives a good result.  Then, you could turn on the ML to see if it improves the result.  Otherwise, if your factors are sketchy, volatile pieces of junk, you won&#39;t be able to test the potential benefit of ML.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='599835b03fb13f709fa0fd6f' id='599835b03fb13f709fa0fd6f'>
<a href='#599835b03fb13f709fa0fd6f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1503147440000' class='quanto-date posted-at response-posted-at' href='#599835b03fb13f709fa0fd6f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant: You have your finger on the pulse, RNNs (specifically LSTMs) are very interesting in that regard. Check out this blog post: <a href="http://www.jakob-aungiers.com/articles/a/LSTM-Neural-Network-for-Time-Series-Prediction">http://www.jakob-aungiers.com/articles/a/LSTM-Neural-Network-for-Time-Series-Prediction</a></p>

<p>Some unittests around the ML framework would also be very helpful, the code complexity is pretty high.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59983afadf0d900010cb0ac6' id='59983afadf0d900010cb0ac6'>
<a href='#59983afadf0d900010cb0ac6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1503148794000' class='quanto-date posted-at response-posted-at' href='#59983afadf0d900010cb0ac6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>By the way, I&#39;m sure you&#39;ve thought of this, but if I were y&#39;all, I&#39;d set up a rig in your office with access to all of the Q data, and tools, plus whatever state-of-the-art ML tools are out there, and get a whip-smart Boston-area intern or starving grad student to play around with it.  Presumably, the licensing terms with your data vendors would allow this.  I bet for $5-10K, you could build a little supercomputer to play with.  There have been numerous requests for high-end deep learning on Q, so you could gather support that it would be beneficial (or show that it stinks) and start to understand how to implement it (or drop it).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='599984ce597283000df4de74' id='599984ce597283000df4de74'>
<a href='#599984ce597283000df4de74'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1503233230000' class='quanto-date posted-at response-posted-at' href='#599984ce597283000df4de74'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>Regarding your comment above that some unit tests around the ML framework would be in order, how would you propose this be done?  Presumably, one would need to use the Q research platform and paste chunks of your code into it.  Ideally, I&#39;d think that it would be nice to test the entire algo with controllable inputs.  One could imagine Q devising and releasing a single toy data set for this purpose, from which multiple factors could be created.  Using the magic of look-ahead bias, one could generate the toy data set from actual stock market data, controlling the degree of predictability of the data set.  The standard, configurable toy data set would then be accessible from both the research platform and the backtester.  It seems like the toy data set would drop right into the existing Q framework, no?</p>

<p>Thanks for the LSTM reference; I&#39;ll need to continue to get up the learning curve on ML.  Intuitively, it seems that if one has reasonable stationarity, then one can learn from the recent past without any fanciness.  By analogy, identifying pictures containing ducks will be the same problem today as it will be in a year.  However, if in a year, there is no such thing as a duck, but we are using a 1-year look back, it won&#39;t work.  I&#39;d seen some comments on Q that for the market, certain time-dependent ML techniques should be used.  Is that what you are working to implement on Q?</p>

<p>Also, regarding your comment &quot;Training does not happen daily&quot; it appears you are using this code within 
<code>class ML(CustomFactor)</code>:</p>

<pre><code>if (not self.init) or (today.weekday() == 0): # Monday  
</code></pre>

<p>I suggest sorting out how to move this control to a scheduled function, rather than burying it in the code, if you are developing a general framework/template/workflow.  For example, to run the ML on a Monday before trading starts, then scheduling a function on Friday to set a flag would do the trick.</p>

<p>Also, I&#39;m wondering if you could have a control for the degree of ML to be imposed to set the relative factor weights in the alpha combination step?  For example, one could have:</p>

<pre><code>alpha_combined = a*alpha_naive + (1-a)*alpha_ML  
</code></pre>

<p>By setting <code>a</code> one could control the influence of the ML relative to a naive alpha combination (e.g. equal weights).  In the ML lingo, I gather that <code>a</code> would be called a hyper-parameter, to be optimized as part of the development.</p>

<p>Another free tip is that although you do a great job of commenting your code, some accompanying schematics/flow charts/swim lanes/state diagrams/etc. would be really helpful.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59ce1a076472593b8b448ddf' id='59ce1a076472593b8b448ddf'>
<a href='#59ce1a076472593b8b448ddf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1506679303000' class='quanto-date posted-at response-posted-at' href='#59ce1a076472593b8b448ddf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>I have spent quite some time testing different approaches for factors combination. One thing that I find difficult is determine the size of historical data to pass to the ML factor. Looking only at recent history (few historical samples) increase chances of overfitting, too many historical samples make the ML factor slow in adapting to changes in market conditions. Do you know of any technique used to estimate the best history size (in this case window_length of ML factor) given how many days in advance we want to predict the prices (n_fwd_days) ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59ce208253ae64000d753d37' id='59ce208253ae64000d753d37'>
<a href='#59ce208253ae64000d753d37'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1506680962000' class='quanto-date posted-at response-posted-at' href='#59ce208253ae64000d753d37'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It would be interesting to hear from Thomas, generally, how Quantopian intends to address the ML hyper-parameter optimization problem.  Each factor would have a characteristic optimal time scale, tau, so the problem sounds a bit gnarly (note tau is the trailing window of factor values, not the window length of data used within the factor).  And the time scale may change with time, so we have tau_n(t), where n is the factor index.  Within the algo, tau would need to be updated periodically, if I&#39;m thinking about this correctly.</p>

<p>One thing I&#39;ve suggested in the past would be to run this R&amp;D stuff off-platform, so that the constraints of the Q platform don&#39;t come into play.  I&#39;d think that the Q R&amp;D team would be chomping at the bit to run on a high-performance platform (e.g. <a href="https://blog.quantopian.com/zipline_in_the_cloud/">https://blog.quantopian.com/zipline_in_the_cloud/</a>).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59d4bbf514b95b5f234d3e7c' id='59d4bbf514b95b5f234d3e7c'>
<a href='#59d4bbf514b95b5f234d3e7c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507113973000' class='quanto-date posted-at response-posted-at' href='#59d4bbf514b95b5f234d3e7c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Luca: Yeah, that&#39;s a tough question. I have done some research on this here: <a href="http://twiecki.github.io/blog/2017/03/14/random-walk-deep-net/">http://twiecki.github.io/blog/2017/03/14/random-walk-deep-net/</a>. Note that PyMC3 is not added to Quantopian. But I think an approach like that could solve the problem. Otherwise you can of course try to analyze each factor to determine the longevity of the signal using alphalens.</p>

<p>@Grant: As you know, I&#39;ve done quite some work on this in the past. I&#39;m not super convinced, however, that it&#39;s really the right thing as it can very easily overfit if you&#39;re not super careful.</p>

<p>These recent slides from Lopez de Prado touch on these and related issues and are well worth a read: <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3031282">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3031282</a>  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59d60c8179d7c7000d97f13a' id='59d60c8179d7c7000d97f13a'>
<a href='#59d60c8179d7c7000d97f13a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1507200129000' class='quanto-date posted-at response-posted-at' href='#59d60c8179d7c7000d97f13a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas,</p>

<p>I&#39;m not sure I understand the argument.  It is something like &quot;Let&#39;s not give sharp knives to chefs in-training; they&#39;ll cut themselves.&quot;  In the book on ML I read recently, I gathered that hyper-parameter optimization is a standard operation.</p>

<p>Besides, for the Q fund, my assumption is that you have a super-sensitive over-fit detector, and would easily filter out the nonsense.</p>

<p>The Q platform kinda supports hyper-parameter optimization now.  Users can run an unlimited number of backtests in parallel (at least that used to be the case), load the results into the research platform, and do the analysis.  And then pick the best hyper-parameter values for use in the algo for the next N periods, and then do it all over again (in theory one could feed in the hyper-parameters with fetcher, without having to stop the algo).  It just seems like a relatively simple API wrapper around this existing process would be nice.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59d62bf61e3d1877a399095c' id='59d62bf61e3d1877a399095c'>
<a href='#59d62bf61e3d1877a399095c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507208182000' class='quanto-date posted-at response-posted-at' href='#59d62bf61e3d1877a399095c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>You&#39;re right, it&#39;s not really a good reason not to add it. We try to provide all capabilities necessary, and hyper-parameter optimization definitely counts as that. We still have some work to support the ML workflow properly, I think it makes sense to only then worry about hyper-parameter optimization.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59d8b751fd3a055252f503b8' id='59d8b751fd3a055252f503b8'>
<a href='#59d8b751fd3a055252f503b8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1507374929000' class='quanto-date posted-at response-posted-at' href='#59d8b751fd3a055252f503b8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I&#39;d be curious how you are approaching developing a Q ML workflow.  Are you constrained by the present hardware &amp; software limitations of the Q platform, or can you run offline (but still have access to the data sets)?  It just seems like you&#39;d want to have an unconstrained platform for R&amp;D, to show the path, versus the other way around.</p>

<p>Also, as I&#39;d mentioned above, it would be prudent to have the capability to synthesize inputs, for algo verification testing.  Is it possible to do this in the research platform?  Can an algo be run there, but with synthetic inputs?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59dc8a63031f3f0010c68265' id='59dc8a63031f3f0010c68265'>
<a href='#59dc8a63031f3f0010c68265'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507625571000' class='quanto-date posted-at response-posted-at' href='#59dc8a63031f3f0010c68265'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Fahrhan: Thanks for sharing, that looks great! I see you had to increase the window length which makes sense and is enabled by the RAM upgrade. Let&#39;s see how it does out-of-sample. Can you paper-trade this?</p>

<p>Curious, what other things did you change?</p>

<p>I also have a version that uses new fundamentals and can run more factors without running into time-outs. Will post soon.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59dcab55e3091f1d3fa4800a' id='59dcab55e3091f1d3fa4800a'>
<a href='#59dcab55e3091f1d3fa4800a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1507634005000' class='quanto-date posted-at response-posted-at' href='#59dcab55e3091f1d3fa4800a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Farhan  because you changed both the algorithm settings and the list of factors in input to the ML model it is difficult to say if you found the right combination of settings that makes the ML model works or if you were just lucky with your input factors. You could try to reset the list of factors as it was in Thomas&#39; version and compare the results.  Then you can add your new factors AND keep the original factors and see if the ML model is able to select your factors amongst all the factors, as your factors offer the best performance they should be the selected ones and the good performance should persist.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e08edd141f05000d0449e1' id='59e08edd141f05000d0449e1'>
<a href='#59e08edd141f05000d0449e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1507888861000' class='quanto-date posted-at response-posted-at' href='#59e08edd141f05000d0449e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>What does 
<code>n_fwd_days</code> control?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e090825006aa000dbe0aaf' id='59e090825006aa000dbe0aaf'>
<a href='#59e090825006aa000dbe0aaf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1507889282000' class='quanto-date posted-at response-posted-at' href='#59e090825006aa000dbe0aaf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It controls how many days in the future you want to predict the return for.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e1ecbb12a4ef36427037b8' id='59e1ecbb12a4ef36427037b8'>
<a href='#59e1ecbb12a4ef36427037b8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1507978427000' class='quanto-date posted-at response-posted-at' href='#59e1ecbb12a4ef36427037b8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Luca -</p>

<p>I thought the point of the ML was to improve the alpha combination step, over a simple equal-weight approach (see <a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">https://blog.quantopian.com/a-professional-quant-equity-workflow/</a>).  So, I don&#39;t understand the idea of applying it to a single factor.</p>

<p>Also, to get at whether the ML code is working as expected, it seems we would want to be working with synthetic factors, with controllable characteristics.  Within the Q research platform, this would be straightforward, I think.  What characteristics of the input data would be required for the ML code to work like a charm?  Once it is shown that the code works under ideal conditions, then perturbations to those conditions (e.g. random walk type noise and other statistical wackiness) can be introduced.  Basically, develop the tool first, and then apply it to the real-world.  This convolution of uncontrolled inputs with an unverified tool doesn&#39;t make sense to me.  Sorta leaping ahead in my opinion, which can lead to a lot of murkiness.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e240fb579397001062e0d9' id='59e240fb579397001062e0d9'>
<a href='#59e240fb579397001062e0d9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1507999995000' class='quanto-date posted-at response-posted-at' href='#59e240fb579397001062e0d9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another thought here would be to incorporate Alphalens into the ML.  As I understand, it is a human-readable tool for assessing alpha factors, but couldn&#39;t it be made readable by a machine?  As part of the ML routine, couldn&#39;t it periodically pass all of the factors to Alphalens, which would provide input to the ML, which would then provide point-in-time weights across all of the factors, for the alpha combination step?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e2449e4c8f6d000d81aaec' id='59e2449e4c8f6d000d81aaec'>
<a href='#59e2449e4c8f6d000d81aaec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1508000926000' class='quanto-date posted-at response-posted-at' href='#59e2449e4c8f6d000d81aaec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant: Yeah, using alphalens (specifically the Information Coefficient) to assess which factors should be used is a great idea. Ideally the classifier would pick up on the same thing but definitely worth a try.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e259e08520f70010108292' id='59e259e08520f70010108292'>
<a href='#59e259e08520f70010108292'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1508006368000' class='quanto-date posted-at response-posted-at' href='#59e259e08520f70010108292'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another note: for factors like the Precog stuff, where there could be over-fitting, the algo should take into account the in-sample versus out-of-sample periods.  The most conservative approach would be to use only the out-of-sample period (i.e. ignore the factor, until the date it became live on Quantopian).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e35f7d6bf945000d2cc074' id='59e35f7d6bf945000d2cc074'>
<a href='#59e35f7d6bf945000d2cc074'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1508073341000' class='quanto-date posted-at response-posted-at' href='#59e35f7d6bf945000d2cc074'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Regarding the Information Coefficient (IC), are we actually talking about <a href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient">Spearman&#39;s rank correlation coefficient</a>, or something else?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e4888906a0e800107450fc' id='59e4888906a0e800107450fc'>
<a href='#59e4888906a0e800107450fc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1508149385000' class='quanto-date posted-at response-posted-at' href='#59e4888906a0e800107450fc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant -</p>

<blockquote>
<p>I thought the point of the ML was to improve the alpha combination<br>
step, over a simple equal-weight approach&gt; So, I don&#39;t understand the idea of applying it to a single factor.</p>
</blockquote>

<p>I fixed 3 bugs in the ML factor, each of them was preventing the ML factor from working at all. I guess showing that the code works is the first step toward a more robust testing. So, here it is, debugged and cleaned up ML factor code for you to use. </p>

<blockquote>
<p>Also, to get at whether the ML code is working as expected, it seems<br>
we would want to be working with synthetic factors, with controllable<br>
characteristics. </p>
</blockquote>

<p>I agree with you but what&#39;s the point of creating a synthetic factor if  Precog factor already performs as an ideal synthetic factor? That&#39;s the reason why I used precog data: first the NB shows the performance of precog iteself, so that you know what kind of data you are using, then the precog data is given in input to the ML factor.</p>

<blockquote>
<p>Once it is shown that the code works under ideal conditions, then perturbations to<br>
those conditions (e.g. random walk type noise and other statistical<br>
wackiness) can be introduced.</p>
</blockquote>

<p>That&#39;s exactly what the NB does, so we completely agree on how to test the ML factor and the fact you have some doubts on that NB might be due a misunderstanding of what the NB exactly does. </p>

<blockquote>
<p>This convolution of uncontrolled inputs with an unverified tool doesn&#39;t make sense to me. </p>
</blockquote>

<p>What is this unverified tool?</p>

<blockquote>
<p>Another thought here would be to incorporate Alphalens into the ML.</p>
</blockquote>

<p>This makes perfectly sense to me but why would you do that? First, clear requirements from the ML factor are needed, then we have to test if the ML factor satisfies those requirements and only if we discover that the current design prevent the ML factor from achieving the desired results  it would be worth trying another approach. Although I don&#39;t believe it is a good idea to go on a trial and error approach, It would be better to understand if the current ML algorithm  (i.e. Adaboost + DecisionTreeClassifier + the transformation applied to the input factor and returns ) can actually learn what we want it to learn. If it is clear that ML factor cannot achieve the desired goals by design, then it is worth trying something else, but that should be a &quot;goals driven design&quot;.</p>

<blockquote>
<p>Another note: for factors like the Precog stuff, where there could be<br>
over-fitting, the algo should take into account the in-sample versus<br>
out-of-sample periods. The most conservative approach would be to use<br>
only the out-of-sample period (i.e. ignore the factor, until the date<br>
it became live on Quantopian).</p>
</blockquote>

<p>By design ML factor can understand if the input factors are overfitted because the factor values matched with future returns won&#39;t be correlated. This is true only if you run ML factor out of sample but in my NB I ran ML factor on historical data and in this case there is no way ML factor can detect onverfitting. In my NB I exploited this ML factor impossibility of overfitting detection so that I could use precog data as it was synthetic data.</p>

<blockquote>
<p>Regarding the Information Coefficient (IC), are we actually talking<br>
about Spearman&#39;s rank correlation coefficient, or something else?</p>
</blockquote>

<p>Exactly, that&#39;s Spearman&#39;s rank correlation coefficient computed against factor values and future returns  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e5ca508f9d5b0006fedd4f' id='59e5ca508f9d5b0006fedd4f'>
<a href='#59e5ca508f9d5b0006fedd4f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1508231760000' class='quanto-date posted-at response-posted-at' href='#59e5ca508f9d5b0006fedd4f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>I fixed 3 bugs in the ML factor, each of them was preventing the ML factor from working at all.</p>
</blockquote>

<p>Just making sure, these fixes are all in the currently posted version, right? Or did you find new bugs.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e5d370e1b5693b2182cb47' id='59e5d370e1b5693b2182cb47'>
<a href='#59e5d370e1b5693b2182cb47'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1508234096000' class='quanto-date posted-at response-posted-at' href='#59e5d370e1b5693b2182cb47'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Luca -</p>

<p>My thinking regarding the IC (Spearman&#39;s rank correlation coefficient) was to address your observation:</p>

<blockquote>
<p>Third test: the ML factor is run with the predictive factor from the<br>
first test plus four other noisy factors, which don&#39;t have alpha<br>
value. The goal of this test is to verify that ML is able to find<br>
alpha even among noise, so we expect the results to be at least as<br>
good as the first test, given the same good factor is present in this<br>
test too. Unfortunately this is not true and the results are good but<br>
not as good as the first test.This is another point where ML factor<br>
needs improvements, being able to discard noisy factors.</p>
</blockquote>

<p>I figure if a human can use the IC to discard noisy factors then a machine should be able to do it, too.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e645e656f25f0008f8762c' id='59e645e656f25f0008f8762c'>
<a href='#59e645e656f25f0008f8762c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1508263398000' class='quanto-date posted-at response-posted-at' href='#59e645e656f25f0008f8762c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas</p>

<blockquote>
<p>Just making sure, these fixes are all in the currently posted version,<br>
right? Or did you find new bugs.</p>
</blockquote>

<p>The 3 bugs are the &quot;old&quot; ones, not new ones. I stopped checking other people code though, so I can only be sure about my latest NB code.  </p>

<p>@Grant</p>

<blockquote>
<p>I figure if a human can use the IC to discard noisy factors then a<br>
machine should be able to do it, too.</p>
</blockquote>

<p>That makes sense, I didn&#39;t get that was the reason of your suggestion, sorry.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e9cd139ce3d7000633a59e' id='59e9cd139ce3d7000633a59e'>
<a href='#59e9cd139ce3d7000633a59e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1508494611000' class='quanto-date posted-at response-posted-at' href='#59e9cd139ce3d7000633a59e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Luca -</p>

<p>Regarding use of the IC in an ML algo (where ML is used for the alpha combination step), one could imagine several approaches upon computing the IC across all factors:</p>

<ol>
<li>Set an IC cut-off and simply exclude some factors from the alpha combination step.<br></li>
<li>Weight the factors by the IC (or a ranking by IC or similar) within the alpha combination step (I&#39;m thinking along the lines of a constraint to the ML algo, but I&#39;m not sure of the mechanics here).<br></li>
<li>Supply the IC as a feature for each factor.<br></li>
<li>Do a one-time screening of factors by IC (i.e. simply don&#39;t include factors that don&#39;t make the cut via Alphalens analsyis).  This is the current Quantopian baseline approach, I think.<br></li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59eb28d0096d2531e36b2fcc' id='59eb28d0096d2531e36b2fcc'>
<a href='#59eb28d0096d2531e36b2fcc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1508583632000' class='quanto-date posted-at response-posted-at' href='#59eb28d0096d2531e36b2fcc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>If this is something you&#39;d like to continue pursuing, would it make sense to release code on github?  And perhaps 
<code>quantopian.experimental</code>?  Or maybe this is just a simplistic illustration that isn&#39;t worth the effort (per your comment above &quot;We still have some work to support the ML workflow properly&quot;).  If I ever get a chunk of time to dig into it, it would be nice to know which code is current, and have visibility on the changes and bug fixes.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59eb5249e1331e00069f5d0d' id='59eb5249e1331e00069f5d0d'>
<a href='#59eb5249e1331e00069f5d0d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1508594249000' class='quanto-date posted-at response-posted-at' href='#59eb5249e1331e00069f5d0d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is an updated version that uses new Fundamentals and allows for using way more data (252 days, but probably can be extend) as well as many more factors. The constraining factor now is training the classifier which can easily time-out in <code>before_trading()</code>. Thus, we need to use something fast, and I changed the classifier to a linear one (which might also help with overfitting).</p>

<p>The training code was also refactored by Joe Jevnik.</p>

<p>Please let me know if you find any problems with it. If it seems fine, I&#39;ll replace the top algo with this one.</p>

<p>@Grant: Yes, I like the idea of putting this on Github.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59ec91cea4b6cf0009596cea' id='59ec91cea4b6cf0009596cea'>
<a href='#59ec91cea4b6cf0009596cea'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1508676046000' class='quanto-date posted-at response-posted-at' href='#59ec91cea4b6cf0009596cea'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>For the code you posted immediately above (Backtest ID: 59eb4263e13c964451a1978a), what is the earliest possible start date for a backtest?  Even as late as 1/1/2004, I&#39;m getting:</p>

<pre><code>KeyError: Timestamp(&#39;2001-06-28 00:00:00+0000&#39;, tz=&#39;UTC&#39;)  
There was a runtime error on line 466.  
</code></pre>

<p>Also, regarding the time out issue with <code>before_trading_start</code>, I understand that for the backtester/trading platform, you have to pick something for a time limit (why 5 minutes?), but this is more of a research project at this point.  Is there a reason backtests can&#39;t be run in the research platform without this constraint?  It seems like one would want to be able to plunk the code into the research platform and then with a simple <code>run_backtest</code> call, run the code using the current backtesting engine, but with control over the <code>before_trading_start</code> time out.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59ed153468ee0e0009e1f0a7' id='59ed153468ee0e0009e1f0a7'>
<a href='#59ed153468ee0e0009e1f0a7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5321ff7fb9eb71a18c00032e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f7ce9c335df5f3ee3dee7b1401f131a5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5321ff7fb9eb71a18c00032e'>David Glover</a>
</div>
<a UTCms='1508709684000' class='quanto-date posted-at response-posted-at' href='#59ed153468ee0e0009e1f0a7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I have a version of the algorithm using a random forest classifier among other changes. (wish i could use a neural network but that doesn&#39;t work on quantopian) but backtests always give the before_trading_start timed out timeout error. Is there a workaround allowing me to simply wait for the longer training time?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f07a2b946aeb666f319644' id='59f07a2b946aeb666f319644'>
<a href='#59f07a2b946aeb666f319644'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1508932139000' class='quanto-date posted-at response-posted-at' href='#59f07a2b946aeb666f319644'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant </p>

<blockquote>
<p>For the code you posted immediately above (Backtest ID:<br>
59eb4263e13c964451a1978a), what is the earliest possible start date<br>
for a backtest?</p>
</blockquote>

<p>Considering that the ML factor has a window length of 252 days and also the input factor of ML with the longest length is 252 days, then you need at least 504 days of historical data (trading days). </p>

<p>@Thomas</p>

<p>The refactored code is really nice expect for the global variable PRED_N_FORWARD_DAYS used internally by ML factor, that should be a ML initialization argument to avoid too easy misuses.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f07d454d2b640009ae2567' id='59f07d454d2b640009ae2567'>
<a href='#59f07d454d2b640009ae2567'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1508932933000' class='quanto-date posted-at response-posted-at' href='#59f07d454d2b640009ae2567'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas</p>

<p>Also, I noticed that the factors are created without the 
<code>mask</code> argument so there is lots of wasted computation and probably memory too (this depends on pipeline implementation, so I don&#39;t know for sure).  Considering we are already reaching the platform limits it would be better to mask the factor by the algorithm universe.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f19f92e33bd70009a1e8a0' id='59f19f92e33bd70009a1e8a0'>
<a href='#59f19f92e33bd70009a1e8a0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1509007250000' class='quanto-date posted-at response-posted-at' href='#59f19f92e33bd70009a1e8a0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Luca -</p>

<p>Thanks.  I just started a backtest, with a 1/1/2005 start date, and it is running; this is consistent with your advice.  A note to the Q team: it sure would be nice to indicate the earliest possible start date as part of the error message.</p>

<p>@ Thomas -</p>

<p>What is the intended purpose of 
<code>quantopian.experimental</code>?  Regarding the <code>before_trading_start</code> time-out issue, another thought is that perhaps you could do a &quot;save as&quot; of the <code>before_trading_start</code> code and call it <code>before_trading_compute</code> (or similar) and eliminate the 5 minute time out (or change it to a much longer time period).  However, <code>before_trading_compute</code> would only be available by importing it:</p>

<p><code>from quantopian.experimental import before_trading_compute</code></p>

<p>Then, presumably, you could keep it sand-boxed (e.g. backtesting only).</p>

<p>Or maybe this would be a hack and waste of time, since a more complete ML workflow is needed?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f1ace6e33bd70009a1e9d2' id='59f1ace6e33bd70009a1e9d2'>
<a href='#59f1ace6e33bd70009a1e9d2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1509010662000' class='quanto-date posted-at response-posted-at' href='#59f1ace6e33bd70009a1e9d2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Looking over the code, I&#39;d assumed that the ML would have at its output a set of weights, by factor (e.g. a vector 
<code>w</code> with N elements, where N is the number of factors).  Then, the combined alpha would be a linear combination of the N alphas, using the weights.  Is this not how it works?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f1bba1e33bd70006a1eb98' id='59f1bba1e33bd70006a1eb98'>
<a href='#59f1bba1e33bd70006a1eb98'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1509014433000' class='quanto-date posted-at response-posted-at' href='#59f1bba1e33bd70006a1eb98'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant</p>

<p>Not exactly, ML does the following:<br>
- rank each input factor<br>
- binarize the historical returns so that the 30% worst returns  become -1 and the 30% top returns  1<br>
- discard returns in the range 30%-70% and the ranked factors values corresponding to the returns in that range<br>
- align factors values with  binarized future returns accordingly to 
<code>n_fwd_days</code><br>
- at this point the ML factor has a trailing window (ML window_length long) of ranked factors aligned with the binarized future returns<br>
- Training: that trailing window is passed to AdaBoostClassifier that will try to understand the relationship between the output, which is the binarized returns one dimensional array (one value per security, 1 or -1), and the input, which is the  ranked factors multi dimensional array (multiple values per security). As AdaBoostClassifier receives a trailing window of binarized returns/ranked factors, then it become clear that a predictive factor will have a consistent relationship between its values and the binarized returns (a particular factor value will have a binarized return value of 1 or -1 every single day of the trailing window, it won&#39;t change) while a non-predictive factor will be inconsistent and the same factor value will have both binarized return values  1 and -1 in different days. This is how AdaBoostClassifier can learn how to predict future returns.<br>
- Prediction: the already trained AdaBoostClassifier is given in input the today ranked factors (that is the multiple ranked factor values associated with each security) and the classifier will output the probability for each security to be 1 or -1. The ML factor output is the probability of a security of being 1.</p>

<p>So I wouldn&#39;t say &quot;the combined alpha would be a linear combination of the N alphas, using the weights. &quot; because AdaBoostClassifier doesn&#39;t combine the multiple factors in a linear way, instead the  combined alpha would be  the probability of a security of being 1 however AdaBoostClassifier predicts it  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f22294e33bd70006a1f53e' id='59f22294e33bd70006a1f53e'>
<a href='#59f22294e33bd70006a1f53e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5847522904d4c600150003f9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bf91c4231625f9896145a877ea25eab9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5847522904d4c600150003f9'>Sam Khorsand</a>
</div>
<a UTCms='1509040788000' class='quanto-date posted-at response-posted-at' href='#59f22294e33bd70006a1f53e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas</p>

<p>Thank you so much for the updated algo. I have one quick question. What would we need to do if we want to go about in testing this algo by using different types of models that scikit learn provides. Such as:</p>

<p>#reg = linear_model.LinearRegression(normalize=True)<br>
    #reg = linear_model.Lasso(alpha = 0.001, normalize=True) # can change options here to use linear or ridge regression instead of lasso<br>
    #reg = linear_model.Ridge (alpha = .5)<br>
    #reg = linear_model.LogisticRegression()<br>
    #reg = linear_model.tree()</p>

<p>Those are just 6 different possibilities, as you know many more are possible. I am trying to wonder where in the code you have provided I would need to alter so that I can test the algo on different types of regressions or classifiers similar to what I list above? Would something need to be altered in the section of the code starting with &#39;class ML(CustomFactor):&#39; ?</p>

<p>Thanks in advance for the help as always. </p>

<p>Best,</p>

<p>Sam  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f2238fb5b8f25a6e3294b3' id='59f2238fb5b8f25a6e3294b3'>
<a href='#59f2238fb5b8f25a6e3294b3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5847522904d4c600150003f9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bf91c4231625f9896145a877ea25eab9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5847522904d4c600150003f9'>Sam Khorsand</a>
</div>
<a UTCms='1509041039000' class='quanto-date posted-at response-posted-at' href='#59f2238fb5b8f25a6e3294b3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas</p>

<p>I think I found it. Would we just alter the line of code:</p>

<p>self._classifier = linear_model.SGDClassifier(penalty=&#39;elasticnet&#39;)</p>

<p>to whatever type of classifier we want instead?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f225a0ec429c3126032346' id='59f225a0ec429c3126032346'>
<a href='#59f225a0ec429c3126032346'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5847522904d4c600150003f9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bf91c4231625f9896145a877ea25eab9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5847522904d4c600150003f9'>Sam Khorsand</a>
</div>
<a UTCms='1509041568000' class='quanto-date posted-at response-posted-at' href='#59f225a0ec429c3126032346'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas</p>

<p>Sorry for multiple messages! One last thing. Can you also please help me find where to locate all the classifiers and regression models Quantopian has to offer? Thus far I have found:</p>

<pre><code>reg = linear_model.LinearRegression(normalize=True)  
reg = linear_model.Lasso(alpha = 0.001, normalize=True) # can change options here to use linear or ridge regression instead of lasso  
reg = linear_model.Ridge (alpha = .5)  
reg = linear_model.LogisticRegression()  
reg = linear_model.tree()  
</code></pre>

<p>But I am assuming there are many others I can play with? Such as XGBoost, LDA, QDA, Random Forrest, SVM?Wondering where I can find a list of all possible ML models we can run Quantopian algos on.......</p>

<p>Thanks in advance!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f261450abf9900099dee5e' id='59f261450abf9900099dee5e'>
<a href='#59f261450abf9900099dee5e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1509056837000' class='quanto-date posted-at response-posted-at' href='#59f261450abf9900099dee5e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Luca -</p>

<p>Thanks for the explanation.  Basically, it sounds like for each security the code generates a new single alpha, based on its alpha values across factors.  For example, if there were only two stocks, XYZ &amp; PDQ, and two factors, A &amp; B, we&#39;d have:</p>

<p>alpha(XYZ) = f(alpha_A(XYZ), alpha_B(XYZ))<br>
alpha(PDQ) = g(alpha_A(PDQ), alpha_B(PDQ))</p>

<p>Effectively, if I understand correctly, it finds the functions f &amp; g, so that when the current alphas are plugged in, the resulting alpha is predictive of returns.</p>

<p>Why was the problem formulated this way, instead of finding the weights for a linear combination of factors?  It would seem like the logical baby step from an equal-weight alpha combination.  Or maybe ML wouldn&#39;t work for this?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f269232663460006dd41da' id='59f269232663460006dd41da'>
<a href='#59f269232663460006dd41da'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1509058851000' class='quanto-date posted-at response-posted-at' href='#59f269232663460006dd41da'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, I believe your interpretation is correct but  I would stick to the nomenclature used in the ML code:</p>

<p>future_return(XYZ)   = trained_AdaboostClassifier(ranked_factor_A(XYZ),  ranked_factor_B(XYZ))<br>
future_return(PDQ) = trained_AdaboostClassifier(ranked_factor_A(PDQ), ranked_factor_B(PDQ))</p>

<p>f and g  are actually the internal model used by AdaBoostClassifier, whose specific paramenters were set during the training phase<br>
alpha_A and alpha_B are the the ranked input factors<br>
alpha is the future expected relative return (actually the probability of the factor values associated to each security of having a binarized return == 1)</p>

<blockquote>
<p>Why was the problem formulated this way, instead of finding the<br>
weights for a linear combination of factors? It would seem like the<br>
logical baby step from an equal-weight alpha combination. Or maybe ML<br>
wouldn&#39;t work for this?</p>
</blockquote>

<p>I&#39;d love to hear from Thomas how and why he came up with this solution, but I personally find this approach very robust and it makes much sense to me. If you dig into the documentation of AdaBoostClassifier and DecisionTreeClassifier (used by default by AdaBoostClassifier) it will makes sense to you too.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f2fa6596db280006c8e0be' id='59f2fa6596db280006c8e0be'>
<a href='#59f2fa6596db280006c8e0be'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1509096037000' class='quanto-date posted-at response-posted-at' href='#59f2fa6596db280006c8e0be'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Luca -</p>

<p>Thanks for the elucidation.  One potential problem I see is that there is nothing in the code to select, point-in-time, which features (alpha factors) are valid and which are not. A given feature could have a Spearman&#39;s rank correlation coefficient (information coefficient or IC) of zero and still be included.  This would seem to be wishful thinking, that even though the IC is zero, the feature would be useful in combination with other features.  There is nothing to eliminate extraneous features point-in-time.</p>

<p>@ Thomas -</p>

<p>I&#39;d recommend using a universal 
<code>rebalance</code> function that simply takes in an Quantopian standard alpha vector and applies the optimize/ordering routine to it.  It appears you have some stuff in there that is specific to your strategy.  My interpretation of <a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">https://blog.quantopian.com/a-professional-quant-equity-workflow/</a> is that the alpha vector should be fully formed prior to the portfolio construction step.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f311280669ca0009c4eaaa' id='59f311280669ca0009c4eaaa'>
<a href='#59f311280669ca0009c4eaaa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1509101864000' class='quanto-date posted-at response-posted-at' href='#59f311280669ca0009c4eaaa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant</p>

<blockquote>
<p>One potential problem I see is that there is nothing in the code to<br>
select, point-in-time, which features (alpha factors) are valid and<br>
which are not. A given feature could have a Spearman&#39;s rank correlation coefficient<br>
(information coefficient or IC) of zero and still be included. </p>
</blockquote>

<p>Yes, there is no control on that.</p>

<blockquote>
<p>This would seem to be wishful thinking, that even though the IC is zero,<br>
the feature would be useful in combination with other features. There<br>
is nothing to eliminate extraneous features point-in-time.</p>
</blockquote>

<p>Well, one could modify the code so that it periodically test and remove the alpha factors with IC too close to 0 and don&#39;t pass them to AdaBoostClassifier, that would be an interesting test.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f33278f9f5e0650cf1830b' id='59f33278f9f5e0650cf1830b'>
<a href='#59f33278f9f5e0650cf1830b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1509110392000' class='quanto-date posted-at response-posted-at' href='#59f33278f9f5e0650cf1830b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Sam Khorsand: We have scikit-learn 0.16 installed on Quantopian: <a href="http://scikit-learn.org/0.16/supervised_learning.html#supervised-learning">http://scikit-learn.org/0.16/supervised_learning.html#supervised-learning</a></p>

<p>@Grant: The key thing to understand is that most classifiers are not linear. As such, the end-result will not be a linear combination of individual factors, bur a non-linear combination of individual factors. A decision tree might classify as: <code>if (momentum_stock_i &gt; 3) and (mean_reversal_stock_i &lt; -2) and ...; then predict 1, else predict 0</code>. Training finds these rules.</p>

<p>Good point on using the <code>rebalance</code> function.</p>

<p>@Luca: We&#39;ve been inspired by some research from Sheng Wang, formerly at Deutsche Bank. I agree that the workflow makes a lot of sense and breaks the problem apart quite nicely.</p>

<p>Another sentiment I recently came across is to not rank stocks as that makes them co-dependent (you change the rank of one stock, you have to rebalance your whole portfolio, incurring large transaction costs). If instead you just try to predict the returns of individual stocks separately, you can trade every position independently. The difference of course is that one is trying to predict absolute returns that way, while the ranking approach just tries to predict relative returns. Although one could try to just predict relative returns of individual stocks by subtracting out the beta-component.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59f35b6ef9f5e0618ff187ec' id='59f35b6ef9f5e0618ff187ec'>
<a href='#59f35b6ef9f5e0618ff187ec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5847522904d4c600150003f9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bf91c4231625f9896145a877ea25eab9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5847522904d4c600150003f9'>Sam Khorsand</a>
</div>
<a UTCms='1509120878000' class='quanto-date posted-at response-posted-at' href='#59f35b6ef9f5e0618ff187ec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas</p>

<p>Yes awesome I see that. But im more curious on whether the syntax is the same as ordinary python in a terminal when trying to import scikit learn and run different scikit learn packages in Quantopian? I assume it is?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f3ac575da9ca1c013c7293' id='59f3ac575da9ca1c013c7293'>
<a href='#59f3ac575da9ca1c013c7293'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1509141591000' class='quanto-date posted-at response-posted-at' href='#59f3ac575da9ca1c013c7293'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s a long backtest.  I guess I&#39;d reiterate my comment that it is hard to tell if the ML does anything (and perhaps even kills returns).  Maybe there needs to be a switch in the code, to change to a simple equal weight, linear combination of factors to combine the alpha for comparison?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f479f85da9ca1c013c823f' id='59f479f85da9ca1c013c823f'>
<a href='#59f479f85da9ca1c013c823f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1509194232000' class='quanto-date posted-at response-posted-at' href='#59f479f85da9ca1c013c823f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Perhaps it is in the code already effectively, but I suggest applying a standard preprocessing step across all features prior to combining them, such that an individual feature could be input into the optimize API as-is (see discussion on ttps://<a href="http://www.quantopian.com/posts/quantcon-nyc-2017-advanced-workshop">www.quantopian.com/posts/quantcon-nyc-2017-advanced-workshop</a> regarding demeaning and scaling of alpha factors), or the features could be simply combined with a linear combination and then input into the optimize API.</p>

<p>There is a discussion of approaches on <a href="http://scikit-learn.org/stable/modules/preprocessing.html">http://scikit-learn.org/stable/modules/preprocessing.html</a>.</p>

<p>I&#39;ve used this function:</p>

<pre><code>from sklearn import preprocessing  
import numpy as np

def preprocess(a):  
    a = np.nan_to_num(a - np.nanmean(a))  
    # return preprocessing.robust_scale(a) # security violation  
    return preprocessing.scale(a)  
</code></pre>

<p>Basically, if you look at the nice workflow on <a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">https://blog.quantopian.com/a-professional-quant-equity-workflow/</a>, all of the individual alphas (features) would be put through a preprocessing step, yielding the final set of alphas to be combined (either by ML or otherwise).  The code should be modular so that a user can easily change the feature preprocessing technique without having to dig into the code and unravel it.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f76ca2de7fc111dd83095f' id='59f76ca2de7fc111dd83095f'>
<a href='#59f76ca2de7fc111dd83095f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1509387426000' class='quanto-date posted-at response-posted-at' href='#59f76ca2de7fc111dd83095f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Folks,<br>
I have a problem I&#39;d like some help with.</p>

<p><strong>How does one explain the behavior(smoothness and positive  monotinicity) of the cumulative returns in the included notebook for the &quot;ML +  predictive factor&quot; cell ?</strong></p>

<p>The notebook is @Luca&#39;s NB, slightly modified.</p>

<p>The modifications are:<br>
1. Changed the start/end dates to essentially the last two years.<br>
2. The key change is to up the &quot;n_fwd_days&#39; to looking about a a half-year ahead(140 days).<br>
3. Also changed the sign (+ to -) of the ML output, to match up with the </p>

<p>I run the &quot;very predictive factor&quot; and the &quot;ML + predictive factor&quot;, with a window of 252 days and 140 foward days look-ahead.<br>
Look</p>

<p>What I was looking for, in Alphalens, as per Q reccomendations, is a strong separation of the red line(lower quintile) below the dark green line(upper quantile, to help produce strong dollar-neutral long/short portfolios when creating a trading algo for the contest.  I&#39;ve done this before with multiple factors, and with the right ones, the effect is the same.</p>

<p>My current guess is that the effect might have to do with an integrative smoothing effect with  the way alphalens &quot;periods&#39; is setup,<br>
but I&#39;m really at a loss to explain this effect theoretically...which is why I&#39;m asking for the &quot;wisdom of the crowd&quot; !</p>

<p>Thanks!<br>
alan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f7ac44696bca4ba170b95a' id='59f7ac44696bca4ba170b95a'>
<a href='#59f7ac44696bca4ba170b95a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1509403716000' class='quanto-date posted-at response-posted-at' href='#59f7ac44696bca4ba170b95a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Alan - nice, I&#39;ve never tried making ML factor with such a long n_fwd_days :) I didn&#39;t get why you inverted the ML sign though, is it because you saw in a previous run that ML was predicting the opposite of what it should have had?  </p>

<blockquote>
<p>How does one explain the behavior(smoothness and positive<br>
monotinicity) of the cumulative returns in the included notebook for<br>
the &quot;ML + predictive factor&quot; cell ?</p>
</blockquote>

<p>I tried running your NB in a different time period and I got different results, but are you saying that you are getting very similar results with many other factor? If so, what are the similarities with this NB (same time frame, same alphalens periods, 140 same ML settings) ?</p>

<p>By the way, I am curious about this cumulative returns output, I&#39;ll double check if it is correct. IF you are curious about how the cumulative returns plot is computed by Alphalens you can look at this <a href="https://www.quantopian.com/posts/alphalens-what-does-it-do?utm_campaign=alphalens-what-does-it-do&utm_medium=email&utm_source=forums#59db674f384c9200104f45b1">thread</a>, it&#39;s a long discussion.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59ff9295db026a0009bb5939' id='59ff9295db026a0009bb5939'>
<a href='#59ff9295db026a0009bb5939'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1509921429000' class='quanto-date posted-at response-posted-at' href='#59ff9295db026a0009bb5939'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Due to limitations in memory and availability of other python libraries, Q might be missing out on recent breakthroughs in deep learning.  In particular, the Keras library with Tensorflow or Theano as backend provides for Long Short Term Memory (LSTM) model, a type of recurrent neural networks that are very suitable for time series prediction as it captures long term dependencies in the temporal space.  The &#39;deep&#39; part is stacking many layers coupled with long training periods for better generalization makes it computationally power and memory hungry. Having said this, I support calls to be able to do computations offline and upload predictions in the Q platform.  This to me, is a win-win compromise as it takes away from Q the burden of providing computational resources that could accomodate highly complex models like deep learning while reaping the innovative benefits of bleeding edge technologies.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a05f6f1db143870d8d7e37b' id='5a05f6f1db143870d8d7e37b'>
<a href='#5a05f6f1db143870d8d7e37b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a03338e036bed00090c8cfd'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/dac725c2b807220953a9b3f577f77892?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a03338e036bed00090c8cfd'>Michele Roselli</a>
</div>
<a UTCms='1510340337000' class='quanto-date posted-at response-posted-at' href='#5a05f6f1db143870d8d7e37b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello all :) I&#39;m new to Quantopian. I read the API infos but I&#39;m struggling with this code anyway (math degree so I&#39;m not a good coder :( ), can someone write some more comment on that after the features part? I would love to help here, I&#39;m thinking about modify the code in to a RL one, just keeping the features and some of the trading stuff.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a1045cc87162a00161105a4' id='5a1045cc87162a00161105a4'>
<a href='#5a1045cc87162a00161105a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1511015884000' class='quanto-date posted-at response-posted-at' href='#5a1045cc87162a00161105a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Thomas -</p>

<p>I&#39;d be interested in your take on how this kind of ML alpha combination approach can be put in the context of the new risk model.  Is the idea here that even if many (or even all) of the factors individually would be considered too risky, the ML, via nonlinear combination of them, might spit out a combined alpha that reduces the risks that would result from a purely linear combination of alphas?</p>

<p>The other comment is, I&#39;m wondering if, for technical indicators relying solely on OHLCV bar data if there will be enough persistent, repeatable (but still transient) alpha for them to make sense as ML features?  As the saying goes, &quot;You can&#39;t get blood out of a stone.&quot;  Or is the idea that the ML, with some non-OHLCV bar data (fundamentals, or so-called alternative data) would find relationships would not be apparent with a rank correlation analysis, for example?</p>

<p>Finally, could ML be used simply to find the coefficients for combining alphas as a polynomial with interaction terms?  For example (generalizable to any number of alphas):</p>

<p>alpha = b0 + b1*alpha1 + b2*alpha2 + b12*alpha1*alpha2</p>

<p>Basically, point-in-time, find the optimal <em>b</em> coefficients.  Perhaps it would work, and not be subject so much to memory limitations and time-outs?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a1d3f3a837b9400131cdf47' id='5a1d3f3a837b9400131cdf47'>
<a href='#5a1d3f3a837b9400131cdf47'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1511866170000' class='quanto-date posted-at response-posted-at' href='#5a1d3f3a837b9400131cdf47'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another thought to clean up the inputs to the ML algo would be to run each individually through the Optimize API with constraints first, and then do the training.  This should tend to tame the ML inputs, and perhaps lead to better results.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a1e95f1f8d2484c47139f51' id='5a1e95f1f8d2484c47139f51'>
<a href='#5a1e95f1f8d2484c47139f51'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1511953905000' class='quanto-date posted-at response-posted-at' href='#5a1e95f1f8d2484c47139f51'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, great questions. One approach is: for every factor, regress it against the risk model and treat the residuals as the actual alpha factor you put into the ML model.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a1fd6a887162a00198dbc65' id='5a1fd6a887162a00198dbc65'>
<a href='#5a1fd6a887162a00198dbc65'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1512036008000' class='quanto-date posted-at response-posted-at' href='#5a1fd6a887162a00198dbc65'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well, as I understand, you are working on all of the machinery to manage risk and all of the other desired constraints (see <a href="https://www.quantopian.com/posts/a-new-contest-is-coming-more-winners-and-a-new-scoring-system">https://www.quantopian.com/posts/a-new-contest-is-coming-more-winners-and-a-new-scoring-system</a>), and presumably it will all reside within the Optimize API.  So, my thought is that each alpha factor would be run through 
<code>calculate_optimal_portfolio</code> first, and then be combined (and then finally stuffed into <code>order_optimal_portfolio</code> for a final tweaking).  This way, each alpha factor is fully constrained and risk-mitigated individually, prior to the combination step.  It would seem that this would tend to de-noise the features using exactly the same constraints that will be applied to the final combined alpha.</p>

<p>Can the Optimize API be used within pipeline?  I don&#39;t recall ever seeing an example.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a1ffaa5f8d248000e7868f5' id='5a1ffaa5f8d248000e7868f5'>
<a href='#5a1ffaa5f8d248000e7868f5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1512045221000' class='quanto-date posted-at response-posted-at' href='#5a1ffaa5f8d248000e7868f5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The Optimize API can&#39;t be used like that. The process I outlined above gets at the same thing, just more direct.</p>

<p>The idea is to &quot;regress&quot; every factor against the existing risk factors. There will definitely be exposures. For example, if you have a novel mean-reversion factor it will be very highly correlated with the one we have in our risk model. But if you then regress out those factor exposures you are left with a factor that&#39;s orthogonal to everything we have in the risk model.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a20973587162a0c81d5e755' id='5a20973587162a0c81d5e755'>
<a href='#5a20973587162a0c81d5e755'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1512085301000' class='quanto-date posted-at response-posted-at' href='#5a20973587162a0c81d5e755'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hmm?  The Optimize API is based on CVXPY, and CVXPY can be used in Pipeline, so it seems like the Optimize API could be made to work within Pipeline (or something like the Optimize API).  I guess I&#39;m confused--why was the Optimize API developed in the first place, if there is a more direct way?  A topic for a separate discussion thread, I suppose...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a213d3b06a0961e422b7052' id='5a213d3b06a0961e422b7052'>
<a href='#5a213d3b06a0961e422b7052'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1512127803000' class='quanto-date posted-at response-posted-at' href='#5a213d3b06a0961e422b7052'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I think what you might need is to show explicitly in <a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">Jonathan&#39;s flowchart</a> a preprocessing step for alpha factors.  I&#39;m not sure from an architectural standpoint whether it would be within each alpha factor (e.g. as a function called at the output of each alpha factor), or at the input stage of the combination step (applied to each alpha factor).  If the preprocessing is common to all factors, then maybe it could be vectorized within the combination step?  The other advantage of having it in the combination module is that the preprocessing can then be tailored to the details of the combination technique.</p>

<p>Within the preprocessing step. all of the noise/clutter/extraneous junk could be removed, prior to combination.  Then, the Optimize API should be more of a nudge than a shove (ideally one should be reasonably close to optimal prior to using any optimization routine).</p>

<p>Is there an active effort to build up a ML API/framework on Quantopian?  If so, it would be interesting to hear how you are approaching things.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a81fc11ea51ea50517d0030' id='5a81fc11ea51ea50517d0030'>
<a href='#5a81fc11ea51ea50517d0030'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/570e873588217b6f69000557'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b864aac34bf961d32080bee21e80db5f?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/570e873588217b6f69000557'>Maxwell Margenot</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1518468113000' class='quanto-date posted-at response-posted-at' href='#5a81fc11ea51ea50517d0030'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s the Machine Learning on Quantopian algo with the risk model added as a constraint to the optimizer. I had to change the objective to a factor-weighted portfolio in order to pass the contest constraints. Additional research on what factors to include should help bring the cumulative returns to positive and allow anyone to submit it to the contest.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a8420bc9f93ea28495fc697' id='5a8420bc9f93ea28495fc697'>
<a href='#5a8420bc9f93ea28495fc697'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1518608572000' class='quanto-date posted-at response-posted-at' href='#5a8420bc9f93ea28495fc697'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Maxwell -</p>

<p>I&#39;d recommended to Thomas W. to sort out how to provide a set of dummy factors that have been synthesized to have favorable characteristics for this type of algo.  As it stands, it is very hard to tell if the algo is working properly, in my opinion.  Basically, my thinking is one ought to compute a baseline with a simplistic/naive factor combination, and then compare it to combining factors via the ML routine.  One would use idealized/toy factors, and systematically add in noise/randomness to see how the ML algo performs.</p>

<p>Is this feasible?  Could you put some factors up on 
<code>quantopian.pipeline.experimental</code> for this purpose?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a8422eed1d7da5837562541' id='5a8422eed1d7da5837562541'>
<a href='#5a8422eed1d7da5837562541'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1518609134000' class='quanto-date posted-at response-posted-at' href='#5a8422eed1d7da5837562541'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant: Completely agree, it&#39;s a great idea. Mainly a question of prioritization.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a84b91c60db90216f290c9d' id='5a84b91c60db90216f290c9d'>
<a href='#5a84b91c60db90216f290c9d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1518647580000' class='quanto-date posted-at response-posted-at' href='#5a84b91c60db90216f290c9d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well could the analysis be done in the research platform, where presumably one can construct factors with look-ahead bias (by time-shifting the Pipeline input data)?  Maybe then Aphalens could be used to see if there is any benefit to using the ML- based alpha combination.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a8591163e52f2436204bed7' id='5a8591163e52f2436204bed7'>
<a href='#5a8591163e52f2436204bed7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1518702870000' class='quanto-date posted-at response-posted-at' href='#5a8591163e52f2436204bed7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes definitely, good idea. Would be great if someone wanted to give that a shot!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a86c377e3fa7f3db7acf2c3' id='5a86c377e3fa7f3db7acf2c3'>
<a href='#5a86c377e3fa7f3db7acf2c3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1518781303000' class='quanto-date posted-at response-posted-at' href='#5a86c377e3fa7f3db7acf2c3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It would be good to have a starting point.  Surely there are papers on the topic of synthesizing toy market factors with controllable characteristics.  As far as priority, I&#39;d think this would have broad applicability in the context of Quantopian.  Maybe I&#39;m thinking about things incorrectly, but the workflow would seem to be:</p>

<ol>
<li>Create set of toy factors with controllable characteristics, X.<br></li>
<li>Run algo on toy factors and confirm algo works as anticipated<br></li>
<li>Create real factors, that are hypothesized to yield a similar set of characteristics, X.<br></li>
<li>Run algo on real factors and test hypothesis.</li>
</ol>

<p>This is kinda standard practice in science/engineering, systematically introducing randomness/noise into a model of the inputs and examining the outputs.  I&#39;m guessing something similar is followed in the world of finance?  </p>

<p>I guess it would be kinda cool to try this, but how would one go all the way through to the algo stage?  Would there by a way to do it with 
<code>quantopian.pipeline.experimental</code>?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a8f9020d04fd709238cb676' id='5a8f9020d04fd709238cb676'>
<a href='#5a8f9020d04fd709238cb676'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5321ff7fb9eb71a18c00032e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f7ce9c335df5f3ee3dee7b1401f131a5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5321ff7fb9eb71a18c00032e'>David Glover</a>
</div>
<a UTCms='1519357984000' class='quanto-date posted-at response-posted-at' href='#5a8f9020d04fd709238cb676'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Question: I hacked together a version of this algo that seems to perform much better than what has been posted, but every so often it returns an error due to NaN input. Now, since quantopian doesn&#39;t provide the full stack trace, I am completely at a loss to what is going on, since the imputer should replace NaN values with 0. The key change I made was that instead of factor ranking or zscore, I use the raw value. Now, this is actually quite important to my algorithm&#39;s function, and it performs much worse using factor rank or zscore. Does anyone have any ideas where things could be going wrong?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a8f9b500014291d9a24eb24' id='5a8f9b500014291d9a24eb24'>
<a href='#5a8f9b500014291d9a24eb24'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1519360848000' class='quanto-date posted-at response-posted-at' href='#5a8f9b500014291d9a24eb24'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Does this resolve your nans definitely? <a href="https://www.quantopian.com/posts/forward-filling-nans-in-pipeline">https://www.quantopian.com/posts/forward-filling-nans-in-pipeline</a><br>
I&#39;ve seen 100% with a macd factor. In that case there was a try except, with nanfill the try always worked, no nans.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a90148dd09e235dc7334604' id='5a90148dd09e235dc7334604'>
<a href='#5a90148dd09e235dc7334604'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1519391885000' class='quanto-date posted-at response-posted-at' href='#5a90148dd09e235dc7334604'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@David: I&#39;m sorry that the IDE is limiting you in your ability to debug the issue. We have a tricky balance to strike between transparent error messages and tight security practices, which is why we limit the error message to just the last line of the stack trace.</p>

<p>Here are a couple of options for debugging the problem:<br>
1) Comment out blocks of code. This is my preferred tactic. I usually comment out most of the code (everything but initialize, usually), then add back one junk at a time, making sure the result is complete and matches my expectation. With a slower backtest, you should kick off a few backtests in parallel so you don&#39;t have to iterate through one section at a time.<br>
2) Try using the built-in debugger by setting a breakpoint in your algorithm and stepping through it line by line. This is the ideal solution, but I know the debugger sometimes goes very slow in algos that perform complex computations. I recommend you try it, and if it doesn&#39;t work, move on to 1) or 3).<br>
3) Email in to <a href="/cdn-cgi/l/email-protection#026467676660636169427377636c766d726b636c2c616d6f"><span class="__cf_email__" data-cfemail="75131010111714161e350400141b011a051c141b5b161a18">[email&#160;protected]</span></a> with your backtest ID, and we can try to get a better error trace for you. Sometimes this is helpful, others it won&#39;t be as helpful, and your best bet is to go back to 1).</p>

<p>Regarding your specific error, are you dropping NaNs in the <code>screen</code> of your pipeline, or are you doing it somewhere else?  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a95f763ef586f680c5a635c' id='5a95f763ef586f680c5a635c'>
<a href='#5a95f763ef586f680c5a635c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5321ff7fb9eb71a18c00032e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f7ce9c335df5f3ee3dee7b1401f131a5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5321ff7fb9eb71a18c00032e'>David Glover</a>
</div>
<a UTCms='1519777635000' class='quanto-date posted-at response-posted-at' href='#5a95f763ef586f680c5a635c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie<br>
Thanks for the advice, will try to drop nans in the screen, as I believed the imputer was sufficient to prevent nan inputs to the classifier.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa44eacff023600156b2bb9' id='5aa44eacff023600156b2bb9'>
<a href='#5aa44eacff023600156b2bb9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a7f0b851bd2a000107012f5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2ac867dafb84fb456bbbecf27778b309?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a7f0b851bd2a000107012f5'>John Strong</a>
</div>
<a UTCms='1520717484000' class='quanto-date posted-at response-posted-at' href='#5aa44eacff023600156b2bb9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>These 3 threads are very rich, but I often see references (especially by Thomas Wiecki) to something Luca said that does not appear in the thread. Have some of Luca&#39;s comments been deleted? Is there a parallel conversation somewhere else that everyone except me is privy to? (Maybe in Slack? Or on Github?) Since Thomas Wiecki frequently praises Luca&#39;s contribution for technical seriousness and relevance, it is all the more disconcerting. I feel like I&#39;m reading Plato to figure out what Socrates actually said, or maybe like I&#39;m reverse engineering data in search of an invisible factor. Those of us who are late to the conversation would be grateful to find the conversation still in tact.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa45c80ff023600186b2c6c' id='5aa45c80ff023600186b2c6c'>
<a href='#5aa45c80ff023600186b2c6c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1520721024000' class='quanto-date posted-at response-posted-at' href='#5aa45c80ff023600186b2c6c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@John Strong,  I delete my comments from time to time if I believe they are no more relevant. In this thread I discussed with Thomas about few bugs in the ML code but the code was eventually fixed and updated so I decided to delete my comments. There was also a NB that I used to test if ML factor works but I deleted that post too due to lack of collaboration. I&#39;ll see if I still have the NB and I&#39;ll post it here  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa4608f5ee4cc0015f98369' id='5aa4608f5ee4cc0015f98369'>
<a href='#5aa4608f5ee4cc0015f98369'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a7f0b851bd2a000107012f5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2ac867dafb84fb456bbbecf27778b309?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a7f0b851bd2a000107012f5'>John Strong</a>
</div>
<a UTCms='1520722063000' class='quanto-date posted-at response-posted-at' href='#5aa4608f5ee4cc0015f98369'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks, that&#39;s kind of you. My vote is: leave the comments in! Even when they&#39;re stale.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa46c18493f3f5f5f9efecb' id='5aa46c18493f3f5f5f9efecb'>
<a href='#5aa46c18493f3f5f5f9efecb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1520725016000' class='quanto-date posted-at response-posted-at' href='#5aa46c18493f3f5f5f9efecb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@John...its&#39;s a flaw in the way Quantopian runs the Forum as far as I&#39;m concerned. </p>

<p>No disrespect to @Luca or others who are just using the forum within the implicit rules, yet  my belief  is that in a Forum like this one, the only entity that should be able to delete posts is the moderator, and that should only be in special circumstances, which should be spelled out to all of us. I realize that there may be IP/privacy issues at play, yet the alternative of &quot;threads-with-holes&quot; doesn&#39;t seem like a good solution either!</p>

<p>So yes...at times it does feel like:  </p>

<blockquote>
<p>I feel like I&#39;m reading Plato to figure out what Socrates actually said, or maybe like I&#39;m reverse engineering data in search of an invisible factor. </p>
</blockquote>

<p>I&#39;ve taken to immediately copying algos/notebooks that I&#39;m interested in in case they quickly disappear...<br>
alan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa480f9493f3f001d9f01d8' id='5aa480f9493f3f001d9f01d8'>
<a href='#5aa480f9493f3f001d9f01d8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1520730361000' class='quanto-date posted-at response-posted-at' href='#5aa480f9493f3f001d9f01d8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is the NB I used to test ML factor. Firstly ML factor is run with a single predictive factor in input. This is done to test that ML is actually able to detect the alpha and to predict the future returns accordingly.  Secondly a slightly predictive factor is added to the mix. Finally we analyze the performance of ML with the predictive factor in input plus 4 non predictive factors  to verify that the alpha is still found when there is lots of noise.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa69324cf6cf15002dac54b' id='5aa69324cf6cf15002dac54b'>
<a href='#5aa69324cf6cf15002dac54b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1520866084000' class='quanto-date posted-at response-posted-at' href='#5aa69324cf6cf15002dac54b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Luca: This is awesome (hopefully people won&#39;t wonder what this was in response to a couple of weeks from now ;))! I don&#39;t remember seeing this actually, but it&#39;s exactly what Grant and I have been looking for. It seems like the ML can still do a good job even with noisy factors present, which is highly reinforcing. Would be interesting to see the <code>clf.feature_importances_</code>how much weight is given to the noisy factors.</p>

<p>Also, would be curious to compare this with different classifiers. Specifically, does a linear predictor does better? Does RandomForest does better than AdaBoost?</p>

<p>Really exciting framework to make progress in.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5aa7074a4d03e7000fc2d022' id='5aa7074a4d03e7000fc2d022'>
<a href='#5aa7074a4d03e7000fc2d022'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1520895818000' class='quanto-date posted-at response-posted-at' href='#5aa7074a4d03e7000fc2d022'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>hopefully people won&#39;t wonder what this was in response to a couple of<br>
weeks from now</p>
</blockquote>

<p>Lol :)</p>

<p>One thing about AdaBoost is that the documentation is not correct and the default 
<code>base_estimator</code> is <code>DecisionTreeClassifier(max_depth=1)</code>. I found that out looking at the source code.  If we want  the <code>DecisionTreeClassifier</code> to keep into consideration the interaction between multiple factors  <code>max_depth</code> cannot be 1.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa79618e40f64001ba591dc' id='5aa79618e40f64001ba591dc'>
<a href='#5aa79618e40f64001ba591dc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1520932376000' class='quanto-date posted-at response-posted-at' href='#5aa79618e40f64001ba591dc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Luca -</p>

<p>So what is the &quot;executive summary&quot; of <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm#5aa480f9493f3f001d9f01d8">your notebook posted above</a>?  If I understand correctly, it is not entirely clear that the ML provides an advantage over a simpler alpha combination.  It says that there isn&#39;t a gross bug (good to know), but I can&#39;t tell if the ML is worth the trouble or potentially disadvantageous over some naive alpha factor combination (e.g. sum of z-scores).</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa7b1914d03e7000fc2e043' id='5aa7b1914d03e7000fc2e043'>
<a href='#5aa7b1914d03e7000fc2e043'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1520939409000' class='quanto-date posted-at response-posted-at' href='#5aa7b1914d03e7000fc2e043'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is what I think we should do:<br>
1. refactor the code to just return the alpha of the factor.<br>
2. run experiments on all kinds of different classifiers and combination methods (like the baselines outlined by Grant)<br>
3. create nice comparison plots of the different approaches / methods in the different scenarios (single strong signal etc)</p>

<p>Anyone here up for the task?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5aa7baefe40f6476a1a59109' id='5aa7baefe40f6476a1a59109'>
<a href='#5aa7baefe40f6476a1a59109'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1520941808000' class='quanto-date posted-at response-posted-at' href='#5aa7baefe40f6476a1a59109'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Regarding re-factoring, would it be possible to put the code on open Github, but have it available for import, via 
<code>quantopian.pipeline.experimental</code>?</p>

<p>Overall, it would be worthwhile to understand where Q is headed with the alpha combination step, as your former CIO Jonathan Larkin discusses on [A Professional Quant Equity Workflow][1]:</p>

<blockquote>
<p>Lastly, modern machine learning techniques can capture complex relationships between alphas. Translating your alphas into features and feeding these into a machine learning classifier is a popular vein of research.</p>
</blockquote>

<p>Before diving into re-factoring, I&#39;d advise doing some system engineering and road-mapping to understand what the goals should be versus time.  In the end, I&#39;d think Q would want some <code>combine_alpha</code> API module that would be extensible and scalable (including compatibility with whatever computing power will be available down the road).</p>

<p>[1]: <a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">https://blog.quantopian.com/a-professional-quant-equity-workflow/</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa7bf17e40f640c8ca58f28' id='5aa7bf17e40f640c8ca58f28'>
<a href='#5aa7bf17e40f640c8ca58f28'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1520942871000' class='quanto-date posted-at response-posted-at' href='#5aa7bf17e40f640c8ca58f28'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think that&#39;s the wrong order. First you want to understand the problem, and we have all the tools to do so, and then you can provide a meaningful API.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5aa7c6ef73e19c0016c3422e' id='5aa7c6ef73e19c0016c3422e'>
<a href='#5aa7c6ef73e19c0016c3422e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1520944879000' class='quanto-date posted-at response-posted-at' href='#5aa7c6ef73e19c0016c3422e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>&quot;If you don&#39;t know where you are going, you might wind up someplace else.&quot;  Yogi Berra</p>

<p>Well, start with what you know.  If it is a reasonable assumption that some sort of alpha combination API is desirable, and at least parts of it would be open-sourced, then the idea of re-factoring the code on Github and being able to import it via 
<code>quantopian.pipeline.experimental</code> seems sound.  It is the 21st century, so source control with a collaborative tool like Github and code import should be a no-brainer, in my opinion.</p>

<p>I&#39;d also note that Jonathan posted the framework on August 31, 2016, so I&#39;d think that some alpha combination framework has been percolating (if anything, in considering how to combine user algos for the fund).  If not, well, I guess other work has taken precedent.  But if so, it could be brought into the sunlight, along with any thinking about platform compute capability versus time.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa81b39e40f644b78a5800f' id='5aa81b39e40f644b78a5800f'>
<a href='#5aa81b39e40f644b78a5800f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1520966457000' class='quanto-date posted-at response-posted-at' href='#5aa81b39e40f644b78a5800f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant -</p>

<p>You understand the NB correctly. The ML factor is not perfect yet, but we have a robust ML method, debugged code and a NB for testing: the hard part is done. Now It takes very little to have fun adding our own ideas to the framework.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aa8f9e0e6e2133cfd313db0' id='5aa8f9e0e6e2133cfd313db0'>
<a href='#5aa8f9e0e6e2133cfd313db0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1521023456000' class='quanto-date posted-at response-posted-at' href='#5aa8f9e0e6e2133cfd313db0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Is there an appropriate Github location for the code?  Also, is there any kind of flowchart/schematic or other existing visual documentation (e.g. in Visio or similar) that could be edited for a re-factoring effort?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aae57ce25eb3b6482b66df8' id='5aae57ce25eb3b6482b66df8'>
<a href='#5aae57ce25eb3b6482b66df8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1521375182000' class='quanto-date posted-at response-posted-at' href='#5aae57ce25eb3b6482b66df8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>Any feedback on my suggestions above?  It seems that to move this forward in a substantive way, input and support from Q would be helpful.  I wouldn&#39;t mind working on it, but I&#39;d like to know how it would fit into the bigger picture.  Also, as I mentioned, getting it on Github and integrating it with the Q plaform in some fashion (e.g. as importable via 
<code>quantopian.pipeline.experimental</code>) would help a lot, as the forum is not well-suited for this sort of thing.  Also, this would allow the resulting code to be used on Quantopian and zipline-live (although if zipline-live is successful, I suspect it will leave Q in the dust in terms of platform compute power, and so zipline-live users may favor other approaches...a framework for alpha combination of Pipeline factors might be useful, regardless).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aaf81f46439f2000c1f4565' id='5aaf81f46439f2000c1f4565'>
<a href='#5aaf81f46439f2000c1f4565'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1521451508000' class='quanto-date posted-at response-posted-at' href='#5aaf81f46439f2000c1f4565'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Those are great suggestions but they probably will not happen soon. As I said before, the workflow <em>is</em> supported (as proven by Luca&#39;s research). There will always be limitations we could sit around for and wait to be resolved. I&#39;m happy to upload the code to a public github repo, just not sure what that unblocks. The steps I outlined above can all be done today.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5aaf99e10f9c41001c32ec98' id='5aaf99e10f9c41001c32ec98'>
<a href='#5aaf99e10f9c41001c32ec98'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1521457633000' class='quanto-date posted-at response-posted-at' href='#5aaf99e10f9c41001c32ec98'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Getting the code to a public Github repo would just be a better practice, I think.  Or we can all clone your algo above, and then repost umpteen versions on this thread and elsewhere on the forum.  I gather that you don&#39;t really have time to shepherd the thing; if there is interest, Github would seem to be the right tool for collaborative work on the code.</p>

<p>My personal interest is that I see it as an opportunity to learn a little bit about ML, and interact with folks more expert than I.  The forum is really challenging in its present state for this type of work, in my opinion.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5aaf9b050f9c41001c32ecae' id='5aaf9b050f9c41001c32ecae'>
<a href='#5aaf9b050f9c41001c32ecae'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1521457925000' class='quanto-date posted-at response-posted-at' href='#5aaf9b050f9c41001c32ecae'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here we go: <a href="https://github.com/quantopian/research_public/blob/92b32ccd61f25fdfbccfc67a82217c64ae3173e3/research/ml_algo.py">https://github.com/quantopian/research_public/blob/92b32ccd61f25fdfbccfc67a82217c64ae3173e3/research/ml_algo.py</a>  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5ab0cbc10a23d65a6d9f44eb' id='5ab0cbc10a23d65a6d9f44eb'>
<a href='#5ab0cbc10a23d65a6d9f44eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1521535937000' class='quanto-date posted-at response-posted-at' href='#5ab0cbc10a23d65a6d9f44eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Thomas - I&#39;ll have a look at some point, to see what I can learn and contribute.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ab39f98ce20ea43e0d51153' id='5ab39f98ce20ea43e0d51153'>
<a href='#5ab39f98ce20ea43e0d51153'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57925923f30759975e0007ae'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8ed8713d39447bc18f93fc259236449c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57925923f30759975e0007ae'>Al Vinjamur</a>
</div>
<a UTCms='1521721240000' class='quanto-date posted-at response-posted-at' href='#5ab39f98ce20ea43e0d51153'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is my first post ever on Q.<br>
This thread is AWESOME.<br>
Very near and dear to my heart because I did stat arb in my past for a very well known fund.<br>
As an admitted &quot;old timer&quot; I&#39;m always amazed to see how far and fast things have come.<br>
Absolutely awesome.</p>

<p>BTW....what is this &quot;advanced momentum&quot; thing? What is the insight?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ab61f7176f90a57eed0610c' id='5ab61f7176f90a57eed0610c'>
<a href='#5ab61f7176f90a57eed0610c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1521885041000' class='quanto-date posted-at response-posted-at' href='#5ab61f7176f90a57eed0610c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I took a first-pass at re-factoring, starting with a framework for the factors/features:</p>

<p><a href="https://www.quantopian.com/posts/multi-factor-algo-template">https://www.quantopian.com/posts/multi-factor-algo-template</a></p>

<p>If you&#39;d like to contribute, please have a look.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5abb4d4cbc2d4b7c5f32036a' id='5abb4d4cbc2d4b7c5f32036a'>
<a href='#5abb4d4cbc2d4b7c5f32036a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1522224460000' class='quanto-date posted-at response-posted-at' href='#5abb4d4cbc2d4b7c5f32036a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I&#39;d be interested in your thoughts on the feasibility of doing part/all of the computationally intensive ML offline, and then uploading the results using the <a href="https://www.quantopian.com/posts/alpha-testers-wanted-upload-your-own-data-to-pipeline">new API that is in the works</a>.  If I understand correctly, to do offline work, there would be a real benefit in having offline access to the 
<code>QTradableStocksUS</code> symbols point-in-time.  This way, the ML would be operating on the same universe as is required by the contest and preferred for the fund.  If I&#39;m thinking about it correctly, one does not want to do the ML on all stocks, for example, and then filter out symbols that are not in the <code>QTradableStocksUS</code>, since in effect the ML will be &quot;contaminated&quot; by the unwanted stocks (as it does not operate on individual stocks, independent of the others).  I&#39;m highlighting this, because I&#39;d think that offline ML would be one of the primary use cases for the new data-upload API, but without access to the point-in-time universe, it would seem a bit hamstrung.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ad567148c4c213107cab962' id='5ad567148c4c213107cab962'>
<a href='#5ad567148c4c213107cab962'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a7f0b851bd2a000107012f5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2ac867dafb84fb456bbbecf27778b309?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a7f0b851bd2a000107012f5'>John Strong</a>
</div>
<a UTCms='1523934996000' class='quanto-date posted-at response-posted-at' href='#5ad567148c4c213107cab962'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I just stumbled on a very interesting use of a Machine Learning within Zipline. Professor Erk Subasi gave a talk two years ago at QuanCon 2016 entitled, &quot;Honey, I Deep-Shrunk the Sample Covariance Matrix!&quot; (a reference to a classic paper by Ledoit and Wolf), in which he shows how he used autoencoders to calculate the covariance matrix used in portfolio optimization. I really would like to understand his algorithm, but it is pretty deep waters for me and I could use a study partner, in case anyone is interested.</p>

<p>You can listen to the video here:<br>
<a href="https://www.youtube.com/watch?v=jSAqgotWYYc&list=PLRFLF1OxMm_W-TiyLZoRYCHOnXG1CqTAL&index=25&ab_channel=Quantopian">https://www.youtube.com/watch?v=jSAqgotWYYc&amp;list=PLRFLF1OxMm_W-TiyLZoRYCHOnXG1CqTAL&amp;index=25&amp;ab_channel=Quantopian</a></p>

<p>You can download his Jupyter notebook with autoencoder code and Zipline integration here:<br>
<a href="https://github.com/erksubasi/AutoencoderCovShrinkage">https://github.com/erksubasi/AutoencoderCovShrinkage</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ad7f779028cf200210a9401' id='5ad7f779028cf200210a9401'>
<a href='#5ad7f779028cf200210a9401'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1524103033000' class='quanto-date posted-at response-posted-at' href='#5ad7f779028cf200210a9401'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@John,<br>
Question: Might there be some similarities with:</p>

<p><a href="https://www.quantopian.com/posts/hierarchical-risk-parity-comparing-various-portfolio-diversification-techniques">https://www.quantopian.com/posts/hierarchical-risk-parity-comparing-various-portfolio-diversification-techniques</a></p>

<p>alan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ad7ff8bf341cc0014a2aec8' id='5ad7ff8bf341cc0014a2aec8'>
<a href='#5ad7ff8bf341cc0014a2aec8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a7f0b851bd2a000107012f5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2ac867dafb84fb456bbbecf27778b309?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a7f0b851bd2a000107012f5'>John Strong</a>
</div>
<a UTCms='1524105099000' class='quanto-date posted-at response-posted-at' href='#5ad7ff8bf341cc0014a2aec8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Alan Coppola, only in the sense that both approaches tackle the problem of ill-conditioned covariance matrices. But OAS is a standard shrinkage technique whereas Erk Subasi is using autoencoders, which is a type of neural net. I had never heard of that before, and Subasi is a quant and portfolio manager. He&#39;s no dummy.</p>

<p>I wish I were a seasoned researcher and could tell you I have made extensive comparisons of Ledoit and OAS and GraphLasso and autoencoders and then offer you list of pros and cons for each. Alas, I&#39;m still a student and green and struggling to invert any convariance matrix bigger than a couple hundred equities.  </p>

<p>But this is an educational thread, no? I thought someone might be intrigued by the idea of using autoencoders to regularize covariance matrices.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ae6ef61571d5b0042609413' id='5ae6ef61571d5b0042609413'>
<a href='#5ae6ef61571d5b0042609413'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/579a46604da9873c150005f1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/214bcc4fd09ef2a5168b79def547fe1d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/579a46604da9873c150005f1'>Ja Lo</a>
</div>
<a UTCms='1525084001000' class='quanto-date posted-at response-posted-at' href='#5ae6ef61571d5b0042609413'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi all,</p>

<p>Great thread, however, if I understand correctly, my question has not come up.</p>

<p>According to my understanding of the posted algorithm, on any given backtest date when the pipeline runs (say, I am bactesting for June 2015)  it identifies the stocks that are part of the universe on that day, and then loads the history of various factors for these stocks.</p>

<p>However, is that actually the data that I want as input to my ML algorithm? If the algorithm looks at factors from one year earlier, shouldnt it consider the stocks that were part of the universe at that time (say, June 2014), not at the backtest date when the pipeline runs (June 2015). In the current form, it appears to me that a lookahead bias or survivorship bias creeps in, and it also results in NaN values being loaded. </p>

<p>In Research I can build pipelines that behave the way I sketch above, but I cant find/hack a way to implement this in the Algorithm environment.</p>

<p>Do I understand this correctly, and does anyone have advice or a reference for this?<br>
For example, on a given backtest date (say, in June 2015), can I load the pipeline output as it would have been at an earlier time (say, in June 2014)?</p>

<p>Thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ae6f3ab571d5b004b6094f6' id='5ae6f3ab571d5b004b6094f6'>
<a href='#5ae6f3ab571d5b004b6094f6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1525085099000' class='quanto-date posted-at response-posted-at' href='#5ae6f3ab571d5b004b6094f6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Ja,</p>

<blockquote>
<p>According to my understanding of the posted algorithm, on any given backtest date when the pipeline runs (say, I am bactesting for June 2015) it identifies the stocks that are part of the universe on that day, and then loads the history of various factors for these stocks.</p>
</blockquote>

<p>That&#39;s not the case. When you run the backtest starting in June 2014, it will load the universe for June 2014, compute the factors, train the model, make predictions etc. Then in July 2014 it will load the universe for that month. So there is no look-ahead bias here.</p>

<p>In general, we try to make it impossible to access future data in a backtest so that you don&#39;t have to worry as much about look-ahead bias.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5ae7a77908c42d003f3f23c0' id='5ae7a77908c42d003f3f23c0'>
<a href='#5ae7a77908c42d003f3f23c0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/579a46604da9873c150005f1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/214bcc4fd09ef2a5168b79def547fe1d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/579a46604da9873c150005f1'>Ja Lo</a>
</div>
<a UTCms='1525131129000' class='quanto-date posted-at response-posted-at' href='#5ae7a77908c42d003f3f23c0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas,</p>

<p>Thanks. Yes, I understand that the pipeline always loads in the data that is available before the open for each date in the backtest. This is what makes the pipeline a great tool!</p>

<p>Maybe I didn&#39;t communicate my observation as clearly as I hoped (and I should possibly have stuck with &quot;survivorship bias&quot;, not &quot;look-ahead bias&quot;). Allow me to try once more, using an explicit example (which I checked!):</p>

<p>Let&#39;s say I am running my backtest. I set the algorithm to rebalance my portfolio every Wednesday. One such rebalance date would be this last Wednesday, 25 April 2018. One of the stocks included in the Q1500US universe on that Wednesday is Equity(45212 [CTRL]).</p>

<p>Now, for every stock in Q1500US (including Equity(45212 [CTRL])) the algorithm loads data from the 252 days prior to last Wednesday, that is, back to 25 April 2017, and trains the ML classifier using this data, makes predictions, and rebalances my portfolio. Okay.</p>

<p>However, Q1500US changed dynamically along the way from 25 April 2017 to 25 April 2018. For example, Equity(45212 [CTRL]) had a market cap less than 500 million back then, and was not in the universe around 25 April 2017. I checked this.</p>

<p>One example, which could get me into trouble is if I use market cap as a predictor: all stocks that had a market cap below $500 million performed great in the ML training data. Otherwise, they wouldn&#39;t be in Q1500US on the rebalance date, 25 April 2018! This is precisely the case for Equity(45212 [CTRL]). So the ML algorithm might overweight market cap. Similarly for long term momentum, such as your 39 week returns.</p>

<p>The solution to this issue would be that when the algorithm loads data from the previous 252 days for each rebalance date, it should take into account what the Q1500US universe was on each of those 252 days. I hope my point is clearer now. My question was whether this is possible. Thanks!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ae985c1b16b9339bf0d3bae' id='5ae985c1b16b9339bf0d3bae'>
<a href='#5ae985c1b16b9339bf0d3bae'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1525253569000' class='quanto-date posted-at response-posted-at' href='#5ae985c1b16b9339bf0d3bae'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Ja,</p>

<p>OK, I see what you&#39;re saying. It&#39;s not really look-ahead bias of the backtest but because of the way we apply the universe, the resulting ML model is biased in a certain way. That sounds right and it&#39;s a keen observation. I&#39;m not quite sure how this could be addressed however. You would want to apply today&#39;s universe only to the historical data. I&#39;m a bit surprised this isn&#39;t what&#39;s happening. Maybe Scotty has an idea?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5aeacb2f162eac08b7691f97' id='5aeacb2f162eac08b7691f97'>
<a href='#5aeacb2f162eac08b7691f97'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1525336879000' class='quanto-date posted-at response-posted-at' href='#5aeacb2f162eac08b7691f97'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>The impact of a limited universe would seem to depend on how the learning is done.  If each stock is independent, it would seem not to matter whether you apply the universe filter before or after the learning.  For example, say I have a stock market of three stocks: ABC, XYZ, &amp; PDQ.  At any point in time, I pick two of the three to be in my tradable universe.  Out of convenience, I could only run my prediction on two (ABC &amp; XYZ), ignoring the third (PDQ), or I could run my prediction on all three (ABC, XYZ, &amp; PDQ), and then filter out the one (PDQ) that is not in my point-in-time universe.  Either way, I should get the same result.</p>

<p>This is still a bit of a mind-bender for me, but I think the problem comes in if I need PDQ as part of my data set to predict ABC &amp; XYZ (which, by policy, will be the only ones I&#39;ll trade going forward).  Taking a horse race analogy, if the three horses are well-separated on the track, one could make the argument that each runs an independent race; the presence of the other horses is irrelevant.  However, if they are bunched up, then potentially I have a very different problem; not including PDQ in the analysis could be problematic.  Does the ML code that is the subject of this forum post include interactions, or does it effectively treat each stock as an independent horse on the track?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5af5aa3a2f58972601d99e0d' id='5af5aa3a2f58972601d99e0d'>
<a href='#5af5aa3a2f58972601d99e0d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1526049338000' class='quanto-date posted-at response-posted-at' href='#5af5aa3a2f58972601d99e0d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Ja,</p>

<p>Scotty provided a solution for the issue you identified. We need to get a universe of stocks that are in the QTU not just today but the complete window duration. This can in fact be achieved quite simple with Pipeline: <code>Any(inputs=[QTU()], window_length=500)</code> creates a new filter that contains all stocks that ever were in the QTU in the last 500 days. You could also use <code>All</code> if you only wanted stocks that were in the QTU at all times during the last 500 days. You can use this filter in-place of where currently <code>QTU</code> is being used.</p>

<p>Let me know if that makes sense and if you make progress with that.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5af953f51c4b45004368c9bc' id='5af953f51c4b45004368c9bc'>
<a href='#5af953f51c4b45004368c9bc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/579a46604da9873c150005f1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/214bcc4fd09ef2a5168b79def547fe1d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/579a46604da9873c150005f1'>Ja Lo</a>
</div>
<a UTCms='1526289397000' class='quanto-date posted-at response-posted-at' href='#5af953f51c4b45004368c9bc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas,</p>

<p>Thanks for investigating! Okay, I see what All and Any would do. So do you mean essentially that in my Pipeline, instead of screen=QTradableStocksUS(), I should set screen=All(inputs=[QTradableStocksUS()], window_length=500). But that raises a NonWindowSafeInput error when I run it. So am I misunderstanding? Thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5afb21e24761cf625254fdc1' id='5afb21e24761cf625254fdc1'>
<a href='#5afb21e24761cf625254fdc1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1526407650000' class='quanto-date posted-at response-posted-at' href='#5afb21e24761cf625254fdc1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Ja,</p>

<p>That&#39;s a bug we just fixed that should be on the platform in a day or two.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b040e857a75686ee6300a8d' id='5b040e857a75686ee6300a8d'>
<a href='#5b040e857a75686ee6300a8d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/579a46604da9873c150005f1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/214bcc4fd09ef2a5168b79def547fe1d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/579a46604da9873c150005f1'>Ja Lo</a>
</div>
<a UTCms='1526992517000' class='quanto-date posted-at response-posted-at' href='#5b040e857a75686ee6300a8d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas,</p>

<p>Thanks for following up. Indeed, it looks like it works as intended now.</p>

<p>Thanks,<br>
Jakob  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b058a3fefc0a1003e67ea62' id='5b058a3fefc0a1003e67ea62'>
<a href='#5b058a3fefc0a1003e67ea62'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5af9a7ff6d88c800444f678c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8f80edcdf4435f9d7f6181b2e7631b6d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5af9a7ff6d88c800444f678c'>Jude Shavlik</a>
</div>
<a UTCms='1527089727000' class='quanto-date posted-at response-posted-at' href='#5b058a3fefc0a1003e67ea62'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;ve read about 1000 Quantopian messages and web pages and didn&#39;t see an answer to the following question, so I am posting:</p>

<p>Does the backtester support a &#39;burn in&#39; phase?<br>
   That is, can one collect training data for N days before making predictions?</p>

<p>(I can get that to occur using an initial call to history() by simply going far enough back,<br>
    and then doing my own sliding-window calculations, but (apparently) not with pipeline() and using built-in factors and Fundamentals.)</p>

<p>I can get a &#39;burn in&#39; to happen with pipeline by:</p>

<pre><code>    def before_trading_start(context, data):  
      ...  
     context.countOfTradingDays += 1  
     fillExamplesInCircularArray(context, data) # Store today&#39;s pipeline data, keeping the last context.historySize days of results.  
     if context.countOfTradingDays &gt;= context.historySize : create_model(context, data) # After the burn-in phase, (re)train daily (or use whatever period one wants).

def trade(context, data): #This is referenced in a call to schedule_function in initialize.  
     if context.countOfTradingDays &lt; context.historySize: return # Don&#39;t trade until the burn-in phase completes.  
    ...
</code></pre>

<p>To collect, process, and store a year&#39;s data on a daily basis (ie, N = historySize = 252) for Q500US only takes about two minutes, but the weakness is that the GUI for the backtester assumes I am &#39;all cash&#39; for the first year.</p>

<p>It would be nice if the backtester supported NOT STARTING the GUI (and its calculation of RETURNS, the benchmark&#39;s returns, etc) until the &#39;burn in&#39; phase completed (with, say a 10 minute &#39;cpu time&#39; limit on burn-in).  Seems a reasonably straightforward change to the tester code.  It is natural (and standard) to collect some historical data before &#39;fielding&#39; an ML system - no need (in most cases) to make &#39;real&#39; predictions until one has a good amount of historical data for initial training.  (I can correct myself the calculations reported in the backtester&#39;s GUI, but if I entered a contest, then I could not use this &#39;burn in&#39; idea, plus it would be nice if the backtester&#39;s GUI supported the burn-in idea since it seems natural.)</p>

<p>Thanks,<br>
Jude<br>
```</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b060d2c57ac15004e3d9d71' id='5b060d2c57ac15004e3d9d71'>
<a href='#5b060d2c57ac15004e3d9d71'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/579a36dd3acd1a32c40004d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d6a71d3cfc8ede36599c82d881730c49?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/579a36dd3acd1a32c40004d0'>chadwick adebiyi</a>
</div>
<a UTCms='1527123244000' class='quanto-date posted-at response-posted-at' href='#5b060d2c57ac15004e3d9d71'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I tried to use the universe = Any(inputs=[QTradableStocksUS()], window_length=500)  as stated above, but I got an error saying Any is not defined.  What do I need to import to get Any and All defined?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b0678402bbba10045b545c5' id='5b0678402bbba10045b545c5'>
<a href='#5b0678402bbba10045b545c5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1527150656000' class='quanto-date posted-at response-posted-at' href='#5b0678402bbba10045b545c5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><code>from quantopian.pipeline.filters import All, Any</code></p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b06982618cff676652eae73' id='5b06982618cff676652eae73'>
<a href='#5b06982618cff676652eae73'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/598a1a0d40da7032bc27e6f6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3d7776b021cbcd0f62b56acb7de7a354?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/598a1a0d40da7032bc27e6f6'>Ivory Ant</a>
</div>
<a UTCms='1527158822000' class='quanto-date posted-at response-posted-at' href='#5b06982618cff676652eae73'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I tried this with 3 factors that have alphas of about [0.10, 0.10, 0.05] which, when combined by simply ranking and summing them, have about ~1.3 sharp and 4% returns.</p>

<p>When hand-picking and combining just the 2 best factors I get ~1.8 Sharp and 7% returns, but the ML algo doesn&#39;t seem to be able to discover that these two combined are the best, since when I run it (with different hyper parameters), I often just get between -4% and +1% returns.</p>

<p>Has anyone that tried this with actual alpha factors been able to verify it works at all?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b069d1b2bbba10f52b545ca' id='5b069d1b2bbba10f52b545ca'>
<a href='#5b069d1b2bbba10f52b545ca'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1527160091000' class='quanto-date posted-at response-posted-at' href='#5b069d1b2bbba10f52b545ca'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Ivory: I think Luca&#39;s analysis above (<a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm?utm_campaign=machine-learning-on-quantopian-part-3-building-an-algorithm&utm_medium=email&utm_source=forums#5aa480f9493f3f001d9f01d8">https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm?utm_campaign=machine-learning-on-quantopian-part-3-building-an-algorithm&amp;utm_medium=email&amp;utm_source=forums#5aa480f9493f3f001d9f01d8</a>) is the best test currently.</p>

<p>What classifier did you use? If it&#39;s a non-linear one it could overfit so I would try a linear one and look at what it&#39;s learning.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b06c1b657ac1500423da8be' id='5b06c1b657ac1500423da8be'>
<a href='#5b06c1b657ac1500423da8be'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/579a36dd3acd1a32c40004d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d6a71d3cfc8ede36599c82d881730c49?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/579a36dd3acd1a32c40004d0'>chadwick adebiyi</a>
</div>
<a UTCms='1527169462000' class='quanto-date posted-at response-posted-at' href='#5b06c1b657ac1500423da8be'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I am still see the NonWindowSafeInput error when I use the universe = Any(inputs=[QTradableStocksUS()], window_length=500) syntax.  The error I got is as follows:<br>
NonWindowSafeInput: Can&#39;t compute windowed expression Any((PrecomputedFilter(NumExprFilter(...), name=&#39;QTradableStocksUS_<strong>version_1&#39;),), window_length=500) with windowed input PrecomputedFilter(NumExprFilter(...), name=&#39;QTradableStocksUS</strong>_version_1&#39;).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b06db6cf9afa40047e52748' id='5b06db6cf9afa40047e52748'>
<a href='#5b06db6cf9afa40047e52748'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/579a46604da9873c150005f1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/214bcc4fd09ef2a5168b79def547fe1d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/579a46604da9873c150005f1'>Ja Lo</a>
</div>
<a UTCms='1527176044000' class='quanto-date posted-at response-posted-at' href='#5b06db6cf9afa40047e52748'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Chadwick,</p>

<p>I find that All and Any works now. However, I find that some features raise a NonWindowSafeInput, such as market cap or earnings yield, unless they are only used in ranked form. Could this be happening to you?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b084e8405acf6210da1339e' id='5b084e8405acf6210da1339e'>
<a href='#5b084e8405acf6210da1339e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57993953f10674de8a0002e0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/99239a400c861028e2d4c1519a0e4157?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57993953f10674de8a0002e0'>Jared Praniewicz</a>
</div>
<a UTCms='1527271044000' class='quanto-date posted-at response-posted-at' href='#5b084e8405acf6210da1339e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Do we have a timeline for tensorflow/keras/theano...anything more robust than sklearn?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b0de4b917748d7c34cb9759' id='5b0de4b917748d7c34cb9759'>
<a href='#5b0de4b917748d7c34cb9759'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5671dc968b7b30b7a600022b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3b0450cad6b0451834af6778d5a6afb6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5671dc968b7b30b7a600022b'>Pej H</a>
</div>
<a UTCms='1527637177000' class='quanto-date posted-at response-posted-at' href='#5b0de4b917748d7c34cb9759'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I was hoping we would see an integration with Compellon 20|20. Blows tensorflow/keras away and doesn&#39;t require a heavy coding background...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b23d29a85bc7050eac85701' id='5b23d29a85bc7050eac85701'>
<a href='#5b23d29a85bc7050eac85701'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1529074330000' class='quanto-date posted-at response-posted-at' href='#5b23d29a85bc7050eac85701'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Does anybody work/play with <a href="https://numer.ai">numerai</a> ? What you have to do there is exactly what the ML factor here tries to achieve: find combination of predictive features  (the equivalent of input factors for ML) that explain the training data and use them to predict the future.  It is really the same goal of ML factor and you have to face the same problems (but there are also many differences in the details).  What is interesting is that sometimes I use numerai ideas on Quantopian and some other times I do the opposite. It is surprising how changing the context helps you thinking at new solutions for the same problem. </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b23e236c2fc720048238a5e' id='5b23e236c2fc720048238a5e'>
<a href='#5b23e236c2fc720048238a5e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529078326000' class='quanto-date posted-at response-posted-at' href='#5b23e236c2fc720048238a5e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I do. Q and Numerai are similar in the sense that they are both crowd sourced hedge funds. The difference is that Numerai provides authors with encrypted blind data and algo authors are free to use whatever predictive quantitative method or techniques they choose with whatever computing power and resources available to them. Q, on the other hand, provides authors with free commercial grade data, limited analytical tools and computational resources within the confines of their trading environment and framework.</p>

<p>As a concrete example, in Numerai, I employ a multilayered deep neural networks algo written in python using Keras/Tensorflow library that is run in GPU powered servers in a cloud for compute power. I don&#39;t think Q&#39;s framework can handle this kind of ML algo.</p>

<p>In the context of ML algos, Q&#39;s current framework and limited compute time allocation per algo/user does not make it suitable to churn out meaningful results. While ML may be in their future pipeline, it is not a priority. Their focus is to fulfill their investors objective which is the low volatility/risk market neutral equity fund through their allocation process.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b23e54ee3821a004512c43c' id='5b23e54ee3821a004512c43c'>
<a href='#5b23e54ee3821a004512c43c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1529079118000' class='quanto-date posted-at response-posted-at' href='#5b23e54ee3821a004512c43c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>What I found limiting on Numerai  is that we are given only a small amount of validation tests to verify our model.  On the other hand Quantopian has plenty of out of sample data and we can test the ML model with both Alphalens or running an algorithm. This is much more interesting.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b23e713e3821a004b12c43d' id='5b23e713e3821a004b12c43d'>
<a href='#5b23e713e3821a004b12c43d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1529079571000' class='quanto-date posted-at response-posted-at' href='#5b23e713e3821a004b12c43d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The other open question is where the &quot;magic&quot; resides, whether it&#39;s in creating new features or the combination of features. Quantopian allows you to work on both parts (although it&#39;s true that the capabilities to do state-of-the-art combination are still limited on the platform).  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b25d019cc950a004ae1a920' id='5b25d019cc950a004ae1a920'>
<a href='#5b25d019cc950a004ae1a920'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5ab478d0fd839131a0649cad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/146e263702502bab3a2ff55c714ba121?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5ab478d0fd839131a0649cad'>Ryan Tremblay</a>
</div>
<a UTCms='1529204761000' class='quanto-date posted-at response-posted-at' href='#5b25d019cc950a004ae1a920'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas last July you stated that Quantopian was using version 0.16.1 of scikit-learn. It looks like this is still the case today (making it an <em>even older</em> version now)? When will this be upgraded? I&#39;d love to experiment with sklearn.neural_network.*, but this is not supported in the very old version of scikit-learn used on Quantopian.   </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b9b80c2a19c4e56a723ae6f' id='5b9b80c2a19c4e56a723ae6f'>
<a href='#5b9b80c2a19c4e56a723ae6f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1536917698000' class='quanto-date posted-at response-posted-at' href='#5b9b80c2a19c4e56a723ae6f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I&#39;ve concluded that the alpha combination step (which would include the kind of ML approach you illustrate above) should be done in <code>before_trading_start</code> where one has access to a full 5 minutes per trading day (or even within <code>handle_data</code> where 50 secs. are allocated).  Is this correct?  Or is there a compelling reason to do alpha combination in Pipeline (where for back testing, there is a rather severe time limitation, due to chunking)?</p>

<p>If I understand how Pipeline works, this would also decouple the potentially variable data loads from any heavy-duty alpha combination computations.  If grabbing chunks of data from a database gets bogged down (e.g. because multiple algos are trying to get data from the same database at the same time), I wouldn&#39;t want to take a hit on my ability to do computations.</p>

<p>I&#39;ve also concluded that rather than using a global to get the trailing data out of Pipeline (you&#39;d suggested this above), one can simply add column labels corresponding to the trailing days, as I describe <a href="https://www.quantopian.com/posts/alpha-factor-combination-in-pipeline-how-to-fancify-it#5b9b7a52a19c4e004123b1c5" rel="nofollow">here</a>.</p>

<p>Then, I think one is left with something like a 20-hour backtest time limit, plus whatever memory limitations are imposed.</p>

<p>Correct?  Am I on the right track?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b9b8b616b2aff7660d3d52b' id='5b9b8b616b2aff7660d3d52b'>
<a href='#5b9b8b616b2aff7660d3d52b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1536920417000' class='quanto-date posted-at response-posted-at' href='#5b9b8b616b2aff7660d3d52b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;m not quite sure in which timeout pipeline runs.<br>
And yes, turning the dataframe into a one-row-columns-only-format, while not great, is probably better than a global variable.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b9b96c46b2aff0048d3d8ed' id='5b9b96c46b2aff0048d3d8ed'>
<a href='#5b9b96c46b2aff0048d3d8ed'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1536923332000' class='quanto-date posted-at response-posted-at' href='#5b9b96c46b2aff0048d3d8ed'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>You could talk with your peeps at Q...I recall that there is now a 10 minute timeout for Pipeline, and <code>before_trading_start</code> no longer runs Pipeline...it is basically a 5 minute compute window, prior to the open.</p>

<p>Thanks,</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b9b9e82e80dfa00462649ad' id='5b9b9e82e80dfa00462649ad'>
<a href='#5b9b9e82e80dfa00462649ad'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1536925314000' class='quanto-date posted-at response-posted-at' href='#5b9b9e82e80dfa00462649ad'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s my take on that <a href="https://www.quantopian.com/posts/downloading-historical-fundamental-data-in-ide-backtester#5b9b9d0be80dfa004b2649d4" rel="nofollow">limitations of Q MLalgo</a></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b9cff9a3e54a1004eff76df' id='5b9cff9a3e54a1004eff76df'>
<a href='#5b9cff9a3e54a1004eff76df'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1537015706000' class='quanto-date posted-at response-posted-at' href='#5b9cff9a3e54a1004eff76df'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas -</p>

<p>I&#39;d be interested in how Pipeline and its output work from a memory standpoint.  If I output the alphas, etc. to <code>before_trading_start</code> to do the alpha combination there, does it effectively double the amount of memory used (since perhaps I&#39;d be copying whatever is in Pipeline to the algo itself)?  Or is the memory in Pipeline effectively freed up prior to the transfer?</p>

<p>I&#39;m assuming here that there is an overall memory constraint for an algo, shared across Pipeline and the algo itself.  But if they are separate, then maybe doesn&#39;t matter?</p>

<p>EDIT - Not sure how to articulate it, but I&#39;m wondering how the chunking works with respect to memory management?  One could imagine that there is input buffering, computations, output buffering and then the memory could be freed up for the algo.  Ideally, after a chunked Pipeline cycle, one would be left with only data in an output buffer, with pointers provided to the algo.  Other memory that was required to run Pipeline over the chunk would be freed up to be used by the algo (obviously, Pipeline doesn&#39;t run in parallel with the algo, since the algo pauses for chunking, so it would seem that the memory could be freed up for the algo, no?).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cd70767ba91bf004a1a65a6' id='5cd70767ba91bf004a1a65a6'>
<a href='#5cd70767ba91bf004a1a65a6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5caa0c949664760044a7b855'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5409a3c8ada5bb2cad89ca500b5b40ae?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5caa0c949664760044a7b855'>Zaha Crou</a>
</div>
<a UTCms='1557596007000' class='quanto-date posted-at response-posted-at' href='#5cd70767ba91bf004a1a65a6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi guys,<br>
I want to predict prices instead of returns, is it possible ? any help please  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ce2c0431a68a6004a00f17c' id='5ce2c0431a68a6004a00f17c'>
<a href='#5ce2c0431a68a6004a00f17c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1558364227000' class='quanto-date posted-at response-posted-at' href='#5ce2c0431a68a6004a00f17c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Zaha,</p>

<p>Yes, you would just need to replace the pipeline output of Returns with prices. However, note that this will introduce all kinds of problems with non-stationarity and adjustments, so I would advise against that unless you had some compelling reason.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5ce57a4f2084310046c7c576' id='5ce57a4f2084310046c7c576'>
<a href='#5ce57a4f2084310046c7c576'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571392f768facb766b000064'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bd5059e9b6bf0bae2dbb6ab4296f8686?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571392f768facb766b000064'>Kevin Yang</a>
</div>
<a UTCms='1558542927000' class='quanto-date posted-at response-posted-at' href='#5ce57a4f2084310046c7c576'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas, Thanks for sharing the fantastic method. The classification model would be different for different stocks, so we basically train about 1000 models everyday/every week. Is it possible to train one model for all the stocks to reduce the computational cost? Thanks!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ce66b6b1ffc07004261acff' id='5ce66b6b1ffc07004261acff'>
<a href='#5ce66b6b1ffc07004261acff'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1558604651000' class='quanto-date posted-at response-posted-at' href='#5ce66b6b1ffc07004261acff'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This trains a single model for each period (monthly I think in this case) across all stocks cross-sectionally.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5ce6a02de9b1085279fe9278' id='5ce6a02de9b1085279fe9278'>
<a href='#5ce6a02de9b1085279fe9278'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571392f768facb766b000064'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bd5059e9b6bf0bae2dbb6ab4296f8686?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571392f768facb766b000064'>Kevin Yang</a>
</div>
<a UTCms='1558618157000' class='quanto-date posted-at response-posted-at' href='#5ce6a02de9b1085279fe9278'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks so much, Thomas! Is it because in this line</p>

<pre><code>def _train_model(self, today, returns, inputs):  
</code></pre>

<p>we do not have assets in the bracket? </p>

<p>If we have </p>

<pre><code>def _train_model(self, today, assets, returns, inputs):  
</code></pre>

<p>then we train one model for one stock?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ce7ac7f0a98f70048fc9be0' id='5ce7ac7f0a98f70048fc9be0'>
<a href='#5ce7ac7f0a98f70048fc9be0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1558686847000' class='quanto-date posted-at response-posted-at' href='#5ce7ac7f0a98f70048fc9be0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>No, the assets have to be in there as it&#39;s part of the calling signature of a pipeline. Take a closer look at what goes on inside the function, there is no loop over assets. Hope that helps!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5ce80e20e48a4e5c216ac904' id='5ce80e20e48a4e5c216ac904'>
<a href='#5ce80e20e48a4e5c216ac904'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571392f768facb766b000064'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bd5059e9b6bf0bae2dbb6ab4296f8686?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571392f768facb766b000064'>Kevin Yang</a>
</div>
<a UTCms='1558711840000' class='quanto-date posted-at response-posted-at' href='#5ce80e20e48a4e5c216ac904'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks so much, Thomas! I think I misunderstand how the customer factors were constructed.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5d192fbb52675b003fb83411' id='5d192fbb52675b003fb83411'>
<a href='#5d192fbb52675b003fb83411'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5578ccc48fd93c0c2e0008c2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7863e091ea0a3aabca6478875fffb442?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5578ccc48fd93c0c2e0008c2'>German Hernandez</a>
</div>
<a UTCms='1561931707000' class='quanto-date posted-at response-posted-at' href='#5d192fbb52675b003fb83411'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas </p>

<p>I am trying to write an analysis  notebook and an algorithm template for my students that uses  a linear regression predictor of the return PRED_N_FORWARD_DAYS as  the combined_factor for the <a href="https://www.quantopian.com/algorithms/5d14d0dace2ee337d7289254" rel="nofollow">Cross-sectional Equity Template</a> included in the examples. </p>

<p>I use the segments of code  form  your  great post <a href="https://www.quantopian.com/posts/machine-learning-on-quantopian-part-3-building-an-algorithm" rel="nofollow">Machine Learning on Quantopian Part 3: Building an Algorithm - Thomas Wiecki</a>  and  form the great post <a href="https://www.quantopian.com/posts/how-to-leverage-the-pipeline-to-conduct-machine-learning-in-the-ide" rel="nofollow">How to Leverage the Pipeline to Conduct Machine Learning in the IDE   Jim Obreen</a> to build the ML(CustomFactor) and the pipeline. </p>

<p>To analyse  the training input data x and training output data  y I used pipelines for  a testing day 2019-01-07 (25 days for  training input data x  from 2018-11-27 to 2018-12-31) and (25 days for  training output data x  from 2018-12-04 to testing day 2019-01-07) . I notice that the number of  training inputs is  49730 different from number of  training outputs is  47401. I tried removing the QTradableStocksUS filter the numbers increase but they are still different.  </p>

<ul>
<li>To plot x vs. y and get a flavor of the relationship I  sliced the last part of x to  but I am sure that the inputs and output  ar not aligned. How can I solve this problem?<br></li>
<li>It seems that the inputs in the ML(CustomFactor) do no have this problem, why ?</li>
</ul>

<p>PD The <a href="https://github.com/gjhernandezp/AT/blob/master/Analysis%20Regression%20Cross-sectional%20Equity%20Template%20.ipynb" rel="nofollow">Notebook</a> is posted in github </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5de2f43901cbcf53892592a4' id='5de2f43901cbcf53892592a4'>
<a href='#5de2f43901cbcf53892592a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58d5636b600675420193ebcf'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/11cbaa7e11ceffe6c4bdece0f0ddad4c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58d5636b600675420193ebcf'>Jack B.</a>
</div>
<a UTCms='1575154745000' class='quanto-date posted-at response-posted-at' href='#5de2f43901cbcf53892592a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas,</p>

<p>I have 2 questions related to your codes:</p>

<p>A. Is there a bug in the following factor ( parenthesis location) ? or I miss something...</p>

<p>class AdvancedMomentum(CustomFactor):<br>
    inputs = (USEquityPricing.close, Returns(window_length=126))<br>
    window_length = 252</p>

<pre><code>def compute(self, today, assets, out, prices, returns):  
    np.divide(  
        (  
            (prices[-21] - prices[-252]) / prices[-252] -  
            prices[-1] - prices[-21]  
        ) / prices[-21],  
        np.nanstd(returns, axis=0),  
        out=out,  
    )
</code></pre>

<p>==&gt; I assume you mean:
class AdvancedMomentum(CustomFactor):<br>
    inputs = (USEquityPricing.close, Returns(window_length=126))<br>
    window_length = 252</p>

<pre><code>def compute(self, today, assets, out, prices, returns):  
    np.divide(  
            (prices[-21] - prices[-252]) / prices[-252] -  
            (prices[-1] - prices[-21]) / prices[-21],  
        np.nanstd(returns, axis=0),  
        out=out,  
    )
</code></pre>

<p>B. in def shift_mask_data(), I am just wondering whether dropping stocks which don&#39;t move much from training set might affect the prediction result?</p>

<p>Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f1dc4dd267ed9000e7f3411' id='5f1dc4dd267ed9000e7f3411'>
<a href='#5f1dc4dd267ed9000e7f3411'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5900ca8048007d00103606c6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/53f017b6ac53938f9bf4a77330ff80aa?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5900ca8048007d00103606c6'>Pier-Olivier Marquis</a>
</div>
<a UTCms='1595786461000' class='quanto-date posted-at response-posted-at' href='#5f1dc4dd267ed9000e7f3411'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Why are returns being shifted by n_forward_days + 1? If we calculate the returns for 5 days, then the 6th element will contain the return for day 5 to 6, which could then shifted backward by 5 days.  Why + 1?  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/machine-learning-on-quantopian-part-3-building-an-algorithm'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/machine-learning-on-quantopian-part-3-building-an-algorithm'>join Quantopian</a> to
post a reply.
</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#b5d3d0d0d1d7d4d6def5c4c0d4dbc1dac5dcd4db9bd6dad8">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
