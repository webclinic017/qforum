<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Trend follow algo
</title>
<meta content='This algo is a trend follow for major asset class ETFs.   Since beta can be high when the stock is in clear up-trend of down-trend, this algo may not be suitable for the contest.   I am sharing it because it may be useful for individual accounts.  For that reason, the leverage is 0.9 to be safe.' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="RH+DBHib2DzCKEbYmlLofxH6QFcmGXyBiaGQwiE5oOc4GfVJ2m0K33s1H+nVvUALKXRjPlzVaZoLrkuoi3zCXA==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=true;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/trend-follow-algo' property='og:url'>
<meta content='Trend follow algo' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/trend-follow-algo' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Trend follow algo' property='og:title'>
<meta content='This algo is a trend follow for major asset class ETFs.   Since beta can be high when the stock is in clear up-trend of down-trend, this algo may not be suitable for the contest.   I am sharing it because it may be useful for individual accounts.  For that reason, the leverage is 0.9 to be safe.' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/trend-follow-algo">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='56011d48a2d376787c0005c5'>
<div class='post-container' data-post-id='56011d48a2d376787c0005c5' id='56011d48a2d376787c0005c5'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Trend follow algo</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/547d2f170670d7d65b000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/30848b3ee4a99b954f8c97ddedf3f3b3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/547d2f170670d7d65b000166'>Naoki Nagai</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1442913608000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Trend follow algo&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Ftrend-follow-algo%3Futm_source%3Dwebsite_share%26utm_campaign%3Dtrend-follow-algo%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Ftrend-follow-algo%3Futm_source%3Dwebsite_share%26utm_campaign%3Dtrend-follow-algo%26utm_medium%3Dlinkedin&amp;title=Trend+follow+algo+%28Naoki+Nagai%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Momentum' data-tag-id='55c50e7d8d4710ec6e00000c' href='/posts/tag/Momentum/newest'>Momentum</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Show Q' data-tag-id='55c50e7d8d4710ec6e000010' href='/posts/tag/Show-Q/newest'>Show Q</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='ETFs' data-tag-id='55d33f633f6ba10065000001' href='/posts/tag/ETFs/newest'>ETFs</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/trend-follow-algo?utm_source=website_share&amp;utm_campaign=trend-follow-algo&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Naoki Nagai" />
<div class='body-text'>
<div class='body-text-container post-body'><p>This algo is a trend follow for major asset class ETFs.   Since beta can be high when the stock is in clear up-trend of down-trend, this algo may not be suitable for the contest.   I am sharing it because it may be useful for individual accounts.  For that reason, the leverage is 0.9 to be safe.  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>72 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5601422a4132a71fda000676' id='5601422a4132a71fda000676'>
<a href='#5601422a4132a71fda000676'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/526d1b5b3d883a68d90002b4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/55fb4dc63e0f604b41147deb3382d645?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/526d1b5b3d883a68d90002b4'>Chris Hall</a>
</div>
<a UTCms='1442923053000' class='quanto-date posted-at response-posted-at' href='#5601422a4132a71fda000676'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>thanks for sharing. I might trade this one.</p>

<p>Try it with some of the reverse ETFs like SDOW. 50% more return with same drawdown  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5601bedf857df4deb70000cc' id='5601bedf857df4deb70000cc'>
<a href='#5601bedf857df4deb70000cc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/547d2f170670d7d65b000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/30848b3ee4a99b954f8c97ddedf3f3b3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/547d2f170670d7d65b000166'>Naoki Nagai</a>
</div>
<a UTCms='1442954979000' class='quanto-date posted-at response-posted-at' href='#5601bedf857df4deb70000cc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Chris.  The script shorts stocks when it is in down trend, so adding SDOW (3x leveraged short DOW index) may be redundant.   For example, when DOW index is going down, it will short DIA and long SDOW, and it will bet too much (4x) DOW falling compared to all other assets.  On the other hand, it might make sense to add leveraged bond ETFs, even though they are not allowed in the contest, to make it volatile enough compared to equities.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5601fa0a8c03b5e7730000da' id='5601fa0a8c03b5e7730000da'>
<a href='#5601fa0a8c03b5e7730000da'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/555c004c50232f96d200008c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9225b6af74af49503be9b22cdf623bb3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/555c004c50232f96d200008c'>Yagnesh Desai</a>
</div>
<a UTCms='1442970125000' class='quanto-date posted-at response-posted-at' href='#5601fa0a8c03b5e7730000da'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Good clean algo. Useful frame work you have.</p>

<p>Use of regression.! I am loving my stay at Quantopian.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5602c7750755547970000674' id='5602c7750755547970000674'>
<a href='#5602c7750755547970000674'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5238ec17d33ac9b935000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5b2a36599ff3000f5572a3ef4347fa4d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5238ec17d33ac9b935000022'>Tom Austin</a>
</div>
<a UTCms='1443022713000' class='quanto-date posted-at response-posted-at' href='#5602c7750755547970000674'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Naoki,</p>

<p>Thanks very much for sharing this. Agree that it&#39;s super helpful / education for me to see coding and how people are using this.  Your code solved one of my questions about creating large universes of ETF&#39;s and then checking to see if they existed at the time or not, so that I can run max. length backtests.  And all the code is very simple and clean to me (as a novice programmer).  Thanks!</p>

<p>I like the linear regression for trend analysis also. I&#39;ve seen that on other Quantopian systems, but hadn&#39;t seen that much on other platforms I was on.  I would suggest that you use limit or vwap orders on the entries.  Even with large ETF&#39;s, can have very volatility intraminute pricing (and sometimes huge movements) that can lose you a lot of money without that.    A single bad trade could really hurt.  But, that will depend on &#39;time decay&#39; of the pattern.</p>

<p>I am curious if you have studied the &#39;signal decay&#39; (how important is it to get really rapid fills for returns).  If so, how do returns &#39;fall off&#39; with only checking signals once every 3 hours, once a day, once a week, once a month.  If the fall off is large, what causes it? Is it the entries being delayed or the stop loss amounts?   </p>

<p>I am also curious about Universe bias (although the universe feels fair).  How much optimization has gone into the selection of these ETF&#39;s?  Have you run any backtests / studies on various universes that are non-correlated with one another, but tend to &#39;exhibit trend behaviors&#39; to see if it&#39;s a general pattern.   The &#39;ideal&#39; would be to have Universe ETF&#39;s selected &#39;mechanically&#39; based on the degree to which they have trended over the past X period.  So, I would think about a much larger Universe of ETF&#39;s to start.  I did run some tests with a lot more emerging stock market indices in the mix, and the performance was much worse (large DD since 7/2011 or so).  In theory these markets should work well (China, Brazil, Russia, Taiwan, etc).  So, that would be concerning.  </p>

<p>(Some of the indices I mixed in:)
    &#39;FXI&#39;, # My addition below here<br>
        &#39;EWJ&#39;,<br>
        &#39;EWZ&#39;,<br>
        &#39;EWA&#39;,<br>
        &#39;IWM&#39;,<br>
        &#39;IWC&#39;,<br>
        &#39;EWW&#39;, # Mexico<br>
        &#39;EWT&#39;, #Taiwan<br>
        &#39;EWY&#39;, # South Korea<br>
        &#39;RSX&#39;, #Russia</p>

<p>I am also curious about any stop-loss testing that you did.  Your current rule is pretty cool.  I don&#39;t get it 100%, but see that it&#39;s generally the slope of the regression line modified in some way by time period.   How sensitive are the results to various stop loss amounts and formulas?  I would likely look at a &#39;constraint&#39; for the maximum stop loss.   Have you looked at &#39;volatility based stops&#39; based on the volatility of the position itself and/or of the overall market?  I have sometimes found these effective in the past.  Have you also just looked at flat &#39;percentage based&#39; stop losses that are applied equally to all positions?  Curious what you found.</p>

<p>And how sensitive is the system to slippage assumptions and or various rebalance periods?</p>

<p>There are some markets that I have heard CTA&#39;s say trend more and exhibit more trend like behaviors (i.e. Asian markets and energies), and it might be interesting to test on groups of just them as well - however most CTA&#39;s trade a lot of different strat&#39;s. </p>

<p>It will also be very cool to combine this with more position and risk management logic - i.e. a &#39;constraint based&#39; risk management at the position, total asset class and &#39;market exposure&#39; levels.<br>
These could be done, for example, with an algo that matches the &#39;slope based&#39; position sizing logical with some volatility (risk) constraints per position (so after the initial &#39;linear regression based position sizing is selected it is put into &#39;risk budget&#39; analyzer and re-adjusted - so that it stays within any position size and asset class level constraints).   As well as potentially constrained &#39;beta&#39; for the long and short sides each week or whatever (so there is a max. long and short beta component).  </p>

<p>Most of the pieces for building this exist on the site. </p>

<p>But it&#39;s gonna take me a few weeks to build it.  But thanks a LOT for sharing. </p>

<p>If I get time (won&#39;t be till early next week), I will check and report back on some of this.  I am also curious about &#39;general effectiveness&#39; of the signal versus it only being effective on this basket.   Anyway, those are just some initial thoughts.</p>

<p>Best,<br>
Tom  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5602cdfc045fce94ce000644' id='5602cdfc045fce94ce000644'>
<a href='#5602cdfc045fce94ce000644'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5238ec17d33ac9b935000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5b2a36599ff3000f5572a3ef4347fa4d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5238ec17d33ac9b935000022'>Tom Austin</a>
</div>
<a UTCms='1443024383000' class='quanto-date posted-at response-posted-at' href='#5602cdfc045fce94ce000644'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I am also curious about some position size approaches that might work, such as:<br>
a)  divide the trend line slop by the Abs value of peak DD over the period to get the raw scores (so this is taken into account)<br>
b)  Creating Omega Ratio, Sortino and Information Ratio over the lookback period and then multiplying the trend line by the average of these - so that we have more risk adjusted &#39;trend strength.&#39;  One or several of these should work to give better position sizing results that are taking account of &#39;risk&#39; not just &#39;slope&#39;.<br>
c) Calculate average trailing X period correlations of all &#39;longs&#39; and all &#39;shorts.&#39;  Then adjust (&#39;slope weights&#39;) * (1.5-the average pairwise correlation of the ETF with all other ETF&#39;s) / (peak DD over lookback).  Something like this should work better than A above as it takes into account the recent correlation of the longs with the other longs being bought and the shorts with the other shorts.</p>

<p>Has anyone coded these &#39;basic ratios&#39; yet?  They may not actually work, as the rebalacing of the volatility may be a core piece of the returns and the system would then need vol to achieve best results. Just some ideas.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5603b76c1933725f970003e8' id='5603b76c1933725f970003e8'>
<a href='#5603b76c1933725f970003e8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5602fc3582171762d7000899'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c93542d3516c7937df3ecb22613ac0f1?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5602fc3582171762d7000899'>Can Arel</a>
</div>
<a UTCms='1443084145000' class='quanto-date posted-at response-posted-at' href='#5603b76c1933725f970003e8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Great Job!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56041ccbfd838a8f9800055a' id='56041ccbfd838a8f9800055a'>
<a href='#56041ccbfd838a8f9800055a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54572fa186b4f33f210002dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b9d43d508d4b3cd3cd3c55b6d0e14efb?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54572fa186b4f33f210002dc'>Pierre Warnier</a>
</div>
<a UTCms='1443110095000' class='quanto-date posted-at response-posted-at' href='#56041ccbfd838a8f9800055a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you for sharing this interesting algo.</p>

<p>It seems very sensitive to various parameters:<br>
 - slope_min (BTW I don&#39;t get how you figure it corresponds to 7%)<br>
 - ETF selection: adding VEU, TLT, or SLV worsens the returns considerably</p>

<p>Also context.multiple does not seem to add much to the results versus context.maxlever alone and again, I don&#39;t really get what it does.<br>
In my tests, the performance worsens considerably when I simulate at minute level suggesting maybe the algo is too quick to react?</p>

<p>Any thoughts?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5609c577d9b2b691f30000e1' id='5609c577d9b2b691f30000e1'>
<a href='#5609c577d9b2b691f30000e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/547d2f170670d7d65b000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/30848b3ee4a99b954f8c97ddedf3f3b3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/547d2f170670d7d65b000166'>Naoki Nagai</a>
</div>
<a UTCms='1443480954000' class='quanto-date posted-at response-posted-at' href='#5609c577d9b2b691f30000e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you for comments, every one.  After thinking about your what you all told me, I have rewrote the script. Here you go.<br>
Major changes;</p>

<p>Consider max drawdown - When entering into a position, the algo looks    into max drawdown over lookback (thanks to Tom Austin).  Drawdown    works better than volatility because volatility could also go up when    the stock is trending sharply, but not drawdowns.</p>

<p>Much broader universe - Departing from the original basic ETFs I chose arbitrary (thanks to Tom, Pierre, Chris), I now use top 5%       trading volume universe.  It is free from look ahead bias.</p>

<p>The result yields quite humble return for 10-year, but with impressive low drawdown, even through the financial crisis.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56105b9cf29553b48b000037' id='56105b9cf29553b48b000037'>
<a href='#56105b9cf29553b48b000037'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/529226078b3fba3b2f00042c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/32567044e0f9eb6ba15ba5c477439a6a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/529226078b3fba3b2f00042c'>Adam Preston</a>
</div>
<a UTCms='1443912607000' class='quanto-date posted-at response-posted-at' href='#56105b9cf29553b48b000037'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Naoki,<br>
What would you say are the &quot;optimizeable&quot; parameters in this algo? Could you possibly identify them?</p>

<p>Thanks!<br>
Adam  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5611f7fa65b25c5aae0001bd' id='5611f7fa65b25c5aae0001bd'>
<a href='#5611f7fa65b25c5aae0001bd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5558ffea86d2d08cb20005ec'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/97358675e9a853b95c91e2ce8859d284?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5558ffea86d2d08cb20005ec'>Serge d&#39;Adesky</a>
</div>
<a UTCms='1444018173000' class='quanto-date posted-at response-posted-at' href='#5611f7fa65b25c5aae0001bd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Naoki,</p>

<p>Great script,  elegant code. Thanks for sharing.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='566740a9f5dc4ed91200016b' id='566740a9f5dc4ed91200016b'>
<a href='#566740a9f5dc4ed91200016b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5605220ce5c9b0f79f000463'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0187aeb839dceb9f619c51a037ce5f6b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5605220ce5c9b0f79f000463'>Lucas Severyn</a>
</div>
<a UTCms='1449607341000' class='quanto-date posted-at response-posted-at' href='#566740a9f5dc4ed91200016b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Does the algo only enter new positions on trend change? So if a trend is established already, it won&#39;t jump onto it until the trend changes? Just looking at this bit from the entry section, which requires a cross of price action and regression line to enter a position.</p>

<pre><code> if slope &gt; slope_min and delta[-1] &gt; 0 and delta[-2] &lt; 0 and dd &lt; context.maxdrawdown:  
                context.weights[s] = slope  
                context.drawdown[s] = slope_min  
                log.info(&#39;/     Long  a = %+.2f%% %3s - %s&#39; %(slope*100, s.symbol, s.security_name),gain)  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56675cf23d1c260e9f00026c' id='56675cf23d1c260e9f00026c'>
<a href='#56675cf23d1c260e9f00026c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/547d2f170670d7d65b000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/30848b3ee4a99b954f8c97ddedf3f3b3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/547d2f170670d7d65b000166'>Naoki Nagai</a>
</div>
<a UTCms='1449614582000' class='quanto-date posted-at response-posted-at' href='#56675cf23d1c260e9f00026c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Actually &#39;delta&#39; is the distance between the current price and the trend line, and not the change in trend line slope.</p>

<p>For example (with long position) it does <em>not</em> enter into position when:</p>

<ul>
<li>Trend is established, but price keep going up above and away from trend line (too late to enter)<br></li>
<li>Trend is established, the price crosses the trend line downward.  (wait till it comes up)<br></li>
<li>Trend is established, the price is swinging a lot and crosses the trend line multiple times (because &#39;dd &lt; context.maxdrawdown&#39; will not be FALSE)<br></li>
</ul>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5667627d9bb3f7f64e00000a' id='5667627d9bb3f7f64e00000a'>
<a href='#5667627d9bb3f7f64e00000a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5605220ce5c9b0f79f000463'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0187aeb839dceb9f619c51a037ce5f6b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5605220ce5c9b0f79f000463'>Lucas Severyn</a>
</div>
<a UTCms='1449616005000' class='quanto-date posted-at response-posted-at' href='#5667627d9bb3f7f64e00000a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for clarifying the &#39;delta&#39;. What I mean, is that if the algo is started today, we willl need to wait until trend changes to enter any positions, correct?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5668bccd9ffcfae16e000426' id='5668bccd9ffcfae16e000426'>
<a href='#5668bccd9ffcfae16e000426'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/550b97655b83ee32fd000132'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1f9775d029ff45e78e133f3379a9299a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/550b97655b83ee32fd000132'>Tristan Rhodes</a>
</div>
<a UTCms='1449704659000' class='quanto-date posted-at response-posted-at' href='#5668bccd9ffcfae16e000426'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Naoki, thanks for sharing this algo.  And thank you for making it easy to understand.  I have learned a lot by reading your algo, and it has given me more ideas to try.  At the very least, my Python skills are slowly improving!  :)</p>

<p>BTW, I have copied your &quot;get_gain&quot; function to a Github community site that I have started.  I hope you don&#39;t mind!</p>

<p><a href="https://github.com/tristanbob/Quantopian-Community">https://github.com/tristanbob/Quantopian-Community</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='566d0580ddc13029a20003f1' id='566d0580ddc13029a20003f1'>
<a href='#566d0580ddc13029a20003f1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5558ffea86d2d08cb20005ec'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/97358675e9a853b95c91e2ce8859d284?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5558ffea86d2d08cb20005ec'>Serge d&#39;Adesky</a>
</div>
<a UTCms='1449985412000' class='quanto-date posted-at response-posted-at' href='#566d0580ddc13029a20003f1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Naoki</p>

<p>I&#39;m really impressed with this algo for larger time frames. I was curious to see how it would perform on intraday trading, using minute bars, and  obviously using different values for the context variables. I figured I would have to tweak it considerably to reduce the very high friction due to bid/ask spreads, but still expected to get moderately positive gains.</p>

<p>Unfortunately, I seem to be doing something very wrong, as it is buying and selling way beyond the limits of the portfolio. This despite your implementation of the  &quot;order_target&quot; as opposed to &quot;order&quot; criteria.</p>

<p>I suspect the problem lies in  the loop that runs every 15 minutes shown below. </p>

<pre><code> for i in range(total_minutes):  
        # Every 15 minutes run schedule  
        if i % 15 == 0:  
          # This will start at 9:31AM and will run every 15 minutes  
          schedule_function(regression, date_rules.every_day(),  time_rules.market_open(minutes=1))  
          schedule_function(trade, date_rules.every_day(),  time_rules.market_open(minutes=1))  
          schedule_function(trail_stop, date_rules.every_day(),  time_rules.market_open(minutes=1))  
          schedule_function(execute, date_rules.every_day(),  time_rules.market_open(minutes=1))  
    ```  
I will struggle with this further, but perhaps you are curious yourself and / or have already successfully dealt with this issue.

By the way, as you can see in the code, I intended to introduce a &quot;limit&quot; order as I have had bad experiences in day trading when dealing with market orders. I had to comment that part of code out because my limits were getting set to 0.00, which resulted in no orders ever getting placed. It&#39;s probably fairly trivial to decode that , so I&#39;ll get to that later.

I look forward to any hints/suggestions you may have.  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='566e0fe30963ab1c1e0001e8' id='566e0fe30963ab1c1e0001e8'>
<a href='#566e0fe30963ab1c1e0001e8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/547d2f170670d7d65b000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/30848b3ee4a99b954f8c97ddedf3f3b3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/547d2f170670d7d65b000166'>Naoki Nagai</a>
</div>
<a UTCms='1450053606000' class='quanto-date posted-at response-posted-at' href='#566e0fe30963ab1c1e0001e8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>You might have already figured it out, but you forgot to add the &#39;i&#39; here.  </p>

<pre><code>          schedule_function(regression, date_rules.every_day(),  time_rules.market_open(minutes=i+1))  
          schedule_function(trade, date_rules.every_day(),  time_rules.market_open(minutes=i+1))  
          schedule_function(trail_stop, date_rules.every_day(),  time_rules.market_open(minutes=i+1))  
          schedule_function(execute, date_rules.every_day(),  time_rules.market_open(minutes=i+1))  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='566e4c36da078697f40003aa' id='566e4c36da078697f40003aa'>
<a href='#566e4c36da078697f40003aa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1450069053000' class='quanto-date posted-at response-posted-at' href='#566e4c36da078697f40003aa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Noticed something that makes an opportunity for a sidenote tip: You can see in the code that the metrics, like those above the chart in the IDE (or full backtest too) are copyable, good for everyone to know. Now, taking that another step, can copy/paste the metrics and also apply a macro to them in an editor for like:<br>
tr121.3%  br118.8%  a0.05  b0.29  sh0.72  s0.88  ir0.02  v0.10  d16.7%  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='566f69d29d90b868de000264' id='566f69d29d90b868de000264'>
<a href='#566f69d29d90b868de000264'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5558ffea86d2d08cb20005ec'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/97358675e9a853b95c91e2ce8859d284?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5558ffea86d2d08cb20005ec'>Serge d&#39;Adesky</a>
</div>
<a UTCms='1450142166000' class='quanto-date posted-at response-posted-at' href='#566f69d29d90b868de000264'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Naoki,</p>

<p>Good catch. That did the trick. Of course, as I suspected it does not make money on intraday, but I want to isolate this further, because if you<br>
eliminate all friction and trading costs, in theory it should be profitable, yet it is not. I&#39;ll play around with my variable settings and let you know how I fare.</p>

<p>Thanks again.</p>

<p>Serge  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56946f597855e2420f000425' id='56946f597855e2420f000425'>
<a href='#56946f597855e2420f000425'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5617f96aa8e03d758000076e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/494daee3e64dd6a51af88b4e5939d3de?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5617f96aa8e03d758000076e'>Nicolas Y</a>
</div>
<a UTCms='1452568415000' class='quanto-date posted-at response-posted-at' href='#56946f597855e2420f000425'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for sharing, Naoki. </p>

<p>What&#39;s the motivation of setting the weight to be slope(ontext.weights[s] = slope)?  is it a magic number?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5697d7c279e37c30a20000e5' id='5697d7c279e37c30a20000e5'>
<a href='#5697d7c279e37c30a20000e5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5673f0630a6bfa534b00000d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/147dbb7c6d5789fd351a368486558c2a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5673f0630a6bfa534b00000d'>Giuseppe Moriconi</a>
</div>
<a UTCms='1452791752000' class='quanto-date posted-at response-posted-at' href='#5697d7c279e37c30a20000e5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello and first of all Thanks for Sharing!</p>

<p>I am trying to analize the algo and maybe this can help someone, i wanted to visualize the value used as a momentum indicator ( <strong>slope</strong> )<br>
So this is my first question: why you consider  <strong>a/b</strong> and not just the slope <strong>a</strong>?</p>

<p>(just SPY in this first notebok )</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5697eb9dfd6e6323ab000154' id='5697eb9dfd6e6323ab000154'>
<a href='#5697eb9dfd6e6323ab000154'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/547d2f170670d7d65b000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/30848b3ee4a99b954f8c97ddedf3f3b3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/547d2f170670d7d65b000166'>Naoki Nagai</a>
</div>
<a UTCms='1452796835000' class='quanto-date posted-at response-posted-at' href='#5697eb9dfd6e6323ab000154'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In this algo I used a/b to be the <em>slope</em> to normalize the price difference.</p>

<p>Stock X: If it is at $100 at day 0, went up average of 1% per day. <em>a</em> will be 1.0 and <em>b</em> will be 100.   <em>a/b</em> will be 0.01.<br>
Stock Y: If it is at $10  at day 0, went up average of 2% per day.   <em>a</em> will be 0.2 and <em>b</em> will be 10.  <em>a/b</em> will be 0.02.</p>

<p>From the <em>slope = a/b</em>, you can tell Stock Y is trending up twice more than Stock X.   The algo then put more weight on Stock Y than Stock X by applying  </p>

<pre><code>context.weights[s] = slope  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56981b98a08b9590aa00016a' id='56981b98a08b9590aa00016a'>
<a href='#56981b98a08b9590aa00016a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5673f0630a6bfa534b00000d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/147dbb7c6d5789fd351a368486558c2a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5673f0630a6bfa534b00000d'>Giuseppe Moriconi</a>
</div>
<a UTCms='1452809119000' class='quanto-date posted-at response-posted-at' href='#56981b98a08b9590aa00016a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This example is perfectly clear thank you very much -Giuseppe  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56a8c5d9953826d4f60003a9' id='56a8c5d9953826d4f60003a9'>
<a href='#56a8c5d9953826d4f60003a9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562a1289674f851bcb0004e2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d5bd698ff611c488050f57c663ac725a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562a1289674f851bcb0004e2'>Lake Austin</a>
</div>
<a UTCms='1453901279000' class='quanto-date posted-at response-posted-at' href='#56a8c5d9953826d4f60003a9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>well-written and brilliant algo! Thanks for sharing!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56a8d8930e9a9910970005a4' id='56a8d8930e9a9910970005a4'>
<a href='#56a8d8930e9a9910970005a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5394bbbdeee25762d2000102'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0af1296044050e221f0e9a9593dee746?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5394bbbdeee25762d2000102'>Daniel C. Place</a>
</div>
<a UTCms='1453906075000' class='quanto-date posted-at response-posted-at' href='#56a8d8930e9a9910970005a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Naoki - Great and simple code! Thanks for sharing! Have you tried trading it live?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56b5602fe6c3bfb4ee000538' id='56b5602fe6c3bfb4ee000538'>
<a href='#56b5602fe6c3bfb4ee000538'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5657a09af95a18caf600085a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cb7ba84227ef79495f4a09f8bf9aea38?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5657a09af95a18caf600085a'>Adam Smith</a>
</div>
<a UTCms='1454727219000' class='quanto-date posted-at response-posted-at' href='#56b5602fe6c3bfb4ee000538'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Naoki - I really enjoy your algo and the backtests look very promising.  I am going to put it for live trading soon. However, my paper trading result shows it requires at least two months to &quot;warm up&quot; before it starts to place the first trade.<br>
Do you have any suggestion how to reduce this period for this algo?<br>
Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56b7e964a8e886b2550000e4' id='56b7e964a8e886b2550000e4'>
<a href='#56b7e964a8e886b2550000e4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/547d2f170670d7d65b000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/30848b3ee4a99b954f8c97ddedf3f3b3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/547d2f170670d7d65b000166'>Naoki Nagai</a>
</div>
<a UTCms='1454893416000' class='quanto-date posted-at response-posted-at' href='#56b7e964a8e886b2550000e4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>A way to &quot;warm it up&quot; beforehand is to run the backtest until the day before you run the live trade (say, Friday evening).  Using the print function, write the current holding and the parameters (in this case, context.weights and context.drawdown.)  Then, hard code the initial holdings in the &#39;initialize function.&#39; (it will start off on Monday morning).  You can check the current date and only output the holding on the last day.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='576034d10e521e2548000004' id='576034d10e521e2548000004'>
<a href='#576034d10e521e2548000004'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/513793a4a1d9044a7f000237'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/012af5703c64ecb848db194e6b7af78c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/513793a4a1d9044a7f000237'>Tybalt Trust</a>
</div>
<a UTCms='1465922776000' class='quanto-date posted-at response-posted-at' href='#576034d10e521e2548000004'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>hey all. does this algo work on Quantopian 2?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57604f590e521e254800016e' id='57604f590e521e254800016e'>
<a href='#57604f590e521e254800016e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56aa949a6eea0323720001aa'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0bed37e92b743d127109a4e2c545ff37?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56aa949a6eea0323720001aa'>Praful Nadella</a>
</div>
<a UTCms='1465929567000' class='quanto-date posted-at response-posted-at' href='#57604f590e521e254800016e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Very good algo! Thanks for sharing.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57607255aae81331a9000355' id='57607255aae81331a9000355'>
<a href='#57607255aae81331a9000355'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1465938523000' class='quanto-date posted-at response-posted-at' href='#57607255aae81331a9000355'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tybalt: If you clone the backtest at the top of this thread, you will get the Quantopian 2 version.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5763acfccbed51e25e0009f2' id='5763acfccbed51e25e0009f2'>
<a href='#5763acfccbed51e25e0009f2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/513793a4a1d9044a7f000237'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/012af5703c64ecb848db194e6b7af78c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/513793a4a1d9044a7f000237'>Tybalt Trust</a>
</div>
<a UTCms='1466150144000' class='quanto-date posted-at response-posted-at' href='#5763acfccbed51e25e0009f2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>thank you sir  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57653ba7893b62438c0002f7' id='57653ba7893b62438c0002f7'>
<a href='#57653ba7893b62438c0002f7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530006e439185472f8000032'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d244c2261df57fa9c6229c306eb91fb7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530006e439185472f8000032'>Novice TAI</a>
</div>
<a UTCms='1466252206000' class='quanto-date posted-at response-posted-at' href='#57653ba7893b62438c0002f7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>the algorithm migrated to Quantopian 2 version, have the obviously difference performance compare to original version!<br>
Could give the advice to check the reason?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='576b477bd0e364285100034b' id='576b477bd0e364285100034b'>
<a href='#576b477bd0e364285100034b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562a1289674f851bcb0004e2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d5bd698ff611c488050f57c663ac725a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562a1289674f851bcb0004e2'>Lake Austin</a>
</div>
<a UTCms='1466648457000' class='quanto-date posted-at response-posted-at' href='#576b477bd0e364285100034b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Big kudos to Nagai-san. indeed very good investment thesis behind the algo.<br>
3 source of profit: asset alloc, stock selection and market timing.  Nagai-san&#39;s v1 and v2 touched 2 of the 3. Thank you.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='576bf0aad0e3642851000a2f' id='576bf0aad0e3642851000a2f'>
<a href='#576bf0aad0e3642851000a2f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/551748d8d62587ea620002c5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/994bd3134488ee7f2ca45c5dcd96005c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/551748d8d62587ea620002c5'>Brandon B</a>
</div>
<a UTCms='1466691760000' class='quanto-date posted-at response-posted-at' href='#576bf0aad0e3642851000a2f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, When back testing in Quantopian 2 The algo does not go short during the 2008 Lehman bankruptcy it just takes no positions.. Why is this different?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5774fbcef10b5dfedc000196' id='5774fbcef10b5dfedc000196'>
<a href='#5774fbcef10b5dfedc000196'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1467284437000' class='quanto-date posted-at response-posted-at' href='#5774fbcef10b5dfedc000196'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Naoki,</p>

<p>I cloned your algo and start the backtesting. I haven&#39;t changed any code. But the &quot;Total Return&quot; is very terrible. :-/  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='579ac033a208c0b1780009ca' id='579ac033a208c0b1780009ca'>
<a href='#579ac033a208c0b1780009ca'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/575c76f22c40f02ae000040a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1b609bdecd20980483b12d1a52ca72aa?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/575c76f22c40f02ae000040a'>Greg Rollins</a>
</div>
<a UTCms='1469759545000' class='quanto-date posted-at response-posted-at' href='#579ac033a208c0b1780009ca'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It seems to be quite hard to write code that works in today&#39;s market.  Perhaps all the quants have canceled  all the information out of it?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5808f99e0ddf1ca5430002cf' id='5808f99e0ddf1ca5430002cf'>
<a href='#5808f99e0ddf1ca5430002cf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56ae5cbbbbbc731b780000b8'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0eccafa1826a9cefa1476f2074ff3300?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56ae5cbbbbbc731b780000b8'>Michele Vianello</a>
</div>
<a UTCms='1476983204000' class='quanto-date posted-at response-posted-at' href='#5808f99e0ddf1ca5430002cf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Me too, the result is totally different now... someone may to explane why?<br>
The code is Very well done for learning purpose for newbee as me.. thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='580d84f3003dabf2740000df' id='580d84f3003dabf2740000df'>
<a href='#580d84f3003dabf2740000df'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55f9ea41c51f6fe282000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/09d3ca2aba7e225443d1f3eab69d67ae?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55f9ea41c51f6fe282000166'>Maxim Girbu</a>
</div>
<a UTCms='1477281018000' class='quanto-date posted-at response-posted-at' href='#580d84f3003dabf2740000df'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It looks like the original algo was migrated to 2.0 incorrectly. See attached the up-to-date return of the original algo. Still need adjust the code to remove the depreciated functions.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='580dda9e0021b56fa7000607' id='580dda9e0021b56fa7000607'>
<a href='#580dda9e0021b56fa7000607'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56ae5cbbbbbc731b780000b8'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0eccafa1826a9cefa1476f2074ff3300?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56ae5cbbbbbc731b780000b8'>Michele Vianello</a>
</div>
<a UTCms='1477302951000' class='quanto-date posted-at response-posted-at' href='#580dda9e0021b56fa7000607'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Right!<br>
Then, this is my small contribution to the Q community: removed all deprecated code.<br>
Any ideas how to improve it?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58101be632f63ea6f3000881' id='58101be632f63ea6f3000881'>
<a href='#58101be632f63ea6f3000881'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55f9ea41c51f6fe282000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/09d3ca2aba7e225443d1f3eab69d67ae?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55f9ea41c51f6fe282000166'>Maxim Girbu</a>
</div>
<a UTCms='1477450735000' class='quanto-date posted-at response-posted-at' href='#58101be632f63ea6f3000881'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Michele for fixing the code.  I think that  another great improvement can be the integration of the volatility based position sizing, for example as described in Robert Carver&#39;s book Systematic Trading (<a href="http://qoppac.blogspot.ca/p/systematic-trading-book.html">http://qoppac.blogspot.ca/p/systematic-trading-book.html</a>).<br>
Simon Thornington tried to implement this logic in his algo here <a href="https://www.quantopian.com/posts/exponentially-weighted-moving-average-and-standard-deviation-in-pipeline">https://www.quantopian.com/posts/exponentially-weighted-moving-average-and-standard-deviation-in-pipeline</a><br>
Unfortunately, his algo didn&#39;t work as intended. Maybe someone can try implementing this logic to adjust position sizing of the algo?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5810baf19ae2e808c700006c' id='5810baf19ae2e808c700006c'>
<a href='#5810baf19ae2e808c700006c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56f9b5c4d4fac0ddb90000e3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ef8bdf38cce83f04a4a924a85d3517c9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56f9b5c4d4fac0ddb90000e3'>A. W.</a>
</div>
<a UTCms='1477491456000' class='quanto-date posted-at response-posted-at' href='#5810baf19ae2e808c700006c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The code doesn&#39;t look fixed at all. The new performance does not match the original performance nor the adjusted performance after Naoki modified to avoid look-ahead bias.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5810c7e99ae2e8912a0000eb' id='5810c7e99ae2e8912a0000eb'>
<a href='#5810c7e99ae2e8912a0000eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55f9ea41c51f6fe282000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/09d3ca2aba7e225443d1f3eab69d67ae?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55f9ea41c51f6fe282000166'>Maxim Girbu</a>
</div>
<a UTCms='1477494772000' class='quanto-date posted-at response-posted-at' href='#5810c7e99ae2e8912a0000eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>A.W. , please note that the diffrence in the performance may come from the different initial capital $.<br>
The most recent version of the algo run with $10K of the initial capital vs. $100K in the original algo  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5810c8720cff730a69000018' id='5810c8720cff730a69000018'>
<a href='#5810c8720cff730a69000018'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55f9ea41c51f6fe282000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/09d3ca2aba7e225443d1f3eab69d67ae?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55f9ea41c51f6fe282000166'>Maxim Girbu</a>
</div>
<a UTCms='1477494912000' class='quanto-date posted-at response-posted-at' href='#5810c8720cff730a69000018'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is my attempt to plug the position volatilty adjustment (credit to Simon&#39;s algo here <a href="https://www.quantopian.com/posts/exponentially-weighted-moving-average-and-standard-deviation-in-pipeline">https://www.quantopian.com/posts/exponentially-weighted-moving-average-and-standard-deviation-in-pipeline</a>)<br>
The algo adjusts the leverage to keep the same volatility.  In some cases the leverage can go up to 3x+, so might not be appropriate for many retail brokerage accounts, but  it achieves 2x performance of the previous algo with very similar drawdowns  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5816f18716a67c382b000726' id='5816f18716a67c382b000726'>
<a href='#5816f18716a67c382b000726'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a0ee60e13e7ecd84000172'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cd8547424fa80cafa3ed868155fe411c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a0ee60e13e7ecd84000172'>Dean  Meyer</a>
</div>
<a UTCms='1477898640000' class='quanto-date posted-at response-posted-at' href='#5816f18716a67c382b000726'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>unbelievable stuff!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58a6ae47ea4e734534033ba7' id='58a6ae47ea4e734534033ba7'>
<a href='#58a6ae47ea4e734534033ba7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5891bb1cfd740873c221114c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3abbe5adae43bbec610fa7ccfafb1693?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5891bb1cfd740873c221114c'>xiang chen</a>
</div>
<a UTCms='1487318599000' class='quanto-date posted-at response-posted-at' href='#58a6ae47ea4e734534033ba7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just read the code. But the point is, the context.price is defined as none at first, so how to compare it with 0? I mean, if context.stopprice[s] &lt; 0:, how does it work?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58f949eb7cea07000d93adcf' id='58f949eb7cea07000d93adcf'>
<a href='#58f949eb7cea07000d93adcf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57f52954d1ee0f7b97000248'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cb27aea9b074a1eefa465dced1ef1a27?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57f52954d1ee0f7b97000248'>Bala Umasankar</a>
</div>
<a UTCms='1492732395000' class='quanto-date posted-at response-posted-at' href='#58f949eb7cea07000d93adcf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>With a request of being pardoned for ignorance of python and statistics I have a silly question. I would appreciate an answer. If y=ax+b is the equation then &#39;a&#39; is the slope and &#39;b&#39; is the intercept. In the code segment I don&#39;t understand the part  <strong>&quot;slope = a / b * 252.0        # Daily return regression * 1 year&quot;</strong><br>
+++++++++++++++++++++++++++++++++++++++++++++++  </p>

<h1>Run regression y = ax + b</h1>

<pre><code>    results = sm.OLS(Y,A).fit()  
    (b, a) =results.params  

    # Normalized slope  
    slope = a / b * 252.0        # Daily return regression * 1 year  
</code></pre>

<p>++++++++++++++++++++++++++++++++++++++++++++++++++++++</p>

<p>If &#39;a&#39; is the slope what does a/b give, if  a is not the slope what does the ols function return ?</p>

<p>Thanks!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5900f80c094cb714278fa6ff' id='5900f80c094cb714278fa6ff'>
<a href='#5900f80c094cb714278fa6ff'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58af5b8272e5fa000de2e4f7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/004adcdf884a3bdab0db62bef0a0e331?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58af5b8272e5fa000de2e4f7'>Walter Greaney</a>
</div>
<a UTCms='1493235724000' class='quanto-date posted-at response-posted-at' href='#5900f80c094cb714278fa6ff'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just ran a back test on this, is there a Robin Hood friendly version of this algo? this pumps through a ton of trades, you would very quickly be labeled a day trader on Robin Hood.</p>

<p>Let me know!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='592346cef0e04c000d2e441d' id='592346cef0e04c000d2e441d'>
<a href='#592346cef0e04c000d2e441d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/547d2f170670d7d65b000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/30848b3ee4a99b954f8c97ddedf3f3b3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/547d2f170670d7d65b000166'>Naoki Nagai</a>
</div>
<a UTCms='1495484110000' class='quanto-date posted-at response-posted-at' href='#592346cef0e04c000d2e441d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This algo was originally written with ETFs to be exposed to diversified asset classes, but now you can this on futures.  Here is an example.</p>

<p><a href="https://www.quantopian.com/posts/futures-trend-reversion-algo">https://www.quantopian.com/posts/futures-trend-reversion-algo</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59234989265cd7000dbdea5d' id='59234989265cd7000dbdea5d'>
<a href='#59234989265cd7000dbdea5d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5346083a839ff34e1400010a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e2319a353b35eac99e765c836ba72044?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5346083a839ff34e1400010a'>Delaney Mackenzie</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1495484809000' class='quanto-date posted-at response-posted-at' href='#59234989265cd7000dbdea5d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>That&#39;s awesome that you already have a futures version of the algorithm, Naoki. Thanks for posting it!  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5af0f4edcef7e400463654a5' id='5af0f4edcef7e400463654a5'>
<a href='#5af0f4edcef7e400463654a5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/592b82c3332dec000db3c03e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c6302774b4fd6e8cb587289494fad37e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/592b82c3332dec000db3c03e'>Blaine Winston</a>
</div>
<a UTCms='1525740781000' class='quanto-date posted-at response-posted-at' href='#5af0f4edcef7e400463654a5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>And....POOF....just like that, this algo went from looking GOOD....to not keeping pace with the benchmark.</p>

<p>Tried to run previously cloned algo TODAY and it gave me an error message on line 149. I thought OK, maybe I had change something, so i cloned it just now and a pop-up box came up and said the ALGO had been migrated to Q2......which seemed like a good idea, until I ran the algo....indeed the logic of the ALGO was still there, but the back test results are &#39;spectacularly&#39; LOWER.....lower even than the benchmark.</p>

<p>I read the Q2 info and there could be a number of things that caused this, but in general, I am quite discouraged that even Q2 will not give accurate results as what may &#39;actually&#39; occur in real time trading ?!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5af1b43623344300471edea0' id='5af1b43623344300471edea0'>
<a href='#5af1b43623344300471edea0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5346083a839ff34e1400010a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e2319a353b35eac99e765c836ba72044?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5346083a839ff34e1400010a'>Delaney Mackenzie</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1525789750000' class='quanto-date posted-at response-posted-at' href='#5af1b43623344300471edea0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Blaine,</p>

<p>We&#39;re constantly improving the accuracy of our backtesting system, one of the ways we do that is open sourcing our engine (amongst many other repos). <a href="https://github.com/quantopian/zipline">https://github.com/quantopian/zipline</a></p>

<p>Algorithms are complex systems with serial state-dependent behavior, small changes can throw off algorithm. That said, good algorithms are generally more robust to small changes, and algorithms being massively different after a small change can imply (amongst other things) that<br>
A: The algorithm was overfit and oversensitive to small parameter changes.<br>
B: There was a bug in the backtesting system that was falsely causing the algorithm to look good.</p>

<p>This is more common than you might think. Overfitting is incredibly common and nobody is immune. As Marcos Lopez de Prado pointed out in his recent QuantCon keynote, backtest overfitting is likely the single biggest problem in finance right now (<a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2308659">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2308659</a>). Part of the reason this occurs is that if you find an anomaly, you&#39;ll likely try to dial into it and take more advantage of that behavior in your data. A data bug or quirk of the data can look no different from a true returns inefficiency. We&#39;ve also released some research about how common overfitting is here <a href="https://blog.quantopian.com/using-machine-learning-to-predict-out-of-sample-performance-of-trading-algorithms/">https://blog.quantopian.com/using-machine-learning-to-predict-out-of-sample-performance-of-trading-algorithms/</a>.</p>

<p>Sometimes a small change to the algo is all that&#39;s needed to get it back on track after a code change like this. Sometimes what our improved backtest system revealed is that the algo was never going to work in the first place. Backtesting is always at best an estimate of what will happen, and that&#39;s why it&#39;s important to use many other techniques to determine whether your algorithm will be okay, and to determine where the failure point actually is. I discuss this more here: <a href="https://blog.quantopian.com/idea-algorithm/">https://blog.quantopian.com/idea-algorithm/</a> In my opinion, backtesting should just be used to check if the algorithm survives real market conditions like <a href="https://www.quantopian.com/lectures/introduction-to-volume-slippage-and-liquidity">slippage</a> and trading costs. You should know your model is predictive before backtesting. That&#39;s what <a href="https://www.quantopian.com/lectures/factor-analysis">alphalens</a> is for.</p>

<p>If you believe you&#39;ve discovered a bug or inaccuracy, please let us know more about what&#39;s going on at <a href="/cdn-cgi/l/email-protection#7c1a1919181e1d1f173c0d091d1208130c151d12521f1311"><span class="__cf_email__" data-cfemail="b7d1d2d2d3d5d6d4dcf7c6c2d6d9c3d8c7ded6d999d4d8da">[email&#160;protected]</span></a>. It&#39;s incredibly helpful to us and everybody who uses Quantopian/Zipline to receive feedback that will make our systems better.</p>

<p>Lastly, for Quantopian&#39;s allocation purposes you shouldn&#39;t worry about beating the market. It&#39;s not a good benchmark unless that&#39;s precisely your target. What&#39;s interesting to us is algorithms with alpha -- returns which are not correlated with other risk factors or strategies. Even with low returns, an uncorrelated algorithm can be combined with other strategies or levered to the point of usefulness. In general if the strategy makes money and has well controlled risk exposures, it doesn&#39;t matter whether or not it beats the market. It&#39;s cheap to buy market exposure through ETFs, so the goal of a single strategy is to be an diversified investment.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b17f935dc12120043bfd64b' id='5b17f935dc12120043bfd64b'>
<a href='#5b17f935dc12120043bfd64b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58942c2f8b2f09282a4f51b3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b0898ec264cd2750907f1f5ed20bd2d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58942c2f8b2f09282a4f51b3'>Wei Chian Ong</a>
</div>
<a UTCms='1528297781000' class='quanto-date posted-at response-posted-at' href='#5b17f935dc12120043bfd64b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Everyone has probably long moved on from the original code, but like Pierre Warnier, I&#39;m having a lot of trouble understanding how a slope_min of 0.252 corresponds to yearly growth of 7%.</p>

<p>Slope = a/b * 252<br>
Assume slope_min = 0.252<br>
0.252 = a/b * 252<br>
0.001 = a/b<br>
Using the example from Naoki Nagai,<br>
&quot;Stock X: If it is at $100 at day 0, went up average of 1% per day. a will be 1.0 and b will be 100. a/b will be 0.01.&quot;
Obviously in this case, a/b of 0.01 is greater than 0.001, so this 1% per day increase stock qualifies.<br>
Now consider a hypothetical Stock Y: If it is at $100 at day 0, and went up 10% in a year (0.0378% per day average as this gives a 10% increase over 1 year). a will be 0.0378 and b will be 100. a/b will be 0.000378 which will be significantly less than 0.001 which means that it doesn&#39;t qualify as exceeding the slope_min, even though it rises 10% in a year which is over 7%.<br>
Apologies for any confusion, but I still can&#39;t figure out how 0.252 slope_min corresponds to 7% increase per year.<br>
Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b1fa1a55ad7680041d5f45f' id='5b1fa1a55ad7680041d5f45f'>
<a href='#5b1fa1a55ad7680041d5f45f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5b1f9ef65ad768004ad5f513'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5435859afd955dddb6ccc1f0a31a482b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5b1f9ef65ad768004ad5f513'>Zenothestoic</a>
</div>
<a UTCms='1528799653000' class='quanto-date posted-at response-posted-at' href='#5b1fa1a55ad7680041d5f45f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It is interesting to read a thread on trend following, bearing in mind what has been happening to trend following CTAs over the last few years. Who knows why but a strategy which made hundreds of millions for the likes of JW Henry and Bill Dunn suddenly stopped working and may or may not &quot;come back&quot;. At least so far as a diversified basket of futures is concerned.</p>

<p>Broadly speaking my belief is that successful &quot;probability&quot; and pattern trading requires the participant to be in the right place at the right time. It is about luck rather than skill; or at least given enough skill not to make a complete fool of yourself you will still get nowhere without luck.</p>

<p>It may be that trend following comes back into profit. It may be that it is too overcrowded.</p>

<p>Ironically of course all investment relies on trends. If a market does not trend upwards over time you will make no profit from it.</p>

<p>The question therefore becomes &quot;to trade or not to trade&quot;.</p>

<p>If world economic growth continues over the next hundred years you can expect to profit from a simple buy and hold of an index. Preferably a world index and preferably an index which is leaning more towards equal weight that market cap.</p>

<p>The trouble is with this industry is that the vast majority of participants are wrongly diagnosing luck for skill.</p>

<p>Other than that the major problem is the incurable disease of overfitting a system to the data.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b71efd49de4f300436e0f0e' id='5b71efd49de4f300436e0f0e'>
<a href='#5b71efd49de4f300436e0f0e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a4709338a027e1243b60dcc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/79bb495657e88a34c1401ad7888e6bcc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a4709338a027e1243b60dcc'>John Bailey</a>
</div>
<a UTCms='1534193620000' class='quanto-date posted-at response-posted-at' href='#5b71efd49de4f300436e0f0e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>What would it take to get someone to explain what this algorithm is doing?</p>

<p>I can&#39;t understand any of it...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b7217d1c9e0626a8f6cd633' id='5b7217d1c9e0626a8f6cd633'>
<a href='#5b7217d1c9e0626a8f6cd633'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/592b82c3332dec000db3c03e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c6302774b4fd6e8cb587289494fad37e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/592b82c3332dec000db3c03e'>Blaine Winston</a>
</div>
<a UTCms='1534203857000' class='quanto-date posted-at response-posted-at' href='#5b7217d1c9e0626a8f6cd633'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>There is significant documentation in the source code.......anything in quotes &quot; &quot; is his documentation as to what each line of code or function is doing. I&#39;m no python expert, but the logic seems straight forward if you read his documentation.</p>

<p>Also...if you click on Naokis name you and look through his previous posts there is quite a large amount of discussion on the algo as well.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b72d140e83ae900458db6c4' id='5b72d140e83ae900458db6c4'>
<a href='#5b72d140e83ae900458db6c4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534251328000' class='quanto-date posted-at response-posted-at' href='#5b72d140e83ae900458db6c4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Right off, I do not particularly like this trading strategy. Enough trades, but too few securities traded. It takes some 2 hours to run. However, money is money and in the CAGR department, it kept its own.</p>

<p>Based on its tearsheet we can notice the strategy has a relatively steady equity curve, but it has started to break down. </p>

<p>All I did was raise the initial capital to $1M, nothing else. Did not even try higher due to the low number of securities. See attached tearsheet.</p>

<p>Nonetheless, the securities traded are highly liquid ETFs, stuff like DIA and QQQ which are tracking indexes and thereby offer data averaging, built-in smoothing, and less volatility.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b72d17a12fa9f0045bd9eee' id='5b72d17a12fa9f0045bd9eee'>
<a href='#5b72d17a12fa9f0045bd9eee'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534251386000' class='quanto-date posted-at response-posted-at' href='#5b72d17a12fa9f0045bd9eee'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This second tearsheet increased the trading interval to 10.25 years (adding 14 months). You increase the duration to see how a trading strategy might behave under a different set of circumstances. It is like having a walk-forward for a strategy since it was showcased in October 2016. Making this test showing what would have happened during the added 14 months.</p>

<p>Based on the tearsheet, it did pretty good. Even raising the CAGR to 28.7%.</p>

<p>It is not what I expected. However, it does demonstrate that throwing away a strategy because it seems to be breaking down as in the previous post might not always be the best solution.</p>

<p>Nonetheless, I still do not like the strategy. However, its trading behavior just became more interesting. It showed sustainable alpha and that is worth investigating. Maybe some of the procedures could be used elsewhere. Still, it is a 28.7% CAGR over its 10.25-year simulation.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b730677e83ae9216c8db25f' id='5b730677e83ae9216c8db25f'>
<a href='#5b730677e83ae9216c8db25f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534264951000' class='quanto-date posted-at response-posted-at' href='#5b730677e83ae9216c8db25f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I had to test adding more capital to this strategy.</p>

<p>Handling $1M might not be enough for the trouble of monitoring the thing for 10 years. Also, the test would show scaling abilities and how trading units would be handled.</p>

<p>Raised the capital to $10M. No other change. If the trading strategy is scalable, the outcome should be in the vicinity of 10 times the previous test at $1M. The attached tearsheet attest to that.</p>

<p>I still have not looked at the code as yet. However, for the preliminary tests, it did not matter. What I wanted to know was: is it worth it to investigate? The answer continues to be yes. Now I know it can handle the pressure and the traded securities are more than sufficiently liquid to accommodate.</p>

<p>The tests of this strategy, up to now, have shown: it can handle more capital, it can handle more time, it can scale up, and it was relatively easy to find something in the vicinity of a 30% CAGR. In fact, it is the first strategy I looked at after my post to that effect in the thread:<br>
<a href="https://www.quantopian.com/posts/the-gaming-of-stock-trading-strategies" rel="nofollow">https://www.quantopian.com/posts/the-gaming-of-stock-trading-strategies</a></p>

<p>I still do not like how it behaves, it is therefore up to me to see if I can make this strategy behave more in the way I would like and determine if it becomes more acceptable. </p>

<p>Nonetheless, the strategy still grew at a 28.2% CAGR over those 10.25 years, turning the initial $10M into $91M. It used leverage to do this which it could afford to pay.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b730f4676dbd5032ca329f7' id='5b730f4676dbd5032ca329f7'>
<a href='#5b730f4676dbd5032ca329f7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a4709338a027e1243b60dcc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/79bb495657e88a34c1401ad7888e6bcc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a4709338a027e1243b60dcc'>John Bailey</a>
</div>
<a UTCms='1534267206000' class='quanto-date posted-at response-posted-at' href='#5b730f4676dbd5032ca329f7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>What would it take to get this explained in plain language?</p>

<p>The code is too complicated. I can&#39;t understand what it&#39;s supposed to do.</p>

<p>Could this be explained in &quot;trading rules&quot; - as if a person were going to do it manually?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b731b2512fa9f0042bda168' id='5b731b2512fa9f0042bda168'>
<a href='#5b731b2512fa9f0042bda168'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/592b82c3332dec000db3c03e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c6302774b4fd6e8cb587289494fad37e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/592b82c3332dec000db3c03e'>Blaine Winston</a>
</div>
<a UTCms='1534270245000' class='quanto-date posted-at response-posted-at' href='#5b731b2512fa9f0042bda168'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>John.....the &#39;plain language&#39; as mentioned earlier is contained within the quotes of the code itself.  All the &#39;trading rules&#39; are there.</p>

<p>Guy....thank you for your wonderful work on this, it has inspired me to expand my mind a bit further with Python and Quantopian.</p>

<p>One thing that greatly concerns me however, is the test period....a 10 year lookback really only covers what I would personally consider an artificial market place where market has had the luxury of unprecedented liquidity and FED intervention...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b731f614751b72b839785b0' id='5b731f614751b72b839785b0'>
<a href='#5b731f614751b72b839785b0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534271329000' class='quanto-date posted-at response-posted-at' href='#5b731f614751b72b839785b0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Blaine, yes. Note that during the same period the majority of portfolio managers nevertheless did not outperform the market averages.</p>

<p>However, your concerns could be programmed in. Meaning you identify what you consider weaknesses and help the strategy navigate its maze to even better results in spite of what the FED might do or not do. </p>

<p>We are really too small to have an impact on what the market does. But, we are in control of what we allow our strategies to do.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b7442ce858ba1004445f755' id='5b7442ce858ba1004445f755'>
<a href='#5b7442ce858ba1004445f755'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534345934000' class='quanto-date posted-at response-posted-at' href='#5b7442ce858ba1004445f755'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The objective of any trading strategy is to have its portfolio grow in size with time. As a matter of fact, it should do this at a compounding rate. The task gets harder the larger the portfolio gets. It is here that the law of diminishing return enters the picture.</p>

<p>We should all ask the same question: can my strategy handle $1M, $10M, $50M, $100M or more? The answer can be had without even changing a line of code. It is sufficient to set the initially allocated capital and run the simulation.</p>

<p>The outcome will show how the strategy behaved and how it handled the added capital resources. For a strategy that is scalable, the outcome is simply scaled up by about the same amount or close to it.  You go from $1M to $10M, then the payoff should be near 10 times. That is if the strategy is scalable. Any trading strategy that uses fixed-fractions as trading unit becomes scalable by design: \(u_t = F(t) / j_t\) where \(j_t\) is the number of securities traded at time \(t\).</p>

<p>Therefore, it should be expected that raising the stakes by a factor of 10 in this trading strategy should result in a corresponding increase in portfolio value. In the attached tearsheet, we can see the law of diminishing return taking its toll. There is still how the trading strategy handled its trades that should be analyzed. Nonetheless, the strategy maintained a 25.5% CAGR over those 10.25 years which translated into $693M in profits. Not so bad.</p>

<p>Presently, one Q member has a $50M allocation. And as a result for any trading strategies we may develop, we should also simulate if our strategies could handle it or not. And that is a very easy test to do! It is part of doing our homework and being able to say: it does.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b74b26625d1172222c3d73d' id='5b74b26625d1172222c3d73d'>
<a href='#5b74b26625d1172222c3d73d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534374502000' class='quanto-date posted-at response-posted-at' href='#5b74b26625d1172222c3d73d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Any change you make to a trading strategy should have some impact on its payoff matrix. Otherwise, the changes in question should be considered simply as cosmetic in nature. You can always do that kind of code. It is just that it does not produce any money. And that is not the object of the game.</p>

<p>I started reading the code and making modifications. Things like: if I increase this number the impact will be to increase volatility but also increase profits. If I insert a little delayed gratification, it should increase profits. If I use a little bit more cash, again it should increase profits by taking more trading opportunities. This should be gradual, spread out over the entire trading interval and still have a positive impact on the strategy&#39;s payoff matrix equation.</p>

<p>$$ F(t) = F_0 \cdot (1 + \bar g)^t = F_0 + \sum (H \cdot \Delta P) -  \sum (Exp) = F_0 + n \cdot \bar x $$</p>

<p>The thing to do to demonstrate that it does, in fact, do as intended is to run the simulation, knowing beforehand that changing those numbers would have a direct impact on the portfolio&#39;s payoff matrix.</p>

<p>The attached tearsheet shows the results. The CAGR came in at 34.7%, meaning that the strategy transformed its $10M into $153M in 10.25 years. Admittedly, it continued to use some leverage to do so, just as in its prior $10M simulation which came in at a 28.2% CAGR.</p>

<p>I have not read all the logic of this program as yet (am at line 37). The strategy is getting more aggressive, trading more and raising its average net profit per trade \(\bar x\) as expected. Evidently, there is a cost to this. It translates into a higher volatility reading and a larger drawdown. I do not mind about that presently since I have not addressed that issue as yet. I do like the strategy&#39;s 0.17 beta reading.</p>

<p>The changes made have nothing to do with the logic of the trading strategy and on how it mixed its stuff to trigger its trades. I only forced the strategy to reconsider its assumptions. Also, it does make the point that the assumptions we give a trading strategy can have quite an impact on its outcome. </p>

<p>This trading strategy started as a throwaway strategy playing the largest EFTs out there, and it is keeping me interested.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b75911f7013e340271e1558' id='5b75911f7013e340271e1558'>
<a href='#5b75911f7013e340271e1558'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/592b82c3332dec000db3c03e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c6302774b4fd6e8cb587289494fad37e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/592b82c3332dec000db3c03e'>Blaine Winston</a>
</div>
<a UTCms='1534431519000' class='quanto-date posted-at response-posted-at' href='#5b75911f7013e340271e1558'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Guy....its very insightful to see how one approaches these things from the deep thought perspective. I&#39;m glad its keeping you interested because its immensely helpful to watch this evolve with detailed analysis.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b7884e8a5adff5cf2ba735b' id='5b7884e8a5adff5cf2ba735b'>
<a href='#5b7884e8a5adff5cf2ba735b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534625000000' class='quanto-date posted-at response-posted-at' href='#5b7884e8a5adff5cf2ba735b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Changed the timing of the trades in order to corroborate the point made in my <a href="https://www.quantopian.com/posts/portfolio-structure-and-overfitting#5b785d03b02a9200491e95cf" rel="nofollow">last post</a> in <a href="https://www.quantopian.com/posts/portfolio-structure-and-overfitting" rel="nofollow">Portfolio Structure and Over-fitting</a>. </p>

<p>Trades were given a different time of day to execute which should result in a different answer. Also, requested more profits as illustrated in the attached tearsheet. </p>

<p>A summary of the impact: </p>

<p>These minor changes raised the portfolio&#39;s matrix payout from $153.1M to $175.8M. Raised its CAGR from 34.7% to 36.5%, a 1.8% increase in its alpha. Not much, but still an added $22.7M for a few numbers. </p>

<p>To do so, the strategy increased its number of trades from 4,440 to 4,768 while also raising its average net profit per trade from $34,491 to $36.871. I still do not know how it trades, but I will get to that later. The alpha is compounded.</p>

<p>In the beginning iterations of this strategy, it was making peanuts on its short trades. That has increased considerably. The strategy now takes on 1,715 shorts which are mostly profitable. The strange thing is that this strategy is supposed to be long only. Therefore, when I&#39;ll get to the code, I will have to find out why and then determine if it is a desirable feature.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b79670da1a11b0044be9013' id='5b79670da1a11b0044be9013'>
<a href='#5b79670da1a11b0044be9013'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534682893000' class='quanto-date posted-at response-posted-at' href='#5b79670da1a11b0044be9013'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>You have a trading strategy but know nothing as to its limits or its architecture. How far can it go? Would it be acceptable trading in this fashion?</p>

<p>Again, I only increased what could have an impact on the strategy&#39;s payoff matrix. When compared with the immediate prior simulation tearsheet we have (n) the number of trades increased from  4,768 to 4,872 while the average net profit per trade when from $36,871 to $45,948. The strategy&#39;s CAGR over the 10.25 years when from 36.5% to 39.9%.</p>

<p>All this translated into generating $223,860,013 in profits compared to $175,803,112 in the previous simulation. A 48M increase just for a few numbers. A 27% increase in net profits.</p>

<p>What is seen in this series of simulations is that I affected all the trades in each scenario, not just one here or there, but all of them by influencing and coercing the payoff matrix. It is like adding a function to the payoff matrix: \( \sum (f(t) \cdot H \cdot \Delta P) \). This function controls the strategy&#39;s restrictions.</p>

<p>Things I often see in trading strategies is conflicting and redundant procedures. Like having two profit target functions, one saying take the profit at 10% and the other at 20%. Surely, everyone would prefer the 20% profit target, but it is never executed since the other one has precedence. However, you can still add to the 10% profit target and push it higher, whereas even if you increase on the 20% mark nothing happens. If you push your 10% profit target above the 20% one then it becomes redundant since the other 20% will take over control.</p>

<p>Very little was changed in these simulations. None of the trading procedures or program logic was changed, and yet, performance increased considerably. Am I over-fitting or simply exploring the architectural limits of this program?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b7d7598e777db0b2fa62928' id='5b7d7598e777db0b2fa62928'>
<a href='#5b7d7598e777db0b2fa62928'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58bcd705e57c67000a346680'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6ddd8fcec7899e4882e1c60af5211972?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58bcd705e57c67000a346680'>Mattias Lamotte</a>
</div>
<a UTCms='1534948760000' class='quanto-date posted-at response-posted-at' href='#5b7d7598e777db0b2fa62928'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Guy,</p>

<p>I would suspect that you are overfitting somewhat. Though you might still obtain a third of the CAGR you are getting on your backtest, and that would not be too bad!</p>

<p>I also significantly improved the algo returns by adding a few more trending ETFs, and changing the slope entry threshold to become asymmetric for longs and for shorts. I&#39;m getting a CAGR of 26% with gross leverage never going above 2 with the initial lookback period of 126 days.</p>

<p>However, my main worry with this algorithm is that if you change the lookback period for the regression line from 126 days to 120 or 130, you get a very different performance (with the algo going nowhere for much longer periods - losing money for 18+ months stretches). While maybe 126 days is a magic number as it only captures 2 earnings calls at nearly all times, I&#39;m always sceptical when a 5% move in one parameter can create such different results.</p>

<p>It was an interesting algo to study. I thought studying the effect of the volatility adjustment was particularly interesting (using pd.ewmstd() which I believe was added by maxim). I did not know this function beforehand and will likely use it in future algos...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b7dcbbd821f6200479e4d6e' id='5b7dcbbd821f6200479e4d6e'>
<a href='#5b7dcbbd821f6200479e4d6e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1534970813000' class='quanto-date posted-at response-posted-at' href='#5b7dcbbd821f6200479e4d6e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Mattias, interesting observations.</p>

<p>Over-fitting, in this case, might be a strong word. The program&#39;s code was not altered, nor its trading logic. </p>

<p>The intention was to appraise the nature of that at a later time. Once I&#39;ve modified the code, maybe I&#39;ll encounter something that says it is a misfit for the task required. For now, I do not know if it is good or bad. </p>

<p>I did my usual initial exploration phase of someone else&#39;s program where I apply functions to the strategy&#39;s payoff matrix to see if it is scalable and sustainable. Most often, if a strategy cannot scale up and last for 10 years and more, I rapidly lose interest. </p>

<p>What I did was relatively simple, see it as a guiding function to the inventory matrix: \(  \sum (k(t) \cdot H \cdot \Delta P)  \) resulting in a positive impact on the outcome. Such modifications are available to anyone. It is where you preset part of your trading strategy&#39;s behavior.</p>

<p>I have not touched the code yet. Nonetheless, I do not expect the future to be like the past, and therefore, the strategy still has to prove itself going forward. At least, it showed that under its set of conditions and trading procedures it managed to outperform over those 10.25 years and doing over 4,000+ trades in the process. That is not negligible.</p>

<p>Will those conditions be the same going forward? As you know, probably not. However, without viewing the relevance of the code, I would be hard-pressed to answer. But, I do expect to see the strategy follow its code and behave in about the same manner as it did in the past. And that is generate about the same number of trades per time interval. This will tend to a constant as in: \(\Delta (n \cdot \bar {x}) / \Delta t \to constant \). And because of this, we will see a return degradation going forward. Measures will be needed to overcome this inherent alpha decay. But that is part of the code modification phase.</p>

<p>This exercise makes you wonder on the value of what is being missed by not exploring the limits of a trading strategy and what these controls \( k(t) \) might really be worth? </p>

<p>This could be viewed as opportunity costs for not having pursued those limits, barriers, or what have you. And, it could be expressed as having value, explicitly: </p>

<p>$$ \sum (k(t) \cdot H \cdot \Delta P)  -   \sum (H \cdot \Delta P) $$</p>

<p>You could take what you or I showed as performance improvements and compare that to the original script&#39;s payoff matrix to get an idea of these opportunity costs. This, just for a few numbers in a program that we did not even design ourselves.</p>

<p>Thanks to @Maxim for updating the strategy, @Michelle for removing the deprecated stuff, and @Naoki for originally putting it out for all to play with to explore its possibilities. There is more that can be done, but that will require reading and understanding the code, the core of the program which could lead to something over-fitted, and maybe not.</p>

<p>I find that term totally over-rated. You know the future will be different, and that, de facto, your trading strategy will process that data differently, and yet, people insist that their trading strategy, which will stay the same, somehow will behave differently in spite of knowing that the data will change. </p>

<p>If I had to use such a term, I would say that the original trading strategy was mostly under-fitted since so much more could have been extracted with relative ease, and by modifying just a few numbers at that.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b7f15a93ea9b16d75d4fa5c' id='5b7f15a93ea9b16d75d4fa5c'>
<a href='#5b7f15a93ea9b16d75d4fa5c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5b1f9ef65ad768004ad5f513'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5435859afd955dddb6ccc1f0a31a482b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5b1f9ef65ad768004ad5f513'>Zenothestoic</a>
</div>
<a UTCms='1535055273000' class='quanto-date posted-at response-posted-at' href='#5b7f15a93ea9b16d75d4fa5c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The last few years should have shown us that trend following is a myth, generally speaking. In terms of commodities, analysis shows very little by way of long term trends over the past 150 years. Demand has largely been satisfied by increased supply in the commodities market through increasing productivity and better extraction methods.</p>

<p>In stocks it is true that the long term trend has been upwards. However even this rise has not been particularly spectacular when inflation is properly accounted for and you assume reinvestment of dividends. Tax free dividend investment is not a given unless you are investing for a fund which is not taxable</p>

<p>Regrettably, most if not all of the topics on this forum are so much time wasted. In the long term you would do as well flipping a coin and would be better off simply by diversifying widely and indexing your money.</p>

<p>Unless that is you have a method which is not dependent on prediction. Reaping the bid offered spread is one such, or collecting the premium on shorting volatility while protecting yourself from the downside.</p>

<p>Most of these schemes are merely pie in the sky and doomed to ignominious failure.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b7f1b5a23fda000463eb67d' id='5b7f1b5a23fda000463eb67d'>
<a href='#5b7f1b5a23fda000463eb67d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/592b82c3332dec000db3c03e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c6302774b4fd6e8cb587289494fad37e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/592b82c3332dec000db3c03e'>Blaine Winston</a>
</div>
<a UTCms='1535056730000' class='quanto-date posted-at response-posted-at' href='#5b7f1b5a23fda000463eb67d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Zenothestoic makes a valid point......</p>

<p>Not to get offtopic, but just an honest question....<br>
Have you guru strategy builders looked over at Quantiacs to see &#39;whats working&#39; as it relates to their systems.  It appears that many of the top performing systems (see link below) are likely &#39;sharpe ratio maximization&#39; strategies which end up with quite a bit of commodity offset. Whats interesting is that I&#39;ve seen a number of sharpe ratio maximization strategies on Quantopian but not many that are successful.....on the other hand, the ones over at Quantiacs appear to have astounding sharpe ratios, performance and minimal drawdowns over long periods.  I guess the question is....what are they doing (would have to be a guess since nothing is public) that the wizards here on Quantopian are not to get such strong results ?</p>

<p><a href="https://www.quantiacs.com/Systems.aspx" rel="nofollow">https://www.quantiacs.com/Systems.aspx</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b7f626f2e47400043c7c9a5' id='5b7f626f2e47400043c7c9a5'>
<a href='#5b7f626f2e47400043c7c9a5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1535074927000' class='quanto-date posted-at response-posted-at' href='#5b7f626f2e47400043c7c9a5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>what are they doing [...] that the wizards here on Quantopian are not to get such strong results ?</p>
</blockquote>

<p>While the answer may sound complex, hopefully it will be clear. A major part is simply the amount of money. Over there, $250k. Here, at $10M, with the modeling percentage that can be traded there is price drift in partial fills so a large number of stocks are required, and also with concentration limits for the contest, that means venturing into weaker alpha signals. Additionally leverage EOD must always be near 1, beta needs to be as close to zero as possible for a higher score, and then sector, turnover, risk &amp; other constraints all contribute to the difference. At $250k here too, similar results with sharpe over 4 and so on would be seen, or even with $1M, and even without stop/limit which we aren&#39;t allowed to use in the contest.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cf47040d55f570049ca7a91' id='5cf47040d55f570049ca7a91'>
<a href='#5cf47040d55f570049ca7a91'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cbd1e89b376b30043e2ea9e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d859b549b288cbe3e0bc89cb5384d8fe?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cbd1e89b376b30043e2ea9e'>Husein Khalil</a>
</div>
<a UTCms='1559523392000' class='quanto-date posted-at response-posted-at' href='#5cf47040d55f570049ca7a91'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you Naoki.</p>

<p>Note that there&#39;s instances where the drawdown calculated for the stop-loss will exceed the drawdown at the open by a small margin, namely due to the fact that the drawdown at entry is done based on the open, whereas for the stop-loss we use the close. This can lead to early exits of positions on smaller timeframes / ranges.</p>

<p>Also, I added a take-profit function based on your 1.95*std that runs following any exit-long/short functions. Again, this is mostly due to the fact that in the crypto market pump and dumps happens frequently and you might be left out had you only taken a stance on the next candle&#39;s close.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ebe485a34b16c5db970159e' id='5ebe485a34b16c5db970159e'>
<a href='#5ebe485a34b16c5db970159e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5d7056b894480e00404d4006'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7321ed642532a5c044fe6339fb83f70c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5d7056b894480e00404d4006'>Rahul Kadam</a>
</div>
<a UTCms='1589528666000' class='quanto-date posted-at response-posted-at' href='#5ebe485a34b16c5db970159e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you very much Naoki.. This is a great start for newbie like me.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/trend-follow-algo'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/trend-follow-algo'>join Quantopian</a> to
post a reply.
</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#2a4c4f4f4e484b49416a5b5f4b445e455a434b4404494547">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
