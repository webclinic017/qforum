<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Stocks On The Move by Andreas Clenow
</title>
<meta content='Book:  http://www.amazon.com/Stocks-Move-Beating-Momentum-Strategies/dp/1511466146 Website:  http://www.followingthetrend.com/ This is my attempt at a faithful recreation of his system.  Sometimes it dips into margin a little, I haven&#39;t isolated why.  Comments welcome! Also, due credit to Ted, who shared another implementation here:  https://www.quantopian.com/posts/anyone-found-a-substantial-momentum-effect  (and James Christopher who says he&#39;s done one too).' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="Ghgsxg/ElHkZk+FE71xGytcCAzw9tujgAPmEFtn2HGZmflqLrTJGmqCOuHWgs+6+74wgVUd6/fuC9l98c7N+3Q==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=true;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/stocks-on-the-move-by-andreas-clenow' property='og:url'>
<meta content='Stocks On The Move by Andreas Clenow' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/stocks-on-the-move-by-andreas-clenow' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Stocks On The Move by Andreas Clenow' property='og:title'>
<meta content='Book:  http://www.amazon.com/Stocks-Move-Beating-Momentum-Strategies/dp/1511466146 Website:  http://www.followingthetrend.com/ This is my attempt at a faithful recreation of his system.  Sometimes it dips into margin a little, I haven&#39;t isolated why.  Comments welcome! Also, due credit to Ted, who shared another implementation here:  https://www.quantopian.com/posts/anyone-found-a-substantial-momentum-effect  (and James Christopher who says he&#39;s done one too).' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/stocks-on-the-move-by-andreas-clenow">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='56bcff8294846cefd0000068'>
<div class='post-container' data-post-id='56bcff8294846cefd0000068' id='56bcff8294846cefd0000068'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Stocks On The Move by Andreas Clenow</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1455226754000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Stocks On The Move by Andreas Clenow&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fstocks-on-the-move-by-andreas-clenow%3Futm_source%3Dwebsite_share%26utm_campaign%3Dstocks-on-the-move-by-andreas-clenow%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fstocks-on-the-move-by-andreas-clenow%3Futm_source%3Dwebsite_share%26utm_campaign%3Dstocks-on-the-move-by-andreas-clenow%26utm_medium%3Dlinkedin&amp;title=Stocks+On+The+Move+by+Andreas+Clenow+%28Simon+Thornington%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Momentum' data-tag-id='55c50e7d8d4710ec6e00000c' href='/posts/tag/Momentum/newest'>Momentum</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Pipeline' data-tag-id='561525bcf252a59171000001' href='/posts/tag/Pipeline/newest'>Pipeline</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/stocks-on-the-move-by-andreas-clenow?utm_source=website_share&amp;utm_campaign=stocks-on-the-move-by-andreas-clenow&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Simon Thornington" />
<div class='body-text'>
<div class='body-text-container post-body'><p>Book: <a href="http://www.amazon.com/Stocks-Move-Beating-Momentum-Strategies/dp/1511466146" rel="nofollow">http://www.amazon.com/Stocks-Move-Beating-Momentum-Strategies/dp/1511466146</a><br>
Website: <a href="http://www.followingthetrend.com/" rel="nofollow">http://www.followingthetrend.com/</a></p>

<p>This is my attempt at a faithful recreation of his system.  Sometimes it dips into margin a little, I haven&#39;t isolated why.  Comments welcome!</p>

<p>Also, due credit to Ted, who shared another implementation here: <a href="https://www.quantopian.com/posts/anyone-found-a-substantial-momentum-effect" rel="nofollow">https://www.quantopian.com/posts/anyone-found-a-substantial-momentum-effect</a> (and James Christopher who says he&#39;s done one too).  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>176 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='56c0554d9be4721d560003f0' id='56c0554d9be4721d560003f0'>
<a href='#56c0554d9be4721d560003f0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1455445332000' class='quanto-date posted-at response-posted-at' href='#56c0554d9be4721d560003f0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;ve just read the book, so thanks for implementing this!</p>

<p>I ran your code through Pyfolio&#39;s full tear sheet, and noted a couple of interesting things:</p>

<pre><code>Top 10 long positions of all time (and max%) [u&#39;BTU&#39; u&#39;BBD&#39; u&#39;AGN&#39; u&#39;OIBR&#39; u&#39;TII&#39; u&#39;GENZ&#39; u&#39;AGNC&#39; u&#39;DELL&#39; u&#39;KMP&#39; u&#39;CAG&#39;] [ 0.525 0.159 0.149 0.147 0.141 0.14 0.129 0.124 0.124 0.123]  
</code></pre>

<p>This means BTU gets up to 52.5% of the portfolio. As far as I can tell, the divisor is the total value of the portfolio including any cash. So this is a huge concentration, which doesn&#39;t seem right. From the charts it looks to be around end of 2007 when SPY falls below its 200 day moving average, and the algorithm stops entering new positions.</p>

<p>Secondly, there do seem to be times the leverage jumps above 1. For example, right at the end of 2012, the leverage increases briefly to 1.2x</p>

<p>I will look into it more. I suspect the error is in the logic of rebalance_positions  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c0e7613da3169657000005' id='56c0e7613da3169657000005'>
<a href='#56c0e7613da3169657000005'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1455482725000' class='quanto-date posted-at response-posted-at' href='#56c0e7613da3169657000005'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I am new to Python, so I haven&#39;t quite been able to fix it, but the cause seems to be the calculation of ATR for the symbol BTU on 2007-12-05. Using <a href="http://www.stockcharts.com">www.stockcharts.com</a> I get an ATR(20) of around $30, which makes sense as the share price is around $800, so that&#39;s a normal daily move of 4%, which is high, but not ridiculous for late 2007.</p>

<p>Breaking the code at this point:</p>

<pre><code>def desired_position_size_in_shares(context, data, sid):  
    account_value = context.account.equity_with_loan  
    target_range = DailyRangePerStock  
    estimated_atr = context.pool[&#39;atr&#39;][sid]  
    return (account_value * target_range) / estimated_atr  
</code></pre>

<p>The estimated_atr is around 2, which is wrong. I&#39;m having trouble debugging the ATR CustomFactor, as I&#39;m not sure how to slice into the arrays using the index columns to get the window of prices for BTU.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c12e04b50a5ab4df000115' id='56c12e04b50a5ab4df000115'>
<a href='#56c12e04b50a5ab4df000115'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1455500813000' class='quanto-date posted-at response-posted-at' href='#56c12e04b50a5ab4df000115'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Dan, this might help for debugging. </p>

<pre><code>class ATR(CustomFactor):  
    [...]  
    btu_sid = symbol(&#39;BTU&#39;).sid

    def compute(self, today, assets, out, close, high, low):  
        btu_idx = assets.get_loc(btu_sid)  
        close[btu_idx] # use me like this to get BTU prices  
        [...]  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c18c232354804e06000379' id='56c18c232354804e06000379'>
<a href='#56c18c232354804e06000379'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1455524903000' class='quanto-date posted-at response-posted-at' href='#56c18c232354804e06000379'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Luca, super helpful.</p>

<p>OK, so the bug is to do with back adjusted prices:</p>

<blockquote>
<p>Our [quantopian&#39;s] data uses adjusted close prices. That means that the effect of all stock splits and merger activity are applied to price and volume data. As an example: A stock is trading at $100, and has a 2:1 split. The new price is $50, and all past price data is retroactively updated 2:1 (volume data is correspondingly updated 1:2). In effect, that means you can ignore stock splits unless you are storing prices in a live trading algorithm. In a live trading algorithm, the stored variable needs to have the split applied to the price and volume. In a backtest, the split is already applied retroactively to all data.</p>
</blockquote>

<p>The ATR of $2 is calculated using closing prices, which were around $55-60 in the 20 days leading up to the calculation date of 2007-12-05. This means the algorithm correctly calculates it must purchase 50 shares, worth around $3000. The actual purchase takes place using back adjusted prices, which is around $800 at the time. This is because BTU had a 15-1 stock split in 2015. In other words, the algorithm is trying to buy 50 of the &quot;new&quot; shares, which is equal to 50x15=750 of the &quot;old&quot; shares.</p>

<p>I suspect the best fix is to calculate the ATR using back adjusted prices, rather than close prices.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c1b97f733e0351bc0004e4' id='56c1b97f733e0351bc0004e4'>
<a href='#56c1b97f733e0351bc0004e4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1455536514000' class='quanto-date posted-at response-posted-at' href='#56c1b97f733e0351bc0004e4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Further to this, I note this algorithm uses pipeline, which adjusts for splits and dividends very differently from the old backtester:</p>

<p><a href="https://www.quantopian.com/posts/the-pipeline-api-dividends-and-splits-what-you-need-to-know">https://www.quantopian.com/posts/the-pipeline-api-dividends-and-splits-what-you-need-to-know</a></p>

<p>It seems the ATR is calculated correctly using prices <em>that are split and dividend adjusted to the date for which the function is being called</em>. However, it seems the <a href="https://www.quantopian.com/help#api-order-target">order_target</a> function is using the old backtester paradigm of back-adjusting the data for all past and future splits, before the algorithm starts. (I note this is what Yahoo does in their Adj close column if you <a href="https://uk.finance.yahoo.com/q/hp?s=BTU&amp;b=1&amp;a=00&amp;c=2007&amp;e=1&amp;d=00&amp;f=2008&amp;g=d">grab historic data for a specific year</a>.)</p>

<p>I am not sure what to do here. Is there a version of order_target that is compatible with pipeline? Position sizing is critical to the success of this (and most algorithms), and ATR position sizing is pretty common.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c20647b50a5ab4df000612' id='56c20647b50a5ab4df000612'>
<a href='#56c20647b50a5ab4df000612'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1455556172000' class='quanto-date posted-at response-posted-at' href='#56c20647b50a5ab4df000612'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Excellent catch. Since ATR isn&#39;t used in te actual pre-universe screening, only for actual position sizing, it would be simplest to just calculate ATR on data from &#39;history()&#39; and use that to determine position sizes.</p>

<p>I&#39;ll do that when I have time, or of course anyone else is welcome to.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c23bacb50a5ab4df00087b' id='56c23bacb50a5ab4df00087b'>
<a href='#56c23bacb50a5ab4df00087b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1455569841000' class='quanto-date posted-at response-posted-at' href='#56c23bacb50a5ab4df00087b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>OK, Simon, I&#39;ve done as you suggested.  Somethings not quite right, as I still get an oversized position.</p>

<pre><code>Top 10 long positions of all time (and max%)  
[u&#39;LIFE&#39; u&#39;GENZ&#39; u&#39;AGN&#39; u&#39;TLD&#39; u&#39;AGNC&#39; u&#39;ELE&#39; u&#39;NTT&#39; u&#39;T&#39; u&#39;YPF&#39; u&#39;TXU&#39;]
[ 0.545  0.11   0.107  0.103  0.102  0.101  0.101  0.099  0.098  0.097]
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c23dfa733e030b2d000249' id='56c23dfa733e030b2d000249'>
<a href='#56c23dfa733e030b2d000249'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1455570430000' class='quanto-date posted-at response-posted-at' href='#56c23dfa733e030b2d000249'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Nice thanks! Looks pretty good even as is, I am sure this could be turned into something tradable.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c716b783af6952f7000139' id='56c716b783af6952f7000139'>
<a href='#56c716b783af6952f7000139'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1455888068000' class='quanto-date posted-at response-posted-at' href='#56c716b783af6952f7000139'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Simon</p>

<p>I was wondering why you have a CustomFactor called Momentum() that you don&#39;t use, and instead you define and use MomentumOfTopN() that internally applies the market cap filter.  I can see your comment &quot;# get our universe in here again because lame&quot;, which made me smile. Why couldn&#39;t you just use Momentum() -- was it a speed issue?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c74b2383af69833500018c' id='56c74b2383af69833500018c'>
<a href='#56c74b2383af69833500018c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1455901489000' class='quanto-date posted-at response-posted-at' href='#56c74b2383af69833500018c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, it times out. Won&#39;t be necessary to do the universe selection within the factor once factors can be masked with a screen.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c90a3130c213afd40000c5' id='56c90a3130c213afd40000c5'>
<a href='#56c90a3130c213afd40000c5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1456015925000' class='quanto-date posted-at response-posted-at' href='#56c90a3130c213afd40000c5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>re: the negative cash, I think this is because in the rebalance, we don&#39;t check available cash to see if we can afford to increase the position size.  For my version, I am going to do two things: only allow rebalance to decrease position sizes, and cap all positions at, say, 5% of the portfolio.  That also seems to be important for stocks which suddenly go very low vol, which happens a lot prior to takeovers/mergers.  Definitely don&#39;t want to be mixing in merger arbitrage into this strategy!  Could also use the EventVestor M&amp;A dataset, but $100/mo is too much for me when I only plan to invest $25k or something into this strategy.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c9b2fed195ba21aa0000b9' id='56c9b2fed195ba21aa0000b9'>
<a href='#56c9b2fed195ba21aa0000b9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1456059138000' class='quanto-date posted-at response-posted-at' href='#56c9b2fed195ba21aa0000b9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Simon,</p>

<ol>
<li>Did you finally find evidence of a momentum effect<br>
(<a href="https://www.quantopian.com/posts/anyone-found-a-substantial-momentum-effect">https://www.quantopian.com/posts/anyone-found-a-substantial-momentum-effect</a>)?<br></li>
<li>It seems you are pulling from everything in the Q database, versus filtering out undesirable stuff (e.g. pink sheets, when-issued, LPs, etc. as illustrated on <a href="https://www.quantopian.com/posts/equity-long-short">https://www.quantopian.com/posts/equity-long-short</a>).  In the code above, you mention &quot;crop down to our pseudo-S&amp;P 500 universe&quot; so I&#39;m wondering, are you intending to grab stocks from a S&amp;P 500 proxy?  If so, is that actually being done?<br></li>
<li>From the results above, I don&#39;t see the allure of the strategy.  I guess the idea is that if there&#39;s another bubble/run up to a crash, as occurred prior to the recent Great Recession debacle, the strategy might outperform and automatically avoid going into the red.  Beyond mid-2009, it just appears to sorta track the S&amp;P 500.<br></li>
<li>Is your overnight gap computation at all realistic, since you can&#39;t use USEquityPricing.open (since it is mysteriously broken, per the Q help page)?<br></li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56ca0937e318b3cb13000149' id='56ca0937e318b3cb13000149'>
<a href='#56ca0937e318b3cb13000149'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1456081212000' class='quanto-date posted-at response-posted-at' href='#56ca0937e318b3cb13000149'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><ol>
<li>Not really, this is just a backtest, and I am not yet convinced.  There are some nice techniques in it though.<br></li>
<li>This is just a filter by market cap, no other filtering.  Some people might want to filter more out.<br></li>
<li>Yeah, it&#39;s not outstanding.<br></li>
<li>If there&#39;s a gap of over 15%, chances are most of that gap was over night, not in continuous trading, so it doesn&#39;t make much of a difference whether you calculate from open or close.<br></li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56ca1401e318b3cb13000197' id='56ca1401e318b3cb13000197'>
<a href='#56ca1401e318b3cb13000197'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1456083974000' class='quanto-date posted-at response-posted-at' href='#56ca1401e318b3cb13000197'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I fixed a couple of things mentioned in this thread, and simplified the algorithm.</p>

<ol>
<li>Fixed the BTU (ticker) issue, where ATR is calculated using different backadjustment paradigms<br></li>
<li>Fixed the LIFE issue, where ATR becomes super narrow due to acquisition target. Filter out stocks with ATR/Price below &lt;0.5%, which is well below the normal range. This avoids ending up with huge dollar values on very low volatility stocks.<br></li>
<li>Removed maxgap and replaced complicated R2 x regression with simple momentum. For me, Andreas included these as his system is semi-manual, and these make the trades more palatable: to make the trends look really obvious on a chart, which is a nice to have in my opinion.<br></li>
<li>Collapsed all lookback periods to 252 days (1 year), to reduce the number of parameters. 100 days works well too.<br></li>
<li>Tidied up the filters/factors, to use some cool features of pipeline<br></li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56ca162c07cde3fb890000bb' id='56ca162c07cde3fb890000bb'>
<a href='#56ca162c07cde3fb890000bb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1456084534000' class='quanto-date posted-at response-posted-at' href='#56ca162c07cde3fb890000bb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I was wondering why the backtest gives a Sharpe of 2.82 (which would be amazing) but the pyfolio tearsheet gives a much more reasonable Sharpe of 0.97.</p>

<pre><code>Backtest  
annual_return          0.17  
annual_volatility      0.18  
sharpe_ratio           0.97  
calmar_ratio           0.79  
stability              0.93  
max_drawdown          -0.22  
omega_ratio            1.19  
sortino_ratio          1.38  
skewness              -0.32  
kurtosis               2.70  
information_ratio      0.04  
alpha                  0.13  
beta                   0.56  
</code></pre>

<p>EDIT: not sure why the notebook is showing that pane.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56ca16eeac0fcfd4960000f3' id='56ca16eeac0fcfd4960000f3'>
<a href='#56ca16eeac0fcfd4960000f3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1456084723000' class='quanto-date posted-at response-posted-at' href='#56ca16eeac0fcfd4960000f3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I don&#39;t trust the backtest sharpes, I think they are not annualized correctly or something, or perhaps use the price return of bonds as the risk-free rate, rather than the continuously compounded yield of bills.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56cb43c095a188cca500013c' id='56cb43c095a188cca500013c'>
<a href='#56cb43c095a188cca500013c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1456161734000' class='quanto-date posted-at response-posted-at' href='#56cb43c095a188cca500013c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey guys, we&#39;re aware of the fault numbers in backtesting, they have to do with the risk-free rates being used to calculate the values. It&#39;s on our short list to fix. For now, use the values returned by the tearsheet in pyfolio, they are correct.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='56d124a088a5e77b02000048' id='56d124a088a5e77b02000048'>
<a href='#56d124a088a5e77b02000048'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5657a09af95a18caf600085a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cb7ba84227ef79495f4a09f8bf9aea38?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5657a09af95a18caf600085a'>Adam Smith</a>
</div>
<a UTCms='1456546980000' class='quanto-date posted-at response-posted-at' href='#56d124a088a5e77b02000048'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Simon and Dan: I did a little modification on the original algo because morningstar.valuation.shares_outstanding is not supported for real money trading yet.  The only change I made is class of MarketCap  </p>

<pre><code>class MarketCap(CustomFactor):  
    inputs = [morningstar.valuation.market_cap]  
    window_length = 1  
        def compute(self, today, assets, out, market_cap):  
                out[:] = market_cap[-1]  
</code></pre>

<p>The attached backtest is based on modified algo for real money trading.  However, the total return drops pretty much compared to Dan&#39;s result.   Do you have any clue why this custom class kills so much on return and sharpe?</p>

<p>Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56e6d88467abe2d7d90007c7' id='56e6d88467abe2d7d90007c7'>
<a href='#56e6d88467abe2d7d90007c7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1457969289000' class='quanto-date posted-at response-posted-at' href='#56e6d88467abe2d7d90007c7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi guys,</p>

<p>I just found this thread and thought I&#39;d throw in a couple of points:</p>

<ul>
<li><p>Bear in mind that the model in the book, just like in my first book, is meant primarily as a teaching tool. That is, it&#39;s a method that works as it but can be improved upon in various ways.  It&#39;s not meant as an optimal model ready for deployment, but rather as a sound foundation. It&#39;s likely to yield nice results over time, but I&#39;m sure you guys can do better.</p></li>
<li><p>Turnover is an issue. If I could redo something in the book, this would be it. As a fund manager, you don&#39;t have to worry about capital gains taxes and trading costs are so low that you can almost disregard them. Even for private accounts, here in Switzerland we don&#39;t have capital gains taxes. This of course is not the situation for everyone. I should have designed the model to greatly reduce turnover, as that will be more of an issue for most readers than for me. I suggest to modify my code to reduce trading. For starters, move to monthly rebalancing and raise the hurdle for position size rebalance.  </p></li>
</ul>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f3fddd09fb3f24d40001ab' id='56f3fddd09fb3f24d40001ab'>
<a href='#56f3fddd09fb3f24d40001ab'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/559be2512492b23da700029f'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d6363d0757fc9f28ced0b7a8d85fdd67?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/559be2512492b23da700029f'>Mark Segal</a>
</div>
<a UTCms='1458830820000' class='quanto-date posted-at response-posted-at' href='#56f3fddd09fb3f24d40001ab'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Simon</p>

<p>Hi Simon,</p>

<p>The  commission and slippage model is set to,  </p>

<pre><code>set_slippage(slippage.FixedSlippage(spread=0.01))  
set_commission(commission.PerShare(cost=0.0035, min_trade_cost=0.35))  
</code></pre>

<p>Are these more reasonable parameters for this kind of algo as opposed to the default setting?</p>

<p>Regards,<br>
Mark  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f3fea940415f91660005b9' id='56f3fea940415f91660005b9'>
<a href='#56f3fea940415f91660005b9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1458831023000' class='quanto-date posted-at response-posted-at' href='#56f3fea940415f91660005b9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think so, yes, but it depends on the precise stocks you are trading and the nature of your account with Interactive Brokers.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f41c934b1d970a6700060e' id='56f41c934b1d970a6700060e'>
<a href='#56f41c934b1d970a6700060e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1458838683000' class='quanto-date posted-at response-posted-at' href='#56f41c934b1d970a6700060e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is a variation of the model, which does not use a trend filter and has simpler rules. It&#39;s more reactive but has a little deeper drawdown. I plan to show this model at QuantCon and will release the full source code after the conference.</p>

<p>Instead of a trend filter, it has a minimum adjusted slope as a requirement.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f65284df37ceeb80000458' id='56f65284df37ceeb80000458'>
<a href='#56f65284df37ceeb80000458'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1458983561000' class='quanto-date posted-at response-posted-at' href='#56f65284df37ceeb80000458'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Andreas - just to check, you know the source code is attached to the backtest?</p>

<p>@Adam - the equity curve looks quite similar, just lower overall return. I would guess that market_cap is somehow only available for lower volatility (ie larger cap) stocks, and this is dampening the return.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f653daf004105901000323' id='56f653daf004105901000323'>
<a href='#56f653daf004105901000323'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1458983903000' class='quanto-date posted-at response-posted-at' href='#56f653daf004105901000323'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I wonder if market cap in fundamentals is only updated quarterly, so the list of highest market cap stocks is &quot;out of date&quot; relative to my list (current price x  last quarter&#39;s shares outstanding). My list would bias to higher current price shares more than your list. I can see how this could pick out recently trending stocks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f6545d2767363645000846' id='56f6545d2767363645000846'>
<a href='#56f6545d2767363645000846'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1458984042000' class='quanto-date posted-at response-posted-at' href='#56f6545d2767363645000846'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Apologies for all the posts, I can&#39;t edit my previous comment on phone.</p>

<p>A good workaround for live trading would be to divide market cap by last quarters price (from a look back on close or from fundamentals) and multiply by current price (from close)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f67b5af00410cbe7000403' id='56f67b5af00410cbe7000403'>
<a href='#56f67b5af00410cbe7000403'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5657a09af95a18caf600085a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cb7ba84227ef79495f4a09f8bf9aea38?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5657a09af95a18caf600085a'>Adam Smith</a>
</div>
<a UTCms='1458994014000' class='quanto-date posted-at response-posted-at' href='#56f67b5af00410cbe7000403'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Dan:  It looks a good way to workaround.  Do you have backtest result can share with us?  </p>

<p>Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f68acbf00410cbe700045f' id='56f68acbf00410cbe700045f'>
<a href='#56f68acbf00410cbe700045f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1458997968000' class='quanto-date posted-at response-posted-at' href='#56f68acbf00410cbe700045f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Adam: I don&#39;t, but maybe the invisible hand will deliver  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f6c6db94d606ae900007de' id='56f6c6db94d606ae900007de'>
<a href='#56f6c6db94d606ae900007de'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1459013344000' class='quanto-date posted-at response-posted-at' href='#56f6c6db94d606ae900007de'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>@Andreas - just to check, you know the source code is attached to the<br>
backtest?</p>
</blockquote>

<p>Well, <em>now</em> I do. :)</p>

<p>No matter, I was going to release that in the wild anyhow. I hope you find it useful. James Christopher has kindly helped me a lot with the code, since I&#39;m not at all a Python coder.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f7d1e4ffbf47f300000149' id='56f7d1e4ffbf47f300000149'>
<a href='#56f7d1e4ffbf47f300000149'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5590c016248f1472ae000286'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1a2b21eaf54a819d57cb3044dba06888?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5590c016248f1472ae000286'>Tim Vidmar</a>
</div>
<a UTCms='1459081704000' class='quanto-date posted-at response-posted-at' href='#56f7d1e4ffbf47f300000149'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Many thanks for the algorithm and the code, Andreas!</p>

<p>Can the indicator that you are using -- the product of the slope and the R^2, if I understood correctly -- be given a straightforward (statistical) meaning? Is there an intuitive way of understanding what it signifies and why it works so well?</p>

<p>Thanks again, </p>

<p>Tim  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f800e14defa9aad60001f6' id='56f800e14defa9aad60001f6'>
<a href='#56f800e14defa9aad60001f6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1459093736000' class='quanto-date posted-at response-posted-at' href='#56f800e14defa9aad60001f6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>What? Didn&#39;t everyone read Stocks on the Move already? It&#39;s all explained in there. :)</p>

<p>Ok fine. Here&#39;s the logic:</p>

<p>First, we use exponential regression to measure the momentum. As opposed to its linear cousin, we get the slope expressed in percent. The daily slope gives you a number with many decimals that&#39;s hard to relate to, so let&#39;s annualized that sucker. Now you have a number which answers the question &quot;How many percent would this stock make in a year, if it was to continue the same trajectory as the recent past?&quot;. No, we don&#39;t expect that to happen, but it gives us a number that we can relate to. </p>

<p>But what about volatility, you ask. Wouldn&#39;t this reward extreme situations, like takeover bids and crazy vola? Yes, but that&#39;s where our friend R2 comes into play. The R2, of coefficient of determination, is a number between 0 and 1 which tells us how well our regression actually fits the data. It would be 1 if all the actual data points are exactly on the line. </p>

<p>So, now we simply punish the volatile stocks by multiplying all of our annualized regression slopes by the R2. A stock with a nice gradual slope will have a high number and won&#39;t take much of a hit. An overly volatile stock filled with big gaps will get pushed down the ladder. </p>

<p>Now we simply buy stocks from the top. Positions are vola parity and rebalancing done monthly. Voila. Simple and robust.</p>

<p>Now go buy my book! :)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f832fcea8d45fb070001f9' id='56f832fcea8d45fb070001f9'>
<a href='#56f832fcea8d45fb070001f9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5590c016248f1472ae000286'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1a2b21eaf54a819d57cb3044dba06888?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5590c016248f1472ae000286'>Tim Vidmar</a>
</div>
<a UTCms='1459106562000' class='quanto-date posted-at response-posted-at' href='#56f832fcea8d45fb070001f9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Sincerest thanks for a very clear explanation, Andreas. You are probably hardly going to believe this but I have independently developed a very similar strategy, as far as I can judge, in which I use the ratio of the average return and the volatility as a ranking criterion (both estimated on a year&#39;s-worth of daily close prices), but it does not work nearly as well as your method. I suspect the crucial difference may be that I do not carry out any volatility based adjustments of the positions.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56f957ed7af16944f900066b' id='56f957ed7af16944f900066b'>
<a href='#56f957ed7af16944f900066b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1459181554000' class='quanto-date posted-at response-posted-at' href='#56f957ed7af16944f900066b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>No problem, Tim. Doesn&#39;t surprise me at all if you did something similar. I&#39;m convinced that a lot of people in the business already know all of what I write about. Hopefully I can explain it better and contribute by teaching and improving upon existing concepts. As opposed to many authors, I never claimed to publish or sell some sort of super system that will make millions in up and down markets, compound at hundreds of percent a year, revolutionize the field and such. </p>

<p>I hope to publish slightly improved variants of concepts which most in the quant HF field already area familiar with, making it accessible and explaining it to people outside this particular field. Without the silly hype.</p>

<p>But that&#39;s not going to stop me from calling the annualized regslope multiplied by R2 by the name Clenow Momentum from now on. Yes, you heard it here first. The all mighty Clenow Momentum indicator is here. Because why not. And because I would find it funny if that name starts showing up in standard charting packages. And because putting your name on stuff seems to qualify you for running for president these days.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57047ea2f284ace4e20003e1' id='57047ea2f284ace4e20003e1'>
<a href='#57047ea2f284ace4e20003e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55423737652061c8f20003ee'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/97ab5803b4df90a5c8fe401c2be71132?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55423737652061c8f20003ee'>Shrikrishna Upadhyaya</a>
</div>
<a UTCms='1459912358000' class='quanto-date posted-at response-posted-at' href='#57047ea2f284ace4e20003e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Andreas,<br>
I tried to run your code but it does not seem to generate any orders? BTW i just finished reading your book and i absolutely loved it. I am new to quantopian and i think your book is a great place to start!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5704ad2f6966432529000271' id='5704ad2f6966432529000271'>
<a href='#5704ad2f6966432529000271'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1459924281000' class='quanto-date posted-at response-posted-at' href='#5704ad2f6966432529000271'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Did you run the algo in minutely mode? If you run it in daily mode, it will probably fail to make orders.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5704de63f284ace4e200069e' id='5704de63f284ace4e200069e'>
<a href='#5704de63f284ace4e200069e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1459936874000' class='quanto-date posted-at response-posted-at' href='#5704de63f284ace4e200069e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks, Dan. Exactly right. </p>

<p>I&#39;m glad you liked the book, Shrikrishna!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5704fd98f3b71d20970001fd' id='5704fd98f3b71d20970001fd'>
<a href='#5704fd98f3b71d20970001fd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5704a8fa55a25472fd0005a0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4f0327bd55fe5faa40b23270c63a88c6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5704a8fa55a25472fd0005a0'>Wouter Joustra</a>
</div>
<a UTCms='1459944860000' class='quanto-date posted-at response-posted-at' href='#5704fd98f3b71d20970001fd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you for your explanation Andreas. Can you tell a bit more regarding your exposure. Because that seems to be the biggest driver of your positive relative performance. It seems that you are &#39;long&#39; at the right time, and not exposed at (almost) the right time. Obviously that is what a momentum indicator has to do, but yours seems to be very good at timing. Can you tell a bit more about that?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='570504eff284ac2eff00081f' id='570504eff284ac2eff00081f'>
<a href='#570504eff284ac2eff00081f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1459946739000' class='quanto-date posted-at response-posted-at' href='#570504eff284ac2eff00081f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Simple really, Wouter. The model buys positive absolute momentum. If there are are not many stocks available with positive momentum, there&#39;s nothing to buy. As you see in the code, there&#39;s a variable for minimum allowed momentum.</p>

<p>There&#39;s no special timing mechanism at work. It&#39;s just that we don&#39;t buy stocks that aren&#39;t performing. And in a bear market, almost nothing is.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5705627ff3b71df975000698' id='5705627ff3b71df975000698'>
<a href='#5705627ff3b71df975000698'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57022334065314b77a0006b4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6db2af53f0ac1c1c9a43e8ec8ccbab87?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57022334065314b77a0006b4'>Pietro</a>
</div>
<a UTCms='1459970692000' class='quanto-date posted-at response-posted-at' href='#5705627ff3b71df975000698'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Why in minute mode we see trades while in daily mode it fails?  Can someone explain the technical reason?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57192bfebb3e7d6347000d01' id='57192bfebb3e7d6347000d01'>
<a href='#57192bfebb3e7d6347000d01'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562545816f0077be2a000054'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/65eed7bd690af7911cb4e82f70d3a8f6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562545816f0077be2a000054'>Shawn Emhe II</a>
</div>
<a UTCms='1461267462000' class='quanto-date posted-at response-posted-at' href='#57192bfebb3e7d6347000d01'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Andreas,<br>
 I was working with your algorithm before Quantopian upgraded to &quot;Q2&quot;. I became interested in your momentum ranking after watching your &quot;Trade like a Chimp&quot; presentation via the quantcon live stream, so I was happy to find the algo here. But I ran into an issue when trying to resolve the &quot;shares_outstanding&quot; live trade limitation that Dan H pointed out. However, when converting the MarketCap function to use the morningstar.valuation.market_cap data directly from pipeline the results were affected more than I expected.</p>

<p>First things first, I modified the code to take advantage of the Q2 enhancements. A summary of the changes are below, along with a backtest of the updated algorithm. I have to say, Q2 really did increase the speed of this backtest significantly.</p>

<blockquote>
<p>Revisions:<br>
Corrected the following errors to migrate the algorithm to &quot;Q2&quot;<br>
Line 60: Function <code>update_universe</code> is deprecated.<br>
Line 104: The <code>history</code> method is deprecated. Use <code>data.history</code> instead.<br>
Line 105: The <code>history</code> method is deprecated. Use <code>data.history</code> instead.<br>
Line 106: The <code>history</code> method is deprecated. Use <code>data.history</code> instead.<br>
Line 137: Checking whether an asset is in data is deprecated.<br>
Line 139: <code>data[sid(N)]</code> is deprecated. Use <code>data.current</code>.<br>
Line 141: <code>data[sid(N)]</code> is deprecated. Use <code>data.current</code>.<br>
Line 117: <code>data[sid(N)]</code> is deprecated. Use <code>data.current</code>.<br>
Line 119: Checking whether an asset is in data is deprecated.<br>
Line 122: Checking whether an asset is in data is deprecated.</p>

<p>Also added error checking to the position sizing function. The<br>
get_poistion_size function threw an input length exception during<br>
one of my backtests. I assume that for whatever reason the backtest<br>
environment wasn&#39;t able to collect full price data for a particular<br>
stock and this broke the talib atr function. To fix this the function<br>
will return 0 if the atr function throws an exception. It will also<br>
log a warning. This seems like a fair way to avoid ordering a security<br>
for which a risk adjusted position size cannot be caluculated.  </p>
</blockquote>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='571933f428b7a23e3b000a51' id='571933f428b7a23e3b000a51'>
<a href='#571933f428b7a23e3b000a51'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562545816f0077be2a000054'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/65eed7bd690af7911cb4e82f70d3a8f6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562545816f0077be2a000054'>Shawn Emhe II</a>
</div>
<a UTCms='1461269496000' class='quanto-date posted-at response-posted-at' href='#571933f428b7a23e3b000a51'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is a second version of the algorithm. The only change is that this version captures market cap as:  </p>

<pre><code>class MarketCap(CustomFactor):  
    inputs = [morningstar.valuation.market_cap]  
    window_length = 1

    def compute(self, today, assets, out, mcap):  
        out[:] = mcap[-1]  
</code></pre>

<p>as opposed to the below, which requires the shares_outstanding data which is unavailable in live trading:</p>

<pre><code>class MarketCap(CustomFactor):  
    inputs = [USEquityPricing.close, morningstar.valuation.shares_outstanding]  
    window_length = 1  
    def compute(self, today, assets, out, close, shares):  
        out[:] = close[-1] * shares[-1]  
</code></pre>

<p>I expected the results to be nearly identical, but as you can see the returns are significantly lower. This suggests that the universe of stocks used to trade has a large impact on the system&#39;s performance. I found this <a href="http://gestaltu.com/2016/01/tactical-alpha-part-iii-asset-allocation-security-selection.html/">post</a> a while ago which makes a strong argument for why a difference of stocks in the universe can lead to these results, but it doesn&#39;t explain why the results of two versions of the MarketCap function are so different.</p>

<p>The issue probably stems from errors with the back adjustment of the values, possibly the same errors that motivated Quantopian&#39;s developers to disable the shares_outstanding data in live trading. They could be causing one version to return a list of large cap stocks and the other (relatively) mid/small cap stocks. If this were the case the performance differences would stem from the difference in returns of large and small or mid cap stocks over the backtest period.</p>

<p>Either way, the results motivate further testing. I am working on moving the slope calculation into the pipeline itself so that the full 8000+ stocks can be ranked and tested against, rather than a market based subset. This will allow a test of the performance of the &quot;Clenow Momentum&quot; ranking independent of market cap. I am also working on a research notebook so that I can replicate your random simulations with a faster vectorized backtester. Do you have any suggestions of what else could be causing this that I could look into as I test?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='572676668536acdb110003e8' id='572676668536acdb110003e8'>
<a href='#572676668536acdb110003e8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/563d6b72f5cf3f200200018e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7f25c069338a5aabe9724fb2e468bda4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/563d6b72f5cf3f200200018e'>Bruce Lee</a>
</div>
<a UTCms='1462138478000' class='quanto-date posted-at response-posted-at' href='#572676668536acdb110003e8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>A silly question. I tried to clone it and do the full backtest. But the most updated data I can retrieve is until Apr 1st. Is there any limitation on quantopian or  I got anything wrong?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57270779d187631cc10005ea' id='57270779d187631cc10005ea'>
<a href='#57270779d187631cc10005ea'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1462175614000' class='quanto-date posted-at response-posted-at' href='#57270779d187631cc10005ea'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Shawn,</p>

<p>Sorry for the late reply. </p>

<p>I have to admit that I&#39;m not overly familiar with the Quantopian environment and technical details. You seem to have found an interesting issue though. I didn&#39;t write the Quantopian code at all actually. I gave my spec to James Christopher at Quantopian who kindly coded it for me. </p>

<p>My local solution, built in C#, is not looking at market cap at all, but rather at historical index membership. I made an &#39;indicator&#39; where you input a stock ticker and an index ticker, and it will return 1 on any day that stock was part of that index, else 0. This way I can make sure that the simulation only considers stocks that were part of a particular index on a particular day.</p>

<p>I&#39;ve done this on many different indexes, American and international, large cap, mid cap, small cap etc, and the concept appears robust across all of these. Of course, it works better on larger indexes with at least a few hundred stocks to pick from.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57279f49cb007a03570002b0' id='57279f49cb007a03570002b0'>
<a href='#57279f49cb007a03570002b0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562545816f0077be2a000054'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/65eed7bd690af7911cb4e82f70d3a8f6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562545816f0077be2a000054'>Shawn Emhe II</a>
</div>
<a UTCms='1462214481000' class='quanto-date posted-at response-posted-at' href='#57279f49cb007a03570002b0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Andreas,<br>
 Thank you for the reply. I did some comparisons in the research environment and found that the manual calculation returns values that can be many times higher than directly querying the historical market cap. The unadjusted number of shares outstanding is causing stocks that have split to be valued in multiples higher than they should be. This is bumping small(er) cap stocks up into the list and increasing the portfolio exposure to small cap stocks. It also explains the performance boost as small caps have tended to outperform the market.<br>
 But, as you&#39;ve said in your book, it can be ok to have an exposure to a risk factor as long as you&#39;re aware of it. And in this case I think this is a chance for smaller momentum investors to take advantage of their size and capture returns in stocks that might not be liquid enough for large momentum funds.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5729f3f0f76982666f000b45' id='5729f3f0f76982666f000b45'>
<a href='#5729f3f0f76982666f000b45'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/569f991732c4400e730000fc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/59075c6a02e25cc9759c4d19d5a92e91?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/569f991732c4400e730000fc'>Adrian Veidt</a>
</div>
<a UTCms='1462367224000' class='quanto-date posted-at response-posted-at' href='#5729f3f0f76982666f000b45'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Actually seems that based on the code below some negative slopes might be promoted over some positive slopes trough even exp in pow  </p>

<pre><code>annualized_slope = (1 + slope)**250  
</code></pre>

<p>So, a slope of -2.9 will yield higher result in above expression over slope of 0.8. I don&#39;t know how realistic these slope numbers are, in my research with OLS I haven&#39;t seen such steep slopes.</p>

<p>I made a little correction to annualized slope calculation for negative slopes<br>
<code>
annualized_slope = (1 + abs(slope))**250 * (-1 if slope &lt; 0 else 1)  
</code></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='572d461ad42b61f8d200061d' id='572d461ad42b61f8d200061d'>
<a href='#572d461ad42b61f8d200061d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5426eee808a6c248b400108d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/df2ef8efddd4f992bb9eaf68dff9cb71?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5426eee808a6c248b400108d'>Jon Mitts</a>
</div>
<a UTCms='1462584863000' class='quanto-date posted-at response-posted-at' href='#572d461ad42b61f8d200061d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Bruce, I&#39;ve been noticing that issue lately, but it seems to resolve itself with a browser refresh.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57c11cf5bfaa797da4000419' id='57c11cf5bfaa797da4000419'>
<a href='#57c11cf5bfaa797da4000419'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5445d537ae79a971410002a2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/09181dbdc9b379152fc5f6b2e49e8599?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5445d537ae79a971410002a2'>Kiran</a>
</div>
<a UTCms='1472273659000' class='quanto-date posted-at response-posted-at' href='#57c11cf5bfaa797da4000419'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>When is the portfolio sold and re-adjusted based on the new ranks?  In the code I only saw a rebalance trigger based on +/- 0.5% change in portfolio value.  Is there also a time-trigger (monthly / weekly) for readjusting the portfolio with new stocks based on ranks?</p>

<p>thx<br>
Kiran  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57c4cf592b2564b649000022' id='57c4cf592b2564b649000022'>
<a href='#57c4cf592b2564b649000022'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1472515935000' class='quanto-date posted-at response-posted-at' href='#57c4cf592b2564b649000022'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I took Shawn&#39;s version of the program, since deprecation issues had been resolved. </p>

<p>Made some modifications intended to raise total return. </p>

<p>Each modification is listed at the end of the program with its corresponding output and reasoning. Each test was done once.</p>

<p>Here is the summary of those tests:</p>

<h1>Stocks on the Move  With Mods</h1>

<p><a href="http://alphapowertrading.com/images/divers/Stocks_on_the_Move.png">http://alphapowertrading.com/images/divers/Stocks_on_the_Move.png</a></p>

<p>These modifications rose the CAGR to 24.82%. This without any change in the program&#39;s logic or procedures.  This is more interesting than the 11.46% of the original version.<br>
I went for the pressure decision points in this program. Did not change code, only assumptions. Meaning that default value of specific variables were changed with the intention of having the program produce more. Technically, I have not read the whole program in detail yet, but I expect to be able to do even more when I do.</p>

<p>So, here is the last backtest:  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58781c86d03c0d1578774d08' id='58781c86d03c0d1578774d08'>
<a href='#58781c86d03c0d1578774d08'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5841af213c428400120004f8'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/323c3a3502407038cb460446e9ce7264?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5841af213c428400120004f8'>Caleb Sandfort</a>
</div>
<a UTCms='1484266630000' class='quanto-date posted-at response-posted-at' href='#58781c86d03c0d1578774d08'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy</p>

<p>I&#39;ve been implementing this strategy myself before coming across this post.  Very impressed with your results, but i have one question. You state:</p>

<p><em>4th mod: context.risk_factor = 0.010; was0.001. Will allow more positions to be taken</em></p>

<p>My question is how does that allow more positions to be taken? Doesn&#39;t it result in larger position sizes and fewer positions?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='588197033c4cb21788731eac' id='588197033c4cb21788731eac'>
<a href='#588197033c4cb21788731eac'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54ea8659ffbdace6b1000046'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f6473f61059455485d908ab4fafd607a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54ea8659ffbdace6b1000046'>Jeff Liu</a>
</div>
<a UTCms='1484887811000' class='quanto-date posted-at response-posted-at' href='#588197033c4cb21788731eac'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Can we add SPY as reference in the following way?<br>
if SPY has a negative slope (which indicates a downturn),short certain amount of SPY for hedging?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58819b7dad53b6000a437bac' id='58819b7dad53b6000a437bac'>
<a href='#58819b7dad53b6000a437bac'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54ea8659ffbdace6b1000046'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f6473f61059455485d908ab4fafd607a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54ea8659ffbdace6b1000046'>Jeff Liu</a>
</div>
<a UTCms='1484888957000' class='quanto-date posted-at response-posted-at' href='#58819b7dad53b6000a437bac'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Can you someone help on coding:<br>
I intend to replace the hard-coded criteria by  comparing slopes &gt; context.min_momentum<br>
    slopes = slopes[slopes &gt; context.min_momentum]<br>
But rather compare recent slopes &gt; slopes_lag by x days?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5894d569acdeab59d14afdd8' id='5894d569acdeab59d14afdd8'>
<a href='#5894d569acdeab59d14afdd8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5866cd23ff2002001200016c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2116e4ddae90ff54a84bb81f2bbbce11?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5866cd23ff2002001200016c'>tony hussey</a>
</div>
<a UTCms='1486148969000' class='quanto-date posted-at response-posted-at' href='#5894d569acdeab59d14afdd8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Clearly this has spectacular returns and is well written...  the draw-down, however, is significant in the 2008-09 period and early 2016 drops... what can we do to reduce the draw-downs on this?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58a4d70fec21ad491d6cfefe' id='58a4d70fec21ad491d6cfefe'>
<a href='#58a4d70fec21ad491d6cfefe'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56b8fc555552f5c7780001d5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/70322f98450e2b24406ee4aefbd08244?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56b8fc555552f5c7780001d5'>Sam West</a>
</div>
<a UTCms='1487197967000' class='quanto-date posted-at response-posted-at' href='#58a4d70fec21ad491d6cfefe'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@caleb It results in allot less positions. It translates to 10% of the account being used for the ATR of each position. If you run the backtest you&#39;ll see that only 3-6 positions are open at a time. e.g. if you&#39;ve got a 100,000 account and an ATR of 1.4 it&#39;ll buy 714  =  ((100,000*0.01)/1.4). If the cost of the security is say $50 you&#39;ll end up spending $35,700 on the first stock or 35% of the account. The cheaper the securities the more positions you&#39;ll have. FYI same period with a fixed 10% per position results in 820%  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bba23e7d39ef000aa9af08' id='58bba23e7d39ef000aa9af08'>
<a href='#58bba23e7d39ef000aa9af08'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5129ae40f774c193b9000016'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/152c39c2e4d769a2a01834a7e74559e9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5129ae40f774c193b9000016'>Scott Phillips</a>
</div>
<a UTCms='1488691774000' class='quanto-date posted-at response-posted-at' href='#58bba23e7d39ef000aa9af08'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;m a purely systematic futures trader, teaching myself python so I can use quantopian, and reduce my reliance on contract programmers and ninjatrader (which I hate with a biblical fury). I read Mr Clenow&#39;s excellent book, and believe the concept is both valid and robust, and not difficult to improve upon in easy ways.</p>

<p>The most obvious way to improve upon it is to lower the drawdowns and then use those lowered drawdowns to up the leverage.</p>

<p>One way that I have used in the past I borrowed from a hedge fund friend of mine, and simplified. It works like this. </p>

<p>Plot your equity curve. Plot an all time high on it, and a 20 day low. It should look something like this.</p>

<p><a href="https://snag.gy/AB7pfE.jpg">https://snag.gy/AB7pfE.jpg</a></p>

<p>Measure the distance between your all time high and the 20 day low (or monthly low, or whatever, it doesn&#39;t matter and shouldn&#39;t really be optimised too heavily) and calculate the percentage from  the bottom. </p>

<p>If you are half way between the 20 day low and the all time high, rebalance so that your positions are half size. If it&#39;s 25% of the way, reduce position sizing to 1/4, etc.</p>

<p>There are a few variants of this I have tried, and I favour turning the system off and paper trading (to preserve an equity curve so you know when to turn it back on) below 25%.</p>

<p>On intraday systems or very prolific systems, a good option is to ONLY trade the system for real money when equity curve is within 25% of the all time high (against the 20 trade low or whatever you are using as a low). Intraday systems tend to run &quot;hot and cold&quot; going through periods of superperformance then underperformance, so this neatly avoids having to do lagging, and inevitably backward looking market regime filters like, for example trading only when the market is above 200 SMA.</p>

<p>After years of trying to match market regime filters to systems, I gave up when I saw this. Fidelity hedge fund in Japan has used something very similar in production for a long time.</p>

<p>I really think this would work very well on this system :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bda2a932b4567a19306a2a' id='58bda2a932b4567a19306a2a'>
<a href='#58bda2a932b4567a19306a2a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58b5f98a4f96ba3f8c83e410'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6c63f85ea771b1f7f228ae8d9a2345ea?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58b5f98a4f96ba3f8c83e410'>Marc Syp</a>
</div>
<a UTCms='1488822953000' class='quanto-date posted-at response-posted-at' href='#58bda2a932b4567a19306a2a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy Fleury --</p>

<p>I have cloned your algorithm and played around with it a bit.  I&#39;m a bit green when it comes to investing, but I&#39;m toying with testing a few strategies with a small amount of capital.  A few questions before I jump into the deep end with this one:</p>

<p>1) Sorry if this is a naive set of questions -- but can this strategy work as well without utilizing leverage?  I notice that it appears to stay below 2x exposure, but I don&#39;t see how that is controlled within the algo.  It appears to leverage and rebalance shortly thereafter.  Does that lower the risk of using leverage?  Would a first time investor like myself be granted 2x leverage or need to provide collateral in case of a margin call?  </p>

<p>2) The backtests on a very low amount of capital (3-5k) appear to perform really well -- I recently started a paper trading test with 4k and will see how that pans out in the next month or two.  In the meantime, is there anything I should watch out for with live trading with real capital at this level of investment?</p>

<p>Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58bdddc0edf0755ab25c3602' id='58bdddc0edf0755ab25c3602'>
<a href='#58bdddc0edf0755ab25c3602'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5129ae40f774c193b9000016'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/152c39c2e4d769a2a01834a7e74559e9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5129ae40f774c193b9000016'>Scott Phillips</a>
</div>
<a UTCms='1488838080000' class='quanto-date posted-at response-posted-at' href='#58bdddc0edf0755ab25c3602'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Marc,</p>

<p>Strongly recommend you read both Mr Clenow&#39;s books before trading this live. Without a more than superficial understanding of the mechanics you will almost certainly be tempted to turn it off or tinker with it when it goes in drawdown. I think he intended this system (and his previously published one) to be illustrative of a concept and not a real production system. It <em>should</em> be quite easy to improve on the concept in material ways without sacrificing robustness (the more conditions you add to a system the more fragile it becomes, meaning the return improves, but one day it falls apart inexplicably).</p>

<p>The low hanging fruit might be to improve on the trend filter (a single MA is quite lagging), adding some short SPY as a hedge when market goes bearish, doing momentum by sector as well as individually (and allocating to the strongest sector first), or expanding the universe (more universe - more opportunities). Also my previous suggestion of scaling up and down depending on how well the system is performing generally makes solid improvements.</p>

<p>Has anyone got other simple ideas for improvements. The concept seems very sound to me, and the fact it works across different markets gives me more confidence in it&#39;s robustness.</p>

<p>Treatment of margin with interactive brokers is covered here <a href="https://ibkb.interactivebrokers.com/article/2085">https://ibkb.interactivebrokers.com/article/2085</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c181c54eaa1b61df73069e' id='58c181c54eaa1b61df73069e'>
<a href='#58c181c54eaa1b61df73069e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1489076677000' class='quanto-date posted-at response-posted-at' href='#58c181c54eaa1b61df73069e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Absolutely right, Scott. All models I&#39;ve published in my books are designed to be teaching tools, not The Clenow Super System. The idea is to teach the concept and explain the logic.</p>

<p>I honestly think that it&#39;s of much greater value to readers if I publish simplified learning models than a polished production model. My intent isn&#39;t that everyone start trading my exact rules. It&#39;s that readers learn how to do these things for themselves, how to adapt models to their own need and develop their own. After all, as the old proverb goes &quot;If you give a freezing man a match, he&#39;ll stay warm for a second, but if you set him on fire he&#39;ll stay warm for the rest of his life&quot;. Or well, something along those lines. Proverbs are hard.</p>

<p>I am actually working on a new book, where I intend to show much more advanced momentum models, among other things. My current plan is to provide Quantopian code wherever possible, to demonstrate the models. They will be a bit more complex models and will be user configurable.</p>

<p>I&#39;ll have futures models in the new book as well, and I hope the Quantopian futures functionality will be finished enough so I can include source for those too.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58c53b31f78725000d15dbb5' id='58c53b31f78725000d15dbb5'>
<a href='#58c53b31f78725000d15dbb5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57ba18811646fc2075000b2e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e8958c457a60cb5c7cde7d3e6d6bf706?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57ba18811646fc2075000b2e'>Carl Bosson</a>
</div>
<a UTCms='1489320753000' class='quanto-date posted-at response-posted-at' href='#58c53b31f78725000d15dbb5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Scott, </p>

<p>Thank you so much for posting the link regarding IB&#39;s buying power and margin. Their customer service is the biggest pile of S**T I&#39;ve ever dealt with(pardon me...). Have been opening five different tickets regarding API and its integration to leverage. All they ever do is referring you to their  section for portfolio margin. You are a true lifesaver! Thank you again.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d1d46b64a6bb3dbde4f566' id='58d1d46b64a6bb3dbde4f566'>
<a href='#58d1d46b64a6bb3dbde4f566'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58aa132d4b1b7158de619b6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/864d1e551cd7756a1b4132f3d1c841cd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58aa132d4b1b7158de619b6b'>Charles Pare</a>
</div>
<a UTCms='1490146411000' class='quanto-date posted-at response-posted-at' href='#58d1d46b64a6bb3dbde4f566'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I played a bit with it, activating only the market (SPY) trend filter and not the SMA filter on individual stocks gives a bit more juice.</p>

<p>DD is also down at 35%. Next mod: when the market trend filter is down, sell faster... stay tuned</p>

<p>I&#39;m halfway reading the book, will finish it first :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d2368b0d78173ec527d885' id='58d2368b0d78173ec527d885'>
<a href='#58d2368b0d78173ec527d885'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1490171531000' class='quanto-date posted-at response-posted-at' href='#58d2368b0d78173ec527d885'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Charles,</p>

<p>I just had a quick look at the code, and have a couple of comments. </p>

<p>The model in my book is meant for you guys to experiment with and improve. There are plenty of ways to improve it, but it&#39;s a good base to start out from.  I&#39;m planning on releasing a more advanced version soon, with more features and a lot of settings to play around with.</p>

<p>There&#39;s a dangerous thing I see here though that I&#39;d caution against.  I see that risk factor is raised to 0.01, with an interesting comment (4th mod). &quot;Will allow for more positions to be taken&quot;. No, it will do the absolute opposite. It will reduce the portfolio size to 3-4 positions, providing an extreme portfolio concentration, kill diversification and add a huge event risk. </p>

<p>The current iteration has the following portfolio composition, as of March 17, 2017:<br>
<strong>AMD: 20.5%<br>
NTAP: 56.9%<br>
NVDA: 28.0%<br>
UAL: 35.5%<br>
Cash: -40.9%<br>
Total equity exposure: 140.9%</strong></p>

<p>The backtest looks good, in theory. But make no mistake, this is an extremely dangerous strategy in that shape.  57% in a single stock is not something I&#39;d recommend. </p>

<p>I&#39;d suggest to either lower the risk factor, or change the logic to have a fixed target number of stocks.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d2a72834c52c2e9f41e718' id='58d2a72834c52c2e9f41e718'>
<a href='#58d2a72834c52c2e9f41e718'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490200360000' class='quanto-date posted-at response-posted-at' href='#58d2a72834c52c2e9f41e718'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I like Charles&#39; modifications to this program. In periods of possible turmoils he reduced leverage to close to zero by turning to cash as a drawdown protection. It does answer the question: why be long if the market is going down? Also, his methods only touch the highest capitalization stocks. Meaning stocks with a very low probability of going bankrupt the next day or so. In fact, over the 14.42 years, none did.</p>

<p>As for the times leverage was used, it appears as a reasonable price to pay for the added excess return.</p>

<p>Leverage will have to be paid, but only for the periods where it exceeded 1.00. It appears as if it was in spurts amounting to about one third of the time or less with an estimated visual average of about 1.10.</p>

<p>I pushed a little bit more. First, I set the initial capital at $1M. Then set leverage explicitly at 1.30. A procedure which would entail higher leveraging fees. The question being: would the strategy withstand the added pressure. The following formula was used to estimate the leveraging charges:  A(t) = (1 + L)A(0)(1 + r +   0.03L)^t.</p>

<p>Result: 26.61% CAGR, after all expenses paid. Before leveraging fees: 28.41% CAGR.<br>
Total net liquidating value: $ 30,071,752 after expenses.</p>

<p>Note that my estimate in this case does over-charge on leveraging fees ($6,791,416).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d2ce3f7ff723000d34f82b' id='58d2ce3f7ff723000d34f82b'>
<a href='#58d2ce3f7ff723000d34f82b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58a1efc120596b38743243bb'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d6c15c21239a25a8a60915d747aa7df3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58a1efc120596b38743243bb'>tester Ro</a>
</div>
<a UTCms='1490210367000' class='quanto-date posted-at response-posted-at' href='#58d2ce3f7ff723000d34f82b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Guy Fleury  it&#39;s the first public algo that is see that generates a positive return having:<br>
 - Comissions set<br>
 - Multiple positions opened everyday<br>
 - 10.000$ as initial capital</p>

<p>Time to scrutinize how exactly does it work  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d2e9347ff723000a34fa2b' id='58d2e9347ff723000a34fa2b'>
<a href='#58d2e9347ff723000a34fa2b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1490217268000' class='quanto-date posted-at response-posted-at' href='#58d2e9347ff723000a34fa2b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;m only looking at the most recent algo. It is not what it appears to be due to over $12M hidden margin. So you would have to tell an investor, this can turn 13M into 36M in 14 years and its the same as if you just buy SPY except we haven&#39;t considered margin costs so nevermind.<br>
Try scheduling closing of any positions that need to be closed at market open separately to help improve on that, and then I&#39;m pretty sure you&#39;ll have something impressively  profitable. It is some good work. Just has that one boo-boo, hidden margin that is so common.</p>

<p>Edit: Now I see that function is per security (not enough sleep), so the following comment doesn&#39;t apply here: When dropna() is used on a dataframe with more than 1 column, in this case any time any stock has a nan, that date is removed for all stocks. Might not be what you want. In place of highs.ffill().dropna(), try highs.ffill().bfill()</p>

<p>Use <a href="http://quantopian.com/posts/pvr">PvR</a> to see clearly.<br>
2017-03-17 13:00 _pvr:222 INFO PvR 0.0733 %/day   cagr 0.3   Portfolio value 36863169   PnL 35863169<br>
2017-03-17 13:00 _pvr:223 INFO   Profited 35863169 on 13477370 activated/transacted for PvR of 266.1%<br>
2017-03-17 13:00 _pvr:224 INFO   QRet 3586.32 PvR 266.10 CshLw -12477370 MxLv 1.83 RskHi 13477370 MxShrt 0<br>
2017-03-17 13:00 pvr:310 INFO 2002-10-17 to 2017-03-17  $1000000  2017-03-22 16:06 US/Eastern<br>
Runtime 0 hr 57.7 min</p>

<p>There&#39;s a kind of nifty alternative that I like for lines like this:</p>

<pre><code>    if current_market_price &gt; average_market_price:  
    #if 1 &gt; 0: # dummy  
</code></pre>

<p>To make the line always run in testing you can do this since 1 evaluates to True:</p>

<pre><code>    if 1 or current_market_price &gt; average_market_price:  
</code></pre>

<p>On the other hand to always skip, since 0 is False:</p>

<pre><code>    if 0 and current_market_price &gt; average_market_price:  
</code></pre>

<p>I use those quite a bit.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d317cb77db2f000db50330' id='58d317cb77db2f000db50330'>
<a href='#58d317cb77db2f000db50330'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490229195000' class='quanto-date posted-at response-posted-at' href='#58d317cb77db2f000db50330'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Following Clenow&#39;s comments on position concentration. I changed one number. Generated a smoother equity line, increased number of positions, reduced concentration, reduce drawdown, reduced leveraging fees, and reduced volatility at the expense of a reduced overall profit. There is a price to pay for everything.</p>

<p>Nonetheless, it is still a 23.36% CAGR with a relatively low volatility number.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d328b1d6b6421383cbd609' id='58d328b1d6b6421383cbd609'>
<a href='#58d328b1d6b6421383cbd609'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58aa132d4b1b7158de619b6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/864d1e551cd7756a1b4132f3d1c841cd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58aa132d4b1b7158de619b6b'>Charles Pare</a>
</div>
<a UTCms='1490233521000' class='quanto-date posted-at response-posted-at' href='#58d328b1d6b6421383cbd609'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Guy,<br>
I think that instead of multiplying the ATR*5 you could just change the risk factor  (context.risk_factor = 0.01) to 0.002. That<code>s the point of this variable if I</code>m not mistaken.</p>

<p>The same way we could add a variable for the leverage to be able to play with it and try different scenarios</p>

<p>Hi Andreas,<br>
It`s such a pleasure to have you reading the thread. Guy Fleury showed that lowering the risk by having more positions and compensating with a bit of leverage can give the same end result.</p>

<p>Now in you opinion, because you talk a lot about managing (buying) the risk and not the money in your book, is there any difference from changing the risk factor from 0.01 to a lower number like 0.001 and add leverage to achieve the same yield? Less risk from one stock crashing our portfolio since we have more positions,more diversification but more chances of going under because we borrowed.</p>

<p>Thanks!<br>
Charles  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d3371d95ed8c000a303c1f' id='58d3371d95ed8c000a303c1f'>
<a href='#58d3371d95ed8c000a303c1f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490237213000' class='quanto-date posted-at response-posted-at' href='#58d3371d95ed8c000a303c1f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Followed Charles&#39;s advice and eliminated the ATR. Put the risk_factor at 0.001 which should satisfy Clenow&#39;s observations.</p>

<p>CAGR = 27.26% including all frictional costs and leveraging fees. </p>

<p>Net liquidating value: $32,368,742.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d33bc293d56c1ee23d8cbe' id='58d33bc293d56c1ee23d8cbe'>
<a href='#58d33bc293d56c1ee23d8cbe'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490238402000' class='quanto-date posted-at response-posted-at' href='#58d33bc293d56c1ee23d8cbe'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here are the tear-sheets analysis on the above simulation.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d377a793d56c0ae53d8acb' id='58d377a793d56c0ae53d8acb'>
<a href='#58d377a793d56c0ae53d8acb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1490253735000' class='quanto-date posted-at response-posted-at' href='#58d377a793d56c0ae53d8acb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>Now in you opinion, because you talk a lot about managing (buying) the<br>
risk and not the money in your book, is there any difference from<br>
changing the risk factor from 0.01 to a lower number like 0.001 and<br>
add leverage to achieve the same yield? Less risk from one stock<br>
crashing our portfolio since we have more positions,more<br>
diversification but more chances of going under because we borrowed.</p>
</blockquote>

<p>Remember that the risk factor here just impacts your position sizes, not the overall portfolio risk. Assuming that you keep the maximum allowed exposure constant, a risk factor of 0.01 will result in a higher defacto risk, as we&#39;ll end up with very few positions. Each stock will have an enormous portfolio impact, leaving you exposed to event risk and without diversification. </p>

<p>In a simulation, fewer stocks usually look better. In reality, that means that you will likely take a big hit when some unexpected event occurs. Just imagine the pain of having a 60% position, and suddenly see it fall 20% on a profit warning. If your portfolio holds 20 stocks or more, the event risk is lower.</p>

<p>Also keep in mind that this is beta heavy strategy. Your primary exposure is to the overall equity markets. You get a lower beta in a long term simulation, because of the built in downside protection. But in normal markets, you&#39;re just heavily long. Leverage can be great, and it can be dangerous. I see no issue with leverage in itself, as long as you are very aware of what you are doing and why. I prefer an unlevered approach when it comes to stocks, but I enjoy taking heavy leverage on futures models. </p>

<p>I didn&#39;t yet look closer at Guy&#39;s latest iteration, but on the surface it looks like it&#39;s not showing exposure over 100% very often. It would be interesting to see how his version would do if you hard cap it to 100% (no leverage). I&#39;m not saying his approach is wrong in any way, but it would be an interesting test. When I find a bit of time, I&#39;ll dig into his version and check what other improvements he made in there.</p>

<p>In case you guys feel like tinkering more: My own models of this kind usually have <em>a lot</em> more settings, for trying different variations. For this model, you could try using a fixed number of stocks, a minimum slope, removing some of the filters like percentile and trend filter, using different allocation models like equal, market cap, inverse market cap, multi factor etc.</p>

<p>And finally, if you&#39;d like to study how the big boys do it, read the methodology paper for the MSCI USA Momentum Index. I wouldn&#39;t copy their approach, since their purposes are different from yours, but there are some interesting points in there. It&#39;s all public.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d3eba495ed8c0af2303aec' id='58d3eba495ed8c0af2303aec'>
<a href='#58d3eba495ed8c0af2303aec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490283428000' class='quanto-date posted-at response-posted-at' href='#58d3eba495ed8c0af2303aec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In Charles&#39; program version (which is quite different from the original) the risk_factor is used to determine the bet size. Making it, de facto, a fix fraction trade allocation method. A very old method dating back prior to the sixties. See the line:</p>

<p>context.portfolio.portfolio_value  context.risk_factor</p>

<p>The fix fraction has some advantages and some drawbacks. For one, it is an easy allocation method. In this case 1% of portfolio value is allocated per position. Meaning that you can have up to 100 stocks in your portfolio at any one time. This is more than enough for diversification purposes. Its drawback is that it is a limiting factor. Irrespective of the merits of a position, all it gets is this 1% of equity. It is a good thing that only the highest caps that were going up are trade candidates in this case.</p>

<p>Any trading strategy can be expressed as: (H.P). You can scale it: k(H.P) by providing more capital. The scaling will increase the position size. Compared to the first iteration of this program, I went for a k = 10. Doing so should have generated 10 times the profit. To do this I had to put down 10 times more in capital. If the trading strategy scaled well, overall, it should have provided the same return, percentage wise, as the first program. Saying that the equity line would be the same as in the first program. Scaling gives: A(t) = kA(0)(1 + r)^t. Notice that there was no alpha in the first presented program in this thread.</p>

<p>If I wanted to go further, I could use some leverage which would result in: (1+L)k(H.P). Evidently, I would have to pay the leveraging fees: A(t) = (1+L)kA(0)(1 + r - lc%)^t. This would be bad since overall it would reduce the strategy&#39;s CAGR. You would simply be assured to underperform the no leverage scenario.</p>

<p>However, the outcome changes a lot if you can add some positive alpha to the mix as Charles&#39; version did. A(t) = (1+L)kA(0)(1 + r +  - lc%)^t.</p>

<p>The question should be: are the relatively small and short excursions above 1.00, which were all paid for, worth the $32,368,742 net liquidating value?</p>

<p>Now, that is a nice question?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d470074fde6b0be1277e29' id='58d470074fde6b0be1277e29'>
<a href='#58d470074fde6b0be1277e29'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58aa132d4b1b7158de619b6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/864d1e551cd7756a1b4132f3d1c841cd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58aa132d4b1b7158de619b6b'>Charles Pare</a>
</div>
<a UTCms='1490317319000' class='quanto-date posted-at response-posted-at' href='#58d470074fde6b0be1277e29'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Guy, you&#39;re way past my knowledge of the finance world (I&#39;m an engineer, managing my money is more of a hobby). I&#39;d love to give my opinion but I`m not sure I completely understand your question with the Alphas</p>

<p>With the added leverage (1.4), we still rarely go over 1 but have a lot less cash available if the market crashes. Depends of how risk tolerant you are. Yes it was worth it for the backtest but the future? Who knows!</p>

<p>Regarding the position size, it should be dependent of the risk of each individual stock according to Clenow`s book. The decision of picking the stock is based on the slope and the r^2. Then we go down the list from the highest to the lowest score. The position size is determined with the risk coefficient (more or less different positions) and the volatility, that&#39;s why you see the division by the average true range. The more volatile, the more you divide (lower) your position. </p>

<p>I agree a very volatile stock shouldn`t make the list in the first place because the r^2 will be low but it could happen if for example a company receives a buying offer and jumps radically to the amount of the offer. R^2 will be low but the slope high and we could end up buying it even if there is no money to make out of that stock.</p>

<p>ATR is there to get lower position on high volatile stocks but is <em>in my opinion</em> way too agressive. I added an ATR factor, I turned it off for this share. Maybe I could use a fix ATR treshold instead just to eliminate the crap, I`ll have to try.</p>

<p>I took your latest version, also added a variable to turn On and Off a few filters and control the ATR. The results are the same, I turned off all the things you did and also set a variable for the leverage.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d55223122ae64df996010f' id='58d55223122ae64df996010f'>
<a href='#58d55223122ae64df996010f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490375203000' class='quanto-date posted-at response-posted-at' href='#58d55223122ae64df996010f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Charles, I like your modifications and will study them. You raised many points. </p>

<p>You say: ...we still rarely go over 1 but have a lot less cash available if the market crashes. Note that the strategy whenever there is some market turmoil, it turns to cash. This explains the dips in exposure. It is the strategy&#39;s way of hiding in a safe place. The strategy spent most of its time in cash during the financial crisis and was ready to buy shortly after it was over.</p>

<p>I am still looking at why the strategy behaves the way it does. If we set the leverage at 1.40, that is what we should get on average. And yet, we get much less. I will need to look into that.</p>

<p>The strategy takes up to 700 of the highest market caps that satisfy the condition of a positive slope &gt;= 2% dampened by r^2, this out of some 8,000 stocks. The R-squared sorting makes the strategy favor lower volatility stocks. But, 0.030.70 is still larger than 0.020.80, or 0.050.20. The question should be: can such a general rule apply across board? There was no proof or demonstration that this selection process provided any benefits above the slope &gt;= 2%.</p>

<p>However, it does partially rearrange the order in which the top 100 stocks will be selected by favoring more those stocks sticking the closest to their respective regression lines, meaning having a lesser variance. If I change the dampening order by reversing it (1  r_value^2), I get a lower performance level since this would favor higher volatility and lower sloped stocks.</p>

<p>However, if I increase R-squared, it has minimal impact, close to none, say for example: (1.4  r_value^2). And if we remove R-squared, we get something in between  (1.4  r_value^2) and (1  r_value^2).</p>

<p>You can increase performance by changing a single number. This one by favoring the stocks that are the most behaved in their rise: (1.2  r_value^2). This would raise the CAGR to 28.47% before leveraging fees, and to 28.17% including all expenses. </p>

<p>However, that is not what improved performance since (1.2  r_value^2) or (1.4  r_value^2) had the same output as (1.0  r_value^2). It was another number that improved performance: the one that raised the min_momentum to 0.05.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d7ff806e4b295ddd164dab' id='58d7ff806e4b295ddd164dab'>
<a href='#58d7ff806e4b295ddd164dab'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58a1efc120596b38743243bb'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d6c15c21239a25a8a60915d747aa7df3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58a1efc120596b38743243bb'>tester Ro</a>
</div>
<a UTCms='1490550656000' class='quanto-date posted-at response-posted-at' href='#58d7ff806e4b295ddd164dab'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Guy Fleury  if i clone &amp; rerun your notebook, charts like the one showing how the algo behaved in events like Fukushima disappear :S<br>
I click on the Run button, i am missing something?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d97645572e22652229df39' id='58d97645572e22652229df39'>
<a href='#58d97645572e22652229df39'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1490646597000' class='quanto-date posted-at response-posted-at' href='#58d97645572e22652229df39'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>When it comes to matching the intended model better, it will have to come from those of you who understand the theory well. You might find some pieces worth adopting here.</p>

<pre><code>$2.66  GF version (including the 12M margin)
$8.11  This version attached, it has no margin
-----  
  ^  
  |______ Profit per dollar risked/activated  
</code></pre>

<p><em>comment out def handle_data() and its contents for speed.</em>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58d9af5da629111e969e7488' id='58d9af5da629111e969e7488'>
<a href='#58d9af5da629111e969e7488'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58aa132d4b1b7158de619b6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/864d1e551cd7756a1b4132f3d1c841cd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58aa132d4b1b7158de619b6b'>Charles Pare</a>
</div>
<a UTCms='1490661213000' class='quanto-date posted-at response-posted-at' href='#58d9af5da629111e969e7488'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Blue,<br>
The big drop in 2013 comes from TSLA being 2/3 of the portfolio and then dropping.</p>

<p>I know the ATR is supposed to deal with the risk but don&#39;t you think we should hardcode a value of each position as a max percentage of what we own? I don&#39;t think in the end the growth would be bigger, but it would be more linear.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da0986ce71d44872cd6544' id='58da0986ce71d44872cd6544'>
<a href='#58da0986ce71d44872cd6544'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1490684294000' class='quanto-date posted-at response-posted-at' href='#58da0986ce71d44872cd6544'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Andreas,</p>

<p>On Mar 27, 2016 you wrote:</p>

<p><em>... we use exponential regression to measure the momentum. As opposed to its linear cousin, we get the slope expressed in percent. The daily slope gives you a number with many decimals that&#39;s hard to relate to, so let&#39;s annualized that...</em></p>

<p>In source code by James Christopher you published on Mar 24, 2016 line 17  </p>

<pre><code>annualized_slope = (1 + slope)**250  
</code></pre>

<p>Can you or somebody else prove that <strong>annualization</strong> done properly.</p>

<p>This is very important because it is the base for most strategy calculations  and used <strong>as is</strong> in other versions by Guy Fleury, Charles Pare, Blue and others.</p>

<p>To my mind it should looks like:  </p>

<pre><code>annualized_slope = (1 + slope)**252 - 1.0  
</code></pre>

<p>Correct me if I am wrong.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da0f68a629111e969e7a6f' id='58da0f68a629111e969e7a6f'>
<a href='#58da0f68a629111e969e7a6f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1490685800000' class='quanto-date posted-at response-posted-at' href='#58da0f68a629111e969e7a6f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s my own function for the slope. I&#39;m from a C (++/#) background, and still learning Python. </p>

<p>Whether you want to use 250 or 252 day count doesn&#39;t matter here. Either is fine, and it won&#39;t have any impact on results. In fact, if you prefer, you could skip the annualization. The only purpose is to get a number easier to relate to, instead of a daily percent slope with a lot of decimals. </p>

<pre><code>def slope(ts):  
    x = np.arange(len(ts))  
    log_ts = np.log(ts)  
    slope, intercept, r_value, p_value, std_err = stats.linregress(x, log_ts)  
    annualized_slope = (np.power(np.exp(slope), 250) - 1) * 100  
    return annualized_slope * (r_value ** 2)  
</code></pre>

<p>Also to keep in mind (not a criticism, just an observation): The code you&#39;re using does not look at 700 stocks. More like 400. The pipeline starts off with 700 and cuts ADRs and non-primaries, resulting in around 400. Do a record on the length of the selected universe index, and you&#39;ll see. Not necessarily an issue, as long as you&#39;re aware of it.</p>

<p>Edit: Using np.power on that last row instead of ** should probably be more efficient.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da2650cdd626000a28fd84' id='58da2650cdd626000a28fd84'>
<a href='#58da2650cdd626000a28fd84'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1490691664000' class='quanto-date posted-at response-posted-at' href='#58da2650cdd626000a28fd84'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Increase of 330% from Vladimir&#39;s change. <em>Q return, my version, still no margin.</em>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da3665a6291156879e7429' id='58da3665a6291156879e7429'>
<a href='#58da3665a6291156879e7429'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1490695781000' class='quanto-date posted-at response-posted-at' href='#58da3665a6291156879e7429'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Andreas,</p>

<p>Thank you very much for quick response.</p>

<p>I agree that using power 250 or 252 does not really matter.<br>
The key difference between my and as is version<br>
is <strong>-1</strong> at the end.<br>
If you will not do that the slops all the time will be positive.</p>

<p>I have tested all 3 versions on static symbol list on 2009-01-16</p>

<p>2009-01-16 07:35  as is version<br>
PRINT<br>
Equity(24 [AAPL])         0.191235<br>
Equity(26578 [GOOG_L])    0.206391<br>
Equity(5061 [MSFT])       0.286681<br>
Equity(16841 [AMZN])      0.119070<br>
Equity(8347 [XOM])        0.136967<br>
Equity(4151 [JNJ])        0.376904<br>
Equity(25006 [JPM])       0.160242<br>
Equity(8151 [WFC])        0.208580<br>
Equity(3149 [GE])         0.169359</p>

<p>2009-01-16 07:35    my version<br>
PRINT<br>
Equity(24 [AAPL])        -0.391464<br>
Equity(26578 [GOOG_L])   -0.389349<br>
Equity(5061 [MSFT])      -0.483870<br>
Equity(16841 [AMZN])     -0.249095<br>
Equity(8347 [XOM])        0.023829<br>
Equity(4151 [JNJ])       -0.243910<br>
Equity(25006 [JPM])      -0.532544<br>
Equity(8151 [WFC])       -0.352849<br>
Equity(3149 [GE])        -0.565920</p>

<p>2009-01-16 07:35   new version<br>
PRINT<br>
Equity(24 [AAPL])        -12.412274<br>
Equity(26578 [GOOG_L])    -9.765479<br>
Equity(5061 [MSFT])      -20.992760<br>
Equity(16841 [AMZN])      -8.511544<br>
Equity(8347 [XOM])         0.509771<br>
Equity(4151 [JNJ])        -7.030777<br>
Equity(25006 [JPM])      -23.293110<br>
Equity(8151 [WFC])       -14.046448<br>
Equity(3149 [GE])        -28.590373</p>

<p>As is version shows all positive slopes which is not right.</p>

<p>What should be minimum adjusted slope requirement for new version context.min_momentum = 0.30 , 30 or 0 ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da5cadcc7dd11fa7335d07' id='58da5cadcc7dd11fa7335d07'>
<a href='#58da5cadcc7dd11fa7335d07'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1490705581000' class='quanto-date posted-at response-posted-at' href='#58da5cadcc7dd11fa7335d07'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Vladimir,</p>

<p>I multiplied with 100, again just to arrive at a number friendlier to the human brain. If you want to keep that, you need to raise your momentum score limit by a factor of 100 as well.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da72180714ee4bc3dfa8e1' id='58da72180714ee4bc3dfa8e1'>
<a href='#58da72180714ee4bc3dfa8e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490711064000' class='quanto-date posted-at response-posted-at' href='#58da72180714ee4bc3dfa8e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The slope output of the regression is a straight line across the 90 days of the momentum_window_length. If one wants to extrapolate, well, it is a straight line. The rate of return does not change, that was it. At the end of the year, the slope will be the same.</p>

<p>That you sort the 90-day slopes is perfectly acceptable. It gives, on average, the highest return performers of the group over the past 90 days. That you multiply this slope by a scalar has no effect on the sorting itself. All the stocks considered remain in the same order.</p>

<p>However, the scaling will move some slopes higher or lower relative to a certain threshold. In this case, the min_momentum serves as this threshold. It is why raising it to 0.05 in my last modification produced higher overall results. You change one number in a strategy and it generates millions. This to show how sensitive a strategy can be to certain numbers.</p>

<p>What I have noticed is that this strategy is also very sensitive to the annualized_slope. If you reduce or increase the 250 exponential, it will reduce overall performance. As if numbers in the vicinity of 250 are at a local maxima. </p>

<p>As Andreas explained, the use of the exponent 250 is simply to spread out the return numbers. What it changes is the number of decimal considered, not the stock ordering. And as Andreas noted as well, if you use slope alone, you will need to adjust the min_momentum threshold.</p>

<p>It&#39;s the added sorting that could be interesting: the dampening by R-squared. What it does is shuffle some of the stocks around, changing the ordering, favoring low volatility stocks. To get an R-squared close to 1, the 90-day price series needs to hug the straight line (slope). And for two stocks having the same slope, the one closer to the straight line gets preferential treatment.</p>

<p>The R-squared dampening reorders the stocks&#39; slope ranking. It will favor stocks with the highest auto-correlation, lower market beta, lower volatility. Technically, it will favor a stock having a short-term trend. That the trend continues is an entirely different problem.</p>

<p>A funny observation, you could increase performance even higher by reducing the  min_momentum threshold to -0.98. The move will allow some marginally selectable stocks to be considered and have an impact on overall return.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da74e4a6291113af9e75a1' id='58da74e4a6291113af9e75a1'>
<a href='#58da74e4a6291113af9e75a1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1490711780000' class='quanto-date posted-at response-posted-at' href='#58da74e4a6291113af9e75a1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Andreas, All,</p>

<p>Here is a version with new Clenow Momentum function &quot;slope&quot;, keeping  it on the same scale as  &quot;as is&quot;<br>
1.0 target leverage, equal number of shares, 0 minimum momentum and risk_factor = 0.003<br>
Lots of room for improvement.<br>
To my mind  equal weighted slightly hedged by bonds version will perform better.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da7b60a629113fb09e7400' id='58da7b60a629113fb09e7400'>
<a href='#58da7b60a629113fb09e7400'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1490713440000' class='quanto-date posted-at response-posted-at' href='#58da7b60a629113fb09e7400'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Guy,</p>

<p>Some minor misunderstandings there, it seems. Let me try to explain. I spent about 60,000 words explaining it in the book, but I&#39;ll try to keep it brief. :)</p>

<p>First off, we&#39;re dealing with exponential regression slopes here, not linear. The slope will therefore tell us the percentage change per day. That number tends to be hard to relate to for humans. The daily slope might be something like 0.0012567. Now if you take that number, add 1 and raise it to 250, you get an annualized number. As in, &quot;what would happen if the same slope continued the whole year?&quot;. We don&#39;t expect this to happen, but it makes the number easier to relate to.</p>

<p>If no human is looking at the number, skip the whole annualization part. 250 is just the approximate number of days in a year here. Feel free to use 252 for a more exact day count. </p>

<p>This process of course makes the number larger. (if positive). So if you use an absolute slope floor, trading will be impacted by your day count. But toggling around the day count doesn&#39;t make sense. Pick one and stick to it. </p>

<p>The original method from the book can certainly be improved upon. That was the purpose of publishing it. I would caution against overly curve fitting it though. Tinker enough with parameters, and you&#39;ll get very high return numbers. Just make sure it&#39;s robust, and not dependent on exact parameters. This is about a broad concept. If the model gets too dependent on exact parameters, it&#39;s not likely to work in reality. Go for a version where parameters can be changed quite a bit and still have fairly similar performance.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da875e0001272a0fbd172d' id='58da875e0001272a0fbd172d'>
<a href='#58da875e0001272a0fbd172d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58b5f98a4f96ba3f8c83e410'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6c63f85ea771b1f7f228ae8d9a2345ea?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58b5f98a4f96ba3f8c83e410'>Marc Syp</a>
</div>
<a UTCms='1490716510000' class='quanto-date posted-at response-posted-at' href='#58da875e0001272a0fbd172d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Has anyone modeled the tax ramifications of short-term capital gains?  What would be the approach to incorporating that into the model (i.e., paying gains from the invested capital)? Or does this strategy preclude the ability to pay tax annually from outside capital?</p>

<p>Really awesome dialogue and development happening here.</p>

<p>Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da8860704d6e506a417b2b' id='58da8860704d6e506a417b2b'>
<a href='#58da8860704d6e506a417b2b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490716768000' class='quanto-date posted-at response-posted-at' href='#58da8860704d6e506a417b2b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Andreas, maybe there is a misunderstanding, but, it is not here. All the modifications I&#39;ve presented are based on Shawn&#39;s version of this program. All my examples used: linregress as defined in:</p>

<p><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html</a></p>

<p>which have a linear output, a straight line.</p>

<p>In the context of linregress, my statements hold. I used (ts) as in Shawn&#39;s version, and not (log.close) as in yours.</p>

<p>And yes, I do agree, the strategy is very sensitive to certain numbers. You can change just a few of them and have a very different picture.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da8d9f704d6e1c3d4177e2' id='58da8d9f704d6e1c3d4177e2'>
<a href='#58da8d9f704d6e1c3d4177e2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1490718111000' class='quanto-date posted-at response-posted-at' href='#58da8d9f704d6e1c3d4177e2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Andreas,</p>

<p>Here is a version with new Clenow Momentum function &quot;slope&quot;, in original scale were it is multiplied with 100 to be  friendlier to the human brain.<br>
The same randomly chosen parameters and absolutely the same results.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da9ebab523cc057ae45792' id='58da9ebab523cc057ae45792'>
<a href='#58da9ebab523cc057ae45792'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1490722490000' class='quanto-date posted-at response-posted-at' href='#58da9ebab523cc057ae45792'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Guy,</p>

<p>I had a quick look. It looks like you&#39;re using the same as Shawn, originally written by James. That version does use exponential slope, not linear. The difference is that the log transformation isn&#39;t encapsulated in the function. It&#39;s done like below, from your latest iteration:</p>

<p>slopes = np.log(closes[context.selected_universe.index].tail(context.momentum_window_length)).apply(_slope)</p>

<p>My version (actually suggested by Shawn in a private email), simply encapsulates the log into the function, negating the need to use the np.log statement in the call above. The result is the same.</p>

<p>What we do is to run a linear regression formula on log data, resulting in an exponential slope. The slope is expressed in percent, not in dollars.</p>

<p>The output is an exponential regression slope. Linear wouldn&#39;t make any sense. That would mean that the absolute price of a stock would be the main factor. A stock with a price of 500 will show larger linear slopes than a stock traded at 10 could ever do. Using linear regression would mean that you no longer deal with momentum, but rather trading stocks based on their absolute price.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da9edea6291155569e7627' id='58da9edea6291155569e7627'>
<a href='#58da9edea6291155569e7627'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490722526000' class='quanto-date posted-at response-posted-at' href='#58da9edea6291155569e7627'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir, remarkable work. I now have to study the impact of your changes.</p>

<p>This puts your strategy version at a 27.44% CAGR all expenses paid since you allowed commission defaults and had no leveraging fees to speak off.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58da9f920714ee1441dfa9af' id='58da9f920714ee1441dfa9af'>
<a href='#58da9f920714ee1441dfa9af'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1490722706000' class='quanto-date posted-at response-posted-at' href='#58da9f920714ee1441dfa9af'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Vladimir,</p>

<p>The version of the slope function I posted encapsulates the log function. You need to remove that part from the call in the rebalance.</p>

<p>slopes = np.log(closes[context.selected_universe.index].tail(context.momentum_window_length)).apply(slope)</p>

<p>should be</p>

<p>slopes = closes[context.selected_universe.index].tail(context.momentum_window_length).apply(slope)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58daa411cc7dd1378b335baa' id='58daa411cc7dd1378b335baa'>
<a href='#58daa411cc7dd1378b335baa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490723857000' class='quanto-date posted-at response-posted-at' href='#58daa411cc7dd1378b335baa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Andreas, I stand corrected. Note that using the slope of a linear regression on the close of a price series or its log will maintain the same ordering. All the stocks, once sorted, will be in the same order. It is only after applying R-squared that the order might change.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58daaccebde363447ee41627' id='58daaccebde363447ee41627'>
<a href='#58daaccebde363447ee41627'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490726094000' class='quanto-date posted-at response-posted-at' href='#58daaccebde363447ee41627'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Using Vladimir&#39;s version since it was leaving some room for leveraging I went for the 1.40 setting as in a previously presented version. I wanted to know if at least it could pay its leveraging fees.<br>
A way to search for the strategy&#39;s limits.</p>

<p>With leverage at 1.40, Vladimir&#39;s version came out with a 41.59% CAGR. That is, it ended with a net liquidating value of  $150,924,996.81 after commissions and before leveraging fees. The estimated total leveraging costs came in at $ 21,492,749. </p>

<p>That is not pocket change. Nonetheless, it would have left the account with a net liquidating value of: $ 129,432,247. That is a 40.09% CAGR, all expenses paid.</p>

<p>A 1.40 leverage setting might be just a number. But it can have a tremendous impact on a trading strategy. Especially, if the trading strategy can support such an undertaking.</p>

<p>Notice that the very first iteration of this strategy in this thread was going absolutely nowhere. You could not even say that there was some alpha there. If there was, it certainly was not visible. Also note that using leverage is a matter of choice and there is no obligation to do so. Already, Vladimir&#39;s version of this program is remarkable.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58dac2c10001270f8cbd1708' id='58dac2c10001270f8cbd1708'>
<a href='#58dac2c10001270f8cbd1708'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490731713000' class='quanto-date posted-at response-posted-at' href='#58dac2c10001270f8cbd1708'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Using Vladimir&#39;s version again, I increased the leveraging factor to 1.50 compared to the previous test using 1.40. This will evidently increase trading and leveraging costs.</p>

<p>At 1.50, the strategy returned a net liquidating value of  $ 209,247,238, a 44.84% CAGR before leveraging expenses which were estimated at: $ 34,537,174. This left a net liquidating value after all expenses of $ 174,710,165. Resulting in a net 43.04% CAGR.</p>

<p>To the question: was the 1.40 setting the upper limit for this trading strategy? Probably not.</p>

<p>Without testing to see what a trading strategy might do using leveraging, we might not even be able to make a reasonable estimate. At least, doing such tests answer the questions: is it feasible? Would it be worth it? How much would it cost?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58db02dab523cc79f7e45970' id='58db02dab523cc79f7e45970'>
<a href='#58db02dab523cc79f7e45970'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490748122000' class='quanto-date posted-at response-posted-at' href='#58db02dab523cc79f7e45970'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>What are the limits of a trading strategy? </p>

<p>How could you find them if not by doing some simulations seeking them out? Once you find them, you can then opt to stay within the confines of these limits.</p>

<p>Again, I changed a few numbers and pushed the strategy to behave as if on steroids. </p>

<p>No change in the trading logic. No new change in the trading procedures. Only constants that can have an impact on the final outcome. These are not just constants or default values, but numbers that can affect the strategy as it evolves over its entire trading interval. This also puts some emphasis of the wide range of results that can be derived from what should be considered minor parameter changes.</p>

<p>Changing just a few numbers generated the following:</p>

<p><a href="http://alphapowertrading.com/quantopian/Vladimir_with_costs_1M_15L.png">http://alphapowertrading.com/quantopian/Vladimir_with_costs_1M_15L.png</a></p>

<p>One reads correctly. That is $ 554,200,338 net liquidating value before leveraging costs. </p>

<p>Even if leverage was kept at 1.50, I opted to charge 0.80 instead of the 0.50 in the previous example. Total leveraging charges were estimated at $ 111,734,086, leaving a net strategy CAGR of 52.56% over its 14.42 years. </p>

<p>The end result has a portfolio account valued at $ 442,466,252 after all expenses paid. With such numbers, one should be ready to trade big.</p>

<p>I would conclude that the two previous examples were not the limit. BTW, this one is not either.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58db1e04b523cc48fbe45772' id='58db1e04b523cc48fbe45772'>
<a href='#58db1e04b523cc48fbe45772'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58b5f98a4f96ba3f8c83e410'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6c63f85ea771b1f7f228ae8d9a2345ea?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58b5f98a4f96ba3f8c83e410'>Marc Syp</a>
</div>
<a UTCms='1490755076000' class='quanto-date posted-at response-posted-at' href='#58db1e04b523cc48fbe45772'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;m curious, @Guy, did you test on different intervals, including starting the strategy right before the 2008 downturn or before the max drawdown in the longest backtest?  Would be curious to know how it performs if entry timing is particularly bad for the strategy, and if it recovers.</p>

<p>Also -- Can you summarize specifically which variables you&#39;re playing with here? :)</p>

<p>Thanks,<br>
Marc  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58db40e550b13d74e82f0751' id='58db40e550b13d74e82f0751'>
<a href='#58db40e550b13d74e82f0751'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58b5f98a4f96ba3f8c83e410'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6c63f85ea771b1f7f228ae8d9a2345ea?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58b5f98a4f96ba3f8c83e410'>Marc Syp</a>
</div>
<a UTCms='1490764005000' class='quanto-date posted-at response-posted-at' href='#58db40e550b13d74e82f0751'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>My contribution -- a variant on Vladimir&#39;s version with Stock trend enabled, higher risk factor, raised market_cap_limit.  </p>

<p>I do have a few questions.  I&#39;m not quite sure how the leverage_factor variable is working.  I have set to 2.0 but my leverage still hovers around 1.  Also, @Guy -- are you calculating the leverage fees manually? I don&#39;t see any code that does the calcs in any of these. Still curious about tax implications as well -- anybody modeled those? How would a casual investor plan to pay taxes if most disposable income is tied up in short term stocks?</p>

<p>Incidentally, this algo returns around 1100% if started October 2007, shortly before the downturn.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58db4fda1251630a15de508d' id='58db4fda1251630a15de508d'>
<a href='#58db4fda1251630a15de508d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1490767834000' class='quanto-date posted-at response-posted-at' href='#58db4fda1251630a15de508d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>No, the order will be dramatically different, and that is the entire point to using exponential regression. If someone wants to trade this model, it&#39;s important that they understand what it is.</p>

<p>Example: (very approximate math)<br>
We&#39;re considering two stocks. ABC Corp is traded at $10 and XYZ Corp is traded at $500. In the past 90 trading days, both stocks gained about $5 in a nice smooth trend. The approximate linear regression slope is around $0.056 for both. They would show a similar ranking using linear regression. </p>

<p>But the exponential slopes would be a little different. ABC made 100% return in 90 days, so the slope would be around 1.00773 per day. XYZ just did 1% in the same time, resulting in a daily slope around 1.000112. If we annualize them, to find out what this means on a yearly basis, we get quite a difference. </p>

<p>ABC: ((1.00773 ^ 250)-1)<em>100 = 585.8<br>
XYZ: ((1.000112 ^ 250)-1)</em>100 = 2.831</p>

<p>The ranking order changed from about equal, to an extreme difference. We are looking for percentage moves here, not dollars and cents. If we would use linear math, a stock with a higher price would only need to make a tiny percent move to be at the top of the list.</p>

<p>Also, be aware that the latest iterations are based on a typo. The log function is applied twice. The slope is calculated on the logs of the logs, so you need to consider what you are actually measuring here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58dc33d51c1d17000db93af4' id='58dc33d51c1d17000db93af4'>
<a href='#58dc33d51c1d17000db93af4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490826197000' class='quanto-date posted-at response-posted-at' href='#58dc33d51c1d17000db93af4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>A problem with trading strategies is to find out if they are scalable or not. And be assured, not all trading strategies are. </p>

<p>You can do a simple test to see if a strategy is scalable. You increase the initial capital put to work by the factor you want. </p>

<p>Using the same equation as before, we have: A(t) = (1+L)kA(0)(1 + r +  - lc% - fc%)^t which accounts for commissions, leveraging fees and alpha. Here, k is the scaling factor. If I set k at 5, the total profits should come close to 5 times the no scaling scenario, giving 5 times A(t). k=1 is equivalent to no scaling.</p>

<p>With the same program as the last chart presented, here is the outcome with $5M as initial capital.</p>

<p><a href="http://alphapowertrading.com/quantopian/Vladimir_with_costs_5M_15L_NLV.png">http://alphapowertrading.com/quantopian/Vladimir_with_costs_5M_15L_NLV.png</a></p>

<p>Based on the simulation, the strategy showed itself to be 100% scalable. It ended with a 54.96% CAGR. In numbers, the initial $5 million grew to $ 2,771,164,252. </p>

<p>Accounting for leveraging expenses which were estimated at: $ 558,701,163, the account would have ended with a net liquidating value of: $ 2,212,463,089 after its 14.42 year journey.</p>

<p>Say a $100 million hedge fund took a 5% position flyer in such a trading strategy. They would get what is above, plus what they might get on their remaining $95 million. $95 million at a net CAGR of 15% (which is above average) would result in: $ 713,294,976 over the same period. Giving the fund a grand total of: $ 2,925,758,065. Thereby raising its total CAGR to: 26.37%.</p>

<p>One has to look at the possibilities to see how far a trading strategy can go.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58dca438a83b43360571bce3' id='58dca438a83b43360571bce3'>
<a href='#58dca438a83b43360571bce3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562545816f0077be2a000054'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/65eed7bd690af7911cb4e82f70d3a8f6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562545816f0077be2a000054'>Shawn Emhe II</a>
</div>
<a UTCms='1490854968000' class='quanto-date posted-at response-posted-at' href='#58dca438a83b43360571bce3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It looks like a lot of attention has been going to tweaking parameters and then checking the bottom line results, without assessing the full implications. This type of approach raises the risk curve fitting.</p>

<p>For example, one suggestion made was to change the risk per stock. Yes, that does have an effect on the total percent returned, but why? With leverage held constant changing this setting has an effect on the number of total stocks held. Raise the risk per stock and decrease the number of stocks held. In an extreme example Andreas pointed out how that could lead to a portfolio of only 3-4 stocks. Not only does that take away the risk benefits of diversification, it also reduces the statistical significance of the backtest. I have a much higher trust in the results of a backtest that made 50 picks per month than one that made 3.</p>

<p>Going in the opposite direction, changing it so that the total number of stocks increases can also have an unexpected affect. There has already been research done on the effects of factor concentration and the size of the portfolio (search the alpha architect blog). Over time a portfolio of 50 momentum stocks should outperform one of 100. But in the short run momentum can go through periods underperformance. During those periods I would expect a portfolio of 100 to outperform 50, as it would decrease the factor exposure and cause the portfolio to perform more in line with the market.</p>

<p>It&#39;s easy to celebrate squeezing a few extra points of gain out of a small tweak, but until considering the full implications you cannot be sure you have actually improved the strategy. What were the market conditions during the backtest? What actually caused the performance to increase? Do you expect those conditions to continue?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58dcc8d677475c529c42f982' id='58dcc8d677475c529c42f982'>
<a href='#58dcc8d677475c529c42f982'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1490864342000' class='quanto-date posted-at response-posted-at' href='#58dcc8d677475c529c42f982'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>It looks like a lot of attention has been going to tweaking parameters and then checking the bottom line results</p>
</blockquote>

<p>I posted a version that was not just tweaking. The original is more popular so far even though mine has a much higher profit per dollar. I was prepared to go further if anyone noticed, for example ranking table can be removed. Why? I can&#39;t get excited about the version with the 12 million margin people are paying attention to, not just because I don&#39;t like margin, instead because the margin is accidental due to unfilled orders, completely unpredictable in the future. My version solves that, or at least addresses it, doing what we should all be doing, sell before buy. Never all in the same minute, too unpredictable and unscalable.</p>

<p>The VY minus-1 change increasing returns by that whopping 330 percentage points (40% of the previous 800) in mine had something to do with a greater quantity of negative slope values, the debugger breaking out when trying to examine that object made understanding it difficult. However I did spend the 10 hour run-time later to insure it was not just due to margin, and edited my comment to reflect that.</p>

<p>Margin looks like profit in the chart. It is an illusion, that&#39;s the more serious underlying trouble with tweaks. Margin looks like profit in the chart. A higher return feels good however a seeming increase can actually be a lower <a href="https://www.quantopian.com/posts/pvr">profit per dollar put at risk</a> where, often, what really happened is deeper margin passing itself off as profit and there&#39;s no way to know, without at least charting cash. The reverse also happens, a positive change uses less margin and the chart shows lower returns. GF is moving in the right direction with margin cost awareness. Wouldn&#39;t it be great if that were built-in.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58dd2a7f6102f067043e30de' id='58dd2a7f6102f067043e30de'>
<a href='#58dd2a7f6102f067043e30de'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1490889343000' class='quanto-date posted-at response-posted-at' href='#58dd2a7f6102f067043e30de'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I started modifying this strategy after Shawn made modifications to Andreas&#39; simpler version of the original program. Sorry to say, but the original version was of no interest (that is my point of view). The first time I looked at the original version, I classified it as a throwaway. It could not even generate a speck of alpha. A lot of time and work with nothing to show profit wise. It ended not even beating the index.</p>

<p>I liked Charles&#39; modifications, they were making the strategy behave differently and showing some alpha. From there, I started using his version of the program.</p>

<p>I use the following equation to keep me on track as to what can impact a trading strategy:<br>
A(t) = (1+L)kA(0)(1 + r +  - lc% - fc%)^t. For sure, frictional costs (fc) are a drag on performance, so is leveraging (lc). Both need to be accounted for. But, notice that alpha is also compounded, not just r which here is viewed as the market average. If a trading strategy does not generate alpha (has it negative), it too will be a drag on performance. It certainly can not be considered a plus.</p>

<p>One can multiply all these negatives by scaling up (k). The scaling is to answer the simple question: can this strategy withstand more capital, or is it to break down under the pressure? Will it maintain its CAGR? It is a CAGR game after all.</p>

<p>This is not asking: can we leverage the thing? It would make no sense if there was no alpha.</p>

<p>I used Charles&#39; modifications to stress test the strategy using leverage since there was now some alpha generation in the design. Also scaled up the stakes to $1M. This raised performance to a 28.17% CAGR including all expenses paid. Already interesting levels for any fund. Most of them still tend to r over the long term.</p>

<p>Valdimir made some nice modifications to the program making it behave differently. It continued to move away from the original design making it quite a different program altogether. You could push on this thing and explore its limits. </p>

<p>The real objective of the game is to squeeze out more alpha (more performance) even if it is more expensive to extract it. </p>

<p>As long as the added alpha can pay for the added expenses and some, you continue to grow.</p>

<p>I showed that one could leverage and also scale this program to higher performance levels. </p>

<p>I understand everyone&#39;s objections. Too much of this, not enough of that, don&#39;t forget this. Sure, we have to consider everything. </p>

<p>But, we also need to know what can we do once a trading strategy has achieved alpha generation. Do we accept it as is and do nothing more, or do we explore how far it can go even if there are some added costs?</p>

<p>For instance, if you change the rank_table_percentile, you change the number of stocks that will be considered as selectable candidates. That criterion already select a lot more candidates than you need. Nonetheless, it will have an impact on the outcome. If you take the top 50 of a 300, 400, or 700 list, will it really matter? Well, the answer is yes it will, even if the top 50 are still the top 50.</p>

<p>You have a very simple strategy here. It bets on the top market caps having the top CAGRs over a 90-day period. That&#39;s it. It amounts to a trend following after an upside breakout. There is nothing original in that process. Variations of this are probably used by more than half of the visible strategies on Q.</p>

<p>Some are afraid of drawdowns which BTW are inevitable. And yet, they could easily make estimates of it using the above formula:  </p>

<p>A(t) = (1+dd%)(1+L)kA(0)(1 + r +  - lc% - fc%)^t</p>

<p>A -0.50 drawdown can happen at any time over a trading interval. With time it gets more and more expensive. For instance, in the last presented test, if there was one going forward, it could exceed a billion. However, one does not design for the drawdown, even if it is a consideration, one designs for the incremental alpha. That is the quest. Just as a side note: during the financial crisis, Mr. Buffett&#39;s drawdown was in excess of 100 billion, and he smiled through it all. He too lives by the same formula.</p>

<p>It is good to know how far you can go in order to stay within acceptable limits. And these acceptable limits is what differentiate every one of us.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58df234d2a95de3972d70bb3' id='58df234d2a95de3972d70bb3'>
<a href='#58df234d2a95de3972d70bb3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1491018573000' class='quanto-date posted-at response-posted-at' href='#58df234d2a95de3972d70bb3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I stated earlier that one could push for more. So, here is the same program with a minor modification (1 number) added to the last iteration. Also, the scaling factor was set to: k=10 instead of k=5. Making it a $10 million initial capital scenario. It follows the equation:<br>
A(t) = (1+vL)kA(0)(1 + r +   vlc%  vfc%)^t, as previously defined.</p>

<p><a href="http://alphapowertrading.com/quantopian/Vladimir_w_costs_10M_15L_impr_w_NLV.png">http://alphapowertrading.com/quantopian/Vladimir_w_costs_10M_15L_impr_w_NLV.png</a></p>

<p>Yes, the number at the bottom of the chart is the net liquidating value at the finish line!</p>

<p>It shows that a trading strategy can have a wide range of outputs depending on the setup of its parameter and default values. Note that no program logic was changed, only a number. Raising the stakes did not alter the program.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58df4ae32a95de4e0ad712bb' id='58df4ae32a95de4e0ad712bb'>
<a href='#58df4ae32a95de4e0ad712bb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1491028707000' class='quanto-date posted-at response-posted-at' href='#58df4ae32a95de4e0ad712bb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>62 thousand percent returns in the screenshot, would of course be margin masked as profit. Am I missing something? Please chart cash, knowing how much the broker is owed is essential.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58dfaaf262fe53542a128a44' id='58dfaaf262fe53542a128a44'>
<a href='#58dfaaf262fe53542a128a44'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1491053298000' class='quanto-date posted-at response-posted-at' href='#58dfaaf262fe53542a128a44'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Gary, as you know, Quantopian does not monitor leveraging costs. Notwithstanding, here is a formula to obtain an estimate:</p>

<p>LevCost(t) = (1+L)kA(0)(1 + r +   fc%)^t  -  (1+L)kA(0)(1 + r +   lc%  fc%)^t</p>

<p>In the last test, r +   fc% = 0.5625, kA(0) = $10M, L = 0.50, -fc% is included, and t is for 14.42 years. This puts the leveraging cost estimate at about $ 1.250 B for a net liquidating value of $ 4.997 B.</p>

<p>You are using leveraging only when the exposure exceeds 1.00. This means that any time you get above 1.00 the cash account goes negative, you owe that money back. And, you have to pay for leveraging on this fluctuating amount. As shown above, it is not a trivial sum.</p>

<p>One could have quit the game at any time during those 14.42 years and receive as net liquidating value the blue line on the chart. One would have had 5,625 days to make that decision, and for each one of those days, it would have been to one&#39;s benefit. The strategy outperformed the benchmark from the start.</p>

<p>But, the game is not about how much frictional costs or leveraging fees you will have to pay. It is about your net CAGR over the long term. That is, what is the score at the end of the game? And in that department, the strategies ends with a  53.85% CAGR (net of all trading costs).</p>

<p>At that level, why should I care if there are business expenses. Sure, I will look at ways to reduce them, but not at the expense of the overall CAGR.</p>

<p>It is a very simple problem, if you want more than the other guy, you have to do more than the other guy.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58dfb1c44abd99000d80c786' id='58dfb1c44abd99000d80c786'>
<a href='#58dfb1c44abd99000d80c786'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1491055044000' class='quanto-date posted-at response-posted-at' href='#58dfb1c44abd99000d80c786'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Created <a href="https://www.quantopian.com/posts/margin-costs-levcost-t-equals-1-plus-l-k-a-0-1-plus-r-plus-a-fc-percent-t-1-plus-l-k-a-0-1-plus-r-plus-a-lc-percent-fc-percent-t">a thread for that, margin costs</a></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e03ccda5d74e7f8cbf4b12' id='58e03ccda5d74e7f8cbf4b12'>
<a href='#58e03ccda5d74e7f8cbf4b12'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1491090637000' class='quanto-date posted-at response-posted-at' href='#58e03ccda5d74e7f8cbf4b12'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In a previous post, I said: this strategy is very simple. One could make a picture, draw a few lines, and the job would be done.  </p>

<p>Out of some 8,300 US stocks, 1500 are selected based on Q&#39;s selection process, then further reduced to the top 700 that could make the list of the highest capitalization stocks over its latest evaluation period. This is further reduced to the number of stocks having the highest CAGR above a minimum positive threshold. For each period, all stocks are reordered in this fashion. You could hold the stocks while they stayed on the selected list.</p>

<p>This is kind of a recurrent theme on Quantopian. Many strategies start with the same premises. By this is meant: take the highest cap stocks, sort them out and pick the top of the list. It is all good. You don&#39;t want to trade illiquid stocks. You want that there be volume to get in and get out of a trade for whatever reason you may have. </p>

<p>Most importantly, it is the kind of principle that will apply that it be over past or future data. But then again, everybody seems to be doing the same thing or some slight variation thereof. How could they differentiate from others? </p>

<p>Here is my viewpoint using a few lines to describe this strategy:<br>
<img src="https://image-proxy.quantopian.com/1375d8278e0da251999848f32a012e8294e5bb3e/687474703a2f2f616c706861706f77657274726164696e672e636f6d2f7175616e746f7069616e2f53746f636b734f6e5468654d6f766546696c746572732e706e67" /><br>
This trading strategy is not only a breakout system, it is a trend following system as well. The assumption being that the 90-day upward trend in the selected stocks might continue. There is no guarantee of it, but it is a reasonable assumption. Notwithstanding, if it was not, one could not extract any alpha. </p>

<p>Note that the original version of this strategy did just that: generate absolutely no alpha. Explicitly stating that there is none to be found, none to be had. Also, statistically stating that, on average, stocks did not have that much memory beyond their 90-day marker.</p>

<p>Yet, what we can see from the above picture appears reasonable. You are taking stocks that have shown to have positive returns over at least the past 90 trading days (4.2 months), and making the assumption that the upward trend might continue. And why not? At least, the stocks making the list have shown they have gone up over the period. It is not an estimate, it is based on actual recorded data.</p>

<p>Nonetheless, the strategy as programmed does not behave totally as intended due to the other settings that somehow control part of the strategy&#39;s behavior. You would expect that the selected stocks would be the likes of AAPL, AMZN, GOOG, MSFT, XOM, etc. An ordered list of the largest capitalization stocks. </p>

<p>But, that is not what you get. Those stocks are not fast movers. Of maybe the 200 or so stocks selected to trade, those 5 stocks might not make the top of the list that often. In fact, of the 5 stocks above, only AMZN was traded once in the first year of this test which had for duration 5,265 days. That is more than one occasion to trade.</p>

<p>You will have to go down the list to get tradable candidates, where momentum becomes an added differentiator.</p>

<p>There are economic reasons for my changes in parameters. They were guided toward increasing trading activity and expanding the average profit per trade, two basic portfolio metrics. And based on my variations to Vladimir&#39;s program version, I would say my presented simulations left more than enough room to do less.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e0fd65d3e991000d70c1f5' id='58e0fd65d3e991000d70c1f5'>
<a href='#58e0fd65d3e991000d70c1f5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1491139941000' class='quanto-date posted-at response-posted-at' href='#58e0fd65d3e991000d70c1f5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>BTW, to have an idea of the impact of commissions on this trading strategy, I only needed to run a simulation twice. Once with, and then, without commissions. This can be solved using about the same equation as presented before:</p>

<p>CommCost(t) = (1+L)kA(0)(1 + r +   lc%)^t  -  (1+L)kA(0)(1 + r +   lc%  fc%)^t</p>

<p>For the latest $10M scenario, the net liquidating value, including leveraging fees, came out as: </p>

<p>without commissions: $ 5.096 B<br>
with commissions:      $ 4.997 B</p>

<p>Cost of commissions: $ 99.013 M. </p>

<p>Not that trivial a sum over the life of the portfolio. It was, nonetheless, the impact of one penny a share...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e10d5085f5d7000d7c1702' id='58e10d5085f5d7000d7c1702'>
<a href='#58e10d5085f5d7000d7c1702'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1491144016000' class='quanto-date posted-at response-posted-at' href='#58e10d5085f5d7000d7c1702'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I hesitate to write this post. I considered not to. The fact that my name, and that of one of my books is in the thread title makes me write it anyhow.</p>

<p>I have no interest in arguing and I will not continue discussions in this thread. I can already see that it is a touchy subject. </p>

<p>The fact still stands that what we are seeing several versions posted which are based on a misunderstanding of the mathematics and the code, and the result is that the model trades something very different from what the descriptions posted along with them say. </p>

<p>As it stands at the moment, there is a sharp disconnect between model code and model description. It does not do what the descriptions say. The results are extremely unrealistic and I would strongly discourage readers from trading in this shape. Given the multiple mathematical errors in the code, the results are accidental and the output is merely curve fitted data.</p>

<p>Having said that, I don&#39;t want to discourage people from tinkering with the code and trying variations. That&#39;s why the code is posted. There are some good improvements in this thread, even if the bulk of the return boost came from mathematical errors.</p>

<p>I understand that posting this may upset some people. It is not my intention. I don&#39;t write this to anger or embarrass people who wrote the modifications. </p>

<p>I merely want to caution readers from trading these versions. They do not do at all what the descriptions state. Be very careful in analyzing the code as well as the trades. </p>

<p>My advise to those following this thread would be to write down the logic of the model on paper, consider why each piece is there and what it does, and then rebuild it from scratch. That is likely the easiest way to spot the issues. The output will be quite different.</p>

<p>With that, I will step out of this thread.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e1228ed3e991000a70c3bd' id='58e1228ed3e991000a70c3bd'>
<a href='#58e1228ed3e991000a70c3bd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58aa132d4b1b7158de619b6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/864d1e551cd7756a1b4132f3d1c841cd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58aa132d4b1b7158de619b6b'>Charles Pare</a>
</div>
<a UTCms='1491149454000' class='quanto-date posted-at response-posted-at' href='#58e1228ed3e991000a70c3bd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Andreas,<br>
In my case and this is probably the case for everyone, you input is much appreciated. I understand someone searching on Google for your book&#39;s algo and arriving here will have to be careful and understand because most variations are not even related to your book main idea: managing risk. Now the latest backtests published don&#39;t even do the linear regression as it was. Yeah we&#39;re very far</p>

<p>I think everyone here understand that but also from what I&#39;ve seen on Quantopian, the main goal here is to stretch the elastic to the max to get the highest returns possible even if 1. The variables are probably fitted too much regarding previous test and will not behave the same in the future and 2. There is no risk hedging or any other security measure and it&#39;s more related to gambling. This is unfortunate Quantopian&#39;s community is not broad enough to attract people with different objectives. Maybe the forum format where there is no category where we could put our posts is not helping, maybe it&#39;s because publishing algos is giving someone your secrets and people don&#39;t do it more I don&#39;t know why it&#39;s like this. I agree with you that almost all the posts with active people are the ones where we&#39;re trying to reach the moon while we should aim for lower and a more secure flight.<br>
I (and other) may have given the impression we don&#39;t understand everything we do which is partially the case but I do my best to read other people&#39;s code and understand the logic behind before publishing a backtest to explain my changes (even if they make no sense I know), at least it has given me the occasion to practice and learn. </p>

<p>That being said, I would never trade algos as the ones I&#39;m posting. In my case it&#39;s more of having fun and learning along the way. If I intend to put money on one algo, that would clearly be the one you describe in your book because I would never gamble my retirement money.<br>
Now if I could suggest something for the future, in your book, at the last chapter you said you would not publish your version of the algo because of the specifics of your trading software, data source and so on. I think things have changed with Quantopian and other players giving everyone the possibility to play with algorithms on an equal field. In your next book which I&#39;m sure to buy ;-) You could do an entry with the official algo as described in the book implemented here or elsewhere. This way, your name won&#39;t be associated with people trying to poorly duplicate your work. Your post will be the first one with your backtest on the top. Anything happening further down the thread will be the writer&#39;s version but won&#39;t be yours, you could add a clear warning. On the business side, I&#39;m sure you could deal some kind of benefits if you were to host your official version on a site like here ;-) I know you said you didn&#39;t write for the money because there is not much to do but you could get something I guess hehehe</p>

<p>Thanks for writing your book, I really appreciated it!</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e1330fe24f76591014ae6b' id='58e1330fe24f76591014ae6b'>
<a href='#58e1330fe24f76591014ae6b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1491153679000' class='quanto-date posted-at response-posted-at' href='#58e1330fe24f76591014ae6b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks, Charles. Much appreciated, fully understood and agreed. </p>

<p>Based on your reply, and despite my last post, I&#39;ll add this one to explain. </p>

<ol>
<li>If accidentally applying the log function twice triples the returns, it&#39;s worth to stop and ask why. Bear in mind that after that happened, we are no longer measuring momentum, and annualizing the resulting regression number makes no sense.<br></li>
<li>The reason why this random change in selection mechanism is able to have a great impact on results, is that we only trade 2 to 4 stocks at a time. Meaning, any change in selection will have an enormous impact, since we no longer have any diversification. Luck impact is through the roof.<br></li>
<li>The reason why we hold portfolios of only a couple of stocks at a time, is that variables are added with claim to impact leverage, but in fact only impacts position size and number of positions. Risk factor is set to extremely high, resulting in small stocks. Then set &#39;leverage factor&#39; to 2, and you get double position sizes and half the number of positions. </li>
</ol>

<p>There are more critical mistakes in the code, but this is what accounts for the seemingly magical return. A tiny number of stocks, randomly selected at huge position sizes. Change any variable, and you&#39;re likely to get an extreme impact, up or down. Results have no predictive value.</p>

<p>Other interesting parts is how the position size is calculated if use_atr and the atr_multiplier are used, again having quite random impact and not doing what they claim to do.</p>

<p>Less important is that we are not considering 700 stocks, but rather around 400. Check the pipeline code and record the size of the investment universe to verify.</p>

<p>Another way to look at it: If we could triple return by applying log function twice and reducing number of stocks, why not apply the log three times and only trade one stock? Point being, if you get seemingly fantastic return boost without knowing how it happened, then something is probably not right.</p>

<p>And, as for my next book: I absolutely do plan to make all the code available, either for Quantopian or for Zipline. Everything will be released in the wild, in Python shape. And writing books for money... Well, if I wanted to write books for money, I would write about wizards, vampires or cheesy bdsm. Based on author payout in the past couple of decades, those are unfortunately the most profitable categories, and sadly I am unqualified to write either of them.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e13ef0c88215000a86dee5' id='58e13ef0c88215000a86dee5'>
<a href='#58e13ef0c88215000a86dee5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1491156720000' class='quanto-date posted-at response-posted-at' href='#58e13ef0c88215000a86dee5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Andreas, I did not hesitate to write this one. Actually, I was waiting for it. You already had provided clues. And like you, I don&#39;t want to upset anyone. I am only looking at a trading strategy, a mathematical problem, a sequence of mathematical operations. It is just a trading script after all, just a program.</p>

<p>However, I do understand your concerns. I would probably give the same advice, if. </p>

<p>But, as I have said before, this program is now something quite different from your original program. It changed its stripes, it changed its trading behavior. And it is all based on what you might call mathematical errors since it departs from your original strategy design. So, I do understand your disconnect. But,</p>

<p>I built on Shawn&#39;s version which was improved by Charles which was further improved by Vladimir. I was changing programs with each iteration changing the code and moving further and further away from the originally posted do nothing trading strategy at the top of this thread. I have not used the original posted trading strategy. I found it uninteresting. It is only with the successive modifications brought by other members in the forum that I explored what one could do with it. Especially, using Vladimir&#39;s version.</p>

<p>Like I have also said before, I did not change the logic or trading procedures as presented in Vladimir&#39;s program. However, I did explore how far one could go, an attempt to find the limits to then slow down a bit and making sure never to exceed them or even get close. To do this, you need to find them first.</p>

<p>That is why you simulate trading strategies in the first place. Not only to find if they are productive, profitable, but also to know if they can or will survive in their future unknown trading environment. It explains why you put out general stock selection principles that could apply on past data as well as on future data. And that you set similarly general trading procedures.</p>

<p>There is only one thing, and not many as you state, that could be considered some kind of mathematical error by some. It is not my case, I don&#39;t see it as an error. You already classified it as a typo. This might be the origin of your concern when, in fact, it is perfectly acceptable. And that is Vladimir&#39;s double log iteration. You see it as a typo, an error, and I see it as a welcomed feature.</p>

<p>Here is why I used and kept Vladimir&#39;s program version. The double log is giving the equivalent of the second derivative on price. In this context, it translates to the price acceleration. And when transposed in Vladimir&#39;s trading script, it not only selects the stocks having the highest positive 90-day CAGRs, it offers preferential treatment to those having the highest accelerating CAGR. </p>

<p>I use the following equation to keep me on track as to what can impact a trading strategy:<br>
A(t) = (1+L)kA(0)(1 + r +  - lc% - fc%)^t. For sure, frictional costs (fc) are a drag on performance, so are leveraging costs (lc). Both need to be accounted for. </p>

<p>The important point here is the alpha generation. If  &gt; lc% + fc%, it will cost you more to do business, but it will also return more. The r +  is compounded, and to improve overall performance, all it needs is to be positive, therefore greater than the costs incurred to obtain it:  &gt; lc% + fc%.</p>

<p>I don&#39;t look at a trading program the same way you do, but that does not make it wrong. It only makes it different. All the trading procedures I used are perfectly legitimate operations, and they all survived within their coded limitations. There were no errors in the code I used, mathematical or otherwise.</p>

<p>I can tell you what I consider the important part in above equation. It is: ^t, time. That is what makes my modifications to Vladimir&#39;s version fly. They are catching random-like exponential drift in a rising market. The obtainable net alpha is compounded and it reverberates across the entire time interval.</p>

<p>I too have covered the extent of what I would have liked to do with Vladimir&#39;s trading strategy. Will probably use some of the things I used here in other programs. But this terminates my participation in this thread. </p>

<p>I have covered what I wanted to see and explore. Hope some have found it interesting.</p>

<p>Wishing you all the best.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e1457fe24f76553c14a98b' id='58e1457fe24f76553c14a98b'>
<a href='#58e1457fe24f76553c14a98b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1491158399000' class='quanto-date posted-at response-posted-at' href='#58e1457fe24f76553c14a98b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>To get back on track, two things:</p>

<ol>
<li>Stop buying and selling in the same minute. The unfilled orders make for out-of-control unpredictability and impossible margin that turns into fake returns. My version shows how to avoid that and was its main point.<br></li>
<li>Recalling some of the things Andreas recommended:</li>
</ol>

<blockquote>
<p>For this model, you could try using a fixed number of stocks, a minimum slope, removing some of the filters like percentile and trend filter, using different allocation models like equal, market cap, inverse market cap, multi factor etc.  </p>
</blockquote>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e14f23d3e991000d70c764' id='58e14f23d3e991000d70c764'>
<a href='#58e14f23d3e991000d70c764'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58aa132d4b1b7158de619b6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/864d1e551cd7756a1b4132f3d1c841cd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58aa132d4b1b7158de619b6b'>Charles Pare</a>
</div>
<a UTCms='1491160867000' class='quanto-date posted-at response-posted-at' href='#58e14f23d3e991000d70c764'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think we are all on the same page here, great!<br>
Blue: I really liked the way you put a queue when buying stocks. I think it&#39;s something we could add to Guy and Vlad&#39;s version and see if it changes the behavior. It should not change that much. If it does we would need to investigate why.</p>

<p>I also like your idea of putting the score in a dedicated table with the slope instead of calling a function to get the position size. It makes the algo easier to add parameters in that table if we want to put a weight on different parameters. For example just add a column i.e. we could add the SMA there too or the log of the log ;-) and look for more than one clue to buy.</p>

<p>However I need to put some time to look at the scores because I&#39;m puzzled why TSLA has such a high score in October 2013. Also your ago buys a lot of different stocks. When comparing to what we should have in Andreas&#39;s book, maybe 20 max but not more. This way it makes it easier to start when you&#39;re a home invester like me and don&#39;t want to put 100k$ down. I haven&#39;t played with the parameters yet so I don&#39;t know if it&#39;s just the risk not being high enough.</p>

<p>Vlad, we need the truth, was the log of the log a typo or a genuine idea hahaha it turned out great but I need to know.</p>

<p>Guy, thanks for your input, it gives me a different perspective on how things work in the major league  and pushing us on completely unintended path.<br>
Now I wish I could have more time to implement all of these plus Blue&#39;s comments ahhhh eventually I&#39;ll do it  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e15ca34212b34ba6fcf20a' id='58e15ca34212b34ba6fcf20a'>
<a href='#58e15ca34212b34ba6fcf20a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562545816f0077be2a000054'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/65eed7bd690af7911cb4e82f70d3a8f6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562545816f0077be2a000054'>Shawn Emhe II</a>
</div>
<a UTCms='1491164323000' class='quanto-date posted-at response-posted-at' href='#58e15ca34212b34ba6fcf20a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Applying the log function twice would measure the acceleration of momentum if the difference were taken in between the operations. And I remember reading an academic paper that found that momentum acceleration might be a more powerful factor than momentum itself. However, I might have missed it, but I didn&#39;t see the second difference being taken in the code. By just applying it twice I&#39;m not sure you get the same result.</p>

<p>Accidental changes sometimes lead to great results. But even when intentionally making modifications care must be taken to test thoroughly. In this case which change had the greatest contribution to the recent results? And why? Was it the change that reduced the number of positions held to less than 5? What type of risk does that expose the portfolio to? Is it worth the risk, even if you can be confident that the past results weren&#39;t luck?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e16214d3e991000d70c917' id='58e16214d3e991000d70c917'>
<a href='#58e16214d3e991000d70c917'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1491165716000' class='quanto-date posted-at response-posted-at' href='#58e16214d3e991000d70c917'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Andreas, </p>

<p>Sorry that I did not implemented in time yours recommendation to remove double log.</p>

<p>Here it is.<br>
It slightly less productive with the same randomly chosen parameters  but still looks like on steroids.<br>
So not to much came from that  &quot;typo&quot;.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e1faab0550a069dd996c23' id='58e1faab0550a069dd996c23'>
<a href='#58e1faab0550a069dd996c23'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57022334065314b77a0006b4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6db2af53f0ac1c1c9a43e8ec8ccbab87?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57022334065314b77a0006b4'>Pietro</a>
</div>
<a UTCms='1491204779000' class='quanto-date posted-at response-posted-at' href='#58e1faab0550a069dd996c23'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Vladimir if you see in daily positions &amp; gain every stock  has the same quantity. This is weird or not?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e23577f7fec7000d34859f' id='58e23577f7fec7000d34859f'>
<a href='#58e23577f7fec7000d34859f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562545816f0077be2a000054'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/65eed7bd690af7911cb4e82f70d3a8f6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562545816f0077be2a000054'>Shawn Emhe II</a>
</div>
<a UTCms='1491219831000' class='quanto-date posted-at response-posted-at' href='#58e23577f7fec7000d34859f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Vladimir,<br>
 Have you had a chance take a look at the pyfolio analysis of your latest backtest? I have attached a notebook of the position tearsheet. It looks like FSLR made up close to 80% of the portfolio in 2008. There are some other heavy concentrations at other times as well. Was that the intention of your changes?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e2d91535f9ba47be57ec23' id='58e2d91535f9ba47be57ec23'>
<a href='#58e2d91535f9ba47be57ec23'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1491261717000' class='quanto-date posted-at response-posted-at' href='#58e2d91535f9ba47be57ec23'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Pietro, Shawn Emhe II</p>

<p>In previous my posts in this thread I used not optimized but randomly chosen  parameters just to illustrate how new slope functions behave.<br>
In latest backtest I just tried Equal number of shares option  </p>

<pre><code>context.use_average_true_range = 0  
</code></pre>

<p>proposed by Charles Pare.</p>

<p>In the following backtest  I am using  less aggressive options:</p>

<p>original ATR weighting </p>

<pre><code>context.use_average_true_range = 1  
</code></pre>

<p>and</p>

<pre><code>context.min_momentum = 30.0  
</code></pre>

<p>to show what you  can do with different <strong>Clenow Momentum</strong> functions  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e2f354943b50000dc9be03' id='58e2f354943b50000dc9be03'>
<a href='#58e2f354943b50000dc9be03'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1491268436000' class='quanto-date posted-at response-posted-at' href='#58e2f354943b50000dc9be03'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Since brokers will not make margin loans beyond 100% of stock value, my version is the only tradable version in this thread, the opposite extreme with no margin. The code provided <a href="https://www.quantopian.com/posts/margin-costs#58e2efcf5b53525e8a102eb7">here</a>  (based on VY above) moves toward addressing that, it can make them somewhat viable maybe, if modified.</p>

<p>A far better way to go: Start with the principles in my version that prevent margin, dump the other portions of my strategy, insert your own since you guys understand what Andreas Clenow is working toward better than I do anyway, then deliberately place orders for intentional margin to whatever level you feel is reasonable, this places you in control of it.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e3bb71848de1238cba0f19' id='58e3bb71848de1238cba0f19'>
<a href='#58e3bb71848de1238cba0f19'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57022334065314b77a0006b4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6db2af53f0ac1c1c9a43e8ec8ccbab87?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57022334065314b77a0006b4'>Pietro</a>
</div>
<a UTCms='1491319665000' class='quanto-date posted-at response-posted-at' href='#58e3bb71848de1238cba0f19'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In this Algo you buy at limit price in open (the first day of the month) where the limit price is the close price of the last day of the month, is that correct?</p>

<p>In quantopian do i have some solutions to know which are  all the stocks potential candidates to be bought?<br>
In other terms, if i want to manually insert orders on the market i need to know which stocks are picked from the algo  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e4104cbe01510927699c1d' id='58e4104cbe01510927699c1d'>
<a href='#58e4104cbe01510927699c1d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1491341388000' class='quanto-date posted-at response-posted-at' href='#58e4104cbe01510927699c1d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Pietro,</p>

<p><em>In this Algo you buy at limit price in open (the first day of the month) where the limit price is the close price of the last day of the month, is that correct?</em></p>

<p>The order executed not at open but at 07:30 according to </p>

<pre><code>schedule_function(rebalance,  
                      date_rules.month_start(),  
                      time_rules.market_open(hours=1))  
</code></pre>

<p>In this code limit price is defined as <em>data.current(security, &quot;price&quot;),</em><br>
that is the price at 07:30</p>

<p><em>do i have some solutions to know which are all the stocks potential candidates to be bought?</em></p>

<p>You may look at log output of backtester</p>

<p>2017-03-01 07:30 PRINT  </p>

<p>Equity(351 [AMD])       616.067663<br>
Equity(18113 [URI])     321.834520<br>
Equity(1937 [CSX])      301.071667<br>
Equity(19725 [NVDA])    210.879091<br>
Equity(43124 [TSRO])    192.551963<br>
Equity(8132 [WDC])      187.978477<br>
Equity(39840 [TSLA])    183.388283<br>
Equity(5121 [MU])       181.775619<br>
Equity(6897 [SIVB])     174.127478<br>
Equity(50242 [DVMT])    153.901290  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e4ab88848de16b4dba0ff1' id='58e4ab88848de16b4dba0ff1'>
<a href='#58e4ab88848de16b4dba0ff1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/589a93aeb56603498dd0af9c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/709f6094ba3e589bfa2ec52a60343887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/589a93aeb56603498dd0af9c'>Rainbow Parrot</a>
</div>
<a UTCms='1491381128000' class='quanto-date posted-at response-posted-at' href='#58e4ab88848de16b4dba0ff1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I was trying to isolate where the outperformance comes from, using the latest version of the algorithm posted here: <a href="https://www.quantopian.com/posts/stocks-on-the-move-by-andreas-clenow#58e2d91535f9ba47be57ec23">https://www.quantopian.com/posts/stocks-on-the-move-by-andreas-clenow#58e2d91535f9ba47be57ec23</a></p>

<p>It turns out that most of the outperformance comes from the MarketCap calculation, namely:</p>

<pre><code>class MarketCap(CustomFactor):  
    inputs = [USEquityPricing.close, morningstar.valuation.shares_outstanding]  
    window_length = 1  
    def compute(self, today, assets, out, close, shares):  
        out[:] = close[-1] * shares[-1]  
</code></pre>

<p>For the <code>shares_outstanding</code> field used in the above calculation, as per the documentation at: <a href="https://www.quantopian.com/help/fundamentals#valuation">https://www.quantopian.com/help/fundamentals#valuation</a></p>

<ol>
<li>This field is updated only quarterly (whereas the algorithm trades monthly based on this data, so it could be using outdated data)<br></li>
<li>This field is is not adjusted for corporate action events including splits (so if there are corporate actions that have happened after the date this field was last updated, we would not have the correct value here)</li>
</ol>

<p>So, I changed the algorithm to use the built-in MarketCap factor instead of the custom factor above, keeping everything else the same. See the attached backtest for the results with this change.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e4f57dfa30fa060638d158' id='58e4f57dfa30fa060638d158'>
<a href='#58e4f57dfa30fa060638d158'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57022334065314b77a0006b4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6db2af53f0ac1c1c9a43e8ec8ccbab87?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57022334065314b77a0006b4'>Pietro</a>
</div>
<a UTCms='1491400061000' class='quanto-date posted-at response-posted-at' href='#58e4f57dfa30fa060638d158'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Vladimir, i need to understand.<br>
Why you say that the limit price is the price at 7:30?</p>

<p>The function &quot;time_rules.market_open(hours=1))&quot; does mean that the code runs one hour after market open, is it correct?  In my log i read 4:30</p>

<p>What i don&#39;t understand is why you buy with limit price. Where the limit price is the price of that moment (4:30, bid or ask).  In this way, in real life, there is a risk of not execute orders.<br>
For a better valuation of this strategy why not use market orders?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e50b6568e387000add79b8' id='58e50b6568e387000add79b8'>
<a href='#58e50b6568e387000add79b8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1491405669000' class='quanto-date posted-at response-posted-at' href='#58e50b6568e387000add79b8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Pietro,</p>

<p><em>The function &quot;time_rules.market_open(hours=1))&quot; does mean that the code runs one hour after market open, is it correct? In my log i read 4:30</em><br>
It is correct.<br>
<em>...why you buy with limit price?</em><br>
It is better to ask this Andreas Clenow, I just  used the modification of his code.<br>
But you may yourself replace limit order for market order and see what will be the results .  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e511d01fdbc0000d7d87af' id='58e511d01fdbc0000d7d87af'>
<a href='#58e511d01fdbc0000d7d87af'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54061e77b01d5fdf49000356'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f7f221d8b77d407426f0458e57e0212a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54061e77b01d5fdf49000356'>Jack Daniel</a>
</div>
<a UTCms='1491407312000' class='quanto-date posted-at response-posted-at' href='#58e511d01fdbc0000d7d87af'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Has there been any thought to disqualifying stocks wherein the adjusted slope is declinging yet still &quot;ranked&quot; at the top of the selection? For example, AMD has been on a steady decline in adjusted slope since 3/1/2017, dropping from above 600 to roughly 200 today. If you compare this to the price chart, you can see that AMD hasn&#39;t made a new high since 2/28.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e5136b4807a9000a7a5ccf' id='58e5136b4807a9000a7a5ccf'>
<a href='#58e5136b4807a9000a7a5ccf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57022334065314b77a0006b4'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6db2af53f0ac1c1c9a43e8ec8ccbab87?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57022334065314b77a0006b4'>Pietro</a>
</div>
<a UTCms='1491407723000' class='quanto-date posted-at response-posted-at' href='#58e5136b4807a9000a7a5ccf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Andreas please can you explain why limit price? </p>

<p>In any case, Vladimir, in log output you see stocks after you&#39;ve bought them not before, is it right?<br>
Is there a way to know before what to buy so one can have time to execute orders on the markets?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e516b40aefe9000a04cb78' id='58e516b40aefe9000a04cb78'>
<a href='#58e516b40aefe9000a04cb78'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1491408564000' class='quanto-date posted-at response-posted-at' href='#58e516b40aefe9000a04cb78'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Pietro,</p>

<p>You may put algo in live paper trading, schedule it 15min earlier and get from there live orders.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e55259b1575c697e524e4a' id='58e55259b1575c697e524e4a'>
<a href='#58e55259b1575c697e524e4a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1491423833000' class='quanto-date posted-at response-posted-at' href='#58e55259b1575c697e524e4a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Pietro: The limit orders were done by James, before I learnt to build my own Python stuff. My own code uses market orders. </p>

<p>I also use the Q500 universe, instead of the market cap workaround. That workaround was built before the Q500 pipeline was available.</p>

<p>My local C# code uses the historical membership of the S&amp;P 500, reading a joiners/leavers database table.</p>

<p>Keep in mind that a model of this kind trades a broad concept. If it becomes too sensitive to exact execution or exact definition of investment universe, it will not be robust.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e63f760540001a88f6add1' id='58e63f760540001a88f6add1'>
<a href='#58e63f760540001a88f6add1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58e63c98a30033000d99b17d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a36e1f37c23e29794939087e68c956ed?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58e63c98a30033000d99b17d'>Alexander Shannon</a>
</div>
<a UTCms='1491484534000' class='quanto-date posted-at response-posted-at' href='#58e63f760540001a88f6add1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Andreas Clenow</p>

<p>After some unsuccessful attempts to develop market timing models for investing my wealth I finally turned to passive investing and specifically to  Vanguard funds. </p>

<p>I do not particularly regret the money I spent to buy your books but little or nothing in them has worked in the last 5 or even more years. Your volatility targeting method generated large losses and was a disaster. I followed your fund in Bloomberg (Yes, I have a terminal in my office still) but now it is not listed after several years of negative returns as shown <a href="http://ibb.co/dxyYtv">in attached</a>. </p>

<p>My question to you: do you believe after your failures that market timing is still viable? </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e64683b775cc0dd7407b56' id='58e64683b775cc0dd7407b56'>
<a href='#58e64683b775cc0dd7407b56'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc20149318942600000ef'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c07480ff96e31388ea3f7b65c5d042da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc20149318942600000ef'>Andreas Clenow</a>
</div>
<a UTCms='1491486339000' class='quanto-date posted-at response-posted-at' href='#58e64683b775cc0dd7407b56'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Ha! It&#39;s this one again. </p>

<p>Yes, of course I know which individual it is who has spent so much time and effort around this story, telling everyone to contact me about my supposed fund blowup. A person whom I have no connection to, but who has apparently been upset with things I wrote on the internet. The individual behind this rather childish campaign will of course not dare to contact me directly about it, nor has he bothered to do any research. </p>

<p>Your post is practically identical to the many newly created Twitter accounts who sent me the same thing. Your account here also seems to be brand new. </p>

<p>What you link to was a tiny fund of a few million, mostly owned by myself and my business partner, with an experimental strategy that didn&#39;t work out very well. In the end, we took it private and continued in-house. It&#39;s one of five funds, 12 structured notes, countless of individual institutional mandates, a few private equity ventures and one bond which I have launched over the years. </p>

<p>So what did you plan to accomplish here? Are you here to contribute to the conversation or did you just hope to cover ad-hominem attacks in rhetorical questions?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e64a1402923a2c037c2538' id='58e64a1402923a2c037c2538'>
<a href='#58e64a1402923a2c037c2538'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58aa132d4b1b7158de619b6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/864d1e551cd7756a1b4132f3d1c841cd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58aa132d4b1b7158de619b6b'>Charles Pare</a>
</div>
<a UTCms='1491487252000' class='quanto-date posted-at response-posted-at' href='#58e64a1402923a2c037c2538'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just a few comments here:</p>

<p>-People should be intelligent enough not to base their investment decisions on some book author they never met.</p>

<p>-People should be intelligent enough to test a strategy before putting real money on the table and understand what they are doing.</p>

<p>-Managing your money is your responsibility and there is nothing to gain on blaming someone else except making a fool of yourself.</p>

<p>-In my opinion the few pages on this thread show there is some advantage of implementing this strategy. The only point is people are arguing is if the CAGR is 12% or 3000% (warning Canadian humor here)   ;-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e679ffb775cc6f20407ad0' id='58e679ffb775cc6f20407ad0'>
<a href='#58e679ffb775cc6f20407ad0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a5e2d0bb26a6a19a0002a6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6c7f590915b50e8f69af885a4509f3b5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a5e2d0bb26a6a19a0002a6'>Roberto M</a>
</div>
<a UTCms='1491499519000' class='quanto-date posted-at response-posted-at' href='#58e679ffb775cc6f20407ad0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It looks we have a bullyish momentum here. The individual behind such Alexander Shannon  account is breaking the Quantopian Terms of Use:</p>

<p>3 Prohibited Activities.<br>
 -  use the Site or Services to <strong>advertise, market, sell, or otherwise promote any commercial enterprise</strong> that you own, are employed by or are otherwise compensated by, either directly or indirectly;<br>
 -  transmit any Content that is unlawful, <strong>harmful, threatening, abusive, harassing, tortious, defamatory, vulgar, obscene, libelous, or otherwise objectionable or which may invade another&#39;s right of privacy or publicity</strong>;</p>

<p>Sorry for that Andreas. Please keep providing your input/feedback/ideas as they are very much appreciated by this community.</p>

<p>Quantopian?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e67bc1b775cc6f20407afa' id='58e67bc1b775cc6f20407afa'>
<a href='#58e67bc1b775cc6f20407afa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4fe8beb792a029000200000d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fe3ffe502559d05f16eb9fe41ab7e9a1?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4fe8beb792a029000200000d'>Dan Dunn</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1491499969000' class='quanto-date posted-at response-posted-at' href='#58e67bc1b775cc6f20407afa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;m watching the thread closely.  It&#39;s definitely close to the edge of acceptability, and I encourage everyone to keep it civil.</p>

<p>As a reminder, we welcome debate and disagreements about ideas.  The <strong>way</strong> that those disagreements are expressed matters quite a bit.  We want the Quantopian community to be accessible and welcoming for as many people as possible.  We don&#39;t want people to be afraid to post because they might be cut down.  Debate is healthy; attacks are not.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='58e67d6c1c57b47b737f27cd' id='58e67d6c1c57b47b737f27cd'>
<a href='#58e67d6c1c57b47b737f27cd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58a1efc120596b38743243bb'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d6c15c21239a25a8a60915d747aa7df3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58a1efc120596b38743243bb'>tester Ro</a>
</div>
<a UTCms='1491500396000' class='quanto-date posted-at response-posted-at' href='#58e67d6c1c57b47b737f27cd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I don&#39;t thing we have a bullyish momentum here, Shannon has exposed himself as &quot;i ran the algo without fully knowing how it works and how it may fail and i lost evertything, blame Andreas for not making me rich by just copying an algorithm&quot;  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e6cc8bb775cc44d0407d6c' id='58e6cc8bb775cc44d0407d6c'>
<a href='#58e6cc8bb775cc44d0407d6c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58a8ce046a7e6f3d2a8cd756'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73b70cb3462654c897208dedeaba5cd3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58a8ce046a7e6f3d2a8cd756'>Eric Bird</a>
</div>
<a UTCms='1491520651000' class='quanto-date posted-at response-posted-at' href='#58e6cc8bb775cc44d0407d6c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Some of these comments are embarrassing to read. The phrase &quot;pearls before swine&quot; comes to mind. Andreas is one of the few professionals willing to share practical and quality research to the retail crowd.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58e6faf402923a149c7c27a8' id='58e6faf402923a149c7c27a8'>
<a href='#58e6faf402923a149c7c27a8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/589a93aeb56603498dd0af9c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/709f6094ba3e589bfa2ec52a60343887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/589a93aeb56603498dd0af9c'>Rainbow Parrot</a>
</div>
<a UTCms='1491532532000' class='quanto-date posted-at response-posted-at' href='#58e6faf402923a149c7c27a8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Personally, I can definitely vouch for the credibility of Andreas. I have read both of his books and found a wealth of information in both of them. In my mail communication with him, where I had some queries after reading <em>Stocks on the Move</em>, he responded immediately in the most helpful manner. Even in his book, he does not claim a CAGR of more than around 12% for this type of momentum strategy over the long term. And looking at the posts above, it does deliver at least that much returns.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58f140b3d5e8cc000d5b1a23' id='58f140b3d5e8cc000d5b1a23'>
<a href='#58f140b3d5e8cc000d5b1a23'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1492205747000' class='quanto-date posted-at response-posted-at' href='#58f140b3d5e8cc000d5b1a23'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Received an email today with the following chart:</p>

<p><img src="https://image-proxy.quantopian.com/f106bc992316972c567e6bf22533fef5210cd48a/687474703a2f2f616c706861706f77657274726164696e672e636f6d2f7175616e746f7069616e2f456d61696c5f4a5f534f544d5f3134792e706e67" /> </p>

<p>Finally, someone has succeeded in duplicating my results, and even do a little better. It says we have the same program settings or very close to it.</p>

<p>Therefore, as previously stated: anyone could do it.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58f1ec565d64740010ce20ac' id='58f1ec565d64740010ce20ac'>
<a href='#58f1ec565d64740010ce20ac'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1492249686000' class='quanto-date posted-at response-posted-at' href='#58f1ec565d64740010ce20ac'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>@Andreas Clenow . After some unsuccessful attempts to develop market timing models for investing my wealth I finally turned to passive investing and specifically to Vanguard funds. I do not particularly regret the money I spent to buy your books but little or nothing in them has worked in the last 5 or even more years. Your volatility targeting method generated large losses and was a disaster. I followed your fund in Bloomberg (Yes, I have a terminal in my office still) but now it is not listed after several years of negative returns as shown in attached.  My question to you: do you believe after your failures that market timing is still viable?</p>
</blockquote>

<p>What was this method? I ask because I am a believer in tactical asset allocation. And Markowitz seems a pretty good route (by way of example).<br>
<a href="https://www.quantopian.com/posts/markowitz-portfolio-construction">Markowitz Portfolio</a></p>

<p>As to buy and hold of Vanguard Funds, yes indeed. Except there is no such thing as &quot;buy and hold&quot;. With the S&amp;P 500 ETF by way of example you only hold stocks so long as they remain in the S$P. You are buying, effectively, a trend following system on US economic growth. As to whether you should add a timing mechanism on top of that ETF is a further question but one that is by no means as simple as it seems. A 60/40 equity bond split works on &quot;market timing&quot; in a sense - you are profit taking and re-allocating to the losing side on a regular basis.</p>

<p>Where criticism of trading sites is justified is to the extent that participants are fooling themselves with ludicrously optimistic back tests based mostly on leverage and or curve fitting. </p>

<p>Quantopian itself can not be criticised on these grounds. All they do is to provide a top notch platform which gives the inexperienced, the gullible and the foolish enough rope to hang themselves. I am not a believer in their approach of gearing a &quot;market neutral&quot; approach to the eyeballs but I am a HUGE fan of the research they produce (the above link being a prime example).</p>

<p>Most people become disappointed because they are enticed by impossible returns marketed in many cases by cynical rogues with phrases like &quot;make millions from scratch by doing bu**er all.&quot;  I don&#39;t think Mr Clenow is guilty of that.</p>

<p>There have been many intelligent comments here on Quantopian in particular by Michael Harris who has severe doubts about market timing - or at least the trend following variety. Fair enough and who knows he may well be right. But if you don&#39;t operate SOME form of decision making on when to enter and or exit you will end up owning the future equivalent of Weimar Germany bonds and a bunch of bankrupt economies.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58f95ff47e886f000d86196e' id='58f95ff47e886f000d86196e'>
<a href='#58f95ff47e886f000d86196e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/564e6e767b818b0fd7000454'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c4e55dc10888f45d742f0b0528e50cba?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/564e6e767b818b0fd7000454'>Justin Williams</a>
</div>
<a UTCms='1492738036000' class='quanto-date posted-at response-posted-at' href='#58f95ff47e886f000d86196e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I sent the screenshot to Guy; it&#39;s a mighty fine example of curve fitting. </p>

<p>The only way I could get leverage to work right was by changing the estimated cash impact and position size taken to two different numbers.</p>

<p>I am really looking forward to playing with the Quantopian futures data so we can create a turtle-esque strategy that employs a diversified futures trend following system, like the one laid out in Andreas&#39;s other book.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58f9a5c2059792000d23b214' id='58f9a5c2059792000d23b214'>
<a href='#58f9a5c2059792000d23b214'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58794da090925a000abd5ca3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/18f509f82da972d016ae90ca4489a17b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58794da090925a000abd5ca3'>jacob shrum</a>
</div>
<a UTCms='1492755906000' class='quanto-date posted-at response-posted-at' href='#58f9a5c2059792000d23b214'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Guy, I got 37,000, drawdown of 19. Major improvements can be made here. If I get it to 50K ill post it for the luls  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59049eda31dfaf6f1120c766' id='59049eda31dfaf6f1120c766'>
<a href='#59049eda31dfaf6f1120c766'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1493475034000' class='quanto-date posted-at response-posted-at' href='#59049eda31dfaf6f1120c766'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Justin, sorry, I thought you had it since your chart did resemble mine. </p>

<p><img src="https://image-proxy.quantopian.com/6315c016ca37ba062ccf1c1d1bb4b53c6ad1bf05/687474703a2f2f616c706861706f77657274726164696e672e636f6d2f7175616e746f7069616e2f534f544d5f4c6173745f566572735f3130306b2e706e67" /> </p>

<p><a href="http://alphapowertrading.com/quantopian/SOTM_Last_Vers_100k.png">http://alphapowertrading.com/quantopian/SOTM_Last_Vers_100k.png</a></p>

<p>As you can observe, the numbers are similar except for the initial capital which is at $100k.</p>

<p>Unfortunately, your version of the program is not that scalable as illustrated in the attached code.</p>

<p>I have not made any code modifications, and used the program as posted. It gave out what I would consider as ordinary results with $10M for initial capital.</p>

<p>It translates to a 13.79% CAGR for the 13.8 years, this before leveraging cost which were estimated at $6.2M, thereby reducing performance to a net 12.89% CAGR all expenses paid.</p>

<p>Any trading strategy we design or transform is just one of the possible scenarios. There are millions of different combination that can be tested. Picking one of them does not necessarily make it over-fitted, optimizing for a result might.</p>

<p>My suggestion: keep it up, you will find a way and the reason why my charts show such high numbers. It is when you will find out the why that you might consider my results as ordinary for that program and even make some improvements of your own to push it further.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5907cef592f5f3001041f8c4' id='5907cef592f5f3001041f8c4'>
<a href='#5907cef592f5f3001041f8c4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1493683957000' class='quanto-date posted-at response-posted-at' href='#5907cef592f5f3001041f8c4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Justin, to get some clues on how you could do it, or improve on your program, take a look at my recent article on the subject:</p>

<p><a href="http://alphapowertrading.com/index.php/papers/251-a-quest-for-stock-profits-part-ii">http://alphapowertrading.com/index.php/papers/251-a-quest-for-stock-profits-part-ii</a></p>

<p>It provides my analysis of the strengths and weaknesses encountered in these trading procedures. It considers same-theme variations with an emphasis put on achievable performances.</p>

<p>Hope it will help.</p>

<p>I looked at your posted program and I don&#39;t see how you would classify it as a: ...mighty fine example of curve fitting. You made some choices from millions of possible parameter combinations. How could you determine if it is over, or under-fitted for that matter, from the few trials you have tried?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5908f8d0798b510010a7ee5d' id='5908f8d0798b510010a7ee5d'>
<a href='#5908f8d0798b510010a7ee5d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56699d9e60d52f61b0000002'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f004afee98567e4b3a496f60f0ae78c7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56699d9e60d52f61b0000002'>William Spratt</a>
</div>
<a UTCms='1493760208000' class='quanto-date posted-at response-posted-at' href='#5908f8d0798b510010a7ee5d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir Yevtushenko, I am currently live trading your most recent code posted 5 weeks ago and was interested in seeing if it would be possible to implement a modification that had the code move to an ETF (IEF for example) instead of cash when reducing exposure.  Andreas in his Equity Momentum algorithm has a section like this (shown below, lines 107  109 in that code) and Id be interested to see how this changed performance of this momentum strategy. I do not have the coding ability myself but wanted to see if you or anyone here would be able to implement that easily.</p>

<p># identifier for the cash management etf, if used.<br>
    context.use_bond_etf = True<br>
    context.bond_etf = sid(23870)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='590df85a65de23000d174132' id='590df85a65de23000d174132'>
<a href='#590df85a65de23000d174132'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1494087770000' class='quanto-date posted-at response-posted-at' href='#590df85a65de23000d174132'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I received the following direct question by email: Is that algo for real? 40,000%?  My answer was rather blunt: </p>

<blockquote>
<p>Yes, and the trading procedures used are perfectly legitimate<br>
operations. They all survived within their coded limitations. There<br>
were no errors in the code, mathematical, logical or otherwise. No<br>
gimmick or deception. Just plain Python programming.</p>
</blockquote>

<p>For me, the real question would have been: would you trade like that? Personally, I would bring more modifications to this strategy before even considering it. It is not my preferred strategy. It is wasteful of capital resources, has too many switcheroos, it is shackled to constant parameters, and makes as time progresses bigger and bigger bets. A way of saying it should be better controlled. Those are all subjective problems. They all can be addressed and fixed. </p>

<p>Nonetheless, my latest iteration, even in its crude state did show that it was more than just productive, </p>

<p>As a reminder. If my strategies are not valid in some way, then I would have to conclude that none of yours are either. Is that blunt enough? </p>

<p>Some think that the charts I&#39;ve posted are not for real, well think again. Some might not like them, but basically, that is not my problem.</p>

<p>Regardless, I am not the designer of this program as I have said before in this thread. Most of it ( 99.8%) is Vladimir&#39;s code. His program modifications made it quite a different program than the original version at the top of this thread, and it is from Vladimir&#39;s version that I made my latest modifications. So, Vladimir, thanks, and also to others who have previously improved on the generic design.</p>

<p>The received email question kind of  implied as if something was wrong or that some wrongdoing was at play when all you have is a program. Valdimir&#39;s program version is still in plain sight for anyone to analyze, clone, modify, and execute. </p>

<p>@Justin in a recent post describing his own program modifications came to the conclusion that: ... it&#39;s a mighty fine example of curve fitting. </p>

<p>I disagree on that. Sorting 700 stocks by capitalization and return is not what I would call curve-fitted. It is just a rather plain stock selection process, and not original. It has been around for ages.</p>

<p>My only contention on this trading strategy would be on the validity of the price data itself. I have no reason to doubt the integrity of the price database provided by Quantopian. If the stock price data as provided was not reliable, everyone&#39;s every simulation would be in doubt. </p>

<p>So, you have these simulation conditions. The price data is guarded and protected by Quantopian. A program is executed somewhere in the cloud on their servers using their data and Python interface. Program code can be shared by those wishing to do so. It is the only thing that is shared: the code. And it can only be executed on Quantopian machines.</p>

<p>Having cloned someone else&#39;s program, it will give the same answers if executed.  If you change the code, stock selection methods, program parameters, trading procedures, or simulation intervals, it is sufficient to have a different answer. It also changes the strategy&#39;s trading behavior. </p>

<p>But, whatever, it remains a program that is executed on someone else&#39;s machines under their setup and conditions. All you can do is supply code or variations thereof. And, code is code, it only executes if it has no programming bugs. </p>

<p>I saw some potential in Valdimir&#39;s program. Was able to extract it and also demonstrate that it was there. You could go from a do-nothing scenario as presented in the first post with no long term alpha generation whatsoever to progressively not only instill some alpha in this program but also have it grow from within. I made it respond better to its inherent mathematical makeup.</p>

<p>Spoiler alert: my modifications to Valdimir&#39;s program pertain to enhancing part of the submartingale properties of the strategy. In essence, letting the program, at times if it can, increase share holdings on some of its advancing stock positions. And since the selected group of stocks candidates as depicted in a previously posted chart are above zero in CAGR terms, they are expressing a positive expectancy for the taken group of positions. </p>

<p>For such a statistical swarm to be productive, a basic requirement would be an upward market drift. It is what you have most of the time when the strategy is taking positions. The posted chart will not let you buy without this positive expectancy. All I did was partly exploit these submartingale properties. And, the simulations I did, not only showed these properties were there, but that you could exploit them as well.</p>

<p>A submartingale has for mathematical expression: E[P(t+1)|(P(1),...,P(t)]  P(t). And if you look back at the cited chart, you will observe that all price series having their CAGR above zero satisfy the condition. It also implies that any return sorting could have done a similar job.</p>

<p>It is not by doing the same thing as everybody else that you will get different results.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59146e3d4795ac289a4d65da' id='59146e3d4795ac289a4d65da'>
<a href='#59146e3d4795ac289a4d65da'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1494511165000' class='quanto-date posted-at response-posted-at' href='#59146e3d4795ac289a4d65da'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Where did the outperformance come from? </p>

<p>From gaming the strategy itself, of course. By making it an automated gambling machine.</p>

<p>Exploiting submartingale properties of the strategy by enhancing its betting procedures. This had for result: making big bets on big price moves while making small bets on smaller ones. This should come as no surprise, at least, it did not to me.</p>

<p>This does not make the underlying trading procedures predictive. That was clearly demonstrated by the original trading strategy at the top of this thread. There was no alpha there.</p>

<p>It is how you modified the program to follow different trading rules that made a difference. And, based on the various tests performed, it made quite a difference. </p>

<p>See the performance progression in the series of charts presented. All achievable by gaming the strategy. It makes the range of outcomes so huge that the first chart appears insignificant by comparison. </p>

<p>It would also appear that gaming the system might be a lot more productive than trying to optimize by finding the local maxima of a strategy parameter. It does raise the question: what should be part of optimization procedures? And what can you do to improve performance?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='591499bade5cfc001041efcd' id='591499bade5cfc001041efcd'>
<a href='#591499bade5cfc001041efcd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1494522298000' class='quanto-date posted-at response-posted-at' href='#591499bade5cfc001041efcd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I do not believe that gambling strategies have any place in an adaptive complex system. Probability may be a fine tool to analyse games of chance with fixed rules but adding a gambling approach to market timing seems to me to be adding one dubious approach to another.</p>

<p>In the long term momentum may be effective.  In the short term I believe it has become less and less effective as a tool to time markets over the past 40 years. My analysis of future markets over the period certainly shows that trends have become less and less easy to profit from in a trading sense as market activity has increased.</p>

<p>To the extent that I am now wary of using momentum for my own trading and prefer to earn rather than speculate on a probabilistic approach.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59160efaf20cc032a7f8513f' id='59160efaf20cc032a7f8513f'>
<a href='#59160efaf20cc032a7f8513f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57be4486e20ff41fb6000105'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5617a93b8b547838eec92d0fa962b7e9?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57be4486e20ff41fb6000105'>Sylvain L.</a>
</div>
<a UTCms='1494617850000' class='quanto-date posted-at response-posted-at' href='#59160efaf20cc032a7f8513f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello, First of all: Sorry for my english ;)</p>

<p>I would like to know how i can add a exception in the code.</p>

<p>I saw the algo buy AMD; in my mind.. i never buy AMD and i will never buy it.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59160f0fe29755286f69f642' id='59160f0fe29755286f69f642'>
<a href='#59160f0fe29755286f69f642'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1494617871000' class='quanto-date posted-at response-posted-at' href='#59160f0fe29755286f69f642'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>My previous post made the point that you could make money, and a lot of it, using what was classified as an automated gambling machine. </p>

<p>All it needed was some kind of generalized excuse to take a trade. It made the point indirectly that it might not matter much which excuse might be used as long as it provided a sufficient number of trading opportunities which might or might not be taken. Only two portfolio metrics mattered: A(t) = A(0) + nAPT, where n is the number of trades, and APT the average profit per trade. Because trading intervals tend to be relatively short, n needs to compensate to make it interesting. A way of saying that n needs to be large, and because of that APT will tend asymptotically to a limit. Look up the law of large numbers if you do not see this.</p>

<p>A single decision space was set: if a stock price was above its 90-day linear CAGR regression and part of the selectable trade candidates, it could be bought and held while it stayed above its positive regression slope.</p>

<p>Some people design trading strategies using fancy names (on the move, momentum rotation, mean reversion,...) with a lot of stuff in them. When, in fact, their designs are no more than automated gambling systems. </p>

<p>I dare call them for what they are intrinsically, that is: automated gambling strategies. It is the case for the originally posted strategy in this thread.</p>

<p>No proof whatsoever, statistical or otherwise, was ever provided showing that a 90-day trend could, in fact, be profitable. No data or evidence of any kind was submitted. The strategy was hard coded with this 90-day CAGR trend without an ounce of justification. Nothing more than: hey dude, I good, trust me! </p>

<p>I do not buy that stuff that easily. I require proof. And, on that count, the originally posted strategy fail miserably by showing no alpha. No trading advantage whatsoever. Even with having 14.42 years to show its merits, it still failed. That is 5,265 days to make its point! And it could not even beat its SPY benchmark.</p>

<p>Due to the considerable lag in the regression of price series, we could view the trade triggering decision point almost as if quasi-random. In the sense that the right edge of the regression line was so outdated that it was like making decisions based on small price variations (as low as 1/90th of a cent) and reacting to price changes from 1 day to as far as 90 days ago.</p>

<p>As if the outcome of a random event, and therefore having low predictability. The lower the predictability, the higher the random nature of the trade decision point itself. And the less you can profit from predictive methods of play. Which is what the original program clearly showed: no alpha. </p>

<p>What are the odds that tomorrow a stock regression line goes up or down by one cent? Talk about market noise. This is much lower than even a whimper, it is close to silence, to cosmic background noise. And yet, trading decisions were based on such price variations for either the entry or the exit of positions. A one cent price move over 90 trading days was sufficient to trigger a trade...</p>

<p>What saved the strategy was that most of its bets were taken while the market, on average, was also going up. Imagine this prodigious concept: betting on long positions mostly when prices in general are going up. Wouldn&#39;t that be a trading revolution in the making, if it hadn&#39;t been there for ages. If a trader does not see that betting long on stocks in a rising market is one way to make profits, maybe he/she is not in the right game.</p>

<p>The original trading strategy as presented in this thread is gambling on the pretense of a positive CAGR slope. And yet, does not generate any alpha. It gets the same results as if a monkey was throwing darts at the financial section of a newspaper.</p>

<p>The methodology used is at most gambling its way to mediocrity. No alpha generation, no explicit skills demonstrated, no reason to think that the whole premises on which was based that trading strategy gave results different from random.</p>

<p>Therefore, yes, if a trading strategy does not generate any alpha  I will call it ordinary or worse.</p>

<p>Would you take the money even if it is coming from what virtually amounts to an automated gambling program? I know I don&#39;t mind or care what generates the money as long as it is there. </p>

<p>And what my simulations showed is that the money is there, the alpha is there, and you can build it yourself. It is a lot more than the originally posted trading strategy had to show.</p>

<p>Exploiting submartingale properties of a trading strategy might not be for everyone. However, no matter what, whatever the math of the game, math is math. An equal sign has a lot more weight than an opinion.</p>

<p>@Anthony, you give opinions but you do not justify them. You send out: I believe, and I suppose. It might be acceptable for you. But, I am in a world of math. Opinions are not enough. I want some kind of justification, some data, some research to support your claims. Prove me wrong! No opinions. Just facts, show some tangible evidence.</p>

<p>@Justin, you have above the explanation why, with the slightest change in parameter, your results are all over the place. You could change the rebalance time to another time of day by minutes and see the performance drop. The reason is related to the trading mechanics of the strategy. It reacts to the difference in price of: (1/90)(p[-1]  p[0]). A one cent move over 90 trading days can trigger a trade. It is making the trade triggering decision process quasi-random. However, I don&#39;t mind,. My program version makes no pretense. It is an automated gambling machine.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59166830a06a46001015b4d3' id='59166830a06a46001015b4d3'>
<a href='#59166830a06a46001015b4d3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1494640688000' class='quanto-date posted-at response-posted-at' href='#59166830a06a46001015b4d3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It is not a question of of maths .  You are are using the wrong tool for the wrong job.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='591712e826025a21f55a94ad' id='591712e826025a21f55a94ad'>
<a href='#591712e826025a21f55a94ad'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1494684392000' class='quanto-date posted-at response-posted-at' href='#591712e826025a21f55a94ad'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Anthony,  again, no proof, no substantiating evidence, no facts. Just as before, only an opinion. </p>

<p>It gets tiresome you know... You have been at it for years now. Always with the same mantra whatever trading strategy I modify. At the very least, you should try to put some substance in your argumentation. Then, it might get interesting.</p>

<p>It is all about math. Period.</p>

<p>In a program you add, subtract, multiply and divide whatever stuff you want, in whichever way you want, under whatever conditions you want. Everywhere you put an equal sign, it will hold. It is the logic of what you are trying to do that might be right, wrong, misunderstood, or ill-conceived.</p>

<p>Note that if you knew the tools I use, you would be able to show the same results I did, and you have not so far.</p>

<p>According to you, apparently, these wrong tools would be applied to the wrong job! Is that programming, time series analysis, gaming theory... Or, is it your way of saying: no matter what, you are wrong! The world is flat, and that&#39;s it!</p>

<p>I know what my program does. I can also make it do more if I want.</p>

<p>In the end, it is very simple: PROVE ME WRONG!  </p>

<p>If you can not prove me wrong, then your opinion has absolutely no value, no mathematical credibility.</p>

<p>It might be a lot easier to prove me right. But there too, you will need math. </p>

<p>On my part, I did put some tangible evidence on the table as to what my version of this program can do. And, I will stand by it.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='591754acd79ea030a658c76c' id='591754acd79ea030a658c76c'>
<a href='#591754acd79ea030a658c76c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1494701228000' class='quanto-date posted-at response-posted-at' href='#591754acd79ea030a658c76c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Guy it&#39;s about the markets and reality not maths or programming.  Anyone with the most basic maths and programming skills can produce wonderful backtests.  Whether they can match these backtests going forward with a real money account is what matters. Have you managed to do that?  I most certainly have not.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59175dd553b8d4248c041a20' id='59175dd553b8d4248c041a20'>
<a href='#59175dd553b8d4248c041a20'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1494703573000' class='quanto-date posted-at response-posted-at' href='#59175dd553b8d4248c041a20'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>Type of trading   Chances of success<br>
Intraday with charts    Zero<br>
Intraday with model Very low<br>
Short-term with chart   Very low<br>
Short-term with models  Low<br>
Trend-following with charts Very low<br>
Trend-following with model  Low<br>
News/sentiment trading  Zero<br>
Rare events Low<br>
Esoteric methods    Very low</p>
</blockquote>

<p><a href="http://www.priceactionlab.com/Blog/2016/12/trading-investing-dichotomy/">Michael Harris</a></p>

<p>I love Michael Harris&#39; Blog. I have absolutely no idea what his software does although no doubt he would be kind enough to give me a free trial if I asked him. What he is, is a no bullshit man. He is a realist and sees most financial bloggers for what they are. We should all take a leaf out of his book.</p>

<p>Note to Quantopian, Guy et al. : please do not get stroppy. This post is not an insult. To anyone. I am merely stating that in my opinion Michael Harris is worth listening to.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='591888cbffefe70010d569f3' id='591888cbffefe70010d569f3'>
<a href='#591888cbffefe70010d569f3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a7430cdcf2e8e3a0000c38'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2fe9a7563bf45ae661919eaeec6c386e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a7430cdcf2e8e3a0000c38'>Michael Harris</a>
</div>
<a UTCms='1494780107000' class='quanto-date posted-at response-posted-at' href='#591888cbffefe70010d569f3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Dear Anthony,</p>

<p>I havent been to these forums for a while because Ive been busy with projects. I just logged in to check the performance of by DIAT4S3 system and to make a quick tweet about it. </p>

<p><a href="https://twitter.com/mikeharrisNY/status/863779504573087744">https://twitter.com/mikeharrisNY/status/863779504573087744</a></p>

<p>I saw your name as the last poster in the forums and checked it out as always for some wisdom. I appreciate the reference to my work but Ive never asked anyone for recognition and frankly I dont care if anyone is listening. Recently I even stopped writing free articles for my blog with market analysis because I want people to do their own homework.</p>

<p>Backtesting is dangerous because the more you try, the lower the chances of success. Please see my recent article in Medium.com</p>

<p><a href="https://medium.com/towards-data-science/the-paradox-of-the-elusive-market-edge-5e6b57b04398">https://medium.com/towards-data-science/the-paradox-of-the-elusive-market-edge-5e6b57b04398</a></p>

<p>Figure 1 (from my book) depicts one of the most dangerous processes one can get involved with in this area. Figure 2 shows how probability of success decreases with new trials because the probability of a Type-I error increases with an increasing number of backtesting runs.<br>
Forward testing with real money is the only way of dealing with this problem but it takes time and resources and the risk of regime change after full deployment is there after all. </p>

<p>Trading has a significant luck dimension. Losers should not blame their skills and winners should not be arrogant. </p>

<p>Online platforms such as Quantopian are forcing efficiency on the markets and academics will be happy and feel vindicated. As traders {rather programmers I should say) from all over the world attempt to capitalize on these new tools that make backtesting accessible to all, their purpose is defeated by the effect on price action and specifically by the increase in randomness. Trading strat development was supposed to be a secretive activity for people who were well-motivated, had money and were looking for extra profit and some fun. When trading turns into relentless data-mining bias using publicly available tools, the result is noise. There will be a long period before a return to normality but in the process damage will be inflicted. But at the end of the day the market will absorb all the noise with known results. </p>

<p>Best.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5922e51e8cfd10428a5cf4f3' id='5922e51e8cfd10428a5cf4f3'>
<a href='#5922e51e8cfd10428a5cf4f3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1495459102000' class='quanto-date posted-at response-posted-at' href='#5922e51e8cfd10428a5cf4f3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just published my latest book:  <strong>A Quest for Stock Profits</strong><br>
It says: if you want more, you will have to do more...<br>
A Quest for Stock Profits is now available on Amazon:  <a href="https://www.amazon.com/dp/B071LL1YR3">https://www.amazon.com/dp/B071LL1YR3</a></p>

<p>It takes what I now consider a lackluster stock trading strategy which had little going for it. It could not even beat its benchmark. The trading method used had nothing out of the ordinary. No predictive powers of any kind. </p>

<p>Nonetheless, it was transformed into a more productive scenario.</p>

<p>Overall, it ends up just gambling its way through. </p>

<p>Seriously winning the game. Not by having better analysis, but by gaming the strategy itself. </p>

<p>The book makes the point that a part of the stock market is behaving as a submartingale, and a way to play it is also with a submartingale trading strategy. To demonstrate the point, it provides simulations which could only result from a submartingale method of play. Some of which have been shown in this thread.</p>

<p>The modifications to the trading strategy are such that it is very different than the original version at the top of this thread from which it is derived. There is no survivorship biases, no optimization, except mathematical and mostly from outside the strategy itself. As said, it accepts gambling its way to the finish line.</p>

<p>The strategy&#39;s trading behavior is considerably altered. But, still, what might be important is the simplicity with which it handles market uncertainty and quasi-randomness of stock price series.</p>

<p>Over recent months I covered a lot of ground on the analysis of this trading strategy. There was a lot more to be said. A lot more to cover. It resulted in this book: </p>

<p><img src="https://image-proxy.quantopian.com/ef08e3eae7b3ad1e51ec8d384f447a05a22d13a5/687474703a2f2f616c706861706f77657274726164696e672e636f6d2f696d616765732f6469766572732f5175657374466f7250726f666974732e706e67" /> </p>

<p>Hope it can help some.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='592dd42e28933a0010c02c38' id='592dd42e28933a0010c02c38'>
<a href='#592dd42e28933a0010c02c38'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1496175662000' class='quanto-date posted-at response-posted-at' href='#592dd42e28933a0010c02c38'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><strong>A Stock Trading Strategy That Is Simply Gambling</strong></p>

<p>My latest book: A Quest for Stock Profits. If you want more, you will have to do more...  makes the point that the original stock trading strategy, on which it is based, was simply gambling. And this automated gambling was somewhat camouflaged in code as if trying to persuade people that it was trading based on some fundamental market data. </p>

<p>The modifications I made to the program were only to enhance this gambling notion. As if saying, if you want to gamble, at least play to win.</p>

<p>When in fact, it was just playing market noise. To such an extent that it did not even outperform its benchmark. It was as if randomly trading on a swarm of stocks.  It is understandable since the trading method was much like having a monkey throw darts at the financial section of the newspaper where the most expected outcome would be tending to the market&#39;s average. Resulting, as should be expected, into a long term no alpha scenario.</p>

<p>This analysis might appear severe, but, let&#39;s see and call things as they are.</p>

<p>Winning at the stock market game is a blurry notion. You can make money, no problem. But, you have to compare whatever you do to a benchmark. And if your efforts do not result in higher profits than the said benchmark, then you have done a lot of work for nothing. That is where the winning comes in. Your efforts, your program has to generate more profits than just buying low-cost index funds. Making some money is not enough. You have to generate some alpha.</p>

<p>To show that your efforts resulted in more than just a random occurrence, you have to exceed by a considerable margin what the market would have given you for practically nothing, just for participating in the game for a long time.</p>

<p>The original trading script defined a 90-day regression line as a trend. As if there was such a thing. One can draw a line on any chart; it does not make it necessarily predictive. </p>

<p>It is just a line that at most can say something about past data, not what is coming next.</p>

<p>It should be evidently clear: there is no 90-day trend. It is a line you draw in the sand, and the market does not and will not even look at it. It will just go its way with no consideration for your trend.</p>

<p>Linear Regression as Trend Line</p>

<p>That you draw a line on a chart does not make it a prediction! At most, maybe a guess, an excuse.</p>

<p>It remains just a line, and when it ends at the right edge of a price chart, you are simply at the right edge of a chart as everyone else. </p>

<p>You are facing an immediate quasi-random future path with a high degree of uncertainty. This is where gurus can give you this wonderful advice: the price will go up tomorrow if it does not go down.</p>

<p>If there was anything predictive in a 90-day trendline, it would be the equivalent of a self-defined free lunch. </p>

<p>The market usually offers few of those, and usually, they do not last. They are rapidly arbitraged out. One has to consider that the whole premise of the 90-day regression has practically no strategic value. Then, what could be its use?</p>

<p>However, if you draw 90-day trendlines for all the stocks all the time, you will find more of them going up than down over extended periods of time. Not as a predictive tool, but simply as a classification of what you see. </p>

<p><strong>Sorting by Price</strong></p>

<p>That you sort stocks by price, or their logs, does not give an advantage either.  </p>

<p>Nonetheless, the strategy is sorting on what might appear as recent accomplishments, and there is some value in that. Big companies got bigger for some economic reasons.</p>

<p>However, it might not be enough to outperform the market. This was clearly demonstrated in the original program simulation. No alpha generation whatsoever. </p>

<p>Tagging along is not how you generate excess returns.</p>

<p>In the original strategy, a trade could be triggered due to a penny move from up to 90 days prior. This in itself makes the trading strategy operate on what looks more like market noise. You should not base a trading strategy on fundamentals where a one-cent price move some 90 days ago has the ability to trigger a trade. </p>

<p>The original strategy is so sensitive to minor price changes that changing its rebalancing time by only a few minutes will give different answers.</p>

<p>Placing bets on such minimal market noise is akin to simply gambling your way out. Try giving probabilities on that, and you will find yourself at the right edge of the chart in need of the support of the above mentioned gurus.</p>

<p>There is practically nothing of interest in the original strategy as was presented. The first post in the forum where the original strategy was provided confirmed this with its test results.</p>

<p>Gambling Acceptance</p>

<p>Having established that the trading strategy is simply gambling, why not accept it as is? And play accordingly. </p>

<p>Find in the method of play what could transform the trading strategy into an alpha generating machine.</p>

<p>Note that this trading strategy is very wasteful of its capital resources, even after my modifications. It trades unnecessarily, has really bad trade timing, and will still trigger a trade from a penny move some 90 days prior. There is much to improve here.</p>

<p>But, nonetheless, it does have a redeeming quality. </p>

<p>By modifying its code, and accepting its gambling habits, you can make a lot of money. You will need guts, perseverance, and capital to do so, but you will get there a lot faster than everyone else.</p>

<p>My modifications accept the strategy&#39;s gambling stance. Sees that the stock selection process itself has some indirect advantages and that applying a submartingale strategy can generate some considerable alpha.</p>

<p>That is the whole purpose of designing automated stock trading strategies. It is to outperform, not just of a few days or weeks, but for years and years. You want to reach the finish with much more than just average performance. To do so, you need some alpha generation. Average performance is always available just by buying low-cost index funds.</p>

<p>Should it really matter that much that you are gambling to generate your alpha? Will you accept it, even if it is gambling? All the while providing you with better odds of outperforming the averages.</p>

<p>That is what my simulations showed, as a kind of proof of concept. You can change the trading strategy&#39;s behavior. There are many variants and improvements that could be made.</p>

<p>Yes, I admit and accept that my code also trades, should I say, gambles its way to the finish line. But then again, it wins, and it wins big. There are reasons for that too.</p>

<p>Related Articles:</p>

<p>A Quest for Stock Profits  Part I<br>
<a href="http://alphapowertrading.com/index.php/papers/250-a-quest-for-stock-profits-part-i">http://alphapowertrading.com/index.php/papers/250-a-quest-for-stock-profits-part-i</a></p>

<p>A Quest for Stock Profits  Part II<br>
<a href="http://alphapowertrading.com/index.php/papers/251-a-quest-for-stock-profits-part-ii">http://alphapowertrading.com/index.php/papers/251-a-quest-for-stock-profits-part-ii</a></p>

<p>Book:<br>
A Quest for Stock Profits. If you want more, you will have to do more...<br>
<a href="https://www.amazon.com/dp/B071LL1YR3">https://www.amazon.com/dp/B071LL1YR3</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='593af490ac92a64f9b068850' id='593af490ac92a64f9b068850'>
<a href='#593af490ac92a64f9b068850'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1497035920000' class='quanto-date posted-at response-posted-at' href='#593af490ac92a64f9b068850'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The following notebook is all about alpha generation.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='593de12b4f20a5000d82a713' id='593de12b4f20a5000d82a713'>
<a href='#593de12b4f20a5000d82a713'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/59166ec0a06a46001015b555'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/57857e55ddda2ac00736c02e664ffce8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/59166ec0a06a46001015b555'>Warren Menezes</a>
</div>
<a UTCms='1497227563000' class='quanto-date posted-at response-posted-at' href='#593de12b4f20a5000d82a713'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is a very informative thread!!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59412d05d3110a000d148142' id='59412d05d3110a000d148142'>
<a href='#59412d05d3110a000d148142'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1497443589000' class='quanto-date posted-at response-posted-at' href='#59412d05d3110a000d148142'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Where is the Alpha?</p>

<p>It might be hiding in plain sight. In my last notebook: No Alpha No Game it was stated it was a sufficient condition to have an upward bias in the price data to win a long term stock market game. </p>

<p>Often times, people want to look at the game as if randomly set, meaning that the probability of going up is about the same as going down. As if playing a heads or tails game. A game known for centuries to be a zero-sum game and unbeatable except by luck; when, in fact, the stock market game might be something quite different.</p>

<p>The picture below surely does corroborate a 50/50 argumentation. Over the past 5,473 trading days (21 years), about half were up days. Within statistical tolerances, it is saying: 50/50 odds. With such a chart one could indeed consider it a zero-sum game. </p>

<p>1   UP and DOWN Days<br>
<img src="https://image-proxy.quantopian.com/8a6e332964ca0e2fef76acf6f5b86a8e5f9d2d06/687474703a2f2f616c706861706f77657274726164696e672e636f6d2f7175616e746f7069616e2f4142545f3432375f55705f446e5f446179735f322e706e67" /> </p>

<p>However, no one is forced to trade as if it was a casino game. They can, and some do, but nobody forces them to do so. If they do, they should realize what are the odds and stop complaining that they do no win so much over the long haul.</p>

<p>They could, for instance, naively wait for a profit to materialize. It is a continuous betting game and one could leave his/her chips on the table over some time interval. Doing so can change one&#39;s perspective. The question then becomes: </p>

<p>How many days in the past could I have been profitable taking a long position?</p>

<p>That is a very simple question to answer. Draw some lines on a chart, get a visual representation. </p>

<p>I used the same chart, took a snapshot of what was visible on my monitor  (18 months). ABT was the first symbol in my folder and it could easily serve as example to make the point. </p>

<p>2   Profitable Days<br>
<img src="https://image-proxy.quantopian.com/b5847e054392e28099d07a3c064a9c9306cb6a65/687474703a2f2f616c706861706f77657274726164696e672e636f6d2f7175616e746f7069616e2f4142545f3432375f55705f446e5f446179735f775f7472656e64732e706e67" /> </p>

<p>From the above chart, one could have taken a position in any of the past 427 trading days and would have made a profit just by holding on. </p>

<p>It could have been done on any of those days, multiple times, and each would have resulted in a profit. The profit would be there just for having waited for a better day to exit a trade. </p>

<p>Of the 5,473 trading days which represent a sufficient statistical sample, 5,395 were below the last price on the chart. Meaning that 98.57% of all prices in the ABT 21-year history would be showing a profit just for having held on.</p>

<p>It was not a question of gambling in a 50/50 world. It was buying a stock that is prospering over time and giving it the time to do something for you.</p>

<p>Sure, you can gamble that tomorrow will be up. But, do you absolutely have to or need to?</p>

<p>Sounds like just giving a prospering stock some leeway and selecting a sell day when it is profitable for you would appear more appropriate. And looking at the above chart, it could have been done many many times. One could have scaled in and out of position as each position was showing a profit. </p>

<p>Thereby, profiting from price fluctuations without predicting price movements, but still taking advantage of them. Without using any indicator, or whatever contraption, and nonetheless pocketing the profits.</p>

<p>What you want from an automated stock trading program is to have a machine do this for you.</p>

<p>Of note, ABT was not an exception. It might be at the top of the list in my DEVX8 folder, but it does show about the same behavior as the other nine in the list, including DIA serving as benchmark. Here are the summary statistics.</p>

<p>3   Summary Stats<br>
<img src="https://image-proxy.quantopian.com/3b3765b7f0384474620ad42f5280035d0c3eb3ef/687474703a2f2f616c706861706f77657274726164696e672e636f6d2f7175616e746f7069616e2f53756d6d6172795f53746174735f44455658382e706e67" /> </p>

<p>See Related articles<br>
<a href="https://www.linkedin.com/today/author/guy-r-fleury-6041529">https://www.linkedin.com/today/author/guy-r-fleury-6041529</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='594252699c616439328062f9' id='594252699c616439328062f9'>
<a href='#594252699c616439328062f9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1497518697000' class='quanto-date posted-at response-posted-at' href='#594252699c616439328062f9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>profiting from price fluctuations without predicting price movements, but still taking advantage of them. Without using any indicator, or whatever contraption, and nonetheless pocketing the profit</p>
</blockquote>

<p>Unfortunately your entire premise consists of &quot;prediction&quot; and to show a small sample of survivors gives lie to the fact that the majority of stocks end up worthless over time.</p>

<p>To quote the DJIA is a different kettle of fish but still predictive.  You are predicting the continuance of economic growth which may (or may not) prove prescient. </p>

<p>I must politely state that in my opinion your entire approach to stock markets and investment is flawed.  There is of course scope for polite  disagreement in life and the markets and it seems to me that you approach markets from the perspective of a computer programmer rather than a realist or investment professional. </p>

<p>No one can or should doubt the numbers you provide above.  You have taken some numbers, applied some programming and drawn some conclusions. Unfortunately in an uncertain world your conclusions are incomplete or more probably inappropriate to apply to an infinite future.</p>

<p>I realise that I have been your constant critic for some years and a thorn in your flesh. But I hope that I may perhaps have served some useful purpose in curbing your enthusiasm for schemes  which do not, sadly, have much basis in reality.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59441882b6fe1f6fdad9db2b' id='59441882b6fe1f6fdad9db2b'>
<a href='#59441882b6fe1f6fdad9db2b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1497634946000' class='quanto-date posted-at response-posted-at' href='#59441882b6fe1f6fdad9db2b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Mr. Garner, so now, it appears sufficient to add a few numbers together, mostly ones, and it become lies. Awesome. </p>

<p>First, the selected group of stocks is somewhat representative of the market. It had an average, as a group, of about 10-12% in the CAGR department which is close enough to the US long term stock market average. So those 10 stocks were just ordinary. The stocks stayed on my list for the simple reason that their respective last price was higher than their initial price some 21 years ago (p(t) &gt; p(0)).</p>

<p>You find the 10-stock sample too small, then, please do the work. Get a thousand stocks over the last 20 or 30 years and do the calculations. The formula is: nb_up_days += 1. You will find about the same numbers. </p>

<p>Regardless, it could not have been predicted with any accuracy some 20 or 30 years ago that they would still be there today. But that could have been observed day by day over the entire period. Giving at least 7,660 days to observe and decide what to do next.</p>

<p>Stock prices, in general, had been going up for the 220 years prior (kind of corroborating evidence). It is no surprise that prices continued to go up for the next 20 years just as the 10-stock sample.</p>

<p>It is looking at the glass half full or half empty again. Quite an old debate. Personally, I go for the half full scenario with the corroborating evidence. I am not part of the portfolio gloom and doom scene. After all, I&#39;m a pessimist: in the long run, I am not going to make it.</p>

<p>One&#39;s job in building a stock portfolio starts with some reasonable stock selection process. You don&#39;t want everything and the kitchen sink in it. A stock trading strategy is not a fit all do all investment/trading kind of thing or else you are doomed. Every fund manager has to make a selection and allocation. Overall, one could consider whatever is selected as just a small sample of what was really available whatever the selection criteria.</p>

<p>I would point out, Mr. Garner, that even the methods you have demonstrated in the past have also been as selective. Jumping in and out of stocks at the slightest hint of a downturn or shiver rippling in the market average. </p>

<p>You design a long only stock trading strategy, and then claim that most stocks are doomed to oblivion. There is kind of a contradiction in there. </p>

<p>What I find surprising is that based on what you just posted, that you even play the game at all.  </p>

<p>Shouldn&#39;t you somehow prefer the short side of things? With an half empty glass, you would know that there is still half of it available even if it is to the downside because that too is kind of a prediction. So, the market goes up on average, or it goes down. Which will it be? I program as if it was going up! My glass is half full.</p>

<p>Why, some 20 years ago, have you not shorted most stocks all their way down? If you missed the opportunity for whatever reason, it is here again. You can do it for the next 20!</p>

<p>Yes, I do make the prediction that over the long run, the US stock market will be higher on average. I do take the same bet Mr. Buffett has taken over the years. It is directly tied to the prosperity of a nation. In every stock we can see the combined efforts and aspirations of every employee in all these companies resumed to one number. And all every employee wants is to survive and prosper by rendering some kind of service to others while building their own retirement funds. Regrettably, there too some do not make it.</p>

<p>Going forward, some stocks will fade away and disappear. Yes. But the job is not to invest in them all, all the way down. In fact, the job is not only to notice they are there, that we will touch some, but to make sure we are not in them long for the ride down. I presented a chart to that effect in a prior post.</p>

<p>My trading strategies, or my modifications to other peoples strategies, might be complicated, but they do have simple economic reasons for generating their alpha. How hard can it get since any trading strategy can be resumed to just two numbers. </p>

<p>In the end, at bean counting time, we all keep score.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='594423c24ada7210dedbc307' id='594423c24ada7210dedbc307'>
<a href='#594423c24ada7210dedbc307'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1497637826000' class='quanto-date posted-at response-posted-at' href='#594423c24ada7210dedbc307'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>With respect Guy your strategies are far from complex. They are simply naive, ill conceived and unrealistic.  I do not want to upset you or insult you. That has never been my object.</p>

<p>I just don&#39;t believe you think things through properly. This is demonstrated perfectly by the following statement:</p>

<blockquote>
<p>Get a thousand stocks over the last 20 or 30 years and do the calculations. The formula is: nb_up_days += 1. You will find about the same numbers.</p>
</blockquote>

<p>My database contains currently listed as well as delisted stocks and mutual funds. I can&#39;t recall the exact number. 80,000 perhaps?</p>

<p>No one is accusing you of &quot;lying&quot;. Certainly not me. I am sure you have many loyal supporters out there on Wealthlab but not many of them will have much experience. </p>

<p>Your numbers do not &quot;lie&quot; - they are merely produced from naive and unrealistic assumptions.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5945584e13a69d001040b79b' id='5945584e13a69d001040b79b'>
<a href='#5945584e13a69d001040b79b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1497716814000' class='quanto-date posted-at response-posted-at' href='#5945584e13a69d001040b79b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Mr. Garner, </p>

<p>Maybe something you might agree on: </p>

<p>...on some days, somehow, some stocks might go up, and on other days or the same day, some other stocks might go down... </p>

<p>For you, the majority of stocks will end up worthless over time. Which technically should be better played to the downside. But, who am I to argue.</p>

<p>My interest is for stocks that can remain above my selected initial minimum value and gradually move up from there in order to stay selectable in a portfolio. Note that doing so eliminates all companies that fail to prosper going forward. Therefore, I am not that much concerned about stocks going bankrupt since they will fail the test to remain on my selectable list of tradable candidates long before they go down to zero.</p>

<p>People try to do the best stock selection they can and use the best trading strategies they can devise. However, they don&#39;t take an 80,000-stock universe to do so or use thousands of strategies. They don&#39;t add the kitchen sink to the process either. Their interest is mostly for the best performers to play long and, at times, the worse to play short. At the end of the day, all tradable shares of all listed companies are in someone&#39;s hands!</p>

<p>I have a dozen or so trading strategies on my website, each using different approaches, and with a lot of details on their governing equations. </p>

<p>Since, as you say, my strategies are so naive and simple, you could duplicate any of them anytime. Your way of showing how naive and simplistic they really are. Hope you could. But, I seriously doubt it.</p>

<p>Maybe a hint might help. I see the trading strategies used as operating in a tumultuous sea of quasi-unpredictable short term variance. A stochastic process where each stock&#39;s mean and variance are also quasi-random processes of other quasi-random processes with random jumps.</p>

<p>This, as before, turns out to be an unproductive exchange. So, I will let it be.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5946659a3d1768000dc89146' id='5946659a3d1768000dc89146'>
<a href='#5946659a3d1768000dc89146'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/525bc0ee7ace0dc6db000113'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73ff156e6f6dad3b1b0e34c03bcf473a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/525bc0ee7ace0dc6db000113'>Anthony FJ Garner</a>
</div>
<a UTCms='1497785754000' class='quanto-date posted-at response-posted-at' href='#5946659a3d1768000dc89146'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>Therefore, I am not that much concerned about stocks going bankrupt since they will fail the test to remain on my selectable list of tradable candidates long before they go down to zero.</p>
</blockquote>

<p>So how does that fit in with this statement you made in your previous post:</p>

<blockquote>
<p>profiting from price fluctuations without predicting price movements, but still taking advantage of them. Without using any indicator, or whatever contraption, and nonetheless pocketing the profit</p>
</blockquote>

<p>And as to the following statement:</p>

<blockquote>
<p>However, they don&#39;t take an 80,000-stock universe to do so or use thousands of strategies. They don&#39;t add the kitchen sink to the process either.</p>
</blockquote>

<p>No they do not.But they probably could and should. If you insist on sampling then do so on a statistically valid basis by including listed and delisted stocks on a random basis over several draws..</p>

<p>You will then likely see that your following statement no longer holds:</p>

<blockquote>
<p>Get a thousand stocks over the last 20 or 30 years and do the calculations. The formula is: nb_up_days += 1. You will find about the same numbers.</p>
</blockquote>

<p>Unfortunately your analysis of markets does not hold water.  And when you add to that your recommendation for dangerous levels of gearing it becomes readily apparent that you have not worked your analysis through.  If you had you would realise that your account would be wiped out long before your goals were achieved and that in any event you would be closed down by broker margin calls.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='595f89c25e50cd0010a1101d' id='595f89c25e50cd0010a1101d'>
<a href='#595f89c25e50cd0010a1101d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514dfe670841894d6a000016'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/89b2360c313fc6ad474d7364e400b3d8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514dfe670841894d6a000016'>Dan Finkelstein</a>
</div>
<a UTCms='1499433410000' class='quanto-date posted-at response-posted-at' href='#595f89c25e50cd0010a1101d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Did anyone else running this algo live get dealt YUMC at the beginning of the month?  Had a not-so-nice %15 drop yesterday.  I&#39;m wondering what paramaters I should tweak to not get this stock or its ilk next time....  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='595f91c52a9dfe000db6b7c0' id='595f91c52a9dfe000db6b7c0'>
<a href='#595f91c52a9dfe000db6b7c0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562545816f0077be2a000054'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/65eed7bd690af7911cb4e82f70d3a8f6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562545816f0077be2a000054'>Shawn Emhe II</a>
</div>
<a UTCms='1499435461000' class='quanto-date posted-at response-posted-at' href='#595f91c52a9dfe000db6b7c0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Dan,<br>
 The stock took a 15% hit, or your account did? I would say the best protection from a drop like that would be to be diversified. If you were invested in 30 or more stocks that move would equate to .5% or less of your account. But if you were invested with more than half of your account in that stock, which is possible with some of the versions above, then that move could be much more painful.<br>
 That&#39;s why as much as I love math, basic principles outweigh fancy formulas. Especially when those formulas have no bearing on out of sample performance.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='595f9b8c90ae0d5d7797b630' id='595f9b8c90ae0d5d7797b630'>
<a href='#595f9b8c90ae0d5d7797b630'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514dfe670841894d6a000016'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/89b2360c313fc6ad474d7364e400b3d8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514dfe670841894d6a000016'>Dan Finkelstein</a>
</div>
<a UTCms='1499437964000' class='quanto-date posted-at response-posted-at' href='#595f9b8c90ae0d5d7797b630'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yeah, no, I am diversified, and perhaps things like YUMC will just happen from time to time.  Looking at the chart, it does appear to be a &quot;stock on the move&quot;.  It&#39;s only been trading since last October, so perhaps adding a filter to reject newer issues could be something to look into.  But I imagine you&#39;d miss out on other opportunities that way...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59672f35f44988000d0a01fd' id='59672f35f44988000d0a01fd'>
<a href='#59672f35f44988000d0a01fd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5501f65c1417ee47b4000053'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4e1f11275965a4ecbc9abef70305008a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5501f65c1417ee47b4000053'>Geert Nijs</a>
</div>
<a UTCms='1499934517000' class='quanto-date posted-at response-posted-at' href='#59672f35f44988000d0a01fd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well, that is the beauty of diversification: you might miss on the downside, but you will miss on the upside also. And of course you can filter, but where do you start and where do you end: filter on market cap ? PE ? volatility ? age on the stock market ? so many parameters  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5bc5b9ff290772004829bde8' id='5bc5b9ff290772004829bde8'>
<a href='#5bc5b9ff290772004829bde8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5bc5b9a27f87e10048ee646d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8638d6b03cc09adcfff0503847f81f44?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5bc5b9a27f87e10048ee646d'>XAVI GALILEA</a>
</div>
<a UTCms='1539684863000' class='quanto-date posted-at response-posted-at' href='#5bc5b9ff290772004829bde8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello, I have created a google sheet with the 600 stocks of Stoxx600 to use Clenow&#39;s strategy. I have get these numbers, but I think that maybe there&#39;s an error. I see strong stocks in the low side and viceversa.</p>

<p><a href="https://docs.google.com/spreadsheets/d/1gh_CbyCk25NTUradPCyxk-4HkaEnteAZ1C4abfEe0yY/edit?usp=sharing" rel="nofollow">https://docs.google.com/spreadsheets/d/1gh_CbyCk25NTUradPCyxk-4HkaEnteAZ1C4abfEe0yY/edit?usp=sharing</a></p>

<p>Sall you help me? Thanks<br>
By the other side, I use Bloomberg. Andreas told me that there is an API to applied the strategy but I have no idea how to get it. Do you know something about it? Thanks again.</p>

<p>Best</p>

<p>X.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5bc8a9f0d845ac00452607bb' id='5bc8a9f0d845ac00452607bb'>
<a href='#5bc8a9f0d845ac00452607bb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58b5f98a4f96ba3f8c83e410'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6c63f85ea771b1f7f228ae8d9a2345ea?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58b5f98a4f96ba3f8c83e410'>Marc Syp</a>
</div>
<a UTCms='1539877360000' class='quanto-date posted-at response-posted-at' href='#5bc8a9f0d845ac00452607bb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Has anyone updated this algo to use the Optimize API?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5bd8c306c1e70b21a43e4780' id='5bd8c306c1e70b21a43e4780'>
<a href='#5bd8c306c1e70b21a43e4780'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5b43d47ddbcc09004a2c8eff'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e06c6b26508021af2cf7471cd0d99034?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5b43d47ddbcc09004a2c8eff'>Johan Gustawsson</a>
</div>
<a UTCms='1540932358000' class='quanto-date posted-at response-posted-at' href='#5bd8c306c1e70b21a43e4780'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Xavi - How does your function look that produces the slope value? I initially had a similar problem.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5bd95d87edbc0c0c0967df77' id='5bd95d87edbc0c0c0967df77'>
<a href='#5bd95d87edbc0c0c0967df77'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5bc5b9a27f87e10048ee646d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8638d6b03cc09adcfff0503847f81f44?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5bc5b9a27f87e10048ee646d'>XAVI GALILEA</a>
</div>
<a UTCms='1540971911000' class='quanto-date posted-at response-posted-at' href='#5bd95d87edbc0c0c0967df77'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Johan, I finally have solved the problem. Everything works well. I had a problem with the fomulas between the spanish excel and google sheet.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cbfa45d969ccc0041bd2562' id='5cbfa45d969ccc0041bd2562'>
<a href='#5cbfa45d969ccc0041bd2562'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5caf6f06689fcb5beec21ae9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ffaa25e56cd460f1f8308a224512b3d6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5caf6f06689fcb5beec21ae9'>Jackie S</a>
</div>
<a UTCms='1556063325000' class='quanto-date posted-at response-posted-at' href='#5cbfa45d969ccc0041bd2562'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi<br>
Have someone meet the same problem with me? When I tried to clone the code, the feedback is there is an undefined variable update_universe.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cbfdb79a1057d4dd818ac1b' id='5cbfdb79a1057d4dd818ac1b'>
<a href='#5cbfdb79a1057d4dd818ac1b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1556077433000' class='quanto-date posted-at response-posted-at' href='#5cbfdb79a1057d4dd818ac1b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Jackie,</p>

<p>Try <a href="https://www.quantopian.com/posts/stocks-on-the-move-by-andreas-clenow#58da74e4a6291113af9e75a1" rel="nofollow">this  version</a> or something nearby.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cc1e996be38822c6474b464' id='5cc1e996be38822c6474b464'>
<a href='#5cc1e996be38822c6474b464'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/584709c0d105bc4727000072'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fbbdf71510a43bd01dc2b787ecd3c797?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/584709c0d105bc4727000072'>luc prieur</a>
</div>
<a UTCms='1556212118000' class='quanto-date posted-at response-posted-at' href='#5cc1e996be38822c6474b464'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well, that was a good read.   First time I go through this thread.  </p>

<p>Thank you Andreas for commenting on the various posts.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cc32a62a91fc749fdbca7ea' id='5cc32a62a91fc749fdbca7ea'>
<a href='#5cc32a62a91fc749fdbca7ea'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/584709c0d105bc4727000072'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fbbdf71510a43bd01dc2b787ecd3c797?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/584709c0d105bc4727000072'>luc prieur</a>
</div>
<a UTCms='1556294242000' class='quanto-date posted-at response-posted-at' href='#5cc32a62a91fc749fdbca7ea'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is an update algorithm that uses the Clenow Momentum.  I use the portfolio optimization library to run my orders.  There is some original  logic that was not carried over to this updated algo, primarily logic related to position sizing and diversification.</p>

<p>This is NOT an improvement on the Algo.   I just refactored it, simplified the code and used the optimize library.  The output is not optimized, and certainly not overfitted like most in this thread.</p>

<p>Enjoy, </p>

<p>Luc  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cc34ae4cf97110702e27325' id='5cc34ae4cf97110702e27325'>
<a href='#5cc34ae4cf97110702e27325'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/584709c0d105bc4727000072'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fbbdf71510a43bd01dc2b787ecd3c797?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/584709c0d105bc4727000072'>luc prieur</a>
</div>
<a UTCms='1556302564000' class='quanto-date posted-at response-posted-at' href='#5cc34ae4cf97110702e27325'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is the Alphalens analysis of the Clenow Momentum.  It clearly shows alpha, but seems to show more MIC at 90 days then 30 days.  The shorts seem to perform well.  So a long-short could be interesting to investigate.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cc3592442e21d5999694c13' id='5cc3592442e21d5999694c13'>
<a href='#5cc3592442e21d5999694c13'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5103fb5f05e76f5d3a000114'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/26758cf12bcb1e1c124dfd950eaaac96?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5103fb5f05e76f5d3a000114'>Ricardo Hanesy</a>
</div>
<a UTCms='1556306212000' class='quanto-date posted-at response-posted-at' href='#5cc3592442e21d5999694c13'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>If you keep on torturing the data any algorithm with show alpha. Read Taleb&#39;s Fooled by Randomness. Besides look at the drawdown of the strategy.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5cc3758742e21d5999694cc6' id='5cc3758742e21d5999694cc6'>
<a href='#5cc3758742e21d5999694cc6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/584709c0d105bc4727000072'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fbbdf71510a43bd01dc2b787ecd3c797?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/584709c0d105bc4727000072'>luc prieur</a>
</div>
<a UTCms='1556313479000' class='quanto-date posted-at response-posted-at' href='#5cc3758742e21d5999694cc6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I edited my previous post.  The algo is simply a refactored version of the original.  It was not meant to improve performance or what not.  Just a contribution to the community.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5dfd3492071519735bc5a04b' id='5dfd3492071519735bc5a04b'>
<a href='#5dfd3492071519735bc5a04b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5db4c96524ed05004be885f5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b81c045c21684b5687044668d0c8da44?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5db4c96524ed05004be885f5'>Robin Gane-McCalla</a>
</div>
<a UTCms='1576875154000' class='quanto-date posted-at response-posted-at' href='#5dfd3492071519735bc5a04b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I have tried to do what Luc did but with TargetWeights in stead of MaximizeAlpha - most of my results have been bad but this one I attached is curious - a sudden massive one day gain.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/stocks-on-the-move-by-andreas-clenow'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/stocks-on-the-move-by-andreas-clenow'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#a1c7c4c4c5c3c0c2cae1d0d4c0cfd5ced1c8c0cf8fc2cecc">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
