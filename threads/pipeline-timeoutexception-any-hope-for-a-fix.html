<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Pipeline TimeoutException: any hope for a fix?
</title>
<meta content='We have had the issue of Pipeline timing out since forever and the main reason of this time-out is that Pipeline is run in chunks. The first chunk is only few days, so that Pipeline doesn&#39;t time out, but soon after the first chuck is completed Pipelines computes several months of data together and we start experiencing TimeoutExceptions.  I might be wrong but the origin of  TimeoutException was to limit the daily pipeline computation to a fixed amount of time. That makes sense if the...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="EIOTIvBfGqdllp6r0H7PWNFl/2/rcBXACU13zykldGVs5eVvUqnIRNyLx5qfkWcs6evcBpG8ANuLQqylg2AW3g==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/pipeline-timeoutexception-any-hope-for-a-fix' property='og:url'>
<meta content='Pipeline TimeoutException: any hope for a fix?' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/pipeline-timeoutexception-any-hope-for-a-fix' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Pipeline TimeoutException: any hope for a fix?' property='og:title'>
<meta content='We have had the issue of Pipeline timing out since forever and the main reason of this time-out is that Pipeline is run in chunks. The first chunk is only few days, so that Pipeline doesn&#39;t time out, but soon after the first chuck is completed Pipelines computes several months of data together and we start experiencing TimeoutExceptions.  I might be wrong but the origin of  TimeoutException was to limit the daily pipeline computation to a fixed amount of time. That makes sense if the...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/pipeline-timeoutexception-any-hope-for-a-fix">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5af5dbcab26e8e004170fcce'>
<div class='post-container' data-post-id='5af5dbcab26e8e004170fcce' id='5af5dbcab26e8e004170fcce'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Pipeline TimeoutException: any hope for a fix?</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<span class='posted-at'>edited </span>
<span UTCms='1526374273000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Pipeline TimeoutException: any hope for a fix?&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fpipeline-timeoutexception-any-hope-for-a-fix%3Futm_source%3Dwebsite_share%26utm_campaign%3Dpipeline-timeoutexception-any-hope-for-a-fix%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fpipeline-timeoutexception-any-hope-for-a-fix%3Futm_source%3Dwebsite_share%26utm_campaign%3Dpipeline-timeoutexception-any-hope-for-a-fix%26utm_medium%3Dlinkedin&amp;title=Pipeline+TimeoutException%3A+any+hope+for+a+fix%3F+%28Luca%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Seeking Help' data-tag-id='55c50e7d8d4710ec6e000003' href='/posts/tag/Seeking-Help/newest'>Seeking Help</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/pipeline-timeoutexception-any-hope-for-a-fix?utm_source=website_share&amp;utm_campaign=pipeline-timeoutexception-any-hope-for-a-fix&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Luca" />
<div class='body-text'>
<div class='body-text-container post-body'><p>We have had the issue of Pipeline timing out since forever and the main reason of this time-out is that Pipeline is run in chunks. The first chunk is only few days, so that Pipeline doesn&#39;t time out, but soon after the first chuck is completed Pipelines computes several months of data together and we start experiencing TimeoutExceptions.  I might be wrong but the origin of  TimeoutException was to limit the daily pipeline computation to a fixed amount of time. That makes sense if the computation is done day by day, but not with the chunks. Spreading the computation in several chunks is a clever optimization, but the way the time-out is handled makes impossible to write complex algorithms. </p>

<p>I believe the Pipeline TimeoutException should depend on the <strong>daily</strong> computation time and this time-out should scale with the size of the chunk the Pipeline is computing.  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>40 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5b15173d1b493a0048acf856' id='5b15173d1b493a0048acf856'>
<a href='#5b15173d1b493a0048acf856'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/598a1a0d40da7032bc27e6f6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3d7776b021cbcd0f62b56acb7de7a354?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/598a1a0d40da7032bc27e6f6'>Ivory Ant</a>
</div>
<a UTCms='1528108861000' class='quanto-date posted-at response-posted-at' href='#5b15173d1b493a0048acf856'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just ran into the same problem when trying out a really simple regression type algo. It just does a one variable regression for every stock in the QTradableStocksUS universe.</p>

<p>Found these posts about the same thing<br>
<a href="https://www.quantopian.com/posts/feature-request-expose-chunksize-in-pipeline-api-to-allow-predictable-backtesting-of-compute-intensive-pipelines-without-timeout">https://www.quantopian.com/posts/feature-request-expose-chunksize-in-pipeline-api-to-allow-predictable-backtesting-of-compute-intensive-pipelines-without-timeout</a><br>
<a href="https://www.quantopian.com/posts/run-pipeline-in-chunks-and-2-bugs">https://www.quantopian.com/posts/run-pipeline-in-chunks-and-2-bugs</a><br>
<a href="https://www.quantopian.com/posts/how-to-handle-large-initial-computations">https://www.quantopian.com/posts/how-to-handle-large-initial-computations</a><br>
<a href="https://www.quantopian.com/posts/anyone-else-having-timeout-issues-with-pipeline">https://www.quantopian.com/posts/anyone-else-having-timeout-issues-with-pipeline</a><br>
<a href="https://www.quantopian.com/posts/error-timeoutexception-call-to-before-trading-start-timed-out">https://www.quantopian.com/posts/error-timeoutexception-call-to-before-trading-start-timed-out</a><br>
<a href="https://www.quantopian.com/posts/speed-please-2">https://www.quantopian.com/posts/speed-please-2</a><br>
<a href="https://www.quantopian.com/posts/before-trading-start-timeout-of-5-mins-is-not-behaving-correctly-in-backtester">https://www.quantopian.com/posts/before-trading-start-timeout-of-5-mins-is-not-behaving-correctly-in-backtester</a><br>
<a href="https://www.quantopian.com/posts/why-i-cannot-enter-the-contest">https://www.quantopian.com/posts/why-i-cannot-enter-the-contest</a></p>

<p>If a simple linear regression with one variable isn&#39;t going to work, not much will.</p>

<p>Edit: I thought the first thread I linked to contained a temporary workaround, but unfortunately this only works in the notebooks.</p>

<p>Are there any other workarounds for the <em>backtest</em> environment?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b22b4e2987e4e40c2ea69b1' id='5b22b4e2987e4e40c2ea69b1'>
<a href='#5b22b4e2987e4e40c2ea69b1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5346083a839ff34e1400010a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e2319a353b35eac99e765c836ba72044?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5346083a839ff34e1400010a'>Delaney Mackenzie</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1529001186000' class='quanto-date posted-at response-posted-at' href='#5b22b4e2987e4e40c2ea69b1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello folks,</p>

<p>Could you post a simple algorithm here which times out but doesn&#39;t have any of your IP in it? Basically a minimum functionality reproduction of this issue. Or point me to one of the threads where someone did share a strategy which was timing out. It will help us understand what is slow.</p>

<p>Thanks,<br>
Delaney  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b22c597987e4e52a5ea6885' id='5b22c597987e4e52a5ea6885'>
<a href='#5b22c597987e4e52a5ea6885'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1529005463000' class='quanto-date posted-at response-posted-at' href='#5b22c597987e4e52a5ea6885'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here it is. After pipelines computed the first chunk (a bunch of days) it failed computing the second chunk with many more days than the first one. My point is explained above.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b22d09d2ae8e023473d7125' id='5b22d09d2ae8e023473d7125'>
<a href='#5b22d09d2ae8e023473d7125'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4e322fa200fffd0001000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f59406ed486edc76c94544468c11344d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4e322fa200fffd0001000001'>Scott Sanderson</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1529008285000' class='quanto-date posted-at response-posted-at' href='#5b22d09d2ae8e023473d7125'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think the issue here is just that the current implementation of <code>RollingLinearRegression</code> is needlessly <strong>extremely</strong>  slow. The reason for that has very little to do with the numerical complexity of running a regression, it has to do with the the fact that <a href="https://github.com/quantopian/zipline/blob/master/zipline/pipeline/factors/statistical.py#L197-L220">it&#39;s implemented in terms of a loop that calls <code>scipy.stats.linregress</code></a>, which adds a huge amount of overhead (in particular, <code>linregress</code> creates a new nameduple subclass every time it&#39;s invoked, which performs a significant amount of work).</p>

<p>To put into perspective how much those overheads matter, the more recently added <code>SimpleBeta</code> factor (which does roughly the same amount of numerical work), is 100-1000x faster on my development machine for reasonable inputs (see <a href="https://github.com/quantopian/zipline/pull/2021">https://github.com/quantopian/zipline/pull/2021</a> for details on this).</p>

<p>It&#39;s difficult for us to straightforwardly apply the same, optimizations to <code>RollingLinearRegressionOfReturns</code> because its contract is that it provdes many different outputs (it provides, alpha, beta, r_value, p_value, and stderr). </p>

<p>If you just want rolling betas, I&#39;d highly recommend using <code>SimpleBeta</code>. As mentioned above, it&#39;s 2-3 orders of magnitued faster. If you&#39;re using the other outputs from <code>RollingLinearRegressionOfReturns</code>, things are a bit trickier. I have a <a href="https://github.com/quantopian/zipline/pull/2071">PR open in Zipline</a> that applies a similar set of optimizations to <code>RollingPearson</code>/<code>RollingPearsonOfReturns</code>, so that could be a potential replacement for <code>r_value</code>. If you&#39;re using <code>p_value</code> or <code>alpha</code>, we don&#39;t currently have a great solution, but I&#39;d be interested to know if those calculations are important to you.</p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b22d2122ae8e06b7b3d7035' id='5b22d2122ae8e06b7b3d7035'>
<a href='#5b22d2122ae8e06b7b3d7035'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5346083a839ff34e1400010a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e2319a353b35eac99e765c836ba72044?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5346083a839ff34e1400010a'>Delaney Mackenzie</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1529008658000' class='quanto-date posted-at response-posted-at' href='#5b22d2122ae8e06b7b3d7035'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s an example of the same algorithm, but with SimpleBeta swapped in. It runs fine with no timeouts.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b22d2922ae8e0070f3d6fd7' id='5b22d2922ae8e0070f3d6fd7'>
<a href='#5b22d2922ae8e0070f3d6fd7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1529008786000' class='quanto-date posted-at response-posted-at' href='#5b22d2922ae8e0070f3d6fd7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Scott,  that is just an example, I would avoid focusing on RollingLinearRegression. Could you please answer to the more general Pipeline TimeoutException issue that I raised at the top of the thread? Do you believe the timeout makes sense as it is now? Why is not scaled to the size of the chunk computed by Pipeline? What is the point of terminating an algorithm after  few minutes?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b22f6792147dd003de84910' id='5b22f6792147dd003de84910'>
<a href='#5b22f6792147dd003de84910'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529017977000' class='quanto-date posted-at response-posted-at' href='#5b22f6792147dd003de84910'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Luca, I would recommend timing your algo before and after SimpleBeta change.  The speedup is quite remarkable. I have been able to do quite a lot more after I made that change.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b22f8c19b4a160043e9daa8' id='5b22f8c19b4a160043e9daa8'>
<a href='#5b22f8c19b4a160043e9daa8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1529018561000' class='quanto-date posted-at response-posted-at' href='#5b22f8c19b4a160043e9daa8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>I believe the Pipeline TimeoutException should depend on the daily computation time and this time-out should scale with the size of the chunk the Pipeline is computing. </p>
</blockquote>

<p>Yes.  If 5 minutes of compute time is allowed for live trading in 
<code>before_trading_start</code> per day, and a chunk is 2 months, then when the chunk is run, (2 months)x(20 days/month)x(5 minutes/day) = 200 minutes should be allowed for each chunk in backtesting.  This is unrealistic, however.  Each user can launch as many backtests as he wants, and if each one lasts almost forever, times 195,000 users...well, you get the picture.</p>

<p>Reducing the timeout of <code>before_trading_start</code> would be one approach, combined with scaling it up for backtesting.  For example, go to (2 months)x(20 days/month)x(0.5 minutes/day) = 20 minutes, but then anybody who is counting on a 5-minute per day timeout in an algo gets hosed--their algo is broken.</p>

<p>Maybe just keep <code>before_trading_start</code> as-is, and create a new function, e.g. <code>pipeline_compute</code> with the timeout scaling with chunk size for backtesting?  Some caps on total backtest time, and the number of backtests running in parallel could be implemented, too.</p>

<p>Seems like if there is a will, there is a way.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b22fad69b4a16003de9dac6' id='5b22fad69b4a16003de9dac6'>
<a href='#5b22fad69b4a16003de9dac6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1529019094000' class='quanto-date posted-at response-posted-at' href='#5b22fad69b4a16003de9dac6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>THANKS Grant, at last someone got my point right.  I know it is unrealistic a huge value for the timeout, but please keep in mind that algorithms could have a global timeout too (1 hour, 1 day, whatever) and that would dictate the termination of the algorithm. Then it is up to the user deciding how to make use of the available time.  Also if you are not using Pipeline you already have access to more computing time, so I am just saying that the current design is flawed and inconsistent <strong>from a user perspective</strong> (but I am pretty sure it makes sense from Quantopian&#39;s point of view).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b22fc659b4a160043e9dac6' id='5b22fc659b4a160043e9dac6'>
<a href='#5b22fc659b4a160043e9dac6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1529019493000' class='quanto-date posted-at response-posted-at' href='#5b22fc659b4a160043e9dac6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Luca -</p>

<p>Thanks for raising the point again.  It is an architectural flaw, and I&#39;m sure Scott realizes this.  It would be good to hear the options for fixing it (eventually...I understand there may be other priorities, at this point).  I have to think that the Quantopian Enterprise users will bump up against it, as well.  So, why not get the problem out of the way before folks start paying for the platform, and get demanding.  We&#39;re just free-loaders, so in the end, we can&#39;t really complain with any authority.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b23125a9b4a16003de9db80' id='5b23125a9b4a16003de9db80'>
<a href='#5b23125a9b4a16003de9db80'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1529025114000' class='quanto-date posted-at response-posted-at' href='#5b23125a9b4a16003de9db80'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Folks, thanks for this thread...good stuff!</p>

<p>I thought that the main timeout  problem was not the computation, but reading the data into their data-cache.<br>
Two days worth the first call(before_trading_starts), then a number of months worth of data is read after that.<br>
Each day, if the  time-to-fill-the-data-cache + computation-time is &gt; ~300 sec, you are at risk of TimeOutException.</p>

<p>I&#39;ve had contest algos chug along for a long time(even over a year), near the 5 min limit for data+computation, then every so often(a few months), the data cache needs to be renewed,and if you get unlucky, that takes too much time on that particular day, with a particular  load and BOOM, you timeout!</p>

<p>I&#39;d be happy if they  gave us the data-loading for free, and just counted computation time.  I can manage that pretty well with timers.<br>
The data-cache refreshing seems more elusive to manage the cache loading time, and it is frustrating to have an algo go along for a long time...then TimeoutException.</p>

<p>The other solution  is to do a lot of computation off-platform, use the new MyData feature to upload answers from the computations, and use your  300 secs daily allocation  more for data-loading/switching logic/ordering...of course this won&#39;t work too well if your major computations involve exotic free data you&#39;re getting from Q.<br>
alan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b2316919b4a160043e9dbaa' id='5b2316919b4a160043e9dbaa'>
<a href='#5b2316919b4a160043e9dbaa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1529026193000' class='quanto-date posted-at response-posted-at' href='#5b2316919b4a160043e9dbaa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Alan and all, the solution should be simple. </p>

<p>The more we make backtests, the more sophisticated our programs become, requiring more and more processing time. That&#39;s OK, and should be expected. What Q should do is simply provide more time to those needing it.</p>

<p>Say after 1,000 backtests, they double the time, double the storage if a program every touch their current limits. After 2,000 backtests, they could double again, or on request, for those reaching beyond those new limits.</p>

<p>Novices do not need to have extended memory usage, they have a learning curve, but some of you guys surely need the extra time, storage, and would make good use of it. </p>

<p>Anyone that has done over a thousand backtest is a valuable resource to have around. There is a lot of experience in all of you. Q should treat those people much better, otherwise they might just go away for greener pastures. They sure have the skills for it. We already have lost quite a few. </p>

<p>IMHO.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b231bf09b4a160046e9db97' id='5b231bf09b4a160046e9db97'>
<a href='#5b231bf09b4a160046e9db97'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5971e2308bc634000d022f24'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3fff8e67995978b6170deb9d9001a7b6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5971e2308bc634000d022f24'>Joakim Arvidsson (Cream Mongoose)</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529027568000' class='quanto-date posted-at response-posted-at' href='#5b231bf09b4a160046e9db97'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>+1</p>

<p>Thank you for this thread! I&#39;m glad I&#39;m not the only one with the TimeOutException error in before_trading_start. For me it&#39;s been seemingly random, and mostly for algos running in the contest, so quite frustrating. </p>

<p>What&#39;s the best/most efficient way to time my Pipeline computation (so I don&#39;t use up valuable time in before_trading_start)? Something like this?</p>

<pre><code>import time

def before_trading_start(context, data):

    start = time.time()  
    context.output = pipeline_output(&#39;data_pipe&#39;)  
    end = time.time()  
    print(end - start)

</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b2383419b4a160049e9de65' id='5b2383419b4a160049e9de65'>
<a href='#5b2383419b4a160049e9de65'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1529054017000' class='quanto-date posted-at response-posted-at' href='#5b2383419b4a160049e9de65'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In my mind, perhaps the best way to move things forward would be to engage one or more of the prospective Quantopian Enterprise users on topics like this (ideally, summarizing their feedback here on the forum).  First off, presumably at least some of them would have experience with other backtesting/trading platforms and could bring industry best-practices to the table (not that the Quantopian API is a turd, but there&#39;s always room for improvement).  Also, for them, time is money, whereas for Quantopian Community, it is an avocation.  For the Quantopian Enterprise professionals, I&#39;d also expect that commodity compute power is the least of their concerns, and so I&#39;d expect some constructive feedback to the Quantopian team, as they start using the platform.  Any resulting changes driven by paying customers will be beneficial to Quantopian Community, since Fawce assures us on <a href="https://www.quantopian.com/posts/important-news-for-our-community">Important News for Our Community</a>:</p>

<blockquote>
<p>We are committed to maintaining parity between the Quantopian Community and Quantopian Enterprise platform capabilities.</p>
</blockquote>

<p>So, if things play out as I&#39;m thinking they might, we&#39;ll see some changes once Quantopian Enterprise is being used by professionals.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b2399892147dd0040e84e8b' id='5b2399892147dd0040e84e8b'>
<a href='#5b2399892147dd0040e84e8b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/598a1a0d40da7032bc27e6f6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3d7776b021cbcd0f62b56acb7de7a354?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/598a1a0d40da7032bc27e6f6'>Ivory Ant</a>
</div>
<a UTCms='1529059721000' class='quanto-date posted-at response-posted-at' href='#5b2399892147dd0040e84e8b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for looking into it, Q guys.</p>

<p>That said: don&#39;t focus too much on <code>RollingLinearRegression</code> in the specific example Luca gave. The problem occurs for any CustomFactor that takes about 4-5 seconds to calculate per day. It boils down to the timeout heuristic being applied to the entire chunk instead of each day in the chunk (see the calculation Grant provided). I think anyone would agree 4-5 seconds CPU time per-day isn&#39;t very extraordinary (to put it into perspective: I&#39;ve used simple ML models written in C that take e.g. an hour per day, it&#39;s mostly caused by having a big universe)</p>

<p>I was just doing LinearRegression per-symbol for one variable to begin with, to get the basic &#39;framework&#39; up and running. Eventually I&#39;d move onto multiple independent variables and maybe throw in some regularization or non-linear models.</p>

<p>Personally I&#39;m in the process of moving all calculations outside the pipeline so that I can take up to 5 minutes per day. For me it was necessary anyway to get around the <code>window_safe</code> problem, it&#39;s still a big hassle though, and off-by-one errors lurk everywhere.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b23c66285bc700044c85d5b' id='5b23c66285bc700044c85d5b'>
<a href='#5b23c66285bc700044c85d5b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529071202000' class='quanto-date posted-at response-posted-at' href='#5b23c66285bc700044c85d5b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>FWIW my pipeline+before_trading_start takes about 30s per day and I haven&#39;t faced any pipeline timeout issue in 2018. Might not be a systemwide issue. There were a few instances when  some of the 15 year longest running ones would just hang after 12 plus hour, but still no timeout error.</p>

<p>Interpreted languages like Python generally make run time optimizations of huge mathematical calculations harder to debug in my opinion than say compiled code of C/C++. Python/Ruby/Perl etc. are easier to get up and running quickly but need some expertise/painful debugging to speed things up just because there are so many different ways of achieving the same result (and like Scott illustrated above the speed ups can be like 1000x if you do it the right way).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b2453b8ee12002ee1fa41a9' id='5b2453b8ee12002ee1fa41a9'>
<a href='#5b2453b8ee12002ee1fa41a9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1529107384000' class='quanto-date posted-at response-posted-at' href='#5b2453b8ee12002ee1fa41a9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Joakim,<br>
Yes...your timer code is fine.<br>
I embellish mine with recording the max time taken, and in logging the values to see the big jumps in resources used.<br>
When the BTmaxelapsed gets close to 300, you are at risk of timing out the next time the data cache is refreshed.</p>

<pre><code>def initialize(context):  
...
   context.BTmaxelapsed = 0.0 # Init BeforeTrading(BT) max timer  
...

def before_trading_start(context, data):  
    start = time.clock() # Start timer for computation of valid candidate stocks.  
    context.pipeline_data         = pipeline_output(&#39;factors&#39;).fillna(0)  
    context.risk_loading_pipeline = pipeline_output(&#39;risk_loading_pipeline&#39;).fillna(0)

    BTelapsed = time.clock() - start  
    if context.BTmaxelapsed &lt; BTelapsed:  
        context.BTmaxelapsed = BTelapsed  
    log.info(&quot;BTmaxElapsed= {} BTcurElapsed= {}&quot;.format(context.BTmaxelapsed, BTelapsed))

</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b247f22529ccc669541d368' id='5b247f22529ccc669541d368'>
<a href='#5b247f22529ccc669541d368'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4e322fa200fffd0001000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f59406ed486edc76c94544468c11344d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4e322fa200fffd0001000001'>Scott Sanderson</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1529118498000' class='quanto-date posted-at response-posted-at' href='#5b247f22529ccc669541d368'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi All,</p>

<p>Thanks for all the feedback in this thread. I spent some time today putting together my thoughts about how we think about timeouts on Quantopian, and about how we could reduce the negative impact of timeouts. I can&#39;t promise any concrete changes in the near term, but hopefully this helps clarify our current thinking about the issue.</p>

<h2>Why Do We Enforce Timeouts on Quantopian?</h2>

<p>We enforce timeouts on Quantopian algorithms for several reasons:</p>

<h3>Stopping Runaway Code Execution</h3>

<p>The simplest reason we enforce timeouts on Quantopian is that we need to handle the possibility that a user accidentally writes an infinite loop in their algorithm. It&#39;s <a href="https://en.wikipedia.org/wiki/Halting_problem">provably impossible</a> to determine statically whether a long-running algorithm will terminate, so the simplest and most reliable option is to stop the algorithm with an error if it doesn&#39;t appear to make progress.</p>

<p>A similar failure mode happens when an algorithm attempts to solve a computationally intractable problem. <a href="http://www.cvxpy.org/">CVXPY</a>, for example, provides an interface for solving <a href="https://en.wikipedia.org/wiki/Integer_programming">mixed-integer programming</a> problems, which require an impractically long time to solve for large inputs. An algorithm that&#39;s trying to run an <a href="https://en.wikipedia.org/wiki/Time_complexity#Exponential_time">exponential-time</a> algorithm on a large input is, for all practical purposes, the same as an algorithm that&#39;s stuck in an infinite loop.</p>

<h3>Finite Computing Resources</h3>

<p>Running financial simulations requires a lot of computing power. To ensure that Quantopian is available for everyone to use, we limit the amount of resources that we allow any single user to consume. One of our most limited resources is &quot;number of backtests concurrently executing at any given time&quot;. If all of our users ran very long backtests, we&#39;d end up running out of memory and CPU cores to start new backtests, so we limit the amount of time that any backtest is allowed to take. Very long backtests also complicate our ability to perform upgrades reliably.</p>

<h3>Operating and Evaluating Funded Algorithms</h3>

<p>A significant portion of Quantopian&#39;s business is operating algorithms to which we&#39;ve provided <a href="https://www.quantopian.com/allocation">allocations</a>.</p>

<p>For us to be able to operate an algorithm in live trading, it needs to complete regular tasks in a reasonable amount of time. For our purposes here, &quot;reasonable&quot; means something like:</p>

<ol>
<li><code>handle_data</code> and scheduled functions need to complete reliably in under a minute.<br></li>
<li><code>before_trading_start</code> needs to complete reliably in 10-15 minutes (though, ideally it completes much faster than that).</li>
</ol>

<p>In addition to needing to be able to operate an algorithm in live trading, we also need to be able to simulate funded algorithms under various conditions (e.g., simulating different potential allocation sizes or different slippage models). This process doesn&#39;t impose quite the same hard limits that live trading does, but we still need algorithms to complete in a reasonable amount of time for our fund research team to be able to operate effectively.</p>

<h2>How Do Pipelines Get Executed in Algorithms?</h2>

<p>The Pipeline API is a batch execution system. It allows users to specify a set of computations that they&#39;d like to run every day, and it efficiently executes those computations <strong>over a range of multiple days</strong>. The batch execution model is important because it allows us to re-use input data for rolling window calculations. For example, if we write a Factor that processes 200 days of trailing pricing data every day, it&#39;s wasteful to load 200 days&#39; worth of data every day, because 199 of today&#39;s data points were also in yesterday&#39;s data. If we know that we&#39;re going to perform the same rolling window computation every day, it&#39;s much more efficient to pre-fetch <strong>all</strong> the data we&#39;ll need to compute our factor for the next N days and then slide a rolling window over that data to compute our factor.</p>

<p>To take advantage of Pipeline&#39;s batch processing model in algorithms, we pre-compute user-provided pipelines in large &quot;chunks&quot;. The algorithm for this is implemented <a href="https://github.com/quantopian/zipline/blob/de893303b49eb70eb250b4832f1e1718178c7dd8/zipline/algorithm.py#L2459-L2553">here</a> in Zipline. It works as follows:</p>

<ul>
<li>The first time <code>pipeline_output</code> is called in an algorithm, we pre-compute 5 days&#39; of the requested  pipeline&#39;s results and return the result for the current day.<br></li>
<li>On subsequent calls to <code>pipeline_output</code>, we check to see if we&#39;ve already pre-computed the current day&#39;s pipeline result. If we have, we simply return it. If we haven&#39;t, we pre-compute the next block of pipeline output, with a chunksize of 126 trading days (approximately half a year).</li>
</ul>

<p>Some immediate consequences of this algorithm:</p>

<ol>
<li>Most calls to <code>pipeline_output</code> return almost immediately, because they simply return already-computed data.<br></li>
<li>The first time you call <code>pipeline_output</code>, it completes relatively quickly, because we only run a 5-day chunk of your pipeline. This is by design: the purpose of the short first chunk is to reduce the delay between starting an algorithm and getting feedback (either seeing a crash, or seeing performance results). The purpose of the short first chunk is <strong>not</strong> to try to prevent timeouts.<br></li>
<li>Every half year, <code>pipeline_output</code> takes much longer than usual to complete, because we pre-compute the next half-year&#39;s worth of results. Almost all <code>before_trading_start</code> timeouts trigger during one of these full-size pipeline chunk executions, and <code>before_trading_start</code> has a longer timeout than other functions on Quantopian primarily because we want to allow longer pipeline executions (though there are legitimate non-pipeline uses for <code>before_trading_start</code> as a general-purpose &quot;do expensive daily computations&quot; function).</li>
</ol>

<h2>What&#39;s the Problem?</h2>

<p>I think I&#39;m hearing a few distinct concerns in this thread:</p>

<ol>
<li>It&#39;s frustrating to have an algorithm time out during <code>before_trading_start</code> because a <code>pipeline_output</code> call that&#39;s doing half a year&#39;s work took too long.<br></li>
<li>It&#39;s <strong>especially</strong> frustrating to have an algorithm successfully complete its first (short) <code>pipeline_output</code> call, only to time out on a later call after several minutes of simulation.<br></li>
<li>Five minutes isn&#39;t enough time to run a half-year chunk for many reasonable pipelines, especially if you do other non-trivial work in your <code>before_trading_start</code>.</li>
</ol>

<p>To these concerns, I&#39;ll add a fourth issue that I consider a wart on the API: to ensure that pipeline executions fall under the 5-minute <code>before_trading_start</code> timeout, <code>pipeline_output</code> usually needs to be called in <code>before_trading_start</code>, but  often you only need your pipeline output in a later scheduled function. This results in many <code>before_trading_start</code> implementations that look like:</p>

<pre><code>def before_trading_start(context, data):  
    # Stash today&#39;s pipeline results for use later.  
    context.pipeline_data = pipeline_output(&#39;my_pipeline&#39;)

def my_scheduled_function(context, data):  
    # Grab the previously-stored pipeline result.  
    pipeline_data = context.pipeline_data  
</code></pre>

<p>One redeeming feature of this idiom is that it makes it clear that pipeline results only update once per day. For the most part, however, it just feels like boilerplate to me. I think it would be nicer if we could just write:</p>

<pre><code>def my_scheduled_function(context, data):  
    pipeline_data = pipeline_output(&#39;my_pipeline&#39;)  
</code></pre>

<p>and not have to worry about which timeout applies when <code>pipeline_output</code> has to do actual work.</p>

<h2>How Can We Make Things Better?</h2>

<p>The easiest way to reduce the impact of timeouts on Quantopian would be to simply increase our time limits. If we bump the <code>before_trading_start</code> timeout from, say, 5 minutes to 10 minutes, many pipelines that currenty time out would run successfully. The problem with simply increasing the BTS timeout, however, is that an algorithm might actually spend its full 10 minute budget on every call to <code>before_trading_start</code> which would cause the algorithm to take much more time than we could realistically support (even the current 5-minute BTS timeout theoretically allows an algorithm to take over 20 hours to complete a year of simulation, which isn&#39;t really feasible for us to suppport).</p>

<p>In my opinion, a better improvement would be to change how <code>pipeline_output</code> works so that we always run pipeline chunks immediately before the start of <code>before_trading_start</code>. This would allow us to impose a separate, longer, (say, 10 minute), timeout on batched pipeline executions while still preventing algorithms from spending an excessive amount of time every day in <code>before_trading_start</code>. This change would also remove the need for invoking <code>pipeline_output</code> in <code>before_trading_start</code>, because we&#39;d be able to guarantee that pipeline results are ready by the time you request them.</p>

<p>A more radical long-term idea might be to add something like a &quot;progress budget&quot; to the backtester. For example, we might start an algorithm with a 15-minute budget that starts ticking down when the algorithm starts. If the budget hit 0, we would trigger a timeout, but we&#39;d add 5 minutes back to your budget for every month of completed progress. A system like this would enable algorithms that occasionally run a very expensive function, so long as that function wasn&#39;t run too often. Under this system, we&#39;d probably still have to maintain time limits on individual API functions to ensure that we could support live operation, but we might be able to relax them a bit more. Implementing and properly tuning a system like this would require a lot of work, so I think it&#39;s unlikely that we&#39;ll build something like this in the immediate future, but it might be something for us to think about moving forward.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b24913aee12000e36fa4452' id='5b24913aee12000e36fa4452'>
<a href='#5b24913aee12000e36fa4452'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529123130000' class='quanto-date posted-at response-posted-at' href='#5b24913aee12000e36fa4452'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Scott, with regard to your statement &quot;If all of our users ran very long backtests, we&#39;d end up running out of memory and CPU cores to start new backtests, so we limit the amount of time that any backtest is allowed to take.&quot; </p>

<p>It appears to me that Q is trying to make the best of a free solution with timing compromises that works well at an aggregate level for the masses as you take in tens of thousands of new members every month. But recent changes will be at the detriment of active users who are the most likely to contribute to writing new contest style algorithms.</p>

<p>My recommendation would be to identify your target audience,  users who have been able to submit an algorithm to the new contest and give them special benefits. Longer backtest completions, wider timeouts etc.  Or an option to pay for servertime. I would be more than willing to pay for servertime to have long running backtests finish to completion.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b24e1b4e7a9900cb8726da1' id='5b24e1b4e7a9900cb8726da1'>
<a href='#5b24e1b4e7a9900cb8726da1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5971e2308bc634000d022f24'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3fff8e67995978b6170deb9d9001a7b6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5971e2308bc634000d022f24'>Joakim Arvidsson (Cream Mongoose)</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529143732000' class='quanto-date posted-at response-posted-at' href='#5b24e1b4e7a9900cb8726da1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi @Scott,</p>

<p>Thank you for your attention to this, and for providing such a detailed and thorough reply. Really appreciated!</p>

<p>How about a layered control approach? Would it make sense to widen the BTS time out (to say 10 min), and at the same time also impose a wider global time out limit (say 1h / year of backtest) to prevent algos abusing the wider BTS limit?</p>

<p>Also, unfortunately I don&#39;t see any explanation as to why some of us have no time out issues when running backtests, but once submitted to the contest the algo starts to time out in BTS after running fine for a few days. For me this has been the main issue, and I don&#39;t appear to be alone with this problem. Very frustrating.</p>

<p>Hi @Alan,</p>

<p>Thank you for providing your max time recording code.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b24e740e7a9900049726fed' id='5b24e740e7a9900049726fed'>
<a href='#5b24e740e7a9900049726fed'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1529145152000' class='quanto-date posted-at response-posted-at' href='#5b24e740e7a9900049726fed'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Scott -</p>

<p>I think we all appreciate that this is a convoluted, gnarly problem for you guys--a classic system engineering problem.</p>

<p>Before getting into the nitty-gritty, let me just lay something out for consideration:</p>

<p><strong>I&#39;m getting the distinct impression that you simply don&#39;t see compelling use cases for expensive computing on your platform.</strong></p>

<p>If this is a correct assumption, then we are just piddling around.  I don&#39;t mean this to be sarcastic; my assumption is that you&#39;ve thought things through, and the numbers just don&#39;t work out.</p>

<p>Some feedback:</p>

<ol>
<li>&quot;even the current 5-minute BTS timeout theoretically allows an algorithm to take over 20 hours to complete a year of simulation, which isn&#39;t really feasible for us to suppport&quot;--If you cannot support 20-hour simulations, then what can you support?  What is the rationale for this requirement?  For example, at 1 minute per day, 252 trading days per year, if you did support 20-hour simulations (leaving 4 hours <em>every day</em> for upgrades), you could support backtests of 5 year duration, which is decent, but not really gonna cut it for serious R&amp;D.  One approach would be, rather than reserving N hours every day for routine upgrades on-the-fly, to batch the upgrades, and do them on a weekly/monthly/quarterly schedule.<br></li>
<li>At 1 minute per day, going to 10 minutes per 6-month chunk won&#39;t even come close.  You&#39;d need to support 126 minutes for every 6-month chunk, to allow 20-hour backtests covering 5 years of simulated trading.  Why not let users make the trade-off, with an N-hour constraint on backtest time (and perhaps number of concurrent backtests), with 10 minutes of pre-open compute time?<br></li>
<li>&quot;If all of our users ran very long backtests, we&#39;d end up running out of memory and CPU cores to start new backtests, so we limit the amount of time that any backtest is allowed to take.&quot;  This is odd.  I had the impression that you run on an infinitely scalable cloud platform.  So, the idea of running out of anything is lost on me.  Your statement gives the impression that if all 195,000 of your users suddenly got inspired to run backtests, you&#39;d be sunk.  Really?  Wouldn&#39;t you just expand your usage of the cloud platform?  Or are you saying that there is a cost constraint?<br></li>
<li>My understanding is that you also need to run backtests to evaluate algos that users have written, but have not yet received an allocation.  I am under the impression that perhaps <em>all</em> full backtests get a look-see after 6-months, to see if they are worthwhile.  You did not mention this explicitly, but if it is the case, it would be another consideration.<br></li>
<li>My recommendation would be to make a more fundamental break between R&amp;D and production flow.  <em>Anyone doing serious R&amp;D is eventually going to pull their hair out on your platform, frankly.</em>  Your paradigm is that all of the R&amp;D efforts need to smoothly and seamlessly flow into production.  One approach would be to just leave the backtesting/live trading API as-is, but augment the research platform to be able to run backtests with fewer constraints.  Let the R&amp;D drive the production capabilities; this is how technological innovation happens.<br></li>
<li>Above, you mention being able to run &quot;on my development machine&quot; (which presumably is a box sitting on your desk).  If you want to cut through all of this over-constrained nonsense, one idea would be to set up a development machine for users.  In fact, I have won ~$1000 in the current contest, and if you are game, I&#39;d be willing to put it toward a machine, in exchange for a small percentage of the profits on any algo developed on it (I realize traceability is impossible, but so long as I get my $1000 back plus a reasonable return, I&#39;m good).  Perhaps others would be willing to chip in, as well.  I&#39;d even procure the machine, build it, drive it to Boston, and help you set it up.<br></li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b252a3be7a99026be726d76' id='5b252a3be7a99026be726d76'>
<a href='#5b252a3be7a99026be726d76'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1529162299000' class='quanto-date posted-at response-posted-at' href='#5b252a3be7a99026be726d76'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The Q-community is Q&#39;s talent pool. They want from this pool (us) to extract the best talent they can find. Their mission is easy: pick the contest winners. Solving an HR problem at the same time.</p>

<p>The Q-community is composed of really bright people. I see it every day in all those posts, notebooks, algos and insights. I like, read, and appreciate all of it.</p>

<p>The problem is that at times it gets frustrating to have limited access, limited resources.<br>
Timeouts are particularly a problem. In reality, presently, I do not even mind having timeouts. But it does end with: not again! </p>

<p>It is just that they happen AFTER waiting for so long for the program to terminate. Oftentimes with no indication that the program stopped running. And this translates into wasting MY time. Now, that is a big distinction. Such frustration can lead to say: enough of this, move on, find a better solution, and probably you will stop saying: not again *&amp;$/(?/#&amp;@.</p>

<p>Q should consider that their talent pool is composed of people, in a way their hidden diamond in the rough. We are valuable. We are a group of people with the highest standards ready to develop programs not only for ourselves but which could also highly benefit Q.</p>

<p>My word to Q is: take care of your talent pool. Give them the resources they need since that is how you are going to win. It is to your benefit to stop those timeouts. Any day, I would let anyone contributing to the pool of knowledge, or designing sophisticated strategies requiring more resources than others have their way. Any day, I would try to provide whatever they need, even if I had to make exceptions to the rules. Have the most talented use more of the resources if need be.</p>

<p>I would let people like Dan Whitnable with his great contributions, not to mention all the others (it would be too long to list them all) have the resources they need when they need it. It is in your best interest. You should see my point.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b25473fe7a99026be726e59' id='5b25473fe7a99026be726e59'>
<a href='#5b25473fe7a99026be726e59'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1529169727000' class='quanto-date posted-at response-posted-at' href='#5b25473fe7a99026be726e59'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s another thought:</p>

<p>The <a href="https://www.quantopian.com/posts/upload-your-custom-datasets-and-signals-with-self-serve-data">new self-serve data API</a> could be enabled on the research platform (along with my backtesting suggestion above).  Additionally, there would be some way to run a daily script on the research platform, to generate a daily feed, for within-platform upload.  Then, one or more algos could grab the data, and with minimal processing, generate orders.  This has the potential of keeping the backtester/live trading API lightweight, while building up compute resources in the more flexible research platform.</p>

<p>The idea is just a twist on the new self-serve data API, except that everything is done on-platform, and thus all data sets are available, and the user doesn&#39;t need to worry about setting up any infrastructure; everything is integrated in the research platform.</p>

<p>It is reasonable that Quantopian wouldn&#39;t be able to offer unlimited compute resources to the planet.  For those users who are not yet able to offer their services in exchange for resources (e.g. either by merit, contest ranking, or an allocation), it would be reasonable to apply a SaaS model (as we now have for premium data sets, and as will be applied to Quantopian Enterprise institutional users).</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b255193ee120015a3fa48c1' id='5b255193ee120015a3fa48c1'>
<a href='#5b255193ee120015a3fa48c1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1529172371000' class='quanto-date posted-at response-posted-at' href='#5b255193ee120015a3fa48c1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Scott, thank you for your very clear reply and for taking the time of reading and carefully consider our points. Unfortunately I wasn&#39;t able to properly communicate my concern, as I can see it is not mentioned in your reply. Please let me try to express it again.</p>

<p>I started this thread for a pure technical reason, it was a simple request with a limited scope. Then the topic evolved into something else (the limited resources), which is worth discussing anyway, but that wasn&#39;t my point.</p>

<p>Here is my point:  <strong>I believe the current pipeline timeout is flawed and inconsistent</strong> and It&#39;d be nice to fix it. I generally find the choices made by the Q team very elegant and clever but I find really hard to accept the design of this pipeline timeout.</p>

<p><strong>Why is the current behavior flawed?</strong></p>

<p>If I used the Pipeline to simply fetch the data I need (that doesn&#39;t require much time so it can scale to 6 months chunk easily) and I moved all the computation that I otherwise would have done in Pipeline inside 
<code>before_trading_start</code> (or even in <code>handle_data</code>) that would allow at least 5 minutes computation per day, because I would use the time available in <code>before_trading_start</code> for the computation of that single day, not the whole chunk. This means a user has actually access to more daily computation time than what pipeline allows, so why creating this timeout in the first place? My answer is that it is just a poor workaround. What Quantopian would  actually like is a maximum daily computation time, but that is not properly expressed in the algorithm requirements (the timeout is in a specific and optional API) and neither enforced (it can be avoided not using Pipeline for computation). </p>

<p>There is also a subtle dishonesty here. The more Pipeline have become nicer and powerful the more the users have changed their code to make use of Pipeline. Nobody ever told us that we were giving away computation resources. Sure we could  go back and rewrite our computation without Pipeline, like we used to do, but it doesn&#39;t really make sense.</p>

<p><strong>Why is the current behavior inconsistent?</strong></p>

<p>It is inconsistent because it is not deterministic from user perspective. The chunk size is defined by Quantopian, so we are given a fixed Pipeline timeout that depends on a variable size that is defined by someone else. Whaaaaat?<br>
To be consistent Q should tell us what is the daily timeout and scale that to the chunk size. Even if it takes forever to compute the Pipeline output there would be a global algorithm timeout that would stop the algorithm anyway.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b2582e55c34c10040eb9f32' id='5b2582e55c34c10040eb9f32'>
<a href='#5b2582e55c34c10040eb9f32'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529184997000' class='quanto-date posted-at response-posted-at' href='#5b2582e55c34c10040eb9f32'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>&quot;Also, unfortunately I don&#39;t see any explanation as to why some of us have no time out issues when running backtests, but once submitted to the contest the algo starts to time out in BTS after running fine for a few days. For me this has been the main issue, and I don&#39;t appear to be alone with this problem. Very frustrating.&quot;</p>

<p>@Joakim, I can give you a plausible answer because I think I know why. The unpredictability of when you hit the BTS timeouts in a contest vs backtest  indicates that there is a central resource in contention that has varying levels of response times based on current load.  Loads and responsiveness of database systems for instance are a function of the worst query running at that moment.  One bad query can slow down the database and a lot of other queries running at that time.  Applying a global timeout of 5 mins in BTS leaves you to the vagaries of external events outside your algorithm like the ones I mentioned above.  Quantopian needs to fix that  pipeline data refreshes should not be considered as part of user&#39;s BTS timeout. That just introduces a lot of uncertainties in terms of what an user can do in a deterministic way. The timeout should perhaps be separated into a wider pipeline refresh timeout to account for external Quantopian dependancies and a separate BTS timeout that starts once that call returns and actual user processing starts.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b25bc9fcc950a0041e1a8a9' id='5b25bc9fcc950a0041e1a8a9'>
<a href='#5b25bc9fcc950a0041e1a8a9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529199775000' class='quanto-date posted-at response-posted-at' href='#5b25bc9fcc950a0041e1a8a9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Luca, based on my understanding daily BTS timeout is the same 5minute everyday. The only variable is how much time is spent in fetching pipeline data which according to Scotts explanation can be one of three values<br>
Day 1 of simulation: fetch 5 day worth of data<br>
Day 2,3,4,5 use cached pipeline data<br>
Day 6: fetch 126 day worth of pipeline data<br>
Day 7, 8 etc you use cached data </p>

<p>The days you are most likely to hit time-outs are the days 126 days worth of data is fetched and cached in pipeline (what Scott refers to as &quot;when pipeline_output has to do actual work&quot;). That day your time will be 5min - data fetch time for 126 days.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b261d8bcc950a004ae1ab61' id='5b261d8bcc950a004ae1ab61'>
<a href='#5b261d8bcc950a004ae1ab61'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5971e2308bc634000d022f24'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3fff8e67995978b6170deb9d9001a7b6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5971e2308bc634000d022f24'>Joakim Arvidsson (Cream Mongoose)</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529224587000' class='quanto-date posted-at response-posted-at' href='#5b261d8bcc950a004ae1ab61'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks @Leo M!</p>

<p>Your explanation makes perfect sense to me, but then again I&#39;m no expert on Q&#39;s backend infrastructure and application architecture. @Scott is though so hopefully he will be able to shed some light on this and either confirm of deny your explanation.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b26bbec5c34c10046ebaa44' id='5b26bbec5c34c10046ebaa44'>
<a href='#5b26bbec5c34c10046ebaa44'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529265132000' class='quanto-date posted-at response-posted-at' href='#5b26bbec5c34c10046ebaa44'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>My concern is not the timeouts because I dont do minutes worth of computation in BTS, I am getting my backtests hang when they go beyond (10-12 hours), I view them similarly and I did not get any responses to my posts in that regard. Ultimately it boils down to cost and resource allocation.<br>
One path is to reduce the possibilities of what can be done in the platform citing some limitations while allowing the same level of service to current and the 100k+ members joining every year and thus keep going lower and lower on total time a backrest is allowed to run, and the other is to figure out what active members who are trying to write allocation worthy algorithms need and cater to their demands. </p>

<p>Some ideas that come to my mind is charge a yearly membership fee to cover the cost of the service.<br>
Implement priority queues and move jobs between low and medium priority queues based on current resource utilization.</p>

<p>Recent policies like hanging backtests that go beyond 10-12 hours (when it has done 80-90% of the processing) hurts their own purpose by limiting the possibilities on the platform. </p>

<p>Allow 2 hours per year of backtest and don&#39;t hang the process in the middle or towards the tail end, instead move it to a lower priority queue where it does the remainder at a slower rate. That&#39;s my request, similar to  some unlimited data plans where you get the best speeds upto a certain usage and then the speed lowers but still progresses to completion.</p>

<p>For the timeouts, allow a similar scaling up. If the first timeout with 5 min doesn&#39;t get hit then scale it up to like 10min for future days. That will serve both the immeadiate feedback when something is wrong with the algorithm as well as meet the requirements to be able to do long running calculations in BTS without the worry of hitting the 5min timeout.</p>

<p>For the contests, I&#39;d suggest change the BTS timeouts to 10min. You have already screened using contest criteria that the algorithm doesn&#39;t go in an infinite loop. To disqualify a contest entry with rigorous 5min timeout after a few days running in the contest serves no purpose since the original possibility of infinite loop doesn&#39;t exist at that point.</p>

<p>I&#39;d also suggest Quantopian take a longer term view in decision making. If we limit today what strategies users are allowed to develop in the platform using a rationale that Investment team needs quicker turnaround of backtests to operate effectively, what happens if say in 2 years hardware improves to such an extent that you are able to do computations 2x faster, then you suddenly end up in a situation where investment team can evaluate strategies that are lot more computationally intensive but those type of strategies were never allowed in the platform due to past policy restrictions.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b26d0fb5c34c10049ebaadf' id='5b26d0fb5c34c10049ebaadf'>
<a href='#5b26d0fb5c34c10049ebaadf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1529270523000' class='quanto-date posted-at response-posted-at' href='#5b26d0fb5c34c10049ebaadf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another random idea is that compute resource allocation could be an interesting ML problem, in the context of Quantopian.  Q undoubtedly has lots of historical meta-data on users (doesn&#39;t every company operating on the web?), and now a cadre of users who have received allocations, and the contest data, etc.  It should be feasible to caste this into a ML problem, to sort out who gets what resources and when.  Users could also put in requests, by filling out surveys, etc.  Users could also flag their status.  Personally, I&#39;ve been taking a break, since submitting a set of algos to the contest.  One could imagine a scale of 1 to 5, with 1 being hibernation, and 5 being highly active.  In hibernation, for example, one would earn credit toward a burst of high activity (presently, I&#39;d rate my level of effort as a 2).  The ML algo could take this as input, along with other factors, to determine the overall resource allocation for a given individual.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b28cf3864a33000451669b3' id='5b28cf3864a33000451669b3'>
<a href='#5b28cf3864a33000451669b3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529401144000' class='quanto-date posted-at response-posted-at' href='#5b28cf3864a33000451669b3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Reading from @Scott&#39;s explanation and issues raised regarding compute timeouts, it is clear that the problem is one of resource budgeting and management. As an immediate solution, a power user should be able to file a request to support for additional compute time after presenting his use case. Support could then issue a time-bound increase in compute time for the user to test. User reports back to support success / failure of algo. Support decides whether to extend time bound resource allocaton . Something along these lines. This would at least give some sophisticated, compute intensive algos a chance to see its end.</p>

<p>I have a current immediate use case running an ML algo that meets all contest criteria with decent returns and stats but is limited as to the number of stocks  (100-120) to evaluate. Over that, I get  compute timeout. I would like to be able to increase the number of stocks to select from to further diversify and mitigate risks to bring down volatility and drawdown without getting timed out.  Can I file a use case request for increase compute resource allocation to further test my ML algo?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b28d27d2d4bf070c9c4ca7d' id='5b28d27d2d4bf070c9c4ca7d'>
<a href='#5b28d27d2d4bf070c9c4ca7d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1529401981000' class='quanto-date posted-at response-posted-at' href='#5b28d27d2d4bf070c9c4ca7d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Several important considerations:</p>

<ol>
<li>Scalability to a large number of users.<br></li>
<li>Supporting, at any given point in time, users with various levels of compute resources.<br></li>
<li>Need for at least 6 months of out-of-sample time, over which resources would need to be allocated.</li>
</ol>

<p>From a user standpoint, the over-riding issue is that for ~$1000 or so, one could build a desktop workstation that would cream the Q platform.  So, it is kinda silly to be working on an algo that trades $10M with compute resource limitations.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b295e205d6af90040043a30' id='5b295e205d6af90040043a30'>
<a href='#5b295e205d6af90040043a30'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4e322fa200fffd0001000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f59406ed486edc76c94544468c11344d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4e322fa200fffd0001000001'>Scott Sanderson</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1529437728000' class='quanto-date posted-at response-posted-at' href='#5b295e205d6af90040043a30'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Luca:</p>

<p>I think my reply was attempting address the concerns you raised in the original post, though I could have been clearer in explaining exactly why I think the solutions outlined at the end of my post would help. Let me try to clarify:</p>

<p>I believe your concern with current behavior is that we enforce the same timeout on a half-year pipeline execution that we enforce on a single-day&#39;s <code>before_trading_start</code> call, which means, effectively, that we give you 126 times less &quot;compute time per day&quot; for pipeline calculations than we give you for work that happens in BTS proper. That &quot;compute time per day&quot; imbalance means that if you&#39;re trying to optimally take advantage of our current timeout logic, you&#39;re incentivized to move your nontrivial computation logic out of the Pipeline API and into BTS.</p>

<p>I agree with most of that criticism, but I think I disagree with the conclusion that we should create a separate timeout on <code>pipeline_output</code> and scale it to <code>5 * chunksize</code> minutes.</p>

<p>Here&#39;s why I disagree:</p>

<p>We don&#39;t really expect (or want) algorithms to use the full five minutes of <code>before_trading_start</code> time every day. If an algorithm spent that five minutes each day, it would take 21 hours for the algorithm complete a year of backtesting, which isn&#39;t feasible for us to support.</p>

<p>The primary reason that the timeout in <code>before_trading_start</code> is 5 minutes is to support the execution of 126-day pipeline chunks (which we&#39;re okay with because they happen relatively infrequently). The BTS timeout used to be 1 minute. We increased it to 5 minutes a few years ago because many people were hitting pipeline timeouts when using the old morningstar fundamentals API, and the easiest way to allow longer pipeline executions was to increase the timeout of BTS. As I mentioned in my original reply, however, bumping the timeout had the unintended consequence of allowing algorithms to spend much more time doing non-pipeline work in BTS.</p>

<p>So, I think we agree that there&#39;s currently an imbalance between the amount of compute time per day allowed for pipeline vs. non-pipeline calculations, and I think we agree that there are legitimate use-cases for which users might need more than (5 / 126) minutes per day to perform pipeline calculations, but I disagree that the right solution is to simply equalize the compute-time-per-day for pipeline vs. non-pipeline calculations by increasing the pipeline timeout, because:</p>

<ol>
<li>There isn&#39;t actually a distinct &quot;pipeline timeout&quot; right now at all. Our current mechanism for allowing longer pipeline executions is simply to increase the timeout of <code>before_trading_start</code>, which doesn&#39;t actually fix the imbalance, because it increases the time allowed for both pipeline and and non-pipeline executions.<br></li>
<li>If we had a separate pipeline timeout (which I think is a good idea) I don&#39;t think we should make it equal to (<code>5 * chunksize</code> minutes), because we don&#39;t actually want to support algorithms that take that much time every day. The fact that we currently do so is an accidental side-effect of trying to support (occasional) longer pipeline executions.</li>
</ol>

<p>As I mentioned in my original reply, I think the right long-term solution is probably to have a uniform budget of time per backtest-day, which would allow users to decide for themselves how best to allocate their processing time. Implementing and tuning that system would be a fairly involved change though, which is why I think a good incremental improvement would be to move pipeline execution out of <code>before_trading_start</code>, which would allow us to modestly increase the pipeline execution timeout without also increasing the BTS timeout further.</p>

<p>Hope that all makes sense. For the other folks in this thread, I wanted to mention that I&#39;ve read all your comments, and if I don&#39;t reply to you directly it&#39;s only because composing useful replies about this sort of thing takes a long time. Thanks for all the feedback!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b296590be31ed0041e6fcb0' id='5b296590be31ed0041e6fcb0'>
<a href='#5b296590be31ed0041e6fcb0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1529439632000' class='quanto-date posted-at response-posted-at' href='#5b296590be31ed0041e6fcb0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you @Scott for taking the time of properly answer my concerns. As usual your replies are very clear and I am happy that my point has been correctly  understood. I now better understand yours. On my side I am happy now. I still won&#39;t be able to run my algorithms for some time, until Q is able to increase the user resources, but that&#39;s life.  </p>

<p>As a side note, I started this thread because I genuinely thought that the Pipeline timeout was a bug. My reasoning was &quot;since we already have a daily computation time of 5 minutes in BTS + 1 minutes for each 
<code>handle_data</code> then what difference does it make a little more computation time in Pipiline?&quot;. Now the full picture is clear anyway and If I had known that since the beginning I wouldn&#39;t have started the thread. On the other hand there have been other interesting points raised by the other people, so maybe it was worth it.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b2972191ea151004bdbdb03' id='5b2972191ea151004bdbdb03'>
<a href='#5b2972191ea151004bdbdb03'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5971e2308bc634000d022f24'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3fff8e67995978b6170deb9d9001a7b6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5971e2308bc634000d022f24'>Joakim Arvidsson (Cream Mongoose)</a>
<span class='badge medal'></span>
</div>
<a UTCms='1529442841000' class='quanto-date posted-at response-posted-at' href='#5b2972191ea151004bdbdb03'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks @Scott, much appreciated!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b2a1cb4be31ed1a0ae6fb9d' id='5b2a1cb4be31ed1a0ae6fb9d'>
<a href='#5b2a1cb4be31ed1a0ae6fb9d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1529486516000' class='quanto-date posted-at response-posted-at' href='#5b2a1cb4be31ed1a0ae6fb9d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Scott -</p>

<p>Your proposal is summarized in:</p>

<blockquote>
<p>a good incremental improvement would be to move pipeline execution out of before_trading_start, which would allow us to modestly increase the pipeline execution timeout without also increasing the BTS timeout further.</p>
</blockquote>

<p>From an architectural standpoint, this makes sense.  It frees up 
<code>before_trading_start</code> to be used for up to 5 minutes per day, independent of the periodic Pipeline chunking, which would be increased to 10 minutes.  Additionally, users would have ~50 seconds per trading minute available.</p>

<p>I&#39;m confused by a couple statements:</p>

<blockquote>
<p>If all of our users ran very long backtests, we&#39;d end up running out of memory and CPU cores to start new backtests, so we limit the amount of time that any backtest is allowed to take. Very long backtests also complicate our ability to perform upgrades reliably.</p>

<p>As I mentioned in my original reply, I think the right long-term solution is probably to have a uniform budget of time per backtest-day, which would allow users to decide for themselves how best to allocate their processing time. Implementing and tuning that system would be a fairly involved change though...</p>
</blockquote>

<p>So is there actually an automatic limit on how long a backtest can take?  Or are you saying that you manually cut off long-running backtests?</p>

<p>Overall, I gather that you are playing an actuarial game with respect to free compute resources, and the return on this investment.  You should have some decent statistics on usage of your system, and should even be able to do longitudinal studies to understand outcomes on an individual user basis.  Presumably, by design, you allow all users the opportunity to chose to run very long backtests, but have data to support that only a limited number will do so at any given time.  The problem would seem to be self-limiting, as well--most users are not going to want to wait a long time for results, and so one would not expect the vast majority of users to be running long backtests.  So, I don&#39;t understand your concern that lots of users could suddenly start running long backtests.  I guess the idea is that you can control the tail of the distribution with the time-outs under discussion.</p>

<p>I&#39;m curious how this problem is solved by professional quants and their employers.  How do other backtesting engines compare?  Your proposal is to go to 10 minutes per 126 days of Pipeline computations, which works out to (10 minutes)*(60 seconds/minute)/(126 days) = ~ 5 seconds/day.  So, you are advertising a backtesting system that limits computations to 5 seconds per day (assuming that the bulk of the computations are done in Pipeline, which is preferred).  This seems kinda slim.</p>

<p>It seems that any discussion of high-performance computing on Quantopian is on the back burner.  This is perplexing, since I would think this option would be attractive to your Quantopian Enterprise users (and their use case would be different from the Community, so the constraints you mention above would not necessarily apply).  What is the story here?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b32139d66324542e99014f6' id='5b32139d66324542e99014f6'>
<a href='#5b32139d66324542e99014f6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1530008477000' class='quanto-date posted-at response-posted-at' href='#5b32139d66324542e99014f6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yesterday, I got the message below.  No big deal, but the algo was submitted to the new contest when it started (many months ago), and suddenly, out-of-the-blue, it crashed.  Maybe it was on the edge of disaster from the get-go; I did not do a timing analysis when I launched it.  To my knowledge, there is nothing in the algo that would make the run time increase with time (e.g. storing an expanding window of data in <code>context</code>).</p>

<p>If Q support wants to have a look, feel free.  And if you want to review the code, I&#39;d be glad to give you permission, if a deep-dive postmortem would be helpful.</p>

<hr>

<p>Hello Grant,</p>

<p>Your contest entry, multi-factor higher turnover, has been disqualified from the competition for the following reason(s):</p>

<p>Algorithm raised an exception</p>

<p>&quot;TimeoutException: Call to before_trading_start timed out&quot;</p>

<p>Navigate to your dashboard or click here to see the full backtest that generated this result.</p>

<p>After you adjust your algorithm, resubmit it to the contest. Before submitting an entry, you can test whether or not it satisfies the constraints by running it through the notebook in Lesson 11 of the Contest Tutorial.</p>

<p>This is an automatically generated email. Please do not reply to this message. If you need assistance, please email <a href="/cdn-cgi/l/email-protection#46202323222427252d06373327283229362f27286825292b"><span class="__cf_email__" data-cfemail="9afcfffffef8fbf9f1daebeffbf4eef5eaf3fbf4b4f9f5f7">[email&#160;protected]</span></a>.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b3216f523179e09a816506e' id='5b3216f523179e09a816506e'>
<a href='#5b3216f523179e09a816506e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1530009334000' class='quanto-date posted-at response-posted-at' href='#5b3216f523179e09a816506e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Also here yesterday.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b323d19330bee00441fb4ad' id='5b323d19330bee00441fb4ad'>
<a href='#5b323d19330bee00441fb4ad'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b9b56c02cabe5dae000143'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e9388ae5102f3b152fa6225f955a29d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b9b56c02cabe5dae000143'>Alisa Deychman</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1530019097000' class='quanto-date posted-at response-posted-at' href='#5b323d19330bee00441fb4ad'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi all, we have also noticed the spike in contest entries timing out and are looking into it. We don&#39;t have any news to share yet, but once we have an update, we will let you know. </p>

<p>We&#39;re reaching out to those who had entries timeout and are offering to continue them. If we missed you, let us know! Send us a request to <a href="/cdn-cgi/l/email-protection#64020101000605070f241511050a100b140d050a4a070b09"><span class="__cf_email__" data-cfemail="bddbd8d8d9dfdcded6fdccc8dcd3c9d2cdd4dcd393ded2d0">[email&#160;protected]</span></a>.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5b34af20ae8b5800427370a1' id='5b34af20ae8b5800427370a1'>
<a href='#5b34af20ae8b5800427370a1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1530179360000' class='quanto-date posted-at response-posted-at' href='#5b34af20ae8b5800427370a1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Alisa -</p>

<p>Any insight into what happened?  What was the root cause of the spike in contest entries timing out?  And is there anything users can do to guard against the failure mode in the future?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5b463cde3c8d3322422f33b3' id='5b463cde3c8d3322422f33b3'>
<a href='#5b463cde3c8d3322422f33b3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5b11bfb1739a65003b432f75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b8c40dd4ccdba231eba19e431c9b5376?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5b11bfb1739a65003b432f75'>Jacob Nazarenko</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1531329758000' class='quanto-date posted-at response-posted-at' href='#5b463cde3c8d3322422f33b3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi All,</p>

<p>We&#39;ve recently implemented a fix according to Scott&#39;s most recent post above -- please see the original post <a href="https://www.quantopian.com/posts/before-trading-start-timeout-fix">here</a> for more information. </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/pipeline-timeoutexception-any-hope-for-a-fix'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/pipeline-timeoutexception-any-hope-for-a-fix'>join Quantopian</a> to
post a reply.
</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#e7818282838586848ca7969286899388978e8689c984888a">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
